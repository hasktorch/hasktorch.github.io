<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DerivingStrategies #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE PartialTypeSignatures #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE PatternSynonyms #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-17"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-18"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><span id="line-19"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-20"></span><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-partial-type-signatures #-}</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier">Control.Monad.Indexed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier">ireturn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator">(&gt;&gt;&gt;=)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/hlan16hghcygrr1n0fqljpsq2978pxwg-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier">Control.Monad.Indexed.State</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/hlan16hghcygrr1n0fqljpsq2978pxwg-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier">IxStateT</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier">Control.Monad.Indexed.Trans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier">IxMonadTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier">ilift</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier">Data.Functor.Indexed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator">(&lt;&lt;$&gt;&gt;)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator">(&lt;&lt;*&gt;&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier">Data.Kind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/53aqqxvip62j3fkmz3ijr9pig0rgbrmg-singletons-lib-singletons-3.0.1-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">Data.Singletons</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/53aqqxvip62j3fkmz3ijr9pig0rgbrmg-singletons-lib-singletons-3.0.1-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">SingKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/53aqqxvip62j3fkmz3ijr9pig0rgbrmg-singletons-lib-singletons-3.0.1-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">fromSing</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier">GHC.Generics</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier">GHC.TypeLits</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier">Nat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier">Symbol</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html"><span class="hs-identifier">Torch.GraduallyTyped.DType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier">DType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier">DataType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#SDataType"><span class="hs-identifier">SDataType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html"><span class="hs-identifier">Torch.GraduallyTyped.Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier">DeviceType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#SDevice"><span class="hs-identifier">SDevice</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Index.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.Index.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Index.Type.html#Index"><span class="hs-identifier">Index</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Index.Type.html#NegativeIndex"><span class="hs-identifier">NegativeIndex</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Index.Type.html#SIndex"><span class="hs-identifier">SIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html"><span class="hs-identifier">Torch.GraduallyTyped.Layout</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier">Layout</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#LayoutType"><span class="hs-identifier">LayoutType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#SLayout"><span class="hs-identifier">SLayout</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#SLayoutType"><span class="hs-identifier">SLayoutType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Class</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier">HasForward</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier">HasInitialize</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier">HasStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier">ModelSpec</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.NonLinearActivation.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Functional.NonLinearActivation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.NonLinearActivation.html#SoftmaxF"><span class="hs-identifier">SoftmaxF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.NonLinearActivation.html#logSoftmax"><span class="hs-identifier">logSoftmax</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Sparse.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Sparse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Sparse.html#Embedding"><span class="hs-identifier">Embedding</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Sparse.html#EmbeddingSpec"><span class="hs-identifier">EmbeddingSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GLMHead.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.GLMHead</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GLMHead.html#GLMHeadF"><span class="hs-identifier">GLMHeadF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GLMHead.html#lmHeadSpec"><span class="hs-identifier">lmHeadSpec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.GTransformer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TransformerDecoderF"><span class="hs-identifier">TransformerDecoderF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TransformerEncoderF"><span class="hs-identifier">TransformerEncoderF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#transformerDecoderSpec"><span class="hs-identifier">transformerDecoderSpec</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#transformerEncoderSpec"><span class="hs-identifier">transformerEncoderSpec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#STransformerHead"><span class="hs-identifier">STransformerHead</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#STransformerStyle"><span class="hs-identifier">STransformerStyle</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ShiftRight"><span class="hs-identifier">ShiftRight</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerHead"><span class="hs-identifier">TransformerHead</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#WithLMHead"><span class="hs-identifier">WithLMHead</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#WithoutHead"><span class="hs-identifier">WithoutHead</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier">TransformerStyle</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#HasDropout"><span class="hs-identifier">HasDropout</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#SHasDropout"><span class="hs-identifier">SHasDropout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html"><span class="hs-identifier">Torch.GraduallyTyped.Prelude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html#Catch"><span class="hs-identifier">Catch</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html#forgetIsChecked"><span class="hs-identifier">forgetIsChecked</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html#%3A%7C%3A"><span class="hs-operator">(:|:)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.List.html"><span class="hs-identifier">Torch.GraduallyTyped.Prelude.List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/cmxygbwkg9vwm5iizgff5i2x5awqcjjn-singletons-base-lib-singletons-base-3.1-haddock-doc/share/doc/singletons-base/html/src"><span class="hs-identifier">SList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/cmxygbwkg9vwm5iizgff5i2x5awqcjjn-singletons-base-lib-singletons-base-3.1-haddock-doc/share/doc/singletons-base/html/src"><span class="hs-identifier">SNil</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.Maybe.html"><span class="hs-identifier">Torch.GraduallyTyped.Prelude.Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/cmxygbwkg9vwm5iizgff5i2x5awqcjjn-singletons-base-lib-singletons-base-3.1-haddock-doc/share/doc/singletons-base/html/src"><span class="hs-identifier">SMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/cmxygbwkg9vwm5iizgff5i2x5awqcjjn-singletons-base-lib-singletons-base-3.1-haddock-doc/share/doc/singletons-base/html/src"><span class="hs-identifier">SNothing</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.TypeLits.html"><span class="hs-identifier">Torch.GraduallyTyped.Prelude.TypeLits</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/cmxygbwkg9vwm5iizgff5i2x5awqcjjn-singletons-base-lib-singletons-base-3.1-haddock-doc/share/doc/singletons-base/html/src"><span class="hs-identifier">SNat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html"><span class="hs-identifier">Torch.GraduallyTyped.RequiresGradient</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier">Gradient</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier">RequiresGradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#SGradient"><span class="hs-identifier">SGradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.Shape.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#By"><span class="hs-identifier">By</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier">Name</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SBy"><span class="hs-identifier">SBy</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier">SDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SSelectDim"><span class="hs-identifier">SSelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier">Shape</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier">Size</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Indexing.html"><span class="hs-identifier">Torch.GraduallyTyped.Tensor.Indexing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Indexing.html#IndexDims"><span class="hs-identifier">IndexDims</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Indexing.html#IndexType"><span class="hs-identifier">IndexType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Indexing.html#Indices"><span class="hs-identifier">Indices</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Indexing.html#SIndexType"><span class="hs-identifier">SIndexType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Indexing.html#SIndices"><span class="hs-identifier">SIndices</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Indexing.html#%21"><span class="hs-operator">(!)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html"><span class="hs-identifier">Torch.GraduallyTyped.Tensor.IndexingSlicingJoining</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#GatherDimF"><span class="hs-identifier">GatherDimF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#SqueezeDimF"><span class="hs-identifier">SqueezeDimF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#UnsqueezeF"><span class="hs-identifier">UnsqueezeF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#sGatherDim"><span class="hs-identifier">sGatherDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#sSqueezeDim"><span class="hs-identifier">sSqueezeDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#sUnsqueeze"><span class="hs-identifier">sUnsqueeze</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.MathOperations.Pointwise.html"><span class="hs-identifier">Torch.GraduallyTyped.Tensor.MathOperations.Pointwise</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.MathOperations.Pointwise.html#mulScalar"><span class="hs-identifier">mulScalar</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.MathOperations.Reduction.html"><span class="hs-identifier">Torch.GraduallyTyped.Tensor.MathOperations.Reduction</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.MathOperations.Reduction.html#MeanAllCheckF"><span class="hs-identifier">MeanAllCheckF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.MathOperations.Reduction.html#meanAll"><span class="hs-identifier">meanAll</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.Tensor.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier">Tensor</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html"><span class="hs-identifier">Torch.GraduallyTyped.Unify</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator">(&lt;+&gt;)</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%7C%3E"><span class="hs-operator">(&lt;|&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier">Prelude</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier">head</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-comment">-- | Data type that is used to represent whether the encoder-decoder transformer model has a scaled embedding.</span><span>
</span><span id="line-58"></span><span id="local-6989586621679719528"><span id="local-6989586621679719529"></span></span><span class="hs-keyword">data</span><span> </span><span id="EncoderDecoderTransformerHasEmbedScaling"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerHasEmbedScaling"><span class="hs-identifier hs-var">EncoderDecoderTransformerHasEmbedScaling</span></a></span></span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="EncoderDecoderTransformerWithEmbedScaling"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerWithEmbedScaling"><span class="hs-identifier hs-var">EncoderDecoderTransformerWithEmbedScaling</span></a></span></span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="EncoderDecoderTransformerWithoutEmbedScaling"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerWithoutEmbedScaling"><span class="hs-identifier hs-var">EncoderDecoderTransformerWithoutEmbedScaling</span></a></span></span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679719522"><span id="local-6989586621679719524"><span class="annot"><span class="annottext">EncoderDecoderTransformerHasEmbedScaling
-&gt; EncoderDecoderTransformerHasEmbedScaling -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: EncoderDecoderTransformerHasEmbedScaling
-&gt; EncoderDecoderTransformerHasEmbedScaling -&gt; Bool
$c/= :: EncoderDecoderTransformerHasEmbedScaling
-&gt; EncoderDecoderTransformerHasEmbedScaling -&gt; Bool
== :: EncoderDecoderTransformerHasEmbedScaling
-&gt; EncoderDecoderTransformerHasEmbedScaling -&gt; Bool
$c== :: EncoderDecoderTransformerHasEmbedScaling
-&gt; EncoderDecoderTransformerHasEmbedScaling -&gt; Bool
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679719502"><span id="local-6989586621679719504"><span id="local-6989586621679719507"><span id="local-6989586621679719510"><span id="local-6989586621679719513"><span id="local-6989586621679719515"><span id="local-6989586621679719517"><span class="annot"><span class="annottext">Eq EncoderDecoderTransformerHasEmbedScaling
EncoderDecoderTransformerHasEmbedScaling
-&gt; EncoderDecoderTransformerHasEmbedScaling -&gt; Bool
EncoderDecoderTransformerHasEmbedScaling
-&gt; EncoderDecoderTransformerHasEmbedScaling -&gt; Ordering
EncoderDecoderTransformerHasEmbedScaling
-&gt; EncoderDecoderTransformerHasEmbedScaling
-&gt; EncoderDecoderTransformerHasEmbedScaling
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: EncoderDecoderTransformerHasEmbedScaling
-&gt; EncoderDecoderTransformerHasEmbedScaling
-&gt; EncoderDecoderTransformerHasEmbedScaling
$cmin :: EncoderDecoderTransformerHasEmbedScaling
-&gt; EncoderDecoderTransformerHasEmbedScaling
-&gt; EncoderDecoderTransformerHasEmbedScaling
max :: EncoderDecoderTransformerHasEmbedScaling
-&gt; EncoderDecoderTransformerHasEmbedScaling
-&gt; EncoderDecoderTransformerHasEmbedScaling
$cmax :: EncoderDecoderTransformerHasEmbedScaling
-&gt; EncoderDecoderTransformerHasEmbedScaling
-&gt; EncoderDecoderTransformerHasEmbedScaling
&gt;= :: EncoderDecoderTransformerHasEmbedScaling
-&gt; EncoderDecoderTransformerHasEmbedScaling -&gt; Bool
$c&gt;= :: EncoderDecoderTransformerHasEmbedScaling
-&gt; EncoderDecoderTransformerHasEmbedScaling -&gt; Bool
&gt; :: EncoderDecoderTransformerHasEmbedScaling
-&gt; EncoderDecoderTransformerHasEmbedScaling -&gt; Bool
$c&gt; :: EncoderDecoderTransformerHasEmbedScaling
-&gt; EncoderDecoderTransformerHasEmbedScaling -&gt; Bool
&lt;= :: EncoderDecoderTransformerHasEmbedScaling
-&gt; EncoderDecoderTransformerHasEmbedScaling -&gt; Bool
$c&lt;= :: EncoderDecoderTransformerHasEmbedScaling
-&gt; EncoderDecoderTransformerHasEmbedScaling -&gt; Bool
&lt; :: EncoderDecoderTransformerHasEmbedScaling
-&gt; EncoderDecoderTransformerHasEmbedScaling -&gt; Bool
$c&lt; :: EncoderDecoderTransformerHasEmbedScaling
-&gt; EncoderDecoderTransformerHasEmbedScaling -&gt; Bool
compare :: EncoderDecoderTransformerHasEmbedScaling
-&gt; EncoderDecoderTransformerHasEmbedScaling -&gt; Ordering
$ccompare :: EncoderDecoderTransformerHasEmbedScaling
-&gt; EncoderDecoderTransformerHasEmbedScaling -&gt; Ordering
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679719495"><span id="local-6989586621679719497"><span id="local-6989586621679719499"><span class="annot"><span class="annottext">Int -&gt; EncoderDecoderTransformerHasEmbedScaling -&gt; ShowS
[EncoderDecoderTransformerHasEmbedScaling] -&gt; ShowS
EncoderDecoderTransformerHasEmbedScaling -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [EncoderDecoderTransformerHasEmbedScaling] -&gt; ShowS
$cshowList :: [EncoderDecoderTransformerHasEmbedScaling] -&gt; ShowS
show :: EncoderDecoderTransformerHasEmbedScaling -&gt; String
$cshow :: EncoderDecoderTransformerHasEmbedScaling -&gt; String
showsPrec :: Int -&gt; EncoderDecoderTransformerHasEmbedScaling -&gt; ShowS
$cshowsPrec :: Int -&gt; EncoderDecoderTransformerHasEmbedScaling -&gt; ShowS
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall x.
Rep EncoderDecoderTransformerHasEmbedScaling x
-&gt; EncoderDecoderTransformerHasEmbedScaling
forall x.
EncoderDecoderTransformerHasEmbedScaling
-&gt; Rep EncoderDecoderTransformerHasEmbedScaling x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x.
Rep EncoderDecoderTransformerHasEmbedScaling x
-&gt; EncoderDecoderTransformerHasEmbedScaling
$cfrom :: forall x.
EncoderDecoderTransformerHasEmbedScaling
-&gt; Rep EncoderDecoderTransformerHasEmbedScaling x
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="ModelSpec"><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-var">ModelSpec</span></a></span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerHasEmbedScaling"><span class="hs-identifier hs-type">EncoderDecoderTransformerHasEmbedScaling</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerHasEmbedScaling"><span class="hs-identifier hs-type">EncoderDecoderTransformerHasEmbedScaling</span></a></span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679721197"><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerHasEmbedScaling"><span class="hs-identifier hs-type">EncoderDecoderTransformerHasEmbedScaling</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679721197"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerHasEmbedScaling"><span class="hs-identifier hs-type">EncoderDecoderTransformerHasEmbedScaling</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679721197"><span class="hs-identifier hs-type">generatorDevice</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-66"></span><span>  </span><span id="local-6989586621679719481"><span class="annot"><span class="annottext">initialize :: forall (m :: * -&gt; *).
MonadThrow m =&gt;
ModelSpec EncoderDecoderTransformerHasEmbedScaling
-&gt; Generator generatorDevice
-&gt; m (EncoderDecoderTransformerHasEmbedScaling,
      Generator generatorDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var hs-var hs-var hs-var">initialize</span></a></span></span><span> </span><span id="local-6989586621679719479"><span class="annot"><span class="annottext">ModelSpec EncoderDecoderTransformerHasEmbedScaling
</span><a href="#local-6989586621679719479"><span class="hs-identifier hs-var">hasEmbedScaling</span></a></span></span><span> </span><span id="local-6989586621679719478"><span class="annot"><span class="annottext">Generator generatorDevice
</span><a href="#local-6989586621679719478"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModelSpec EncoderDecoderTransformerHasEmbedScaling
</span><a href="#local-6989586621679719479"><span class="hs-identifier hs-var">hasEmbedScaling</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Generator generatorDevice
</span><a href="#local-6989586621679719478"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerHasEmbedScaling"><span class="hs-identifier hs-type">EncoderDecoderTransformerHasEmbedScaling</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-69"></span><span>  </span><span id="local-6989586621679719467"><span class="annot"><span class="annottext">fromStateDict :: forall (m :: * -&gt; *).
(MonadIO m, MonadThrow m, MonadState StateDict m) =&gt;
ModelSpec EncoderDecoderTransformerHasEmbedScaling
-&gt; StateDictKey -&gt; m EncoderDecoderTransformerHasEmbedScaling
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromStateDict</span></a></span></span><span> </span><span id="local-6989586621679719465"><span class="annot"><span class="annottext">ModelSpec EncoderDecoderTransformerHasEmbedScaling
</span><a href="#local-6989586621679719465"><span class="hs-identifier hs-var">hasEmbedScaling</span></a></span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec EncoderDecoderTransformerHasEmbedScaling
</span><a href="#local-6989586621679719465"><span class="hs-identifier hs-var">hasEmbedScaling</span></a></span><span>
</span><span id="line-70"></span><span>  </span><span id="local-6989586621679719459"><span class="annot"><span class="annottext">toStateDict :: forall (m :: * -&gt; *).
(MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; EncoderDecoderTransformerHasEmbedScaling -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var hs-var hs-var hs-var">toStateDict</span></a></span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">EncoderDecoderTransformerHasEmbedScaling
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-comment">-- | Generic encoder-decoder transformer model.</span><span>
</span><span id="line-73"></span><span class="hs-comment">-- This is a model that can be used to encode and decode sequences of variable length.</span><span>
</span><span id="line-74"></span><span class="hs-comment">--</span><span>
</span><span id="line-75"></span><span class="hs-comment">-- - @inputEmbedDim@: the dimension of the input embedding.</span><span>
</span><span id="line-76"></span><span class="hs-comment">-- - @encoder@: a transformer encoder.</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- - @decoder@: a transformer decoder.</span><span>
</span><span id="line-78"></span><span class="hs-comment">-- - @sharedEmbedding@: a shared embedding layer.</span><span>
</span><span id="line-79"></span><span class="hs-comment">-- - @head@: a head layer for the output.</span><span>
</span><span id="line-80"></span><span id="local-6989586621679719456"><span id="local-6989586621679719457"></span></span><span class="hs-keyword">data</span><span>
</span><span id="line-81"></span><span>  </span><span id="GEncoderDecoderTransformer"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GEncoderDecoderTransformer"><span class="hs-identifier hs-var">GEncoderDecoderTransformer</span></a></span></span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679721136"><span class="annot"><a href="#local-6989586621679721136"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679721140"><span class="annot"><a href="#local-6989586621679721140"><span class="hs-identifier hs-type">encoder</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679721139"><span class="annot"><a href="#local-6989586621679721139"><span class="hs-identifier hs-type">decoder</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679721138"><span class="annot"><a href="#local-6989586621679721138"><span class="hs-identifier hs-type">sharedEmbedding</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679721137"><span class="annot"><a href="#local-6989586621679721137"><span class="hs-identifier hs-type">head</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-88"></span><span>  </span><span id="GEncoderDecoderTransformer"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GEncoderDecoderTransformer"><span class="hs-identifier hs-var">GEncoderDecoderTransformer</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679721176"><span class="annot"><a href="#local-6989586621679721176"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679721175"><span class="annot"><a href="#local-6989586621679721175"><span class="hs-identifier hs-type">encoder</span></a></span></span><span> </span><span id="local-6989586621679721174"><span class="annot"><a href="#local-6989586621679721174"><span class="hs-identifier hs-type">decoder</span></a></span></span><span> </span><span id="local-6989586621679721173"><span class="annot"><a href="#local-6989586621679721173"><span class="hs-identifier hs-type">sharedEmbedding</span></a></span></span><span> </span><span id="local-6989586621679721172"><span class="annot"><a href="#local-6989586621679721172"><span class="hs-identifier hs-type">head</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- | input embedding dim for scaling</span><span>
</span><span id="line-91"></span><span>      </span><span id="edtInputEmbedDim"><span class="annot"><span class="annottext">forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head.
GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; SDim inputEmbedDim
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtInputEmbedDim"><span class="hs-identifier hs-var hs-var">edtInputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679721176"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-92"></span><span>      </span><span class="hs-comment">-- | encoder</span><span>
</span><span id="line-93"></span><span>      </span><span id="edtEncoder"><span class="annot"><span class="annottext">forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head.
GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; encoder
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtEncoder"><span class="hs-identifier hs-var hs-var">edtEncoder</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679721175"><span class="hs-identifier hs-type">encoder</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-94"></span><span>      </span><span class="hs-comment">-- | decoder</span><span>
</span><span id="line-95"></span><span>      </span><span id="edtDecoder"><span class="annot"><span class="annottext">forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head.
GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; decoder
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtDecoder"><span class="hs-identifier hs-var hs-var">edtDecoder</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679721174"><span class="hs-identifier hs-type">decoder</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-96"></span><span>      </span><span class="hs-comment">-- | embedding shared between encoder and decoder</span><span>
</span><span id="line-97"></span><span>      </span><span id="edtSharedEmbedding"><span class="annot"><span class="annottext">forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head.
GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; sharedEmbedding
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtSharedEmbedding"><span class="hs-identifier hs-var hs-var">edtSharedEmbedding</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679721173"><span class="hs-identifier hs-type">sharedEmbedding</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-98"></span><span>      </span><span class="hs-comment">-- | transformer head</span><span>
</span><span id="line-99"></span><span>      </span><span id="edtHead"><span class="annot"><span class="annottext">forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head.
GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; head
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtHead"><span class="hs-identifier hs-var hs-var">edtHead</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679721172"><span class="hs-identifier hs-type">head</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-100"></span><span>      </span><span class="hs-comment">-- | embedding scaling</span><span>
</span><span id="line-101"></span><span>      </span><span id="edtEmbedScaling"><span class="annot"><span class="annottext">forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head.
GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; EncoderDecoderTransformerHasEmbedScaling
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtEmbedScaling"><span class="hs-identifier hs-var hs-var">edtEmbedScaling</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerHasEmbedScaling"><span class="hs-identifier hs-type">EncoderDecoderTransformerHasEmbedScaling</span></a></span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-103"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GEncoderDecoderTransformer"><span class="hs-identifier hs-type">GEncoderDecoderTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679721176"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679721175"><span class="hs-identifier hs-type">encoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679721174"><span class="hs-identifier hs-type">decoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679721173"><span class="hs-identifier hs-type">sharedEmbedding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679721172"><span class="hs-identifier hs-type">head</span></a></span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679719434"><span id="local-6989586621679719436"><span id="local-6989586621679719447"><span class="annot"><span class="annottext">Int
-&gt; GEncoderDecoderTransformer
     inputEmbedDim encoder decoder sharedEmbedding head
-&gt; ShowS
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head.
(Show encoder, Show decoder, Show sharedEmbedding, Show head) =&gt;
Int
-&gt; GEncoderDecoderTransformer
     inputEmbedDim encoder decoder sharedEmbedding head
-&gt; ShowS
forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head.
(Show encoder, Show decoder, Show sharedEmbedding, Show head) =&gt;
[GEncoderDecoderTransformer
   inputEmbedDim encoder decoder sharedEmbedding head]
-&gt; ShowS
forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head.
(Show encoder, Show decoder, Show sharedEmbedding, Show head) =&gt;
GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; String
showList :: [GEncoderDecoderTransformer
   inputEmbedDim encoder decoder sharedEmbedding head]
-&gt; ShowS
$cshowList :: forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head.
(Show encoder, Show decoder, Show sharedEmbedding, Show head) =&gt;
[GEncoderDecoderTransformer
   inputEmbedDim encoder decoder sharedEmbedding head]
-&gt; ShowS
show :: GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; String
$cshow :: forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head.
(Show encoder, Show decoder, Show sharedEmbedding, Show head) =&gt;
GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; String
showsPrec :: Int
-&gt; GEncoderDecoderTransformer
     inputEmbedDim encoder decoder sharedEmbedding head
-&gt; ShowS
$cshowsPrec :: forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head.
(Show encoder, Show decoder, Show sharedEmbedding, Show head) =&gt;
Int
-&gt; GEncoderDecoderTransformer
     inputEmbedDim encoder decoder sharedEmbedding head
-&gt; ShowS
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head x.
Rep
  (GEncoderDecoderTransformer
     inputEmbedDim encoder decoder sharedEmbedding head)
  x
-&gt; GEncoderDecoderTransformer
     inputEmbedDim encoder decoder sharedEmbedding head
forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head x.
GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; Rep
     (GEncoderDecoderTransformer
        inputEmbedDim encoder decoder sharedEmbedding head)
     x
$cto :: forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head x.
Rep
  (GEncoderDecoderTransformer
     inputEmbedDim encoder decoder sharedEmbedding head)
  x
-&gt; GEncoderDecoderTransformer
     inputEmbedDim encoder decoder sharedEmbedding head
$cfrom :: forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head x.
GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; Rep
     (GEncoderDecoderTransformer
        inputEmbedDim encoder decoder sharedEmbedding head)
     x
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span>
</span><span id="line-107"></span><span>  </span><span id="ModelSpec"><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-var">ModelSpec</span></a></span></span><span> </span><span id="local-6989586621679719427"><span id="local-6989586621679719428"><span id="local-6989586621679719429"><span id="local-6989586621679719430"><span id="local-6989586621679719431"><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GEncoderDecoderTransformer"><span class="hs-identifier hs-type">GEncoderDecoderTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719431"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719430"><span class="hs-identifier hs-type">encoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719429"><span class="hs-identifier hs-type">decoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719428"><span class="hs-identifier hs-type">sharedEmbedding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719427"><span class="hs-identifier hs-type">head</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-108"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GEncoderDecoderTransformer"><span class="hs-identifier hs-type">GEncoderDecoderTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719431"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719430"><span class="hs-identifier hs-type">encoder</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719429"><span class="hs-identifier hs-type">decoder</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719428"><span class="hs-identifier hs-type">sharedEmbedding</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719427"><span class="hs-identifier hs-type">head</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-111"></span><span>  </span><span id="GEncoderDecoderTransformerF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GEncoderDecoderTransformerF"><span class="hs-identifier hs-var">GEncoderDecoderTransformerF</span></a></span></span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719426"><span class="annot"><a href="#local-6989586621679719426"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719425"><span class="annot"><a href="#local-6989586621679719425"><span class="hs-identifier hs-type">transformerHead</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerHead"><span class="hs-identifier hs-type">TransformerHead</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719424"><span class="annot"><a href="#local-6989586621679719424"><span class="hs-identifier hs-type">numEncoderLayers</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719423"><span class="annot"><a href="#local-6989586621679719423"><span class="hs-identifier hs-type">numDecoderLayers</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719422"><span class="annot"><a href="#local-6989586621679719422"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719421"><span class="annot"><a href="#local-6989586621679719421"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719420"><span class="annot"><a href="#local-6989586621679719420"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719419"><span class="annot"><a href="#local-6989586621679719419"><span class="hs-identifier hs-type">headDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719418"><span class="annot"><a href="#local-6989586621679719418"><span class="hs-identifier hs-type">headEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719417"><span class="annot"><a href="#local-6989586621679719417"><span class="hs-identifier hs-type">embedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719416"><span class="annot"><a href="#local-6989586621679719416"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719415"><span class="annot"><a href="#local-6989586621679719415"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719414"><span class="annot"><a href="#local-6989586621679719414"><span class="hs-identifier hs-type">posEncDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719413"><span class="annot"><a href="#local-6989586621679719413"><span class="hs-identifier hs-type">vocabDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719412"><span class="annot"><a href="#local-6989586621679719412"><span class="hs-identifier hs-type">hasDropout</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#HasDropout"><span class="hs-identifier hs-type">HasDropout</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-127"></span><span>    </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-128"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-129"></span><span>  </span><span id="GEncoderDecoderTransformerF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GEncoderDecoderTransformerF"><span class="hs-identifier hs-var">GEncoderDecoderTransformerF</span></a></span></span><span> </span><span id="local-6989586621679719397"><span id="local-6989586621679719398"><span id="local-6989586621679719399"><span id="local-6989586621679719400"><span id="local-6989586621679719401"><span id="local-6989586621679719402"><span id="local-6989586621679719403"><span id="local-6989586621679719404"><span id="local-6989586621679719405"><span id="local-6989586621679719406"><span id="local-6989586621679719407"><span id="local-6989586621679719408"><span id="local-6989586621679719409"><span id="local-6989586621679719410"><span id="local-6989586621679719411"><span class="annot"><a href="#local-6989586621679719411"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719410"><span class="hs-identifier hs-type">transformerHead</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719409"><span class="hs-identifier hs-type">numEncoderLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719408"><span class="hs-identifier hs-type">numDecoderLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719407"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719406"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719405"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719404"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719403"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719402"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719401"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719400"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719399"><span class="hs-identifier hs-type">posEncDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719398"><span class="hs-identifier hs-type">vocabDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719397"><span class="hs-identifier hs-type">hasDropout</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-130"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GEncoderDecoderTransformer"><span class="hs-identifier hs-type">GEncoderDecoderTransformer</span></a></span><span>
</span><span id="line-131"></span><span>      </span><span class="annot"><a href="#local-6989586621679719401"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span>
</span><span id="line-132"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTEncoderF"><span class="hs-identifier hs-type">EDTEncoderF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719411"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719409"><span class="hs-identifier hs-type">numEncoderLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719407"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719406"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719405"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719404"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719403"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719402"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719401"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719400"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719399"><span class="hs-identifier hs-type">posEncDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719397"><span class="hs-identifier hs-type">hasDropout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTDecoderF"><span class="hs-identifier hs-type">EDTDecoderF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719411"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719408"><span class="hs-identifier hs-type">numDecoderLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719407"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719406"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719405"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719404"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719403"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719402"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719401"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719400"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719399"><span class="hs-identifier hs-type">posEncDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719397"><span class="hs-identifier hs-type">hasDropout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTSharedEmbeddingF"><span class="hs-identifier hs-type">EDTSharedEmbeddingF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719411"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719407"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719406"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719405"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719401"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719398"><span class="hs-identifier hs-type">vocabDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTHeadF"><span class="hs-identifier hs-type">EDTHeadF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719411"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719410"><span class="hs-identifier hs-type">transformerHead</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719407"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719406"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719405"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719401"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719398"><span class="hs-identifier hs-type">vocabDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="hs-comment">-- | Specifies the encoder of the encoder-decoder transformer model.</span><span>
</span><span id="line-138"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-139"></span><span>  </span><span id="EDTEncoderF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTEncoderF"><span class="hs-identifier hs-var">EDTEncoderF</span></a></span></span><span>
</span><span id="line-140"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719393"><span class="annot"><a href="#local-6989586621679719393"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719392"><span class="annot"><a href="#local-6989586621679719392"><span class="hs-identifier hs-type">numEncoderLayers</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719391"><span class="annot"><a href="#local-6989586621679719391"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719390"><span class="annot"><a href="#local-6989586621679719390"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719389"><span class="annot"><a href="#local-6989586621679719389"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719388"><span class="annot"><a href="#local-6989586621679719388"><span class="hs-identifier hs-type">headDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-146"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719387"><span class="annot"><a href="#local-6989586621679719387"><span class="hs-identifier hs-type">headEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719386"><span class="annot"><a href="#local-6989586621679719386"><span class="hs-identifier hs-type">embedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719385"><span class="annot"><a href="#local-6989586621679719385"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719384"><span class="annot"><a href="#local-6989586621679719384"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719383"><span class="annot"><a href="#local-6989586621679719383"><span class="hs-identifier hs-type">posEncDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719382"><span class="annot"><a href="#local-6989586621679719382"><span class="hs-identifier hs-type">hasDropout</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#HasDropout"><span class="hs-identifier hs-type">HasDropout</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-152"></span><span>    </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-153"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-154"></span><span>  </span><span id="EDTEncoderF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTEncoderF"><span class="hs-identifier hs-var">EDTEncoderF</span></a></span></span><span> </span><span id="local-6989586621679719370"><span id="local-6989586621679719371"><span id="local-6989586621679719372"><span id="local-6989586621679719373"><span id="local-6989586621679719374"><span id="local-6989586621679719375"><span id="local-6989586621679719376"><span id="local-6989586621679719377"><span id="local-6989586621679719378"><span id="local-6989586621679719379"><span id="local-6989586621679719380"><span id="local-6989586621679719381"><span class="annot"><a href="#local-6989586621679719381"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719380"><span class="hs-identifier hs-type">numEncoderLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719379"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719378"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719377"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719376"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719375"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719374"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719373"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719372"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719371"><span class="hs-identifier hs-type">posEncDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719370"><span class="hs-identifier hs-type">hasDropout</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-155"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TransformerEncoderF"><span class="hs-identifier hs-type">TransformerEncoderF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719381"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719380"><span class="hs-identifier hs-type">numEncoderLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719379"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719378"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719377"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719376"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719375"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719374"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719373"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719372"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719371"><span class="hs-identifier hs-type">posEncDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719370"><span class="hs-identifier hs-type">hasDropout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="hs-comment">-- | Specifies the decoder of the encoder-decoder transformer model.</span><span>
</span><span id="line-158"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-159"></span><span>  </span><span id="EDTDecoderF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTDecoderF"><span class="hs-identifier hs-var">EDTDecoderF</span></a></span></span><span>
</span><span id="line-160"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719369"><span class="annot"><a href="#local-6989586621679719369"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719368"><span class="annot"><a href="#local-6989586621679719368"><span class="hs-identifier hs-type">numDecoderLayers</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719367"><span class="annot"><a href="#local-6989586621679719367"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719366"><span class="annot"><a href="#local-6989586621679719366"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719365"><span class="annot"><a href="#local-6989586621679719365"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719364"><span class="annot"><a href="#local-6989586621679719364"><span class="hs-identifier hs-type">headDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719363"><span class="annot"><a href="#local-6989586621679719363"><span class="hs-identifier hs-type">headEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719362"><span class="annot"><a href="#local-6989586621679719362"><span class="hs-identifier hs-type">embedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719361"><span class="annot"><a href="#local-6989586621679719361"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719360"><span class="annot"><a href="#local-6989586621679719360"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719359"><span class="annot"><a href="#local-6989586621679719359"><span class="hs-identifier hs-type">posEncDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719358"><span class="annot"><a href="#local-6989586621679719358"><span class="hs-identifier hs-type">hasDropout</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#HasDropout"><span class="hs-identifier hs-type">HasDropout</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-172"></span><span>    </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-173"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-174"></span><span>  </span><span id="EDTDecoderF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTDecoderF"><span class="hs-identifier hs-var">EDTDecoderF</span></a></span></span><span> </span><span id="local-6989586621679719346"><span id="local-6989586621679719347"><span id="local-6989586621679719348"><span id="local-6989586621679719349"><span id="local-6989586621679719350"><span id="local-6989586621679719351"><span id="local-6989586621679719352"><span id="local-6989586621679719353"><span id="local-6989586621679719354"><span id="local-6989586621679719355"><span id="local-6989586621679719356"><span id="local-6989586621679719357"><span class="annot"><a href="#local-6989586621679719357"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719356"><span class="hs-identifier hs-type">numDecoderLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719355"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719354"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719353"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719352"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719351"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719350"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719349"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719348"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719347"><span class="hs-identifier hs-type">posEncDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719346"><span class="hs-identifier hs-type">hasDropout</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-175"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TransformerDecoderF"><span class="hs-identifier hs-type">TransformerDecoderF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719357"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719356"><span class="hs-identifier hs-type">numDecoderLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719355"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719354"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719353"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719352"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719351"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719350"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719349"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719349"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719348"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719347"><span class="hs-identifier hs-type">posEncDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719346"><span class="hs-identifier hs-type">hasDropout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span class="hs-comment">-- | Specifies the shared embedding layer of the encoder-decoder transformer model.</span><span>
</span><span id="line-178"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-179"></span><span>  </span><span id="EDTSharedEmbeddingF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTSharedEmbeddingF"><span class="hs-identifier hs-var">EDTSharedEmbeddingF</span></a></span></span><span>
</span><span id="line-180"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719345"><span class="annot"><a href="#local-6989586621679719345"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719344"><span class="annot"><a href="#local-6989586621679719344"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719343"><span class="annot"><a href="#local-6989586621679719343"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719342"><span class="annot"><a href="#local-6989586621679719342"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719341"><span class="annot"><a href="#local-6989586621679719341"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719340"><span class="annot"><a href="#local-6989586621679719340"><span class="hs-identifier hs-type">vocabDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-187"></span><span>  </span><span id="EDTSharedEmbeddingF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTSharedEmbeddingF"><span class="hs-identifier hs-var">EDTSharedEmbeddingF</span></a></span></span><span> </span><span id="local-6989586621679719335"><span id="local-6989586621679719336"><span id="local-6989586621679719337"><span id="local-6989586621679719338"><span id="local-6989586621679719339"><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="#local-6989586621679719339"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719338"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719337"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719336"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719335"><span class="hs-identifier hs-type">vocabDim</span></a></span></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-188"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Sparse.html#Embedding"><span class="hs-identifier hs-type">Embedding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719339"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier hs-type">Layout</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Dense"><span class="hs-identifier hs-type">Dense</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679719338"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719337"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719335"><span class="hs-identifier hs-type">vocabDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719336"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nothing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span class="hs-comment">-- | Specifies the head of the encoder-decoder transformer model.</span><span>
</span><span id="line-191"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-192"></span><span>  </span><span id="EDTHeadF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTHeadF"><span class="hs-identifier hs-var">EDTHeadF</span></a></span></span><span>
</span><span id="line-193"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719334"><span class="annot"><a href="#local-6989586621679719334"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719333"><span class="annot"><a href="#local-6989586621679719333"><span class="hs-identifier hs-type">transformerHead</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerHead"><span class="hs-identifier hs-type">TransformerHead</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719332"><span class="annot"><a href="#local-6989586621679719332"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719331"><span class="annot"><a href="#local-6989586621679719331"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719330"><span class="annot"><a href="#local-6989586621679719330"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719329"><span class="annot"><a href="#local-6989586621679719329"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719328"><span class="annot"><a href="#local-6989586621679719328"><span class="hs-identifier hs-type">vocabDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-200"></span><span>    </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-201"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-202"></span><span>  </span><span id="EDTHeadF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTHeadF"><span class="hs-identifier hs-var">EDTHeadF</span></a></span></span><span> </span><span id="local-6989586621679719322"><span id="local-6989586621679719323"><span id="local-6989586621679719324"><span id="local-6989586621679719325"><span id="local-6989586621679719326"><span id="local-6989586621679719327"><span class="annot"><a href="#local-6989586621679719327"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#WithoutHead"><span class="hs-identifier hs-type">WithoutHead</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719326"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719325"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719324"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719323"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719322"><span class="hs-identifier hs-type">vocabDim</span></a></span></span></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-203"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>  </span><span id="EDTHeadF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTHeadF"><span class="hs-identifier hs-var">EDTHeadF</span></a></span></span><span> </span><span id="local-6989586621679719316"><span id="local-6989586621679719317"><span id="local-6989586621679719318"><span id="local-6989586621679719319"><span id="local-6989586621679719320"><span id="local-6989586621679719321"><span class="annot"><a href="#local-6989586621679719321"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#WithLMHead"><span class="hs-identifier hs-type">WithLMHead</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719320"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719319"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719318"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719317"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719316"><span class="hs-identifier hs-type">vocabDim</span></a></span></span></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-205"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GLMHead.html#GLMHeadF"><span class="hs-identifier hs-type">GLMHeadF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719321"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719320"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719319"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719318"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719317"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719316"><span class="hs-identifier hs-type">vocabDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="hs-comment">-- | Specifies the parameters of an encoder-decoder transformer model.</span><span>
</span><span id="line-208"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#encoderDecoderTransformerSpec"><span class="hs-identifier hs-type">encoderDecoderTransformerSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-209"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679721128"><span class="annot"><a href="#local-6989586621679721128"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span id="local-6989586621679721126"><span class="annot"><a href="#local-6989586621679721126"><span class="hs-identifier hs-type">transformerHead</span></a></span></span><span> </span><span id="local-6989586621679721124"><span class="annot"><a href="#local-6989586621679721124"><span class="hs-identifier hs-type">numEncoderLayers</span></a></span></span><span> </span><span id="local-6989586621679721122"><span class="annot"><a href="#local-6989586621679721122"><span class="hs-identifier hs-type">numDecoderLayers</span></a></span></span><span> </span><span id="local-6989586621679721121"><span class="annot"><a href="#local-6989586621679721121"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679721119"><span class="annot"><a href="#local-6989586621679721119"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679721117"><span class="annot"><a href="#local-6989586621679721117"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679721115"><span class="annot"><a href="#local-6989586621679721115"><span class="hs-identifier hs-type">headDim</span></a></span></span><span> </span><span id="local-6989586621679721114"><span class="annot"><a href="#local-6989586621679721114"><span class="hs-identifier hs-type">headEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679721113"><span class="annot"><a href="#local-6989586621679721113"><span class="hs-identifier hs-type">embedDim</span></a></span></span><span> </span><span id="local-6989586621679721112"><span class="annot"><a href="#local-6989586621679721112"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679721111"><span class="annot"><a href="#local-6989586621679721111"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span> </span><span id="local-6989586621679721110"><span class="annot"><a href="#local-6989586621679721110"><span class="hs-identifier hs-type">posEncDim</span></a></span></span><span> </span><span id="local-6989586621679721109"><span class="annot"><a href="#local-6989586621679721109"><span class="hs-identifier hs-type">vocabDim</span></a></span></span><span> </span><span id="local-6989586621679721108"><span class="annot"><a href="#local-6989586621679721108"><span class="hs-identifier hs-type">hasDropout</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-210"></span><span>  </span><span class="hs-comment">-- | the style of the encoder-decoder transformer model, e.g. 'ST5', 'SBART', etc.</span><span>
</span><span id="line-211"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#STransformerStyle"><span class="hs-identifier hs-type">STransformerStyle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679721128"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-212"></span><span>  </span><span class="hs-comment">-- | the head of the encoder-decoder transformer model.</span><span>
</span><span id="line-213"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#STransformerHead"><span class="hs-identifier hs-type">STransformerHead</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679721126"><span class="hs-identifier hs-type">transformerHead</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-214"></span><span>  </span><span class="hs-comment">-- | the number of encoder layers of the encoder-decoder transformer model.</span><span>
</span><span id="line-215"></span><span>  </span><span class="annot"><a href="../file:///nix/store/cmxygbwkg9vwm5iizgff5i2x5awqcjjn-singletons-base-lib-singletons-base-3.1-haddock-doc/share/doc/singletons-base/html/src"><span class="hs-identifier hs-type">SNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679721124"><span class="hs-identifier hs-type">numEncoderLayers</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-216"></span><span>  </span><span class="hs-comment">-- | the number of decoder layers of the encoder-decoder transformer model.</span><span>
</span><span id="line-217"></span><span>  </span><span class="annot"><a href="../file:///nix/store/cmxygbwkg9vwm5iizgff5i2x5awqcjjn-singletons-base-lib-singletons-base-3.1-haddock-doc/share/doc/singletons-base/html/src"><span class="hs-identifier hs-type">SNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679721122"><span class="hs-identifier hs-type">numDecoderLayers</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-218"></span><span>  </span><span class="hs-comment">-- | whether or not to compute the gradient of the model parameters</span><span>
</span><span id="line-219"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#SGradient"><span class="hs-identifier hs-type">SGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679721121"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-220"></span><span>  </span><span class="hs-comment">-- | the computational device on which the model is allocated.</span><span>
</span><span id="line-221"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#SDevice"><span class="hs-identifier hs-type">SDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679721119"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-222"></span><span>  </span><span class="hs-comment">-- | the data type of the model parameters.</span><span>
</span><span id="line-223"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#SDataType"><span class="hs-identifier hs-type">SDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679721117"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-224"></span><span>  </span><span class="hs-comment">-- | the dimension of all transformer heads in the encoder-decoder transformer model.</span><span>
</span><span id="line-225"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679721115"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-226"></span><span>  </span><span class="hs-comment">-- | the dimension of the transformer head embeddings.</span><span>
</span><span id="line-227"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679721114"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-228"></span><span>  </span><span class="hs-comment">-- | the dimension of the transformer embeddings.</span><span>
</span><span id="line-229"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679721113"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-comment">-- | the dimension of the input embeddings for both the encoder and the decoder.</span><span>
</span><span id="line-231"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679721112"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-232"></span><span>  </span><span class="hs-comment">-- | the dimension of the feed-forward network.</span><span>
</span><span id="line-233"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679721111"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-234"></span><span>  </span><span class="hs-comment">-- | the dimension of the positional embeddings.</span><span>
</span><span id="line-235"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679721110"><span class="hs-identifier hs-type">posEncDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-236"></span><span>  </span><span class="hs-comment">-- | the dimension of the vocabulary.</span><span>
</span><span id="line-237"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679721109"><span class="hs-identifier hs-type">vocabDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-238"></span><span>  </span><span class="hs-comment">-- | whether or not to use dropout.</span><span>
</span><span id="line-239"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#SHasDropout"><span class="hs-identifier hs-type">SHasDropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679721108"><span class="hs-identifier hs-type">hasDropout</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-240"></span><span>  </span><span class="hs-comment">-- | the dropout rate.</span><span>
</span><span id="line-241"></span><span>  </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-242"></span><span>  </span><span class="hs-comment">-- | the epsilon value for numerical stability of the layer normalization.</span><span>
</span><span id="line-243"></span><span>  </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-244"></span><span>  </span><span class="hs-comment">-- | the parameter specification of an encoder-decoder transformer model.</span><span>
</span><span id="line-245"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GEncoderDecoderTransformerF"><span class="hs-identifier hs-type">GEncoderDecoderTransformerF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679721128"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679721126"><span class="hs-identifier hs-type">transformerHead</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679721124"><span class="hs-identifier hs-type">numEncoderLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679721122"><span class="hs-identifier hs-type">numDecoderLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679721121"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679721119"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679721117"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679721115"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679721114"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679721113"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679721112"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679721111"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679721110"><span class="hs-identifier hs-type">posEncDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679721109"><span class="hs-identifier hs-type">vocabDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679721108"><span class="hs-identifier hs-type">hasDropout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span id="encoderDecoderTransformerSpec"><span class="annot"><span class="annottext">encoderDecoderTransformerSpec :: forall (style :: TransformerStyle)
       (transformerHead :: TransformerHead) (numEncoderLayers :: Nat)
       (numDecoderLayers :: Nat) (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (headDim :: Dim (Name Symbol) (Size Nat))
       (headEmbedDim :: Dim (Name Symbol) (Size Nat))
       (embedDim :: Dim (Name Symbol) (Size Nat))
       (inputEmbedDim :: Dim (Name Symbol) (Size Nat))
       (ffnDim :: Dim (Name Symbol) (Size Nat))
       (posEncDim :: Dim (Name Symbol) (Size Nat))
       (vocabDim :: Dim (Name Symbol) (Size Nat))
       (hasDropout :: HasDropout).
STransformerStyle style
-&gt; STransformerHead transformerHead
-&gt; SNat numEncoderLayers
-&gt; SNat numDecoderLayers
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim headDim
-&gt; SDim headEmbedDim
-&gt; SDim embedDim
-&gt; SDim inputEmbedDim
-&gt; SDim ffnDim
-&gt; SDim posEncDim
-&gt; SDim vocabDim
-&gt; SHasDropout hasDropout
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (GEncoderDecoderTransformerF
        style
        transformerHead
        numEncoderLayers
        numDecoderLayers
        gradient
        device
        dataType
        headDim
        headEmbedDim
        embedDim
        inputEmbedDim
        ffnDim
        posEncDim
        vocabDim
        hasDropout)
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#encoderDecoderTransformerSpec"><span class="hs-identifier hs-var hs-var">encoderDecoderTransformerSpec</span></a></span></span><span> </span><span id="local-6989586621679719314"><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679719314"><span class="hs-identifier hs-var">style</span></a></span></span><span> </span><span id="local-6989586621679719313"><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><a href="#local-6989586621679719313"><span class="hs-identifier hs-var">transformerHead</span></a></span></span><span> </span><span id="local-6989586621679719312"><span class="annot"><span class="annottext">SNat numEncoderLayers
</span><a href="#local-6989586621679719312"><span class="hs-identifier hs-var">numEncoderLayers</span></a></span></span><span> </span><span id="local-6989586621679719311"><span class="annot"><span class="annottext">SNat numDecoderLayers
</span><a href="#local-6989586621679719311"><span class="hs-identifier hs-var">numDecoderLayers</span></a></span></span><span> </span><span id="local-6989586621679719310"><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679719310"><span class="hs-identifier hs-var">gradient</span></a></span></span><span> </span><span id="local-6989586621679719309"><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679719309"><span class="hs-identifier hs-var">device</span></a></span></span><span> </span><span id="local-6989586621679719308"><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679719308"><span class="hs-identifier hs-var">dataType</span></a></span></span><span> </span><span id="local-6989586621679719307"><span class="annot"><span class="annottext">SDim headDim
</span><a href="#local-6989586621679719307"><span class="hs-identifier hs-var">headDim</span></a></span></span><span> </span><span id="local-6989586621679719306"><span class="annot"><span class="annottext">SDim headEmbedDim
</span><a href="#local-6989586621679719306"><span class="hs-identifier hs-var">headEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679719305"><span class="annot"><span class="annottext">SDim embedDim
</span><a href="#local-6989586621679719305"><span class="hs-identifier hs-var">embedDim</span></a></span></span><span> </span><span id="local-6989586621679719304"><span class="annot"><span class="annottext">SDim inputEmbedDim
</span><a href="#local-6989586621679719304"><span class="hs-identifier hs-var">inputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679719303"><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679719303"><span class="hs-identifier hs-var">ffnDim</span></a></span></span><span> </span><span id="local-6989586621679719302"><span class="annot"><span class="annottext">SDim posEncDim
</span><a href="#local-6989586621679719302"><span class="hs-identifier hs-var">posEncDim</span></a></span></span><span> </span><span id="local-6989586621679719301"><span class="annot"><span class="annottext">SDim vocabDim
</span><a href="#local-6989586621679719301"><span class="hs-identifier hs-var">vocabDim</span></a></span></span><span> </span><span id="local-6989586621679719300"><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><a href="#local-6989586621679719300"><span class="hs-identifier hs-var">hasDropout</span></a></span></span><span> </span><span id="local-6989586621679719299"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679719299"><span class="hs-identifier hs-var">dropoutP</span></a></span></span><span> </span><span id="local-6989586621679719298"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679719298"><span class="hs-identifier hs-var">eps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-247"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679719297"><span class="annot"><span class="annottext">encoderSpec :: STransformerStyle style
-&gt; NamedModel
     (GTransformer
        (ModelSpec
           (TEPosEncF style gradient device dataType inputEmbedDim posEncDim))
        (ModelSpec
           (TERelPosEncF style gradient device dataType headDim posEncDim))
        (ModelSpec
           (TEInitialLayerNormF style gradient device dataType inputEmbedDim))
        (ModelSpec (TEInitialDropoutF style hasDropout))
        (NamedModel
           (GTransformerStack
              (VectorSpec
                 numEncoderLayers
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (QInProjF style gradient device dataType inputEmbedDim embedDim)
                                (KInProjF style gradient device dataType inputEmbedDim embedDim)
                                (VInProjF style gradient device dataType inputEmbedDim embedDim)
                                (OutProjF style gradient device dataType embedDim inputEmbedDim)
                                (DropoutF style hasDropout)))
                          (SADropoutF style hasDropout)
                          (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                    ()
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                          (FFNInputTransformationF
                             style gradient device dataType inputEmbedDim ffnDim)
                          (FFNActivationF style)
                          (FFNActivationDropoutF style hasDropout)
                          (FFNOutputProjectionF
                             style gradient device dataType inputEmbedDim ffnDim)
                          (FFNOutputDropoutF style hasDropout)
                          (FFNOutputLayerNormF
                             style gradient device dataType inputEmbedDim)))))))
        (ModelSpec
           (TEFinalLayerNormF style gradient device dataType inputEmbedDim))
        (ModelSpec (TEFinalDropoutF style hasDropout)))
</span><a href="#local-6989586621679719297"><span class="hs-identifier hs-var hs-var">encoderSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;encoder.&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall {style :: TransformerStyle}.
STransformerStyle style
-&gt; GTransformer
     (ModelSpec
        (TEPosEncF style gradient device dataType inputEmbedDim posEncDim))
     (ModelSpec
        (TERelPosEncF style gradient device dataType headDim posEncDim))
     (ModelSpec
        (TEInitialLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TEInitialDropoutF style hasDropout))
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numEncoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             (DropoutF style hasDropout)))
                       (SADropoutF style hasDropout)
                       (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 ()
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                       (FFNInputTransformationF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNActivationF style)
                       (FFNActivationDropoutF style hasDropout)
                       (FFNOutputProjectionF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNOutputDropoutF style hasDropout)
                       (FFNOutputLayerNormF
                          style gradient device dataType inputEmbedDim)))))))
     (ModelSpec
        (TEFinalLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TEFinalDropoutF style hasDropout))
</span><a href="#local-6989586621679719291"><span class="hs-identifier hs-var">encoderSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'T5
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span>
</span><span id="line-248"></span><span>      </span><span class="annot"><a href="#local-6989586621679719297"><span class="hs-identifier hs-var">encoderSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;encoder.&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall {style :: TransformerStyle}.
STransformerStyle style
-&gt; GTransformer
     (ModelSpec
        (TEPosEncF style gradient device dataType inputEmbedDim posEncDim))
     (ModelSpec
        (TERelPosEncF style gradient device dataType headDim posEncDim))
     (ModelSpec
        (TEInitialLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TEInitialDropoutF style hasDropout))
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numEncoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             (DropoutF style hasDropout)))
                       (SADropoutF style hasDropout)
                       (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 ()
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                       (FFNInputTransformationF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNActivationF style)
                       (FFNActivationDropoutF style hasDropout)
                       (FFNOutputProjectionF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNOutputDropoutF style hasDropout)
                       (FFNOutputLayerNormF
                          style gradient device dataType inputEmbedDim)))))))
     (ModelSpec
        (TEFinalLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TEFinalDropoutF style hasDropout))
</span><a href="#local-6989586621679719291"><span class="hs-identifier hs-var">encoderSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'ByT5
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span>
</span><span id="line-249"></span><span>      </span><span class="annot"><a href="#local-6989586621679719297"><span class="hs-identifier hs-var">encoderSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;model.encoder.&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall {style :: TransformerStyle}.
STransformerStyle style
-&gt; GTransformer
     (ModelSpec
        (TEPosEncF style gradient device dataType inputEmbedDim posEncDim))
     (ModelSpec
        (TERelPosEncF style gradient device dataType headDim posEncDim))
     (ModelSpec
        (TEInitialLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TEInitialDropoutF style hasDropout))
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numEncoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             (DropoutF style hasDropout)))
                       (SADropoutF style hasDropout)
                       (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 ()
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                       (FFNInputTransformationF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNActivationF style)
                       (FFNActivationDropoutF style hasDropout)
                       (FFNOutputProjectionF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNOutputDropoutF style hasDropout)
                       (FFNOutputLayerNormF
                          style gradient device dataType inputEmbedDim)))))))
     (ModelSpec
        (TEFinalLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TEFinalDropoutF style hasDropout))
</span><a href="#local-6989586621679719291"><span class="hs-identifier hs-var">encoderSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'BART
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span>
</span><span id="line-250"></span><span>      </span><span class="annot"><a href="#local-6989586621679719297"><span class="hs-identifier hs-var">encoderSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;model.encoder.&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall {style :: TransformerStyle}.
STransformerStyle style
-&gt; GTransformer
     (ModelSpec
        (TEPosEncF style gradient device dataType inputEmbedDim posEncDim))
     (ModelSpec
        (TERelPosEncF style gradient device dataType headDim posEncDim))
     (ModelSpec
        (TEInitialLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TEInitialDropoutF style hasDropout))
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numEncoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             (DropoutF style hasDropout)))
                       (SADropoutF style hasDropout)
                       (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 ()
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                       (FFNInputTransformationF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNActivationF style)
                       (FFNActivationDropoutF style hasDropout)
                       (FFNOutputProjectionF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNOutputDropoutF style hasDropout)
                       (FFNOutputLayerNormF
                          style gradient device dataType inputEmbedDim)))))))
     (ModelSpec
        (TEFinalLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TEFinalDropoutF style hasDropout))
</span><a href="#local-6989586621679719291"><span class="hs-identifier hs-var">encoderSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'MBART
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span>
</span><span id="line-251"></span><span>      </span><span class="annot"><a href="#local-6989586621679719297"><span class="hs-identifier hs-var">encoderSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;model.encoder.&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall {style :: TransformerStyle}.
STransformerStyle style
-&gt; GTransformer
     (ModelSpec
        (TEPosEncF style gradient device dataType inputEmbedDim posEncDim))
     (ModelSpec
        (TERelPosEncF style gradient device dataType headDim posEncDim))
     (ModelSpec
        (TEInitialLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TEInitialDropoutF style hasDropout))
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numEncoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             (DropoutF style hasDropout)))
                       (SADropoutF style hasDropout)
                       (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 ()
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                       (FFNInputTransformationF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNActivationF style)
                       (FFNActivationDropoutF style hasDropout)
                       (FFNOutputProjectionF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNOutputDropoutF style hasDropout)
                       (FFNOutputLayerNormF
                          style gradient device dataType inputEmbedDim)))))))
     (ModelSpec
        (TEFinalLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TEFinalDropoutF style hasDropout))
</span><a href="#local-6989586621679719291"><span class="hs-identifier hs-var">encoderSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'Pegasus
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span>
</span><span id="line-252"></span><span>      </span><span class="annot"><a href="#local-6989586621679719297"><span class="hs-identifier hs-var">encoderSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span>
</span><span id="line-253"></span><span>      </span><span class="annot"><a href="#local-6989586621679719297"><span class="hs-identifier hs-var">encoderSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span>
</span><span id="line-254"></span><span>      </span><span class="annot"><a href="#local-6989586621679719297"><span class="hs-identifier hs-var">encoderSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span>
</span><span id="line-255"></span><span>      </span><span id="local-6989586621679719265"><span class="annot"><span class="annottext">decoderSpec :: STransformerStyle style
-&gt; NamedModel
     (GTransformer
        (ModelSpec
           (TDPosEncF style gradient device dataType inputEmbedDim posEncDim))
        (ModelSpec
           (TDRelPosEncF style gradient device dataType headDim posEncDim))
        (ModelSpec
           (TDInitialLayerNormF style gradient device dataType inputEmbedDim))
        (ModelSpec (TDInitialDropoutF style hasDropout))
        (NamedModel
           (GTransformerStack
              (VectorSpec
                 numDecoderLayers
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (QInProjF style gradient device dataType inputEmbedDim embedDim)
                                (KInProjF style gradient device dataType inputEmbedDim embedDim)
                                (VInProjF style gradient device dataType inputEmbedDim embedDim)
                                (OutProjF style gradient device dataType embedDim inputEmbedDim)
                                (DropoutF style hasDropout)))
                          (SADropoutF style hasDropout)
                          (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                    (NamedModel
                       (GCrossAttention
                          (CAInitialLayerNormF style gradient device dataType inputEmbedDim)
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (QInProjF style gradient device dataType inputEmbedDim embedDim)
                                (KInProjF style gradient device dataType inputEmbedDim embedDim)
                                (VInProjF style gradient device dataType inputEmbedDim embedDim)
                                (OutProjF style gradient device dataType embedDim inputEmbedDim)
                                (DropoutF style hasDropout)))
                          (CADropoutF style hasDropout)
                          (CAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                          (FFNInputTransformationF
                             style gradient device dataType inputEmbedDim ffnDim)
                          (FFNActivationF style)
                          (FFNActivationDropoutF style hasDropout)
                          (FFNOutputProjectionF
                             style gradient device dataType inputEmbedDim ffnDim)
                          (FFNOutputDropoutF style hasDropout)
                          (FFNOutputLayerNormF
                             style gradient device dataType inputEmbedDim)))))))
        (ModelSpec
           (TDFinalLayerNormF style gradient device dataType inputEmbedDim))
        (ModelSpec (TDFinalDropoutF style hasDropout)))
</span><a href="#local-6989586621679719265"><span class="hs-identifier hs-var hs-var">decoderSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;decoder.&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall {style :: TransformerStyle}.
STransformerStyle style
-&gt; GTransformer
     (ModelSpec
        (TDPosEncF style gradient device dataType inputEmbedDim posEncDim))
     (ModelSpec
        (TDRelPosEncF style gradient device dataType headDim posEncDim))
     (ModelSpec
        (TDInitialLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TDInitialDropoutF style hasDropout))
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numDecoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             (DropoutF style hasDropout)))
                       (SADropoutF style hasDropout)
                       (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 (NamedModel
                    (GCrossAttention
                       (CAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             (DropoutF style hasDropout)))
                       (CADropoutF style hasDropout)
                       (CAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                       (FFNInputTransformationF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNActivationF style)
                       (FFNActivationDropoutF style hasDropout)
                       (FFNOutputProjectionF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNOutputDropoutF style hasDropout)
                       (FFNOutputLayerNormF
                          style gradient device dataType inputEmbedDim)))))))
     (ModelSpec
        (TDFinalLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TDFinalDropoutF style hasDropout))
</span><a href="#local-6989586621679719262"><span class="hs-identifier hs-var">decoderSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'T5
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span>
</span><span id="line-256"></span><span>      </span><span class="annot"><a href="#local-6989586621679719265"><span class="hs-identifier hs-var">decoderSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;decoder.&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall {style :: TransformerStyle}.
STransformerStyle style
-&gt; GTransformer
     (ModelSpec
        (TDPosEncF style gradient device dataType inputEmbedDim posEncDim))
     (ModelSpec
        (TDRelPosEncF style gradient device dataType headDim posEncDim))
     (ModelSpec
        (TDInitialLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TDInitialDropoutF style hasDropout))
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numDecoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             (DropoutF style hasDropout)))
                       (SADropoutF style hasDropout)
                       (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 (NamedModel
                    (GCrossAttention
                       (CAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             (DropoutF style hasDropout)))
                       (CADropoutF style hasDropout)
                       (CAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                       (FFNInputTransformationF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNActivationF style)
                       (FFNActivationDropoutF style hasDropout)
                       (FFNOutputProjectionF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNOutputDropoutF style hasDropout)
                       (FFNOutputLayerNormF
                          style gradient device dataType inputEmbedDim)))))))
     (ModelSpec
        (TDFinalLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TDFinalDropoutF style hasDropout))
</span><a href="#local-6989586621679719262"><span class="hs-identifier hs-var">decoderSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'ByT5
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span>
</span><span id="line-257"></span><span>      </span><span class="annot"><a href="#local-6989586621679719265"><span class="hs-identifier hs-var">decoderSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;model.decoder.&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall {style :: TransformerStyle}.
STransformerStyle style
-&gt; GTransformer
     (ModelSpec
        (TDPosEncF style gradient device dataType inputEmbedDim posEncDim))
     (ModelSpec
        (TDRelPosEncF style gradient device dataType headDim posEncDim))
     (ModelSpec
        (TDInitialLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TDInitialDropoutF style hasDropout))
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numDecoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             (DropoutF style hasDropout)))
                       (SADropoutF style hasDropout)
                       (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 (NamedModel
                    (GCrossAttention
                       (CAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             (DropoutF style hasDropout)))
                       (CADropoutF style hasDropout)
                       (CAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                       (FFNInputTransformationF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNActivationF style)
                       (FFNActivationDropoutF style hasDropout)
                       (FFNOutputProjectionF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNOutputDropoutF style hasDropout)
                       (FFNOutputLayerNormF
                          style gradient device dataType inputEmbedDim)))))))
     (ModelSpec
        (TDFinalLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TDFinalDropoutF style hasDropout))
</span><a href="#local-6989586621679719262"><span class="hs-identifier hs-var">decoderSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'BART
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span>
</span><span id="line-258"></span><span>      </span><span class="annot"><a href="#local-6989586621679719265"><span class="hs-identifier hs-var">decoderSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;model.decoder.&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall {style :: TransformerStyle}.
STransformerStyle style
-&gt; GTransformer
     (ModelSpec
        (TDPosEncF style gradient device dataType inputEmbedDim posEncDim))
     (ModelSpec
        (TDRelPosEncF style gradient device dataType headDim posEncDim))
     (ModelSpec
        (TDInitialLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TDInitialDropoutF style hasDropout))
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numDecoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             (DropoutF style hasDropout)))
                       (SADropoutF style hasDropout)
                       (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 (NamedModel
                    (GCrossAttention
                       (CAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             (DropoutF style hasDropout)))
                       (CADropoutF style hasDropout)
                       (CAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                       (FFNInputTransformationF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNActivationF style)
                       (FFNActivationDropoutF style hasDropout)
                       (FFNOutputProjectionF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNOutputDropoutF style hasDropout)
                       (FFNOutputLayerNormF
                          style gradient device dataType inputEmbedDim)))))))
     (ModelSpec
        (TDFinalLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TDFinalDropoutF style hasDropout))
</span><a href="#local-6989586621679719262"><span class="hs-identifier hs-var">decoderSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'MBART
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span>
</span><span id="line-259"></span><span>      </span><span class="annot"><a href="#local-6989586621679719265"><span class="hs-identifier hs-var">decoderSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;model.decoder.&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall {style :: TransformerStyle}.
STransformerStyle style
-&gt; GTransformer
     (ModelSpec
        (TDPosEncF style gradient device dataType inputEmbedDim posEncDim))
     (ModelSpec
        (TDRelPosEncF style gradient device dataType headDim posEncDim))
     (ModelSpec
        (TDInitialLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TDInitialDropoutF style hasDropout))
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numDecoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             (DropoutF style hasDropout)))
                       (SADropoutF style hasDropout)
                       (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 (NamedModel
                    (GCrossAttention
                       (CAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             (DropoutF style hasDropout)))
                       (CADropoutF style hasDropout)
                       (CAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                       (FFNInputTransformationF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNActivationF style)
                       (FFNActivationDropoutF style hasDropout)
                       (FFNOutputProjectionF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNOutputDropoutF style hasDropout)
                       (FFNOutputLayerNormF
                          style gradient device dataType inputEmbedDim)))))))
     (ModelSpec
        (TDFinalLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TDFinalDropoutF style hasDropout))
</span><a href="#local-6989586621679719262"><span class="hs-identifier hs-var">decoderSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'Pegasus
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span>
</span><span id="line-260"></span><span>      </span><span class="annot"><a href="#local-6989586621679719265"><span class="hs-identifier hs-var">decoderSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span>
</span><span id="line-261"></span><span>      </span><span class="annot"><a href="#local-6989586621679719265"><span class="hs-identifier hs-var">decoderSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span>
</span><span id="line-262"></span><span>      </span><span class="annot"><a href="#local-6989586621679719265"><span class="hs-identifier hs-var">decoderSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span>
</span><span id="line-263"></span><span>      </span><span id="local-6989586621679719244"><span class="annot"><span class="annottext">sharedEmbeddingSpec :: STransformerStyle style
-&gt; NamedModel
     (EmbeddingSpec
        gradient
        ('Layout 'Dense)
        device
        dataType
        vocabDim
        inputEmbedDim
        'Nothing)
</span><a href="#local-6989586621679719244"><span class="hs-identifier hs-var hs-var">sharedEmbeddingSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;shared.&quot;</span></span><span> </span><span class="annot"><span class="annottext">EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  vocabDim
  inputEmbedDim
  'Nothing
</span><a href="#local-6989586621679719241"><span class="hs-identifier hs-var">sharedEmbeddingSpec'</span></a></span><span>
</span><span id="line-264"></span><span>      </span><span class="annot"><a href="#local-6989586621679719244"><span class="hs-identifier hs-var">sharedEmbeddingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;shared.&quot;</span></span><span> </span><span class="annot"><span class="annottext">EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  vocabDim
  inputEmbedDim
  'Nothing
</span><a href="#local-6989586621679719241"><span class="hs-identifier hs-var">sharedEmbeddingSpec'</span></a></span><span>
</span><span id="line-265"></span><span>      </span><span class="annot"><a href="#local-6989586621679719244"><span class="hs-identifier hs-var">sharedEmbeddingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;model.shared.&quot;</span></span><span> </span><span class="annot"><span class="annottext">EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  vocabDim
  inputEmbedDim
  'Nothing
</span><a href="#local-6989586621679719241"><span class="hs-identifier hs-var">sharedEmbeddingSpec'</span></a></span><span>
</span><span id="line-266"></span><span>      </span><span class="annot"><a href="#local-6989586621679719244"><span class="hs-identifier hs-var">sharedEmbeddingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;model.shared.&quot;</span></span><span> </span><span class="annot"><span class="annottext">EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  vocabDim
  inputEmbedDim
  'Nothing
</span><a href="#local-6989586621679719241"><span class="hs-identifier hs-var">sharedEmbeddingSpec'</span></a></span><span>
</span><span id="line-267"></span><span>      </span><span class="annot"><a href="#local-6989586621679719244"><span class="hs-identifier hs-var">sharedEmbeddingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;model.shared.&quot;</span></span><span> </span><span class="annot"><span class="annottext">EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  vocabDim
  inputEmbedDim
  'Nothing
</span><a href="#local-6989586621679719241"><span class="hs-identifier hs-var">sharedEmbeddingSpec'</span></a></span><span>
</span><span id="line-268"></span><span>      </span><span class="annot"><a href="#local-6989586621679719244"><span class="hs-identifier hs-var">sharedEmbeddingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span>
</span><span id="line-269"></span><span>      </span><span class="annot"><a href="#local-6989586621679719244"><span class="hs-identifier hs-var">sharedEmbeddingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span>
</span><span id="line-270"></span><span>      </span><span class="annot"><a href="#local-6989586621679719244"><span class="hs-identifier hs-var">sharedEmbeddingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span>
</span><span id="line-271"></span><span>      </span><span id="local-6989586621679719223"><span class="annot"><span class="annottext">headSpec :: STransformerStyle style
-&gt; STransformerHead transformerHead
-&gt; ModelSpec
     (EDTHeadF
        style
        transformerHead
        gradient
        device
        dataType
        inputEmbedDim
        vocabDim)
</span><a href="#local-6989586621679719223"><span class="hs-identifier hs-var hs-var">headSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SWithoutHead"><span class="hs-identifier hs-var">SWithoutHead</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>      </span><span class="annot"><a href="#local-6989586621679719223"><span class="hs-identifier hs-var">headSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SWithLMHead"><span class="hs-identifier hs-var">SWithLMHead</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;lm_head.&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall {style :: TransformerStyle}.
STransformerStyle style
-&gt; GLMHead
     inputEmbedDim
     (ModelSpec
        (LMHeadDenseF style gradient device dataType inputEmbedDim))
     (ModelSpec (LMHeadActivationF style))
     (ModelSpec
        (LMHeadLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec
        (LMHeadDecoderF
           style gradient device dataType inputEmbedDim vocabDim))
     (ModelSpec (LMHeadBiasF style gradient device dataType vocabDim))
</span><a href="#local-6989586621679719215"><span class="hs-identifier hs-var">headSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'T5
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span>
</span><span id="line-273"></span><span>      </span><span class="annot"><a href="#local-6989586621679719223"><span class="hs-identifier hs-var">headSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SWithoutHead"><span class="hs-identifier hs-var">SWithoutHead</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-274"></span><span>      </span><span class="annot"><a href="#local-6989586621679719223"><span class="hs-identifier hs-var">headSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SWithLMHead"><span class="hs-identifier hs-var">SWithLMHead</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;lm_head.&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall {style :: TransformerStyle}.
STransformerStyle style
-&gt; GLMHead
     inputEmbedDim
     (ModelSpec
        (LMHeadDenseF style gradient device dataType inputEmbedDim))
     (ModelSpec (LMHeadActivationF style))
     (ModelSpec
        (LMHeadLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec
        (LMHeadDecoderF
           style gradient device dataType inputEmbedDim vocabDim))
     (ModelSpec (LMHeadBiasF style gradient device dataType vocabDim))
</span><a href="#local-6989586621679719215"><span class="hs-identifier hs-var">headSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'ByT5
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span>
</span><span id="line-275"></span><span>      </span><span class="annot"><a href="#local-6989586621679719223"><span class="hs-identifier hs-var">headSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SWithoutHead"><span class="hs-identifier hs-var">SWithoutHead</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-276"></span><span>      </span><span class="annot"><a href="#local-6989586621679719223"><span class="hs-identifier hs-var">headSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SWithLMHead"><span class="hs-identifier hs-var">SWithLMHead</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall {style :: TransformerStyle}.
STransformerStyle style
-&gt; GLMHead
     inputEmbedDim
     (ModelSpec
        (LMHeadDenseF style gradient device dataType inputEmbedDim))
     (ModelSpec (LMHeadActivationF style))
     (ModelSpec
        (LMHeadLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec
        (LMHeadDecoderF
           style gradient device dataType inputEmbedDim vocabDim))
     (ModelSpec (LMHeadBiasF style gradient device dataType vocabDim))
</span><a href="#local-6989586621679719215"><span class="hs-identifier hs-var">headSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'BART
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span>
</span><span id="line-277"></span><span>      </span><span class="annot"><a href="#local-6989586621679719223"><span class="hs-identifier hs-var">headSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SWithoutHead"><span class="hs-identifier hs-var">SWithoutHead</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span>      </span><span class="annot"><a href="#local-6989586621679719223"><span class="hs-identifier hs-var">headSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SWithLMHead"><span class="hs-identifier hs-var">SWithLMHead</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall {style :: TransformerStyle}.
STransformerStyle style
-&gt; GLMHead
     inputEmbedDim
     (ModelSpec
        (LMHeadDenseF style gradient device dataType inputEmbedDim))
     (ModelSpec (LMHeadActivationF style))
     (ModelSpec
        (LMHeadLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec
        (LMHeadDecoderF
           style gradient device dataType inputEmbedDim vocabDim))
     (ModelSpec (LMHeadBiasF style gradient device dataType vocabDim))
</span><a href="#local-6989586621679719215"><span class="hs-identifier hs-var">headSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'MBART
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span>
</span><span id="line-279"></span><span>      </span><span class="annot"><a href="#local-6989586621679719223"><span class="hs-identifier hs-var">headSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SWithoutHead"><span class="hs-identifier hs-var">SWithoutHead</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-280"></span><span>      </span><span class="annot"><a href="#local-6989586621679719223"><span class="hs-identifier hs-var">headSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SWithLMHead"><span class="hs-identifier hs-var">SWithLMHead</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall {style :: TransformerStyle}.
STransformerStyle style
-&gt; GLMHead
     inputEmbedDim
     (ModelSpec
        (LMHeadDenseF style gradient device dataType inputEmbedDim))
     (ModelSpec (LMHeadActivationF style))
     (ModelSpec
        (LMHeadLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec
        (LMHeadDecoderF
           style gradient device dataType inputEmbedDim vocabDim))
     (ModelSpec (LMHeadBiasF style gradient device dataType vocabDim))
</span><a href="#local-6989586621679719215"><span class="hs-identifier hs-var">headSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'Pegasus
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span>
</span><span id="line-281"></span><span>      </span><span class="annot"><a href="#local-6989586621679719223"><span class="hs-identifier hs-var">headSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span>
</span><span id="line-282"></span><span>      </span><span class="annot"><a href="#local-6989586621679719223"><span class="hs-identifier hs-var">headSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span>
</span><span id="line-283"></span><span>      </span><span class="annot"><a href="#local-6989586621679719223"><span class="hs-identifier hs-var">headSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span>
</span><span id="line-284"></span><span>      </span><span class="annot"><a href="#local-6989586621679719184"><span class="hs-identifier hs-type">embedScalingSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#STransformerStyle"><span class="hs-identifier hs-type">STransformerStyle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679721128"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerHasEmbedScaling"><span class="hs-identifier hs-type">EncoderDecoderTransformerHasEmbedScaling</span></a></span><span>
</span><span id="line-285"></span><span>      </span><span id="local-6989586621679719184"><span class="annot"><span class="annottext">embedScalingSpec :: STransformerStyle style -&gt; EncoderDecoderTransformerHasEmbedScaling
</span><a href="#local-6989586621679719184"><span class="hs-identifier hs-var hs-var">embedScalingSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EncoderDecoderTransformerHasEmbedScaling
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerWithoutEmbedScaling"><span class="hs-identifier hs-var">EncoderDecoderTransformerWithoutEmbedScaling</span></a></span><span>
</span><span id="line-286"></span><span>      </span><span class="annot"><a href="#local-6989586621679719184"><span class="hs-identifier hs-var">embedScalingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EncoderDecoderTransformerHasEmbedScaling
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerWithoutEmbedScaling"><span class="hs-identifier hs-var">EncoderDecoderTransformerWithoutEmbedScaling</span></a></span><span>
</span><span id="line-287"></span><span>      </span><span class="annot"><a href="#local-6989586621679719184"><span class="hs-identifier hs-var">embedScalingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EncoderDecoderTransformerHasEmbedScaling
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerWithoutEmbedScaling"><span class="hs-identifier hs-var">EncoderDecoderTransformerWithoutEmbedScaling</span></a></span><span>
</span><span id="line-288"></span><span>      </span><span class="annot"><a href="#local-6989586621679719184"><span class="hs-identifier hs-var">embedScalingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EncoderDecoderTransformerHasEmbedScaling
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerWithoutEmbedScaling"><span class="hs-identifier hs-var">EncoderDecoderTransformerWithoutEmbedScaling</span></a></span><span>
</span><span id="line-289"></span><span>      </span><span class="annot"><a href="#local-6989586621679719184"><span class="hs-identifier hs-var">embedScalingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EncoderDecoderTransformerHasEmbedScaling
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerWithEmbedScaling"><span class="hs-identifier hs-var">EncoderDecoderTransformerWithEmbedScaling</span></a></span><span>
</span><span id="line-290"></span><span>      </span><span class="annot"><a href="#local-6989586621679719184"><span class="hs-identifier hs-var">embedScalingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span>
</span><span id="line-291"></span><span>      </span><span class="annot"><a href="#local-6989586621679719184"><span class="hs-identifier hs-var">embedScalingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span>
</span><span id="line-292"></span><span>      </span><span class="annot"><a href="#local-6989586621679719184"><span class="hs-identifier hs-var">embedScalingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span>
</span><span id="line-293"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head.
SDim inputEmbedDim
-&gt; encoder
-&gt; decoder
-&gt; sharedEmbedding
-&gt; head
-&gt; EncoderDecoderTransformerHasEmbedScaling
-&gt; GEncoderDecoderTransformer
     inputEmbedDim encoder decoder sharedEmbedding head
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GEncoderDecoderTransformer"><span class="hs-identifier hs-var">GEncoderDecoderTransformer</span></a></span><span> </span><span class="annot"><span class="annottext">SDim inputEmbedDim
</span><a href="#local-6989586621679719304"><span class="hs-identifier hs-var">inputEmbedDim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; NamedModel
     (GTransformer
        (ModelSpec
           (TEPosEncF style gradient device dataType inputEmbedDim posEncDim))
        (ModelSpec
           (TERelPosEncF style gradient device dataType headDim posEncDim))
        (ModelSpec
           (TEInitialLayerNormF style gradient device dataType inputEmbedDim))
        (ModelSpec (TEInitialDropoutF style hasDropout))
        (NamedModel
           (GTransformerStack
              (VectorSpec
                 numEncoderLayers
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (QInProjF style gradient device dataType inputEmbedDim embedDim)
                                (KInProjF style gradient device dataType inputEmbedDim embedDim)
                                (VInProjF style gradient device dataType inputEmbedDim embedDim)
                                (OutProjF style gradient device dataType embedDim inputEmbedDim)
                                (DropoutF style hasDropout)))
                          (SADropoutF style hasDropout)
                          (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                    ()
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                          (FFNInputTransformationF
                             style gradient device dataType inputEmbedDim ffnDim)
                          (FFNActivationF style)
                          (FFNActivationDropoutF style hasDropout)
                          (FFNOutputProjectionF
                             style gradient device dataType inputEmbedDim ffnDim)
                          (FFNOutputDropoutF style hasDropout)
                          (FFNOutputLayerNormF
                             style gradient device dataType inputEmbedDim)))))))
        (ModelSpec
           (TEFinalLayerNormF style gradient device dataType inputEmbedDim))
        (ModelSpec (TEFinalDropoutF style hasDropout)))
</span><a href="#local-6989586621679719297"><span class="hs-identifier hs-var">encoderSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679719314"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; NamedModel
     (GTransformer
        (ModelSpec
           (TDPosEncF style gradient device dataType inputEmbedDim posEncDim))
        (ModelSpec
           (TDRelPosEncF style gradient device dataType headDim posEncDim))
        (ModelSpec
           (TDInitialLayerNormF style gradient device dataType inputEmbedDim))
        (ModelSpec (TDInitialDropoutF style hasDropout))
        (NamedModel
           (GTransformerStack
              (VectorSpec
                 numDecoderLayers
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (QInProjF style gradient device dataType inputEmbedDim embedDim)
                                (KInProjF style gradient device dataType inputEmbedDim embedDim)
                                (VInProjF style gradient device dataType inputEmbedDim embedDim)
                                (OutProjF style gradient device dataType embedDim inputEmbedDim)
                                (DropoutF style hasDropout)))
                          (SADropoutF style hasDropout)
                          (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                    (NamedModel
                       (GCrossAttention
                          (CAInitialLayerNormF style gradient device dataType inputEmbedDim)
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (QInProjF style gradient device dataType inputEmbedDim embedDim)
                                (KInProjF style gradient device dataType inputEmbedDim embedDim)
                                (VInProjF style gradient device dataType inputEmbedDim embedDim)
                                (OutProjF style gradient device dataType embedDim inputEmbedDim)
                                (DropoutF style hasDropout)))
                          (CADropoutF style hasDropout)
                          (CAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                          (FFNInputTransformationF
                             style gradient device dataType inputEmbedDim ffnDim)
                          (FFNActivationF style)
                          (FFNActivationDropoutF style hasDropout)
                          (FFNOutputProjectionF
                             style gradient device dataType inputEmbedDim ffnDim)
                          (FFNOutputDropoutF style hasDropout)
                          (FFNOutputLayerNormF
                             style gradient device dataType inputEmbedDim)))))))
        (ModelSpec
           (TDFinalLayerNormF style gradient device dataType inputEmbedDim))
        (ModelSpec (TDFinalDropoutF style hasDropout)))
</span><a href="#local-6989586621679719265"><span class="hs-identifier hs-var">decoderSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679719314"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; NamedModel
     (EmbeddingSpec
        gradient
        ('Layout 'Dense)
        device
        dataType
        vocabDim
        inputEmbedDim
        'Nothing)
</span><a href="#local-6989586621679719244"><span class="hs-identifier hs-var">sharedEmbeddingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679719314"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; STransformerHead transformerHead
-&gt; ModelSpec
     (EDTHeadF
        style
        transformerHead
        gradient
        device
        dataType
        inputEmbedDim
        vocabDim)
</span><a href="#local-6989586621679719223"><span class="hs-identifier hs-var">headSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679719314"><span class="hs-identifier hs-var">style</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><a href="#local-6989586621679719313"><span class="hs-identifier hs-var">transformerHead</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style -&gt; EncoderDecoderTransformerHasEmbedScaling
</span><a href="#local-6989586621679719184"><span class="hs-identifier hs-var">embedScalingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679719314"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-294"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-295"></span><span>    </span><span class="annot"><a href="#local-6989586621679719291"><span class="hs-identifier hs-type">encoderSpec'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span>
</span><span id="line-296"></span><span>    </span><span id="local-6989586621679719291"><span class="annot"><span class="annottext">encoderSpec' :: STransformerStyle style
-&gt; GTransformer
     (ModelSpec
        (TEPosEncF style gradient device dataType inputEmbedDim posEncDim))
     (ModelSpec
        (TERelPosEncF style gradient device dataType headDim posEncDim))
     (ModelSpec
        (TEInitialLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TEInitialDropoutF style hasDropout))
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numEncoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             (DropoutF style hasDropout)))
                       (SADropoutF style hasDropout)
                       (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 ()
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                       (FFNInputTransformationF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNActivationF style)
                       (FFNActivationDropoutF style hasDropout)
                       (FFNOutputProjectionF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNOutputDropoutF style hasDropout)
                       (FFNOutputLayerNormF
                          style gradient device dataType inputEmbedDim)))))))
     (ModelSpec
        (TEFinalLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TEFinalDropoutF style hasDropout))
</span><a href="#local-6989586621679719291"><span class="hs-identifier hs-var hs-var">encoderSpec'</span></a></span></span><span> </span><span id="local-6989586621679719169"><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679719169"><span class="hs-identifier hs-var">style'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (style :: TransformerStyle) (numLayers :: Nat)
       (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (headDim :: Dim (Name Symbol) (Size Nat))
       (headEmbedDim :: Dim (Name Symbol) (Size Nat))
       (embedDim :: Dim (Name Symbol) (Size Nat))
       (inputEmbedDim :: Dim (Name Symbol) (Size Nat))
       (ffnDim :: Dim (Name Symbol) (Size Nat))
       (posEncDim :: Dim (Name Symbol) (Size Nat))
       (hasDropout :: HasDropout).
STransformerStyle style
-&gt; SNat numLayers
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim headDim
-&gt; SDim headEmbedDim
-&gt; SDim embedDim
-&gt; SDim inputEmbedDim
-&gt; SDim ffnDim
-&gt; SDim posEncDim
-&gt; SHasDropout hasDropout
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (TransformerEncoderF
        style
        numLayers
        gradient
        device
        dataType
        headDim
        headEmbedDim
        embedDim
        inputEmbedDim
        ffnDim
        posEncDim
        hasDropout)
</span><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#transformerEncoderSpec"><span class="hs-identifier hs-var">transformerEncoderSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679719169"><span class="hs-identifier hs-var">style'</span></a></span><span> </span><span class="annot"><span class="annottext">SNat numEncoderLayers
</span><a href="#local-6989586621679719312"><span class="hs-identifier hs-var">numEncoderLayers</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679719310"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679719309"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679719308"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDim headDim
</span><a href="#local-6989586621679719307"><span class="hs-identifier hs-var">headDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim headEmbedDim
</span><a href="#local-6989586621679719306"><span class="hs-identifier hs-var">headEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim embedDim
</span><a href="#local-6989586621679719305"><span class="hs-identifier hs-var">embedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim inputEmbedDim
</span><a href="#local-6989586621679719304"><span class="hs-identifier hs-var">inputEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679719303"><span class="hs-identifier hs-var">ffnDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim posEncDim
</span><a href="#local-6989586621679719302"><span class="hs-identifier hs-var">posEncDim</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><a href="#local-6989586621679719300"><span class="hs-identifier hs-var">hasDropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679719299"><span class="hs-identifier hs-var">dropoutP</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679719298"><span class="hs-identifier hs-var">eps</span></a></span><span>
</span><span id="line-297"></span><span>    </span><span class="annot"><a href="#local-6989586621679719262"><span class="hs-identifier hs-type">decoderSpec'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span>
</span><span id="line-298"></span><span>    </span><span id="local-6989586621679719262"><span class="annot"><span class="annottext">decoderSpec' :: STransformerStyle style
-&gt; GTransformer
     (ModelSpec
        (TDPosEncF style gradient device dataType inputEmbedDim posEncDim))
     (ModelSpec
        (TDRelPosEncF style gradient device dataType headDim posEncDim))
     (ModelSpec
        (TDInitialLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TDInitialDropoutF style hasDropout))
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numDecoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             (DropoutF style hasDropout)))
                       (SADropoutF style hasDropout)
                       (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 (NamedModel
                    (GCrossAttention
                       (CAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             (DropoutF style hasDropout)))
                       (CADropoutF style hasDropout)
                       (CAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                       (FFNInputTransformationF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNActivationF style)
                       (FFNActivationDropoutF style hasDropout)
                       (FFNOutputProjectionF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNOutputDropoutF style hasDropout)
                       (FFNOutputLayerNormF
                          style gradient device dataType inputEmbedDim)))))))
     (ModelSpec
        (TDFinalLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TDFinalDropoutF style hasDropout))
</span><a href="#local-6989586621679719262"><span class="hs-identifier hs-var hs-var">decoderSpec'</span></a></span></span><span> </span><span id="local-6989586621679719168"><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679719168"><span class="hs-identifier hs-var">style'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (style :: TransformerStyle) (numLayers :: Nat)
       (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (headDim :: Dim (Name Symbol) (Size Nat))
       (headEmbedDim :: Dim (Name Symbol) (Size Nat))
       (embedDim :: Dim (Name Symbol) (Size Nat))
       (decoderInputEmbedDim :: Dim (Name Symbol) (Size Nat))
       (encoderOutputEmbedDim :: Dim (Name Symbol) (Size Nat))
       (ffnDim :: Dim (Name Symbol) (Size Nat))
       (posEncDim :: Dim (Name Symbol) (Size Nat))
       (hasDropout :: HasDropout).
STransformerStyle style
-&gt; SNat numLayers
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim headDim
-&gt; SDim headEmbedDim
-&gt; SDim embedDim
-&gt; SDim decoderInputEmbedDim
-&gt; SDim encoderOutputEmbedDim
-&gt; SDim ffnDim
-&gt; SDim posEncDim
-&gt; SHasDropout hasDropout
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (TransformerDecoderF
        style
        numLayers
        gradient
        device
        dataType
        headDim
        headEmbedDim
        embedDim
        decoderInputEmbedDim
        encoderOutputEmbedDim
        ffnDim
        posEncDim
        hasDropout)
</span><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#transformerDecoderSpec"><span class="hs-identifier hs-var">transformerDecoderSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679719168"><span class="hs-identifier hs-var">style'</span></a></span><span> </span><span class="annot"><span class="annottext">SNat numDecoderLayers
</span><a href="#local-6989586621679719311"><span class="hs-identifier hs-var">numDecoderLayers</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679719310"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679719309"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679719308"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDim headDim
</span><a href="#local-6989586621679719307"><span class="hs-identifier hs-var">headDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim headEmbedDim
</span><a href="#local-6989586621679719306"><span class="hs-identifier hs-var">headEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim embedDim
</span><a href="#local-6989586621679719305"><span class="hs-identifier hs-var">embedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim inputEmbedDim
</span><a href="#local-6989586621679719304"><span class="hs-identifier hs-var">inputEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim inputEmbedDim
</span><a href="#local-6989586621679719304"><span class="hs-identifier hs-var">inputEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679719303"><span class="hs-identifier hs-var">ffnDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim posEncDim
</span><a href="#local-6989586621679719302"><span class="hs-identifier hs-var">posEncDim</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><a href="#local-6989586621679719300"><span class="hs-identifier hs-var">hasDropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679719299"><span class="hs-identifier hs-var">dropoutP</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679719298"><span class="hs-identifier hs-var">eps</span></a></span><span>
</span><span id="line-299"></span><span>    </span><span id="local-6989586621679719241"><span class="annot"><span class="annottext">sharedEmbeddingSpec' :: EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  vocabDim
  inputEmbedDim
  'Nothing
</span><a href="#local-6989586621679719241"><span class="hs-identifier hs-var hs-var">sharedEmbeddingSpec'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (embedNumDim :: Dim (Name Symbol) (Size Nat))
       (embedDim :: Dim (Name Symbol) (Size Nat))
       (paddingIdx :: Maybe Nat).
SGradient gradient
-&gt; SLayout layout
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim embedNumDim
-&gt; SDim embedDim
-&gt; SMaybe paddingIdx
-&gt; EmbeddingSpec
     gradient layout device dataType embedNumDim embedDim paddingIdx
</span><a href="Torch.GraduallyTyped.NN.Sparse.html#EmbeddingSpec"><span class="hs-identifier hs-var">EmbeddingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679719310"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (layoutType :: LayoutType).
SLayoutType layoutType -&gt; SLayout ('Layout layoutType)
</span><a href="Torch.GraduallyTyped.Layout.html#SLayout"><span class="hs-identifier hs-var">SLayout</span></a></span><span> </span><span class="annot"><span class="annottext">SLayoutType 'Dense
</span><a href="Torch.GraduallyTyped.Layout.html#SDense"><span class="hs-identifier hs-var">SDense</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679719309"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679719308"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDim vocabDim
</span><a href="#local-6989586621679719301"><span class="hs-identifier hs-var">vocabDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim inputEmbedDim
</span><a href="#local-6989586621679719304"><span class="hs-identifier hs-var">inputEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. SMaybe 'Nothing
</span><a href="../file:///nix/store/cmxygbwkg9vwm5iizgff5i2x5awqcjjn-singletons-base-lib-singletons-base-3.1-haddock-doc/share/doc/singletons-base/html/src"><span class="hs-identifier hs-var">SNothing</span></a></span><span>
</span><span id="line-300"></span><span>    </span><span class="annot"><a href="#local-6989586621679719215"><span class="hs-identifier hs-type">headSpec'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span>
</span><span id="line-301"></span><span>    </span><span id="local-6989586621679719215"><span class="annot"><span class="annottext">headSpec' :: STransformerStyle style
-&gt; GLMHead
     inputEmbedDim
     (ModelSpec
        (LMHeadDenseF style gradient device dataType inputEmbedDim))
     (ModelSpec (LMHeadActivationF style))
     (ModelSpec
        (LMHeadLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec
        (LMHeadDecoderF
           style gradient device dataType inputEmbedDim vocabDim))
     (ModelSpec (LMHeadBiasF style gradient device dataType vocabDim))
</span><a href="#local-6989586621679719215"><span class="hs-identifier hs-var hs-var">headSpec'</span></a></span></span><span> </span><span id="local-6989586621679719164"><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679719164"><span class="hs-identifier hs-var">style'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (style :: TransformerStyle)
       (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (inputEmbedDim :: Dim (Name Symbol) (Size Nat))
       (vocabDim :: Dim (Name Symbol) (Size Nat)).
STransformerStyle style
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim inputEmbedDim
-&gt; SDim vocabDim
-&gt; Double
-&gt; ModelSpec
     (GLMHeadF style gradient device dataType inputEmbedDim vocabDim)
</span><a href="Torch.GraduallyTyped.NN.Transformer.GLMHead.html#lmHeadSpec"><span class="hs-identifier hs-var">lmHeadSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679719164"><span class="hs-identifier hs-var">style'</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679719310"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679719309"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679719308"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDim inputEmbedDim
</span><a href="#local-6989586621679719304"><span class="hs-identifier hs-var">inputEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim vocabDim
</span><a href="#local-6989586621679719301"><span class="hs-identifier hs-var">vocabDim</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679719298"><span class="hs-identifier hs-var">eps</span></a></span><span>
</span><span id="line-302"></span><span>
</span><span id="line-303"></span><span class="hs-keyword">instance</span><span>
</span><span id="line-304"></span><span>  </span><span id="local-6989586621679719162"><span id="local-6989586621679720943"><span id="local-6989586621679720944"><span id="local-6989586621679720945"><span id="local-6989586621679720946"><span id="local-6989586621679720947"><span id="local-6989586621679720948"><span id="local-6989586621679720949"><span id="local-6989586621679720950"><span id="local-6989586621679720951"><span id="local-6989586621679720952"><span id="local-6989586621679720953"><span id="local-6989586621679720954"><span id="local-6989586621679720955"><span id="local-6989586621679720956"><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720956"><span class="hs-identifier hs-type">encoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720955"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720954"><span class="hs-identifier hs-type">encoder'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720953"><span class="hs-identifier hs-type">generatorDevice0</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-305"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720952"><span class="hs-identifier hs-type">decoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720953"><span class="hs-identifier hs-type">generatorDevice0</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720951"><span class="hs-identifier hs-type">decoder'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720950"><span class="hs-identifier hs-type">generatorDevice1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-306"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720949"><span class="hs-identifier hs-type">sharedEmbedding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720950"><span class="hs-identifier hs-type">generatorDevice1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720948"><span class="hs-identifier hs-type">sharedEmbedding'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720947"><span class="hs-identifier hs-type">generatorDevice2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-307"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720946"><span class="hs-identifier hs-type">head</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720947"><span class="hs-identifier hs-type">generatorDevice2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720945"><span class="hs-identifier hs-type">head'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720944"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-308"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-309"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span>
</span><span id="line-310"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GEncoderDecoderTransformer"><span class="hs-identifier hs-type">GEncoderDecoderTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720943"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720956"><span class="hs-identifier hs-type">encoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720952"><span class="hs-identifier hs-type">decoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720949"><span class="hs-identifier hs-type">sharedEmbedding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720946"><span class="hs-identifier hs-type">head</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-311"></span><span>    </span><span class="annot"><a href="#local-6989586621679720955"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-312"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GEncoderDecoderTransformer"><span class="hs-identifier hs-type">GEncoderDecoderTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720943"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720954"><span class="hs-identifier hs-type">encoder'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720951"><span class="hs-identifier hs-type">decoder'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720948"><span class="hs-identifier hs-type">sharedEmbedding'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720945"><span class="hs-identifier hs-type">head'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span>    </span><span class="annot"><a href="#local-6989586621679720944"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-314"></span><span>
</span><span id="line-315"></span><span class="hs-keyword">instance</span><span>
</span><span id="line-316"></span><span>  </span><span id="local-6989586621679719158"><span id="local-6989586621679719160"><span id="local-6989586621679720938"><span id="local-6989586621679720939"><span id="local-6989586621679720940"><span id="local-6989586621679720941"><span id="local-6989586621679720942"><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720942"><span class="hs-identifier hs-type">encoder</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-317"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720941"><span class="hs-identifier hs-type">decoder</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-318"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720940"><span class="hs-identifier hs-type">sharedEmbedding</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-319"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720939"><span class="hs-identifier hs-type">head</span></a></span><span>
</span><span id="line-320"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-321"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GEncoderDecoderTransformer"><span class="hs-identifier hs-type">GEncoderDecoderTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720938"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720942"><span class="hs-identifier hs-type">encoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720941"><span class="hs-identifier hs-type">decoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720940"><span class="hs-identifier hs-type">sharedEmbedding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720939"><span class="hs-identifier hs-type">head</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span><span>
</span><span id="line-322"></span><span>
</span><span id="line-323"></span><span id="local-6989586621679719156"><span id="local-6989586621679719157"></span></span><span class="hs-keyword">data</span><span>
</span><span id="line-324"></span><span>  </span><span id="GSimplifiedEncoderDecoderTransformer"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier hs-var">GSimplifiedEncoderDecoderTransformer</span></a></span></span><span>
</span><span id="line-325"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679720859"><span class="annot"><a href="#local-6989586621679720859"><span class="hs-identifier hs-type">model</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679720858"><span class="annot"><a href="#local-6989586621679720858"><span class="hs-identifier hs-type">mkPos</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-327"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679720857"><span class="annot"><a href="#local-6989586621679720857"><span class="hs-identifier hs-type">mkDecoderPos</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-328"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679720856"><span class="annot"><a href="#local-6989586621679720856"><span class="hs-identifier hs-type">mkPaddingMask</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-329"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679720855"><span class="annot"><a href="#local-6989586621679720855"><span class="hs-identifier hs-type">mkAttentionMask</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-330"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679720854"><span class="annot"><a href="#local-6989586621679720854"><span class="hs-identifier hs-type">mkCrossAttentionMask</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-331"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679720853"><span class="annot"><a href="#local-6989586621679720853"><span class="hs-identifier hs-type">mkDecoderAttentionMask</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-333"></span><span>  </span><span id="GSimplifiedEncoderDecoderTransformer"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier hs-var">GSimplifiedEncoderDecoderTransformer</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-334"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679720930"><span class="annot"><a href="#local-6989586621679720930"><span class="hs-identifier hs-type">model</span></a></span></span><span> </span><span id="local-6989586621679720929"><span class="annot"><a href="#local-6989586621679720929"><span class="hs-identifier hs-type">mkPos</span></a></span></span><span> </span><span id="local-6989586621679720928"><span class="annot"><a href="#local-6989586621679720928"><span class="hs-identifier hs-type">mkDecoderPos</span></a></span></span><span> </span><span id="local-6989586621679720927"><span class="annot"><a href="#local-6989586621679720927"><span class="hs-identifier hs-type">mkPaddingMask</span></a></span></span><span> </span><span id="local-6989586621679720926"><span class="annot"><a href="#local-6989586621679720926"><span class="hs-identifier hs-type">mkAttentionMask</span></a></span></span><span> </span><span id="local-6989586621679720925"><span class="annot"><a href="#local-6989586621679720925"><span class="hs-identifier hs-type">mkCrossAttentionMask</span></a></span></span><span> </span><span id="local-6989586621679720924"><span class="annot"><a href="#local-6989586621679720924"><span class="hs-identifier hs-type">mkDecoderAttentionMask</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-335"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- | encoder-decoder model</span><span>
</span><span id="line-336"></span><span>      </span><span id="sedtModel"><span class="annot"><span class="annottext">forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; model
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtModel"><span class="hs-identifier hs-var hs-var">sedtModel</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679720930"><span class="hs-identifier hs-type">model</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-337"></span><span>      </span><span class="hs-comment">-- | shift for decoder input</span><span>
</span><span id="line-338"></span><span>      </span><span id="sedtDecoderInputShift"><span class="annot"><span class="annottext">forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; ShiftRight Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtDecoderInputShift"><span class="hs-identifier hs-var hs-var">sedtDecoderInputShift</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ShiftRight"><span class="hs-identifier hs-type">ShiftRight</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-339"></span><span>      </span><span class="hs-comment">-- | shift for padding mask</span><span>
</span><span id="line-340"></span><span>      </span><span id="sedtPaddingMaskShift"><span class="annot"><span class="annottext">forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; ShiftRight Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtPaddingMaskShift"><span class="hs-identifier hs-var hs-var">sedtPaddingMaskShift</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ShiftRight"><span class="hs-identifier hs-type">ShiftRight</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-341"></span><span>      </span><span class="hs-comment">-- | make encoder input positions</span><span>
</span><span id="line-342"></span><span>      </span><span id="sedtMkPos"><span class="annot"><span class="annottext">forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; mkPos
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtMkPos"><span class="hs-identifier hs-var hs-var">sedtMkPos</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679720929"><span class="hs-identifier hs-type">mkPos</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-343"></span><span>      </span><span class="hs-comment">-- | make decoder input position</span><span>
</span><span id="line-344"></span><span>      </span><span id="sedtMkDecoderPos"><span class="annot"><span class="annottext">forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; mkDecoderPos
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtMkDecoderPos"><span class="hs-identifier hs-var hs-var">sedtMkDecoderPos</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679720928"><span class="hs-identifier hs-type">mkDecoderPos</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-345"></span><span>      </span><span class="hs-comment">-- | make padding mask</span><span>
</span><span id="line-346"></span><span>      </span><span id="sedtMkPaddingMask"><span class="annot"><span class="annottext">forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; mkPaddingMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtMkPaddingMask"><span class="hs-identifier hs-var hs-var">sedtMkPaddingMask</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679720927"><span class="hs-identifier hs-type">mkPaddingMask</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-347"></span><span>      </span><span class="hs-comment">-- | make attention mask</span><span>
</span><span id="line-348"></span><span>      </span><span id="sedtMkAttentionMask"><span class="annot"><span class="annottext">forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; mkAttentionMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtMkAttentionMask"><span class="hs-identifier hs-var hs-var">sedtMkAttentionMask</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679720926"><span class="hs-identifier hs-type">mkAttentionMask</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-349"></span><span>      </span><span class="hs-comment">-- | make cross-attention mask</span><span>
</span><span id="line-350"></span><span>      </span><span id="sedtMkCrossAttentionMask"><span class="annot"><span class="annottext">forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; mkCrossAttentionMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtMkCrossAttentionMask"><span class="hs-identifier hs-var hs-var">sedtMkCrossAttentionMask</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679720925"><span class="hs-identifier hs-type">mkCrossAttentionMask</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-351"></span><span>      </span><span class="hs-comment">-- | make decoder attention mask</span><span>
</span><span id="line-352"></span><span>      </span><span id="sedtMkDecoderAttentionMask"><span class="annot"><span class="annottext">forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; mkDecoderAttentionMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtMkDecoderAttentionMask"><span class="hs-identifier hs-var hs-var">sedtMkDecoderAttentionMask</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679720924"><span class="hs-identifier hs-type">mkDecoderAttentionMask</span></a></span><span>
</span><span id="line-353"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-354"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier hs-type">GSimplifiedEncoderDecoderTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720930"><span class="hs-identifier hs-type">model</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720929"><span class="hs-identifier hs-type">mkPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720928"><span class="hs-identifier hs-type">mkDecoderPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720927"><span class="hs-identifier hs-type">mkPaddingMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720926"><span class="hs-identifier hs-type">mkAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720925"><span class="hs-identifier hs-type">mkCrossAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720924"><span class="hs-identifier hs-type">mkDecoderAttentionMask</span></a></span><span>
</span><span id="line-355"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679719131"><span id="local-6989586621679719144"><span class="annot"><span class="annottext">GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask
-&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
(Eq model, Eq mkPos, Eq mkDecoderPos, Eq mkPaddingMask,
 Eq mkAttentionMask, Eq mkCrossAttentionMask,
 Eq mkDecoderAttentionMask) =&gt;
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask
-&gt; Bool
/= :: GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask
-&gt; Bool
$c/= :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
(Eq model, Eq mkPos, Eq mkDecoderPos, Eq mkPaddingMask,
 Eq mkAttentionMask, Eq mkCrossAttentionMask,
 Eq mkDecoderAttentionMask) =&gt;
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask
-&gt; Bool
== :: GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask
-&gt; Bool
$c== :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
(Eq model, Eq mkPos, Eq mkDecoderPos, Eq mkPaddingMask,
 Eq mkAttentionMask, Eq mkCrossAttentionMask,
 Eq mkDecoderAttentionMask) =&gt;
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask
-&gt; Bool
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679719090"><span id="local-6989586621679719092"><span id="local-6989586621679719095"><span id="local-6989586621679719098"><span id="local-6989586621679719101"><span id="local-6989586621679719113"><span id="local-6989586621679719126"><span class="annot"><span class="annottext">GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask
-&gt; Bool
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask
-&gt; Ordering
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall {model} {mkPos} {mkDecoderPos} {mkPaddingMask}
       {mkAttentionMask} {mkCrossAttentionMask} {mkDecoderAttentionMask}.
(Ord model, Ord mkPos, Ord mkDecoderPos, Ord mkPaddingMask,
 Ord mkAttentionMask, Ord mkCrossAttentionMask,
 Ord mkDecoderAttentionMask) =&gt;
Eq
  (GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask)
forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
(Ord model, Ord mkPos, Ord mkDecoderPos, Ord mkPaddingMask,
 Ord mkAttentionMask, Ord mkCrossAttentionMask,
 Ord mkDecoderAttentionMask) =&gt;
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask
-&gt; Bool
forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
(Ord model, Ord mkPos, Ord mkDecoderPos, Ord mkPaddingMask,
 Ord mkAttentionMask, Ord mkCrossAttentionMask,
 Ord mkDecoderAttentionMask) =&gt;
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask
-&gt; Ordering
forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
(Ord model, Ord mkPos, Ord mkDecoderPos, Ord mkPaddingMask,
 Ord mkAttentionMask, Ord mkCrossAttentionMask,
 Ord mkDecoderAttentionMask) =&gt;
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask
-&gt; GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask
min :: GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask
-&gt; GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask
$cmin :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
(Ord model, Ord mkPos, Ord mkDecoderPos, Ord mkPaddingMask,
 Ord mkAttentionMask, Ord mkCrossAttentionMask,
 Ord mkDecoderAttentionMask) =&gt;
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask
-&gt; GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask
max :: GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask
-&gt; GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask
$cmax :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
(Ord model, Ord mkPos, Ord mkDecoderPos, Ord mkPaddingMask,
 Ord mkAttentionMask, Ord mkCrossAttentionMask,
 Ord mkDecoderAttentionMask) =&gt;
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask
-&gt; GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask
&gt;= :: GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask
-&gt; Bool
$c&gt;= :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
(Ord model, Ord mkPos, Ord mkDecoderPos, Ord mkPaddingMask,
 Ord mkAttentionMask, Ord mkCrossAttentionMask,
 Ord mkDecoderAttentionMask) =&gt;
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask
-&gt; Bool
&gt; :: GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask
-&gt; Bool
$c&gt; :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
(Ord model, Ord mkPos, Ord mkDecoderPos, Ord mkPaddingMask,
 Ord mkAttentionMask, Ord mkCrossAttentionMask,
 Ord mkDecoderAttentionMask) =&gt;
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask
-&gt; Bool
&lt;= :: GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask
-&gt; Bool
$c&lt;= :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
(Ord model, Ord mkPos, Ord mkDecoderPos, Ord mkPaddingMask,
 Ord mkAttentionMask, Ord mkCrossAttentionMask,
 Ord mkDecoderAttentionMask) =&gt;
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask
-&gt; Bool
&lt; :: GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask
-&gt; Bool
$c&lt; :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
(Ord model, Ord mkPos, Ord mkDecoderPos, Ord mkPaddingMask,
 Ord mkAttentionMask, Ord mkCrossAttentionMask,
 Ord mkDecoderAttentionMask) =&gt;
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask
-&gt; Bool
compare :: GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask
-&gt; Ordering
$ccompare :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
(Ord model, Ord mkPos, Ord mkDecoderPos, Ord mkPaddingMask,
 Ord mkAttentionMask, Ord mkCrossAttentionMask,
 Ord mkDecoderAttentionMask) =&gt;
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask
-&gt; Ordering
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679719072"><span id="local-6989586621679719074"><span id="local-6989586621679719088"><span class="annot"><span class="annottext">Int
-&gt; GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask
-&gt; ShowS
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
(Show model, Show mkPos, Show mkDecoderPos, Show mkPaddingMask,
 Show mkAttentionMask, Show mkCrossAttentionMask,
 Show mkDecoderAttentionMask) =&gt;
Int
-&gt; GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask
-&gt; ShowS
forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
(Show model, Show mkPos, Show mkDecoderPos, Show mkPaddingMask,
 Show mkAttentionMask, Show mkCrossAttentionMask,
 Show mkDecoderAttentionMask) =&gt;
[GSimplifiedEncoderDecoderTransformer
   model
   mkPos
   mkDecoderPos
   mkPaddingMask
   mkAttentionMask
   mkCrossAttentionMask
   mkDecoderAttentionMask]
-&gt; ShowS
forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
(Show model, Show mkPos, Show mkDecoderPos, Show mkPaddingMask,
 Show mkAttentionMask, Show mkCrossAttentionMask,
 Show mkDecoderAttentionMask) =&gt;
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; String
showList :: [GSimplifiedEncoderDecoderTransformer
   model
   mkPos
   mkDecoderPos
   mkPaddingMask
   mkAttentionMask
   mkCrossAttentionMask
   mkDecoderAttentionMask]
-&gt; ShowS
$cshowList :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
(Show model, Show mkPos, Show mkDecoderPos, Show mkPaddingMask,
 Show mkAttentionMask, Show mkCrossAttentionMask,
 Show mkDecoderAttentionMask) =&gt;
[GSimplifiedEncoderDecoderTransformer
   model
   mkPos
   mkDecoderPos
   mkPaddingMask
   mkAttentionMask
   mkCrossAttentionMask
   mkDecoderAttentionMask]
-&gt; ShowS
show :: GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; String
$cshow :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
(Show model, Show mkPos, Show mkDecoderPos, Show mkPaddingMask,
 Show mkAttentionMask, Show mkCrossAttentionMask,
 Show mkDecoderAttentionMask) =&gt;
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; String
showsPrec :: Int
-&gt; GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask
-&gt; ShowS
$cshowsPrec :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
(Show model, Show mkPos, Show mkDecoderPos, Show mkPaddingMask,
 Show mkAttentionMask, Show mkCrossAttentionMask,
 Show mkDecoderAttentionMask) =&gt;
Int
-&gt; GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask
-&gt; ShowS
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask x.
Rep
  (GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask)
  x
-&gt; GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask
forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask x.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; Rep
     (GSimplifiedEncoderDecoderTransformer
        model
        mkPos
        mkDecoderPos
        mkPaddingMask
        mkAttentionMask
        mkCrossAttentionMask
        mkDecoderAttentionMask)
     x
$cto :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask x.
Rep
  (GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask)
  x
-&gt; GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask
$cfrom :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask x.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; Rep
     (GSimplifiedEncoderDecoderTransformer
        model
        mkPos
        mkDecoderPos
        mkPaddingMask
        mkAttentionMask
        mkCrossAttentionMask
        mkDecoderAttentionMask)
     x
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span>
</span><span id="line-358"></span><span>  </span><span id="ModelSpec"><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-var">ModelSpec</span></a></span></span><span> </span><span id="local-6989586621679719062"><span id="local-6989586621679719063"><span id="local-6989586621679719064"><span id="local-6989586621679719065"><span id="local-6989586621679719066"><span id="local-6989586621679719067"><span id="local-6989586621679719068"><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier hs-type">GSimplifiedEncoderDecoderTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719068"><span class="hs-identifier hs-type">model</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719067"><span class="hs-identifier hs-type">mkPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719066"><span class="hs-identifier hs-type">mkDecoderPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719065"><span class="hs-identifier hs-type">mkPaddingMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719064"><span class="hs-identifier hs-type">mkAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719063"><span class="hs-identifier hs-type">mkCrossAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719062"><span class="hs-identifier hs-type">mkDecoderAttentionMask</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-359"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier hs-type">GSimplifiedEncoderDecoderTransformer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719068"><span class="hs-identifier hs-type">model</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719067"><span class="hs-identifier hs-type">mkPos</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719066"><span class="hs-identifier hs-type">mkDecoderPos</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719065"><span class="hs-identifier hs-type">mkPaddingMask</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719064"><span class="hs-identifier hs-type">mkAttentionMask</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719063"><span class="hs-identifier hs-type">mkCrossAttentionMask</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719062"><span class="hs-identifier hs-type">mkDecoderAttentionMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-360"></span><span>
</span><span id="line-361"></span><span class="hs-keyword">instance</span><span>
</span><span id="line-362"></span><span>  </span><span id="local-6989586621679719060"><span id="local-6989586621679720829"><span id="local-6989586621679720830"><span id="local-6989586621679720831"><span id="local-6989586621679720832"><span id="local-6989586621679720833"><span id="local-6989586621679720834"><span id="local-6989586621679720835"><span id="local-6989586621679720836"><span id="local-6989586621679720837"><span id="local-6989586621679720838"><span id="local-6989586621679720839"><span id="local-6989586621679720840"><span id="local-6989586621679720841"><span id="local-6989586621679720842"><span id="local-6989586621679720843"><span id="local-6989586621679720844"><span id="local-6989586621679720845"><span id="local-6989586621679720846"><span id="local-6989586621679720847"><span id="local-6989586621679720848"><span id="local-6989586621679720849"><span id="local-6989586621679720850"><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720850"><span class="hs-identifier hs-type">model</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720849"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720848"><span class="hs-identifier hs-type">model'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720847"><span class="hs-identifier hs-type">generatorDevice0</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-363"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720846"><span class="hs-identifier hs-type">mkPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720847"><span class="hs-identifier hs-type">generatorDevice0</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720845"><span class="hs-identifier hs-type">mkPos'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720844"><span class="hs-identifier hs-type">generatorDevice1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-364"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720843"><span class="hs-identifier hs-type">mkDecoderPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720844"><span class="hs-identifier hs-type">generatorDevice1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720842"><span class="hs-identifier hs-type">mkDecoderPos'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720841"><span class="hs-identifier hs-type">generatorDevice2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-365"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720840"><span class="hs-identifier hs-type">mkPaddingMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720841"><span class="hs-identifier hs-type">generatorDevice2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720839"><span class="hs-identifier hs-type">mkPaddingMask'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720838"><span class="hs-identifier hs-type">generatorDevice3</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-366"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720837"><span class="hs-identifier hs-type">mkAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720838"><span class="hs-identifier hs-type">generatorDevice3</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720836"><span class="hs-identifier hs-type">mkAttentionMask'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720835"><span class="hs-identifier hs-type">generatorDevice4</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-367"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720834"><span class="hs-identifier hs-type">mkCrossAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720835"><span class="hs-identifier hs-type">generatorDevice4</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720833"><span class="hs-identifier hs-type">mkCrossAttentionMask'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720832"><span class="hs-identifier hs-type">generatorDevice5</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-368"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720831"><span class="hs-identifier hs-type">mkDecoderAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720832"><span class="hs-identifier hs-type">generatorDevice5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720830"><span class="hs-identifier hs-type">mkDecoderAttentionMask'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720829"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-369"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-370"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span>
</span><span id="line-371"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier hs-type">GSimplifiedEncoderDecoderTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720850"><span class="hs-identifier hs-type">model</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720846"><span class="hs-identifier hs-type">mkPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720843"><span class="hs-identifier hs-type">mkDecoderPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720840"><span class="hs-identifier hs-type">mkPaddingMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720837"><span class="hs-identifier hs-type">mkAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720834"><span class="hs-identifier hs-type">mkCrossAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720831"><span class="hs-identifier hs-type">mkDecoderAttentionMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-372"></span><span>    </span><span class="annot"><a href="#local-6989586621679720849"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-373"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier hs-type">GSimplifiedEncoderDecoderTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720848"><span class="hs-identifier hs-type">model'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720845"><span class="hs-identifier hs-type">mkPos'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720842"><span class="hs-identifier hs-type">mkDecoderPos'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720839"><span class="hs-identifier hs-type">mkPaddingMask'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720836"><span class="hs-identifier hs-type">mkAttentionMask'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720833"><span class="hs-identifier hs-type">mkCrossAttentionMask'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720830"><span class="hs-identifier hs-type">mkDecoderAttentionMask'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-374"></span><span>    </span><span class="annot"><a href="#local-6989586621679720829"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-375"></span><span>
</span><span id="line-376"></span><span class="hs-keyword">instance</span><span>
</span><span id="line-377"></span><span>  </span><span id="local-6989586621679719056"><span id="local-6989586621679719058"><span id="local-6989586621679720822"><span id="local-6989586621679720823"><span id="local-6989586621679720824"><span id="local-6989586621679720825"><span id="local-6989586621679720826"><span id="local-6989586621679720827"><span id="local-6989586621679720828"><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720828"><span class="hs-identifier hs-type">model</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-378"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720827"><span class="hs-identifier hs-type">mkPos</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-379"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720826"><span class="hs-identifier hs-type">mkDecoderPos</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-380"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720825"><span class="hs-identifier hs-type">mkPaddingMask</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-381"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720824"><span class="hs-identifier hs-type">mkAttentionMask</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-382"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720823"><span class="hs-identifier hs-type">mkCrossAttentionMask</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-383"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720822"><span class="hs-identifier hs-type">mkDecoderAttentionMask</span></a></span><span>
</span><span id="line-384"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-385"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier hs-type">GSimplifiedEncoderDecoderTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720828"><span class="hs-identifier hs-type">model</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720827"><span class="hs-identifier hs-type">mkPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720826"><span class="hs-identifier hs-type">mkDecoderPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720825"><span class="hs-identifier hs-type">mkPaddingMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720824"><span class="hs-identifier hs-type">mkAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720823"><span class="hs-identifier hs-type">mkCrossAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720822"><span class="hs-identifier hs-type">mkDecoderAttentionMask</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-386"></span><span>
</span><span id="line-387"></span><span class="hs-comment">-- | Input data type for use with an encoder-decoder transformer.</span><span>
</span><span id="line-388"></span><span class="hs-comment">-- Use this for training.</span><span>
</span><span id="line-389"></span><span id="local-6989586621679719054"><span id="local-6989586621679719055"></span></span><span class="hs-keyword">data</span><span> </span><span id="EncoderDecoderTransformerInput"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerInput"><span class="hs-identifier hs-var">EncoderDecoderTransformerInput</span></a></span></span><span> </span><span id="local-6989586621679720758"><span class="annot"><a href="#local-6989586621679720758"><span class="hs-identifier hs-type">input</span></a></span></span><span> </span><span id="local-6989586621679720757"><span class="annot"><a href="#local-6989586621679720757"><span class="hs-identifier hs-type">decoderInput</span></a></span></span><span> </span><span id="local-6989586621679720756"><span class="annot"><a href="#local-6989586621679720756"><span class="hs-identifier hs-type">pos</span></a></span></span><span> </span><span id="local-6989586621679720755"><span class="annot"><a href="#local-6989586621679720755"><span class="hs-identifier hs-type">decoderPos</span></a></span></span><span> </span><span id="local-6989586621679720754"><span class="annot"><a href="#local-6989586621679720754"><span class="hs-identifier hs-type">attentionMask</span></a></span></span><span> </span><span id="local-6989586621679720753"><span class="annot"><a href="#local-6989586621679720753"><span class="hs-identifier hs-type">decoderAttentionMask</span></a></span></span><span> </span><span id="local-6989586621679720752"><span class="annot"><a href="#local-6989586621679720752"><span class="hs-identifier hs-type">crossAttentionMask</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-390"></span><span>  </span><span id="EncoderDecoderTransformerInput"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerInput"><span class="hs-identifier hs-var">EncoderDecoderTransformerInput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-391"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679720814"><span class="annot"><a href="#local-6989586621679720814"><span class="hs-identifier hs-type">input</span></a></span></span><span> </span><span id="local-6989586621679720813"><span class="annot"><a href="#local-6989586621679720813"><span class="hs-identifier hs-type">decoderInput</span></a></span></span><span> </span><span id="local-6989586621679720812"><span class="annot"><a href="#local-6989586621679720812"><span class="hs-identifier hs-type">pos</span></a></span></span><span> </span><span id="local-6989586621679720811"><span class="annot"><a href="#local-6989586621679720811"><span class="hs-identifier hs-type">decoderPos</span></a></span></span><span> </span><span id="local-6989586621679720810"><span class="annot"><a href="#local-6989586621679720810"><span class="hs-identifier hs-type">attentionMask</span></a></span></span><span> </span><span id="local-6989586621679720809"><span class="annot"><a href="#local-6989586621679720809"><span class="hs-identifier hs-type">decoderAttentionMask</span></a></span></span><span> </span><span id="local-6989586621679720808"><span class="annot"><a href="#local-6989586621679720808"><span class="hs-identifier hs-type">crossAttentionMask</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-392"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="edtInput"><span class="annot"><span class="annottext">forall input decoderInput pos decoderPos attentionMask
       decoderAttentionMask crossAttentionMask.
EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; input
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtInput"><span class="hs-identifier hs-var hs-var">edtInput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679720814"><span class="hs-identifier hs-type">input</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-393"></span><span>      </span><span id="edtDecoderInput"><span class="annot"><span class="annottext">forall input decoderInput pos decoderPos attentionMask
       decoderAttentionMask crossAttentionMask.
EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; decoderInput
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtDecoderInput"><span class="hs-identifier hs-var hs-var">edtDecoderInput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679720813"><span class="hs-identifier hs-type">decoderInput</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-394"></span><span>      </span><span id="edtPos"><span class="annot"><span class="annottext">forall input decoderInput pos decoderPos attentionMask
       decoderAttentionMask crossAttentionMask.
EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; pos
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtPos"><span class="hs-identifier hs-var hs-var">edtPos</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679720812"><span class="hs-identifier hs-type">pos</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-395"></span><span>      </span><span id="edtDecoderPos"><span class="annot"><span class="annottext">forall input decoderInput pos decoderPos attentionMask
       decoderAttentionMask crossAttentionMask.
EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; decoderPos
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtDecoderPos"><span class="hs-identifier hs-var hs-var">edtDecoderPos</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679720811"><span class="hs-identifier hs-type">decoderPos</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-396"></span><span>      </span><span id="edtAttentionMask"><span class="annot"><span class="annottext">forall input decoderInput pos decoderPos attentionMask
       decoderAttentionMask crossAttentionMask.
EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; attentionMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtAttentionMask"><span class="hs-identifier hs-var hs-var">edtAttentionMask</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679720810"><span class="hs-identifier hs-type">attentionMask</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-397"></span><span>      </span><span id="edtDecoderAttentionMask"><span class="annot"><span class="annottext">forall input decoderInput pos decoderPos attentionMask
       decoderAttentionMask crossAttentionMask.
EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; decoderAttentionMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtDecoderAttentionMask"><span class="hs-identifier hs-var hs-var">edtDecoderAttentionMask</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679720809"><span class="hs-identifier hs-type">decoderAttentionMask</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-398"></span><span>      </span><span id="edtCrossAttentionMask"><span class="annot"><span class="annottext">forall input decoderInput pos decoderPos attentionMask
       decoderAttentionMask crossAttentionMask.
EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; crossAttentionMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtCrossAttentionMask"><span class="hs-identifier hs-var hs-var">edtCrossAttentionMask</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679720808"><span class="hs-identifier hs-type">crossAttentionMask</span></a></span><span>
</span><span id="line-399"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-400"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerInput"><span class="hs-identifier hs-type">EncoderDecoderTransformerInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720814"><span class="hs-identifier hs-type">input</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720813"><span class="hs-identifier hs-type">decoderInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720812"><span class="hs-identifier hs-type">pos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720811"><span class="hs-identifier hs-type">decoderPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720810"><span class="hs-identifier hs-type">attentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720809"><span class="hs-identifier hs-type">decoderAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720808"><span class="hs-identifier hs-type">crossAttentionMask</span></a></span><span>
</span><span id="line-401"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679719035"><span id="local-6989586621679719044"><span class="annot"><span class="annottext">EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerInput
     input
     decoderInput
     pos
     decoderPos
     attentionMask
     decoderAttentionMask
     crossAttentionMask
-&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall input decoderInput pos decoderPos attentionMask
       decoderAttentionMask crossAttentionMask.
(Eq input, Eq decoderInput, Eq pos, Eq decoderPos,
 Eq attentionMask, Eq decoderAttentionMask,
 Eq crossAttentionMask) =&gt;
EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerInput
     input
     decoderInput
     pos
     decoderPos
     attentionMask
     decoderAttentionMask
     crossAttentionMask
-&gt; Bool
/= :: EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerInput
     input
     decoderInput
     pos
     decoderPos
     attentionMask
     decoderAttentionMask
     crossAttentionMask
-&gt; Bool
$c/= :: forall input decoderInput pos decoderPos attentionMask
       decoderAttentionMask crossAttentionMask.
(Eq input, Eq decoderInput, Eq pos, Eq decoderPos,
 Eq attentionMask, Eq decoderAttentionMask,
 Eq crossAttentionMask) =&gt;
EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerInput
     input
     decoderInput
     pos
     decoderPos
     attentionMask
     decoderAttentionMask
     crossAttentionMask
-&gt; Bool
== :: EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerInput
     input
     decoderInput
     pos
     decoderPos
     attentionMask
     decoderAttentionMask
     crossAttentionMask
-&gt; Bool
$c== :: forall input decoderInput pos decoderPos attentionMask
       decoderAttentionMask crossAttentionMask.
(Eq input, Eq decoderInput, Eq pos, Eq decoderPos,
 Eq attentionMask, Eq decoderAttentionMask,
 Eq crossAttentionMask) =&gt;
EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerInput
     input
     decoderInput
     pos
     decoderPos
     attentionMask
     decoderAttentionMask
     crossAttentionMask
-&gt; Bool
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679719002"><span id="local-6989586621679719004"><span id="local-6989586621679719007"><span id="local-6989586621679719010"><span id="local-6989586621679719013"><span id="local-6989586621679719022"><span id="local-6989586621679719031"><span class="annot"><span class="annottext">EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerInput
     input
     decoderInput
     pos
     decoderPos
     attentionMask
     decoderAttentionMask
     crossAttentionMask
-&gt; Bool
EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerInput
     input
     decoderInput
     pos
     decoderPos
     attentionMask
     decoderAttentionMask
     crossAttentionMask
-&gt; Ordering
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall {input} {decoderInput} {pos} {decoderPos} {attentionMask}
       {decoderAttentionMask} {crossAttentionMask}.
(Ord input, Ord decoderInput, Ord pos, Ord decoderPos,
 Ord attentionMask, Ord decoderAttentionMask,
 Ord crossAttentionMask) =&gt;
Eq
  (EncoderDecoderTransformerInput
     input
     decoderInput
     pos
     decoderPos
     attentionMask
     decoderAttentionMask
     crossAttentionMask)
forall input decoderInput pos decoderPos attentionMask
       decoderAttentionMask crossAttentionMask.
(Ord input, Ord decoderInput, Ord pos, Ord decoderPos,
 Ord attentionMask, Ord decoderAttentionMask,
 Ord crossAttentionMask) =&gt;
EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerInput
     input
     decoderInput
     pos
     decoderPos
     attentionMask
     decoderAttentionMask
     crossAttentionMask
-&gt; Bool
forall input decoderInput pos decoderPos attentionMask
       decoderAttentionMask crossAttentionMask.
(Ord input, Ord decoderInput, Ord pos, Ord decoderPos,
 Ord attentionMask, Ord decoderAttentionMask,
 Ord crossAttentionMask) =&gt;
EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerInput
     input
     decoderInput
     pos
     decoderPos
     attentionMask
     decoderAttentionMask
     crossAttentionMask
-&gt; Ordering
forall input decoderInput pos decoderPos attentionMask
       decoderAttentionMask crossAttentionMask.
(Ord input, Ord decoderInput, Ord pos, Ord decoderPos,
 Ord attentionMask, Ord decoderAttentionMask,
 Ord crossAttentionMask) =&gt;
EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerInput
     input
     decoderInput
     pos
     decoderPos
     attentionMask
     decoderAttentionMask
     crossAttentionMask
-&gt; EncoderDecoderTransformerInput
     input
     decoderInput
     pos
     decoderPos
     attentionMask
     decoderAttentionMask
     crossAttentionMask
min :: EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerInput
     input
     decoderInput
     pos
     decoderPos
     attentionMask
     decoderAttentionMask
     crossAttentionMask
-&gt; EncoderDecoderTransformerInput
     input
     decoderInput
     pos
     decoderPos
     attentionMask
     decoderAttentionMask
     crossAttentionMask
$cmin :: forall input decoderInput pos decoderPos attentionMask
       decoderAttentionMask crossAttentionMask.
(Ord input, Ord decoderInput, Ord pos, Ord decoderPos,
 Ord attentionMask, Ord decoderAttentionMask,
 Ord crossAttentionMask) =&gt;
EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerInput
     input
     decoderInput
     pos
     decoderPos
     attentionMask
     decoderAttentionMask
     crossAttentionMask
-&gt; EncoderDecoderTransformerInput
     input
     decoderInput
     pos
     decoderPos
     attentionMask
     decoderAttentionMask
     crossAttentionMask
max :: EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerInput
     input
     decoderInput
     pos
     decoderPos
     attentionMask
     decoderAttentionMask
     crossAttentionMask
-&gt; EncoderDecoderTransformerInput
     input
     decoderInput
     pos
     decoderPos
     attentionMask
     decoderAttentionMask
     crossAttentionMask
$cmax :: forall input decoderInput pos decoderPos attentionMask
       decoderAttentionMask crossAttentionMask.
(Ord input, Ord decoderInput, Ord pos, Ord decoderPos,
 Ord attentionMask, Ord decoderAttentionMask,
 Ord crossAttentionMask) =&gt;
EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerInput
     input
     decoderInput
     pos
     decoderPos
     attentionMask
     decoderAttentionMask
     crossAttentionMask
-&gt; EncoderDecoderTransformerInput
     input
     decoderInput
     pos
     decoderPos
     attentionMask
     decoderAttentionMask
     crossAttentionMask
&gt;= :: EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerInput
     input
     decoderInput
     pos
     decoderPos
     attentionMask
     decoderAttentionMask
     crossAttentionMask
-&gt; Bool
$c&gt;= :: forall input decoderInput pos decoderPos attentionMask
       decoderAttentionMask crossAttentionMask.
(Ord input, Ord decoderInput, Ord pos, Ord decoderPos,
 Ord attentionMask, Ord decoderAttentionMask,
 Ord crossAttentionMask) =&gt;
EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerInput
     input
     decoderInput
     pos
     decoderPos
     attentionMask
     decoderAttentionMask
     crossAttentionMask
-&gt; Bool
&gt; :: EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerInput
     input
     decoderInput
     pos
     decoderPos
     attentionMask
     decoderAttentionMask
     crossAttentionMask
-&gt; Bool
$c&gt; :: forall input decoderInput pos decoderPos attentionMask
       decoderAttentionMask crossAttentionMask.
(Ord input, Ord decoderInput, Ord pos, Ord decoderPos,
 Ord attentionMask, Ord decoderAttentionMask,
 Ord crossAttentionMask) =&gt;
EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerInput
     input
     decoderInput
     pos
     decoderPos
     attentionMask
     decoderAttentionMask
     crossAttentionMask
-&gt; Bool
&lt;= :: EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerInput
     input
     decoderInput
     pos
     decoderPos
     attentionMask
     decoderAttentionMask
     crossAttentionMask
-&gt; Bool
$c&lt;= :: forall input decoderInput pos decoderPos attentionMask
       decoderAttentionMask crossAttentionMask.
(Ord input, Ord decoderInput, Ord pos, Ord decoderPos,
 Ord attentionMask, Ord decoderAttentionMask,
 Ord crossAttentionMask) =&gt;
EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerInput
     input
     decoderInput
     pos
     decoderPos
     attentionMask
     decoderAttentionMask
     crossAttentionMask
-&gt; Bool
&lt; :: EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerInput
     input
     decoderInput
     pos
     decoderPos
     attentionMask
     decoderAttentionMask
     crossAttentionMask
-&gt; Bool
$c&lt; :: forall input decoderInput pos decoderPos attentionMask
       decoderAttentionMask crossAttentionMask.
(Ord input, Ord decoderInput, Ord pos, Ord decoderPos,
 Ord attentionMask, Ord decoderAttentionMask,
 Ord crossAttentionMask) =&gt;
EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerInput
     input
     decoderInput
     pos
     decoderPos
     attentionMask
     decoderAttentionMask
     crossAttentionMask
-&gt; Bool
compare :: EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerInput
     input
     decoderInput
     pos
     decoderPos
     attentionMask
     decoderAttentionMask
     crossAttentionMask
-&gt; Ordering
$ccompare :: forall input decoderInput pos decoderPos attentionMask
       decoderAttentionMask crossAttentionMask.
(Ord input, Ord decoderInput, Ord pos, Ord decoderPos,
 Ord attentionMask, Ord decoderAttentionMask,
 Ord crossAttentionMask) =&gt;
EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerInput
     input
     decoderInput
     pos
     decoderPos
     attentionMask
     decoderAttentionMask
     crossAttentionMask
-&gt; Ordering
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679718988"><span id="local-6989586621679718990"><span id="local-6989586621679719000"><span class="annot"><span class="annottext">Int
-&gt; EncoderDecoderTransformerInput
     input
     decoderInput
     pos
     decoderPos
     attentionMask
     decoderAttentionMask
     crossAttentionMask
-&gt; ShowS
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall input decoderInput pos decoderPos attentionMask
       decoderAttentionMask crossAttentionMask.
(Show input, Show decoderInput, Show pos, Show decoderPos,
 Show attentionMask, Show decoderAttentionMask,
 Show crossAttentionMask) =&gt;
Int
-&gt; EncoderDecoderTransformerInput
     input
     decoderInput
     pos
     decoderPos
     attentionMask
     decoderAttentionMask
     crossAttentionMask
-&gt; ShowS
forall input decoderInput pos decoderPos attentionMask
       decoderAttentionMask crossAttentionMask.
(Show input, Show decoderInput, Show pos, Show decoderPos,
 Show attentionMask, Show decoderAttentionMask,
 Show crossAttentionMask) =&gt;
[EncoderDecoderTransformerInput
   input
   decoderInput
   pos
   decoderPos
   attentionMask
   decoderAttentionMask
   crossAttentionMask]
-&gt; ShowS
forall input decoderInput pos decoderPos attentionMask
       decoderAttentionMask crossAttentionMask.
(Show input, Show decoderInput, Show pos, Show decoderPos,
 Show attentionMask, Show decoderAttentionMask,
 Show crossAttentionMask) =&gt;
EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; String
showList :: [EncoderDecoderTransformerInput
   input
   decoderInput
   pos
   decoderPos
   attentionMask
   decoderAttentionMask
   crossAttentionMask]
-&gt; ShowS
$cshowList :: forall input decoderInput pos decoderPos attentionMask
       decoderAttentionMask crossAttentionMask.
(Show input, Show decoderInput, Show pos, Show decoderPos,
 Show attentionMask, Show decoderAttentionMask,
 Show crossAttentionMask) =&gt;
[EncoderDecoderTransformerInput
   input
   decoderInput
   pos
   decoderPos
   attentionMask
   decoderAttentionMask
   crossAttentionMask]
-&gt; ShowS
show :: EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; String
$cshow :: forall input decoderInput pos decoderPos attentionMask
       decoderAttentionMask crossAttentionMask.
(Show input, Show decoderInput, Show pos, Show decoderPos,
 Show attentionMask, Show decoderAttentionMask,
 Show crossAttentionMask) =&gt;
EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; String
showsPrec :: Int
-&gt; EncoderDecoderTransformerInput
     input
     decoderInput
     pos
     decoderPos
     attentionMask
     decoderAttentionMask
     crossAttentionMask
-&gt; ShowS
$cshowsPrec :: forall input decoderInput pos decoderPos attentionMask
       decoderAttentionMask crossAttentionMask.
(Show input, Show decoderInput, Show pos, Show decoderPos,
 Show attentionMask, Show decoderAttentionMask,
 Show crossAttentionMask) =&gt;
Int
-&gt; EncoderDecoderTransformerInput
     input
     decoderInput
     pos
     decoderPos
     attentionMask
     decoderAttentionMask
     crossAttentionMask
-&gt; ShowS
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall input decoderInput pos decoderPos attentionMask
       decoderAttentionMask crossAttentionMask x.
Rep
  (EncoderDecoderTransformerInput
     input
     decoderInput
     pos
     decoderPos
     attentionMask
     decoderAttentionMask
     crossAttentionMask)
  x
-&gt; EncoderDecoderTransformerInput
     input
     decoderInput
     pos
     decoderPos
     attentionMask
     decoderAttentionMask
     crossAttentionMask
forall input decoderInput pos decoderPos attentionMask
       decoderAttentionMask crossAttentionMask x.
EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; Rep
     (EncoderDecoderTransformerInput
        input
        decoderInput
        pos
        decoderPos
        attentionMask
        decoderAttentionMask
        crossAttentionMask)
     x
$cto :: forall input decoderInput pos decoderPos attentionMask
       decoderAttentionMask crossAttentionMask x.
Rep
  (EncoderDecoderTransformerInput
     input
     decoderInput
     pos
     decoderPos
     attentionMask
     decoderAttentionMask
     crossAttentionMask)
  x
-&gt; EncoderDecoderTransformerInput
     input
     decoderInput
     pos
     decoderPos
     attentionMask
     decoderAttentionMask
     crossAttentionMask
$cfrom :: forall input decoderInput pos decoderPos attentionMask
       decoderAttentionMask crossAttentionMask x.
EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; Rep
     (EncoderDecoderTransformerInput
        input
        decoderInput
        pos
        decoderPos
        attentionMask
        decoderAttentionMask
        crossAttentionMask)
     x
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-402"></span><span>
</span><span id="line-403"></span><span id="local-6989586621679718983"><span id="local-6989586621679718984"></span></span><span class="hs-keyword">data</span><span> </span><span id="EncoderDecoderTransformerInput%27"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerInput%27"><span class="hs-identifier hs-var">EncoderDecoderTransformerInput'</span></a></span></span><span> </span><span id="local-6989586621679720736"><span class="annot"><a href="#local-6989586621679720736"><span class="hs-identifier hs-type">input</span></a></span></span><span> </span><span id="local-6989586621679720735"><span class="annot"><a href="#local-6989586621679720735"><span class="hs-identifier hs-type">pos</span></a></span></span><span> </span><span id="local-6989586621679720734"><span class="annot"><a href="#local-6989586621679720734"><span class="hs-identifier hs-type">attentionMask</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-404"></span><span>  </span><span id="EncoderDecoderTransformerInput%27"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerInput%27"><span class="hs-identifier hs-var">EncoderDecoderTransformerInput'</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-405"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679720748"><span class="annot"><a href="#local-6989586621679720748"><span class="hs-identifier hs-type">input</span></a></span></span><span> </span><span id="local-6989586621679720747"><span class="annot"><a href="#local-6989586621679720747"><span class="hs-identifier hs-type">pos</span></a></span></span><span> </span><span id="local-6989586621679720746"><span class="annot"><a href="#local-6989586621679720746"><span class="hs-identifier hs-type">attentionMask</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-406"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="edtInput%27"><span class="annot"><span class="annottext">forall input pos attentionMask.
EncoderDecoderTransformerInput' input pos attentionMask -&gt; input
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtInput%27"><span class="hs-identifier hs-var hs-var">edtInput'</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679720748"><span class="hs-identifier hs-type">input</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-407"></span><span>      </span><span id="edtPos%27"><span class="annot"><span class="annottext">forall input pos attentionMask.
EncoderDecoderTransformerInput' input pos attentionMask -&gt; pos
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtPos%27"><span class="hs-identifier hs-var hs-var">edtPos'</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679720747"><span class="hs-identifier hs-type">pos</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-408"></span><span>      </span><span id="edtAttentionMask%27"><span class="annot"><span class="annottext">forall input pos attentionMask.
EncoderDecoderTransformerInput' input pos attentionMask
-&gt; attentionMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtAttentionMask%27"><span class="hs-identifier hs-var hs-var">edtAttentionMask'</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679720746"><span class="hs-identifier hs-type">attentionMask</span></a></span><span>
</span><span id="line-409"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-410"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerInput%27"><span class="hs-identifier hs-type">EncoderDecoderTransformerInput'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720748"><span class="hs-identifier hs-type">input</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720747"><span class="hs-identifier hs-type">pos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720746"><span class="hs-identifier hs-type">attentionMask</span></a></span><span>
</span><span id="line-411"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679718972"><span id="local-6989586621679718977"><span class="annot"><span class="annottext">EncoderDecoderTransformerInput' input pos attentionMask
-&gt; EncoderDecoderTransformerInput' input pos attentionMask -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall input pos attentionMask.
(Eq input, Eq pos, Eq attentionMask) =&gt;
EncoderDecoderTransformerInput' input pos attentionMask
-&gt; EncoderDecoderTransformerInput' input pos attentionMask -&gt; Bool
/= :: EncoderDecoderTransformerInput' input pos attentionMask
-&gt; EncoderDecoderTransformerInput' input pos attentionMask -&gt; Bool
$c/= :: forall input pos attentionMask.
(Eq input, Eq pos, Eq attentionMask) =&gt;
EncoderDecoderTransformerInput' input pos attentionMask
-&gt; EncoderDecoderTransformerInput' input pos attentionMask -&gt; Bool
== :: EncoderDecoderTransformerInput' input pos attentionMask
-&gt; EncoderDecoderTransformerInput' input pos attentionMask -&gt; Bool
$c== :: forall input pos attentionMask.
(Eq input, Eq pos, Eq attentionMask) =&gt;
EncoderDecoderTransformerInput' input pos attentionMask
-&gt; EncoderDecoderTransformerInput' input pos attentionMask -&gt; Bool
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679718947"><span id="local-6989586621679718949"><span id="local-6989586621679718952"><span id="local-6989586621679718955"><span id="local-6989586621679718958"><span id="local-6989586621679718963"><span id="local-6989586621679718968"><span class="annot"><span class="annottext">EncoderDecoderTransformerInput' input pos attentionMask
-&gt; EncoderDecoderTransformerInput' input pos attentionMask -&gt; Bool
EncoderDecoderTransformerInput' input pos attentionMask
-&gt; EncoderDecoderTransformerInput' input pos attentionMask
-&gt; Ordering
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall {input} {pos} {attentionMask}.
(Ord input, Ord pos, Ord attentionMask) =&gt;
Eq (EncoderDecoderTransformerInput' input pos attentionMask)
forall input pos attentionMask.
(Ord input, Ord pos, Ord attentionMask) =&gt;
EncoderDecoderTransformerInput' input pos attentionMask
-&gt; EncoderDecoderTransformerInput' input pos attentionMask -&gt; Bool
forall input pos attentionMask.
(Ord input, Ord pos, Ord attentionMask) =&gt;
EncoderDecoderTransformerInput' input pos attentionMask
-&gt; EncoderDecoderTransformerInput' input pos attentionMask
-&gt; Ordering
forall input pos attentionMask.
(Ord input, Ord pos, Ord attentionMask) =&gt;
EncoderDecoderTransformerInput' input pos attentionMask
-&gt; EncoderDecoderTransformerInput' input pos attentionMask
-&gt; EncoderDecoderTransformerInput' input pos attentionMask
min :: EncoderDecoderTransformerInput' input pos attentionMask
-&gt; EncoderDecoderTransformerInput' input pos attentionMask
-&gt; EncoderDecoderTransformerInput' input pos attentionMask
$cmin :: forall input pos attentionMask.
(Ord input, Ord pos, Ord attentionMask) =&gt;
EncoderDecoderTransformerInput' input pos attentionMask
-&gt; EncoderDecoderTransformerInput' input pos attentionMask
-&gt; EncoderDecoderTransformerInput' input pos attentionMask
max :: EncoderDecoderTransformerInput' input pos attentionMask
-&gt; EncoderDecoderTransformerInput' input pos attentionMask
-&gt; EncoderDecoderTransformerInput' input pos attentionMask
$cmax :: forall input pos attentionMask.
(Ord input, Ord pos, Ord attentionMask) =&gt;
EncoderDecoderTransformerInput' input pos attentionMask
-&gt; EncoderDecoderTransformerInput' input pos attentionMask
-&gt; EncoderDecoderTransformerInput' input pos attentionMask
&gt;= :: EncoderDecoderTransformerInput' input pos attentionMask
-&gt; EncoderDecoderTransformerInput' input pos attentionMask -&gt; Bool
$c&gt;= :: forall input pos attentionMask.
(Ord input, Ord pos, Ord attentionMask) =&gt;
EncoderDecoderTransformerInput' input pos attentionMask
-&gt; EncoderDecoderTransformerInput' input pos attentionMask -&gt; Bool
&gt; :: EncoderDecoderTransformerInput' input pos attentionMask
-&gt; EncoderDecoderTransformerInput' input pos attentionMask -&gt; Bool
$c&gt; :: forall input pos attentionMask.
(Ord input, Ord pos, Ord attentionMask) =&gt;
EncoderDecoderTransformerInput' input pos attentionMask
-&gt; EncoderDecoderTransformerInput' input pos attentionMask -&gt; Bool
&lt;= :: EncoderDecoderTransformerInput' input pos attentionMask
-&gt; EncoderDecoderTransformerInput' input pos attentionMask -&gt; Bool
$c&lt;= :: forall input pos attentionMask.
(Ord input, Ord pos, Ord attentionMask) =&gt;
EncoderDecoderTransformerInput' input pos attentionMask
-&gt; EncoderDecoderTransformerInput' input pos attentionMask -&gt; Bool
&lt; :: EncoderDecoderTransformerInput' input pos attentionMask
-&gt; EncoderDecoderTransformerInput' input pos attentionMask -&gt; Bool
$c&lt; :: forall input pos attentionMask.
(Ord input, Ord pos, Ord attentionMask) =&gt;
EncoderDecoderTransformerInput' input pos attentionMask
-&gt; EncoderDecoderTransformerInput' input pos attentionMask -&gt; Bool
compare :: EncoderDecoderTransformerInput' input pos attentionMask
-&gt; EncoderDecoderTransformerInput' input pos attentionMask
-&gt; Ordering
$ccompare :: forall input pos attentionMask.
(Ord input, Ord pos, Ord attentionMask) =&gt;
EncoderDecoderTransformerInput' input pos attentionMask
-&gt; EncoderDecoderTransformerInput' input pos attentionMask
-&gt; Ordering
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679718937"><span id="local-6989586621679718939"><span id="local-6989586621679718945"><span class="annot"><span class="annottext">Int
-&gt; EncoderDecoderTransformerInput' input pos attentionMask -&gt; ShowS
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall input pos attentionMask.
(Show input, Show pos, Show attentionMask) =&gt;
Int
-&gt; EncoderDecoderTransformerInput' input pos attentionMask -&gt; ShowS
forall input pos attentionMask.
(Show input, Show pos, Show attentionMask) =&gt;
[EncoderDecoderTransformerInput' input pos attentionMask] -&gt; ShowS
forall input pos attentionMask.
(Show input, Show pos, Show attentionMask) =&gt;
EncoderDecoderTransformerInput' input pos attentionMask -&gt; String
showList :: [EncoderDecoderTransformerInput' input pos attentionMask] -&gt; ShowS
$cshowList :: forall input pos attentionMask.
(Show input, Show pos, Show attentionMask) =&gt;
[EncoderDecoderTransformerInput' input pos attentionMask] -&gt; ShowS
show :: EncoderDecoderTransformerInput' input pos attentionMask -&gt; String
$cshow :: forall input pos attentionMask.
(Show input, Show pos, Show attentionMask) =&gt;
EncoderDecoderTransformerInput' input pos attentionMask -&gt; String
showsPrec :: Int
-&gt; EncoderDecoderTransformerInput' input pos attentionMask -&gt; ShowS
$cshowsPrec :: forall input pos attentionMask.
(Show input, Show pos, Show attentionMask) =&gt;
Int
-&gt; EncoderDecoderTransformerInput' input pos attentionMask -&gt; ShowS
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall input pos attentionMask x.
Rep (EncoderDecoderTransformerInput' input pos attentionMask) x
-&gt; EncoderDecoderTransformerInput' input pos attentionMask
forall input pos attentionMask x.
EncoderDecoderTransformerInput' input pos attentionMask
-&gt; Rep (EncoderDecoderTransformerInput' input pos attentionMask) x
$cto :: forall input pos attentionMask x.
Rep (EncoderDecoderTransformerInput' input pos attentionMask) x
-&gt; EncoderDecoderTransformerInput' input pos attentionMask
$cfrom :: forall input pos attentionMask x.
EncoderDecoderTransformerInput' input pos attentionMask
-&gt; Rep (EncoderDecoderTransformerInput' input pos attentionMask) x
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-412"></span><span>
</span><span id="line-413"></span><span id="local-6989586621679718932"><span id="local-6989586621679718933"></span></span><span class="hs-keyword">data</span><span> </span><span id="SimplifiedEncoderDecoderTransformerInput"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerInput"><span class="hs-identifier hs-var">SimplifiedEncoderDecoderTransformerInput</span></a></span></span><span> </span><span id="local-6989586621679720725"><span class="annot"><a href="#local-6989586621679720725"><span class="hs-identifier hs-type">input</span></a></span></span><span> </span><span id="local-6989586621679720724"><span class="annot"><a href="#local-6989586621679720724"><span class="hs-identifier hs-type">decoderInput</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-414"></span><span>  </span><span id="SimplifiedEncoderDecoderTransformerInput"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerInput"><span class="hs-identifier hs-var">SimplifiedEncoderDecoderTransformerInput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-415"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679720731"><span class="annot"><a href="#local-6989586621679720731"><span class="hs-identifier hs-type">input</span></a></span></span><span> </span><span id="local-6989586621679720730"><span class="annot"><a href="#local-6989586621679720730"><span class="hs-identifier hs-type">decoderInput</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-416"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="sedtInput"><span class="annot"><span class="annottext">forall input decoderInput.
SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; input
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtInput"><span class="hs-identifier hs-var hs-var">sedtInput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679720731"><span class="hs-identifier hs-type">input</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-417"></span><span>      </span><span id="sedtDecoderInput"><span class="annot"><span class="annottext">forall input decoderInput.
SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; decoderInput
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtDecoderInput"><span class="hs-identifier hs-var hs-var">sedtDecoderInput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679720730"><span class="hs-identifier hs-type">decoderInput</span></a></span><span>
</span><span id="line-418"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-419"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerInput"><span class="hs-identifier hs-type">SimplifiedEncoderDecoderTransformerInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720731"><span class="hs-identifier hs-type">input</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720730"><span class="hs-identifier hs-type">decoderInput</span></a></span><span>
</span><span id="line-420"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679718923"><span id="local-6989586621679718927"><span class="annot"><span class="annottext">SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall input decoderInput.
(Eq input, Eq decoderInput) =&gt;
SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; Bool
/= :: SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; Bool
$c/= :: forall input decoderInput.
(Eq input, Eq decoderInput) =&gt;
SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; Bool
== :: SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; Bool
$c== :: forall input decoderInput.
(Eq input, Eq decoderInput) =&gt;
SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; Bool
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679718900"><span id="local-6989586621679718902"><span id="local-6989586621679718905"><span id="local-6989586621679718908"><span id="local-6989586621679718911"><span id="local-6989586621679718915"><span id="local-6989586621679718919"><span class="annot"><span class="annottext">SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; Bool
SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; Ordering
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall {input} {decoderInput}.
(Ord input, Ord decoderInput) =&gt;
Eq (SimplifiedEncoderDecoderTransformerInput input decoderInput)
forall input decoderInput.
(Ord input, Ord decoderInput) =&gt;
SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; Bool
forall input decoderInput.
(Ord input, Ord decoderInput) =&gt;
SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; Ordering
forall input decoderInput.
(Ord input, Ord decoderInput) =&gt;
SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; SimplifiedEncoderDecoderTransformerInput input decoderInput
min :: SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; SimplifiedEncoderDecoderTransformerInput input decoderInput
$cmin :: forall input decoderInput.
(Ord input, Ord decoderInput) =&gt;
SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; SimplifiedEncoderDecoderTransformerInput input decoderInput
max :: SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; SimplifiedEncoderDecoderTransformerInput input decoderInput
$cmax :: forall input decoderInput.
(Ord input, Ord decoderInput) =&gt;
SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; SimplifiedEncoderDecoderTransformerInput input decoderInput
&gt;= :: SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; Bool
$c&gt;= :: forall input decoderInput.
(Ord input, Ord decoderInput) =&gt;
SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; Bool
&gt; :: SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; Bool
$c&gt; :: forall input decoderInput.
(Ord input, Ord decoderInput) =&gt;
SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; Bool
&lt;= :: SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; Bool
$c&lt;= :: forall input decoderInput.
(Ord input, Ord decoderInput) =&gt;
SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; Bool
&lt; :: SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; Bool
$c&lt; :: forall input decoderInput.
(Ord input, Ord decoderInput) =&gt;
SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; Bool
compare :: SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; Ordering
$ccompare :: forall input decoderInput.
(Ord input, Ord decoderInput) =&gt;
SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; Ordering
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679718891"><span id="local-6989586621679718893"><span id="local-6989586621679718898"><span class="annot"><span class="annottext">Int
-&gt; SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; ShowS
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall input decoderInput.
(Show input, Show decoderInput) =&gt;
Int
-&gt; SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; ShowS
forall input decoderInput.
(Show input, Show decoderInput) =&gt;
[SimplifiedEncoderDecoderTransformerInput input decoderInput]
-&gt; ShowS
forall input decoderInput.
(Show input, Show decoderInput) =&gt;
SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; String
showList :: [SimplifiedEncoderDecoderTransformerInput input decoderInput]
-&gt; ShowS
$cshowList :: forall input decoderInput.
(Show input, Show decoderInput) =&gt;
[SimplifiedEncoderDecoderTransformerInput input decoderInput]
-&gt; ShowS
show :: SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; String
$cshow :: forall input decoderInput.
(Show input, Show decoderInput) =&gt;
SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; String
showsPrec :: Int
-&gt; SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; ShowS
$cshowsPrec :: forall input decoderInput.
(Show input, Show decoderInput) =&gt;
Int
-&gt; SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; ShowS
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall input decoderInput x.
Rep (SimplifiedEncoderDecoderTransformerInput input decoderInput) x
-&gt; SimplifiedEncoderDecoderTransformerInput input decoderInput
forall input decoderInput x.
SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; Rep
     (SimplifiedEncoderDecoderTransformerInput input decoderInput) x
$cto :: forall input decoderInput x.
Rep (SimplifiedEncoderDecoderTransformerInput input decoderInput) x
-&gt; SimplifiedEncoderDecoderTransformerInput input decoderInput
$cfrom :: forall input decoderInput x.
SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; Rep
     (SimplifiedEncoderDecoderTransformerInput input decoderInput) x
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-421"></span><span>
</span><span id="line-422"></span><span id="local-6989586621679718886"><span id="local-6989586621679718887"></span></span><span class="hs-keyword">data</span><span> </span><span id="SimplifiedEncoderDecoderTransformerInput%27"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerInput%27"><span class="hs-identifier hs-var">SimplifiedEncoderDecoderTransformerInput'</span></a></span></span><span> </span><span id="local-6989586621679720720"><span class="annot"><a href="#local-6989586621679720720"><span class="hs-identifier hs-type">input</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-423"></span><span>  </span><span id="SimplifiedEncoderDecoderTransformerInput%27"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerInput%27"><span class="hs-identifier hs-var">SimplifiedEncoderDecoderTransformerInput'</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-424"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679720722"><span class="annot"><a href="#local-6989586621679720722"><span class="hs-identifier hs-type">input</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-425"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="sedtInput%27"><span class="annot"><span class="annottext">forall input.
SimplifiedEncoderDecoderTransformerInput' input -&gt; input
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtInput%27"><span class="hs-identifier hs-var hs-var">sedtInput'</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679720722"><span class="hs-identifier hs-type">input</span></a></span><span>
</span><span id="line-426"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-427"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerInput%27"><span class="hs-identifier hs-type">SimplifiedEncoderDecoderTransformerInput'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720722"><span class="hs-identifier hs-type">input</span></a></span><span>
</span><span id="line-428"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679718879"><span id="local-6989586621679718882"><span class="annot"><span class="annottext">SimplifiedEncoderDecoderTransformerInput' input
-&gt; SimplifiedEncoderDecoderTransformerInput' input -&gt; Bool
forall input.
Eq input =&gt;
SimplifiedEncoderDecoderTransformerInput' input
-&gt; SimplifiedEncoderDecoderTransformerInput' input -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: SimplifiedEncoderDecoderTransformerInput' input
-&gt; SimplifiedEncoderDecoderTransformerInput' input -&gt; Bool
$c/= :: forall input.
Eq input =&gt;
SimplifiedEncoderDecoderTransformerInput' input
-&gt; SimplifiedEncoderDecoderTransformerInput' input -&gt; Bool
== :: SimplifiedEncoderDecoderTransformerInput' input
-&gt; SimplifiedEncoderDecoderTransformerInput' input -&gt; Bool
$c== :: forall input.
Eq input =&gt;
SimplifiedEncoderDecoderTransformerInput' input
-&gt; SimplifiedEncoderDecoderTransformerInput' input -&gt; Bool
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679718858"><span id="local-6989586621679718860"><span id="local-6989586621679718863"><span id="local-6989586621679718866"><span id="local-6989586621679718869"><span id="local-6989586621679718872"><span id="local-6989586621679718875"><span class="annot"><span class="annottext">SimplifiedEncoderDecoderTransformerInput' input
-&gt; SimplifiedEncoderDecoderTransformerInput' input -&gt; Bool
SimplifiedEncoderDecoderTransformerInput' input
-&gt; SimplifiedEncoderDecoderTransformerInput' input -&gt; Ordering
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall {input}.
Ord input =&gt;
Eq (SimplifiedEncoderDecoderTransformerInput' input)
forall input.
Ord input =&gt;
SimplifiedEncoderDecoderTransformerInput' input
-&gt; SimplifiedEncoderDecoderTransformerInput' input -&gt; Bool
forall input.
Ord input =&gt;
SimplifiedEncoderDecoderTransformerInput' input
-&gt; SimplifiedEncoderDecoderTransformerInput' input -&gt; Ordering
forall input.
Ord input =&gt;
SimplifiedEncoderDecoderTransformerInput' input
-&gt; SimplifiedEncoderDecoderTransformerInput' input
-&gt; SimplifiedEncoderDecoderTransformerInput' input
min :: SimplifiedEncoderDecoderTransformerInput' input
-&gt; SimplifiedEncoderDecoderTransformerInput' input
-&gt; SimplifiedEncoderDecoderTransformerInput' input
$cmin :: forall input.
Ord input =&gt;
SimplifiedEncoderDecoderTransformerInput' input
-&gt; SimplifiedEncoderDecoderTransformerInput' input
-&gt; SimplifiedEncoderDecoderTransformerInput' input
max :: SimplifiedEncoderDecoderTransformerInput' input
-&gt; SimplifiedEncoderDecoderTransformerInput' input
-&gt; SimplifiedEncoderDecoderTransformerInput' input
$cmax :: forall input.
Ord input =&gt;
SimplifiedEncoderDecoderTransformerInput' input
-&gt; SimplifiedEncoderDecoderTransformerInput' input
-&gt; SimplifiedEncoderDecoderTransformerInput' input
&gt;= :: SimplifiedEncoderDecoderTransformerInput' input
-&gt; SimplifiedEncoderDecoderTransformerInput' input -&gt; Bool
$c&gt;= :: forall input.
Ord input =&gt;
SimplifiedEncoderDecoderTransformerInput' input
-&gt; SimplifiedEncoderDecoderTransformerInput' input -&gt; Bool
&gt; :: SimplifiedEncoderDecoderTransformerInput' input
-&gt; SimplifiedEncoderDecoderTransformerInput' input -&gt; Bool
$c&gt; :: forall input.
Ord input =&gt;
SimplifiedEncoderDecoderTransformerInput' input
-&gt; SimplifiedEncoderDecoderTransformerInput' input -&gt; Bool
&lt;= :: SimplifiedEncoderDecoderTransformerInput' input
-&gt; SimplifiedEncoderDecoderTransformerInput' input -&gt; Bool
$c&lt;= :: forall input.
Ord input =&gt;
SimplifiedEncoderDecoderTransformerInput' input
-&gt; SimplifiedEncoderDecoderTransformerInput' input -&gt; Bool
&lt; :: SimplifiedEncoderDecoderTransformerInput' input
-&gt; SimplifiedEncoderDecoderTransformerInput' input -&gt; Bool
$c&lt; :: forall input.
Ord input =&gt;
SimplifiedEncoderDecoderTransformerInput' input
-&gt; SimplifiedEncoderDecoderTransformerInput' input -&gt; Bool
compare :: SimplifiedEncoderDecoderTransformerInput' input
-&gt; SimplifiedEncoderDecoderTransformerInput' input -&gt; Ordering
$ccompare :: forall input.
Ord input =&gt;
SimplifiedEncoderDecoderTransformerInput' input
-&gt; SimplifiedEncoderDecoderTransformerInput' input -&gt; Ordering
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679718850"><span id="local-6989586621679718852"><span id="local-6989586621679718856"><span class="annot"><span class="annottext">Int -&gt; SimplifiedEncoderDecoderTransformerInput' input -&gt; ShowS
forall input.
Show input =&gt;
Int -&gt; SimplifiedEncoderDecoderTransformerInput' input -&gt; ShowS
forall input.
Show input =&gt;
[SimplifiedEncoderDecoderTransformerInput' input] -&gt; ShowS
forall input.
Show input =&gt;
SimplifiedEncoderDecoderTransformerInput' input -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [SimplifiedEncoderDecoderTransformerInput' input] -&gt; ShowS
$cshowList :: forall input.
Show input =&gt;
[SimplifiedEncoderDecoderTransformerInput' input] -&gt; ShowS
show :: SimplifiedEncoderDecoderTransformerInput' input -&gt; String
$cshow :: forall input.
Show input =&gt;
SimplifiedEncoderDecoderTransformerInput' input -&gt; String
showsPrec :: Int -&gt; SimplifiedEncoderDecoderTransformerInput' input -&gt; ShowS
$cshowsPrec :: forall input.
Show input =&gt;
Int -&gt; SimplifiedEncoderDecoderTransformerInput' input -&gt; ShowS
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall input x.
Rep (SimplifiedEncoderDecoderTransformerInput' input) x
-&gt; SimplifiedEncoderDecoderTransformerInput' input
forall input x.
SimplifiedEncoderDecoderTransformerInput' input
-&gt; Rep (SimplifiedEncoderDecoderTransformerInput' input) x
$cto :: forall input x.
Rep (SimplifiedEncoderDecoderTransformerInput' input) x
-&gt; SimplifiedEncoderDecoderTransformerInput' input
$cfrom :: forall input x.
SimplifiedEncoderDecoderTransformerInput' input
-&gt; Rep (SimplifiedEncoderDecoderTransformerInput' input) x
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-429"></span><span>
</span><span id="line-430"></span><span id="local-6989586621679718845"><span id="local-6989586621679718846"></span></span><span class="hs-keyword">data</span><span> </span><span id="SimplifiedEncoderDecoderTransformerTrainingInput"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerTrainingInput"><span class="hs-identifier hs-var">SimplifiedEncoderDecoderTransformerTrainingInput</span></a></span></span><span> </span><span id="local-6989586621679720711"><span class="annot"><a href="#local-6989586621679720711"><span class="hs-identifier hs-type">input</span></a></span></span><span> </span><span id="local-6989586621679720710"><span class="annot"><a href="#local-6989586621679720710"><span class="hs-identifier hs-type">target</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-431"></span><span>  </span><span id="SimplifiedEncoderDecoderTransformerTrainingInput"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerTrainingInput"><span class="hs-identifier hs-var">SimplifiedEncoderDecoderTransformerTrainingInput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-432"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679720717"><span class="annot"><a href="#local-6989586621679720717"><span class="hs-identifier hs-type">input</span></a></span></span><span> </span><span id="local-6989586621679720716"><span class="annot"><a href="#local-6989586621679720716"><span class="hs-identifier hs-type">target</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-433"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="sedtTrainingInput"><span class="annot"><span class="annottext">forall input target.
SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; input
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtTrainingInput"><span class="hs-identifier hs-var hs-var">sedtTrainingInput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679720717"><span class="hs-identifier hs-type">input</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-434"></span><span>      </span><span id="sedtTarget"><span class="annot"><span class="annottext">forall input target.
SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; target
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtTarget"><span class="hs-identifier hs-var hs-var">sedtTarget</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679720716"><span class="hs-identifier hs-type">target</span></a></span><span>
</span><span id="line-435"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-436"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerTrainingInput"><span class="hs-identifier hs-type">SimplifiedEncoderDecoderTransformerTrainingInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720717"><span class="hs-identifier hs-type">input</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720716"><span class="hs-identifier hs-type">target</span></a></span><span>
</span><span id="line-437"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679718836"><span id="local-6989586621679718840"><span class="annot"><span class="annottext">SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall input target.
(Eq input, Eq target) =&gt;
SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; Bool
/= :: SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; Bool
$c/= :: forall input target.
(Eq input, Eq target) =&gt;
SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; Bool
== :: SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; Bool
$c== :: forall input target.
(Eq input, Eq target) =&gt;
SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; Bool
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679718813"><span id="local-6989586621679718815"><span id="local-6989586621679718818"><span id="local-6989586621679718821"><span id="local-6989586621679718824"><span id="local-6989586621679718828"><span id="local-6989586621679718832"><span class="annot"><span class="annottext">SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; Bool
SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; Ordering
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall {input} {target}.
(Ord input, Ord target) =&gt;
Eq (SimplifiedEncoderDecoderTransformerTrainingInput input target)
forall input target.
(Ord input, Ord target) =&gt;
SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; Bool
forall input target.
(Ord input, Ord target) =&gt;
SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; Ordering
forall input target.
(Ord input, Ord target) =&gt;
SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; SimplifiedEncoderDecoderTransformerTrainingInput input target
min :: SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; SimplifiedEncoderDecoderTransformerTrainingInput input target
$cmin :: forall input target.
(Ord input, Ord target) =&gt;
SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; SimplifiedEncoderDecoderTransformerTrainingInput input target
max :: SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; SimplifiedEncoderDecoderTransformerTrainingInput input target
$cmax :: forall input target.
(Ord input, Ord target) =&gt;
SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; SimplifiedEncoderDecoderTransformerTrainingInput input target
&gt;= :: SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; Bool
$c&gt;= :: forall input target.
(Ord input, Ord target) =&gt;
SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; Bool
&gt; :: SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; Bool
$c&gt; :: forall input target.
(Ord input, Ord target) =&gt;
SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; Bool
&lt;= :: SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; Bool
$c&lt;= :: forall input target.
(Ord input, Ord target) =&gt;
SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; Bool
&lt; :: SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; Bool
$c&lt; :: forall input target.
(Ord input, Ord target) =&gt;
SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; Bool
compare :: SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; Ordering
$ccompare :: forall input target.
(Ord input, Ord target) =&gt;
SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; Ordering
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679718804"><span id="local-6989586621679718806"><span id="local-6989586621679718811"><span class="annot"><span class="annottext">Int
-&gt; SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; ShowS
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall input target.
(Show input, Show target) =&gt;
Int
-&gt; SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; ShowS
forall input target.
(Show input, Show target) =&gt;
[SimplifiedEncoderDecoderTransformerTrainingInput input target]
-&gt; ShowS
forall input target.
(Show input, Show target) =&gt;
SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; String
showList :: [SimplifiedEncoderDecoderTransformerTrainingInput input target]
-&gt; ShowS
$cshowList :: forall input target.
(Show input, Show target) =&gt;
[SimplifiedEncoderDecoderTransformerTrainingInput input target]
-&gt; ShowS
show :: SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; String
$cshow :: forall input target.
(Show input, Show target) =&gt;
SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; String
showsPrec :: Int
-&gt; SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; ShowS
$cshowsPrec :: forall input target.
(Show input, Show target) =&gt;
Int
-&gt; SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; ShowS
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall input target x.
Rep
  (SimplifiedEncoderDecoderTransformerTrainingInput input target) x
-&gt; SimplifiedEncoderDecoderTransformerTrainingInput input target
forall input target x.
SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; Rep
     (SimplifiedEncoderDecoderTransformerTrainingInput input target) x
$cto :: forall input target x.
Rep
  (SimplifiedEncoderDecoderTransformerTrainingInput input target) x
-&gt; SimplifiedEncoderDecoderTransformerTrainingInput input target
$cfrom :: forall input target x.
SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; Rep
     (SimplifiedEncoderDecoderTransformerTrainingInput input target) x
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-438"></span><span>
</span><span id="line-439"></span><span class="hs-comment">-- | Output data type for use with an encoder-decoder transformer.</span><span>
</span><span id="line-440"></span><span id="local-6989586621679718799"><span id="local-6989586621679718800"></span></span><span class="hs-keyword">data</span><span> </span><span id="EncoderDecoderTransformerOutput"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerOutput"><span class="hs-identifier hs-var">EncoderDecoderTransformerOutput</span></a></span></span><span> </span><span id="local-6989586621679720701"><span class="annot"><a href="#local-6989586621679720701"><span class="hs-identifier hs-type">decoderOutput</span></a></span></span><span> </span><span id="local-6989586621679720700"><span class="annot"><a href="#local-6989586621679720700"><span class="hs-identifier hs-type">encoderOutput</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-441"></span><span>  </span><span id="EncoderDecoderTransformerOutput"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerOutput"><span class="hs-identifier hs-var">EncoderDecoderTransformerOutput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-442"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679720707"><span class="annot"><a href="#local-6989586621679720707"><span class="hs-identifier hs-type">decoderOutput</span></a></span></span><span> </span><span id="local-6989586621679720706"><span class="annot"><a href="#local-6989586621679720706"><span class="hs-identifier hs-type">encoderOutput</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-443"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="edtDecoderOutput"><span class="annot"><span class="annottext">forall decoderOutput encoderOutput.
EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; decoderOutput
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtDecoderOutput"><span class="hs-identifier hs-var hs-var">edtDecoderOutput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679720707"><span class="hs-identifier hs-type">decoderOutput</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-444"></span><span>      </span><span id="edtEncoderOutput"><span class="annot"><span class="annottext">forall decoderOutput encoderOutput.
EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; encoderOutput
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtEncoderOutput"><span class="hs-identifier hs-var hs-var">edtEncoderOutput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679720706"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span>
</span><span id="line-445"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-446"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerOutput"><span class="hs-identifier hs-type">EncoderDecoderTransformerOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720707"><span class="hs-identifier hs-type">decoderOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720706"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span>
</span><span id="line-447"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679718790"><span id="local-6989586621679718794"><span class="annot"><span class="annottext">EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall decoderOutput encoderOutput.
(Eq decoderOutput, Eq encoderOutput) =&gt;
EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; Bool
/= :: EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; Bool
$c/= :: forall decoderOutput encoderOutput.
(Eq decoderOutput, Eq encoderOutput) =&gt;
EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; Bool
== :: EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; Bool
$c== :: forall decoderOutput encoderOutput.
(Eq decoderOutput, Eq encoderOutput) =&gt;
EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; Bool
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679718767"><span id="local-6989586621679718769"><span id="local-6989586621679718772"><span id="local-6989586621679718775"><span id="local-6989586621679718778"><span id="local-6989586621679718782"><span id="local-6989586621679718786"><span class="annot"><span class="annottext">EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; Bool
EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; Ordering
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall {decoderOutput} {encoderOutput}.
(Ord decoderOutput, Ord encoderOutput) =&gt;
Eq (EncoderDecoderTransformerOutput decoderOutput encoderOutput)
forall decoderOutput encoderOutput.
(Ord decoderOutput, Ord encoderOutput) =&gt;
EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; Bool
forall decoderOutput encoderOutput.
(Ord decoderOutput, Ord encoderOutput) =&gt;
EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; Ordering
forall decoderOutput encoderOutput.
(Ord decoderOutput, Ord encoderOutput) =&gt;
EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; EncoderDecoderTransformerOutput decoderOutput encoderOutput
min :: EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; EncoderDecoderTransformerOutput decoderOutput encoderOutput
$cmin :: forall decoderOutput encoderOutput.
(Ord decoderOutput, Ord encoderOutput) =&gt;
EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; EncoderDecoderTransformerOutput decoderOutput encoderOutput
max :: EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; EncoderDecoderTransformerOutput decoderOutput encoderOutput
$cmax :: forall decoderOutput encoderOutput.
(Ord decoderOutput, Ord encoderOutput) =&gt;
EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; EncoderDecoderTransformerOutput decoderOutput encoderOutput
&gt;= :: EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; Bool
$c&gt;= :: forall decoderOutput encoderOutput.
(Ord decoderOutput, Ord encoderOutput) =&gt;
EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; Bool
&gt; :: EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; Bool
$c&gt; :: forall decoderOutput encoderOutput.
(Ord decoderOutput, Ord encoderOutput) =&gt;
EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; Bool
&lt;= :: EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; Bool
$c&lt;= :: forall decoderOutput encoderOutput.
(Ord decoderOutput, Ord encoderOutput) =&gt;
EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; Bool
&lt; :: EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; Bool
$c&lt; :: forall decoderOutput encoderOutput.
(Ord decoderOutput, Ord encoderOutput) =&gt;
EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; Bool
compare :: EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; Ordering
$ccompare :: forall decoderOutput encoderOutput.
(Ord decoderOutput, Ord encoderOutput) =&gt;
EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; Ordering
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679718758"><span id="local-6989586621679718760"><span id="local-6989586621679718765"><span class="annot"><span class="annottext">Int
-&gt; EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; ShowS
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall decoderOutput encoderOutput.
(Show decoderOutput, Show encoderOutput) =&gt;
Int
-&gt; EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; ShowS
forall decoderOutput encoderOutput.
(Show decoderOutput, Show encoderOutput) =&gt;
[EncoderDecoderTransformerOutput decoderOutput encoderOutput]
-&gt; ShowS
forall decoderOutput encoderOutput.
(Show decoderOutput, Show encoderOutput) =&gt;
EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; String
showList :: [EncoderDecoderTransformerOutput decoderOutput encoderOutput]
-&gt; ShowS
$cshowList :: forall decoderOutput encoderOutput.
(Show decoderOutput, Show encoderOutput) =&gt;
[EncoderDecoderTransformerOutput decoderOutput encoderOutput]
-&gt; ShowS
show :: EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; String
$cshow :: forall decoderOutput encoderOutput.
(Show decoderOutput, Show encoderOutput) =&gt;
EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; String
showsPrec :: Int
-&gt; EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; ShowS
$cshowsPrec :: forall decoderOutput encoderOutput.
(Show decoderOutput, Show encoderOutput) =&gt;
Int
-&gt; EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; ShowS
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall decoderOutput encoderOutput x.
Rep (EncoderDecoderTransformerOutput decoderOutput encoderOutput) x
-&gt; EncoderDecoderTransformerOutput decoderOutput encoderOutput
forall decoderOutput encoderOutput x.
EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; Rep
     (EncoderDecoderTransformerOutput decoderOutput encoderOutput) x
$cto :: forall decoderOutput encoderOutput x.
Rep (EncoderDecoderTransformerOutput decoderOutput encoderOutput) x
-&gt; EncoderDecoderTransformerOutput decoderOutput encoderOutput
$cfrom :: forall decoderOutput encoderOutput x.
EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; Rep
     (EncoderDecoderTransformerOutput decoderOutput encoderOutput) x
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-448"></span><span>
</span><span id="line-449"></span><span id="local-6989586621679718753"><span id="local-6989586621679718754"></span></span><span class="hs-keyword">data</span><span> </span><span id="EncoderDecoderTransformerOutput%27"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerOutput%27"><span class="hs-identifier hs-var">EncoderDecoderTransformerOutput'</span></a></span></span><span> </span><span id="local-6989586621679720696"><span class="annot"><a href="#local-6989586621679720696"><span class="hs-identifier hs-type">encoderOutput</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-450"></span><span>  </span><span id="EncoderDecoderTransformerOutput%27"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerOutput%27"><span class="hs-identifier hs-var">EncoderDecoderTransformerOutput'</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-451"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679720698"><span class="annot"><a href="#local-6989586621679720698"><span class="hs-identifier hs-type">encoderOutput</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-452"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="edtEncoderOutput%27"><span class="annot"><span class="annottext">forall encoderOutput.
EncoderDecoderTransformerOutput' encoderOutput -&gt; encoderOutput
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtEncoderOutput%27"><span class="hs-identifier hs-var hs-var">edtEncoderOutput'</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679720698"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span>
</span><span id="line-453"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-454"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerOutput%27"><span class="hs-identifier hs-type">EncoderDecoderTransformerOutput'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720698"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span>
</span><span id="line-455"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679718746"><span id="local-6989586621679718749"><span class="annot"><span class="annottext">EncoderDecoderTransformerOutput' encoderOutput
-&gt; EncoderDecoderTransformerOutput' encoderOutput -&gt; Bool
forall encoderOutput.
Eq encoderOutput =&gt;
EncoderDecoderTransformerOutput' encoderOutput
-&gt; EncoderDecoderTransformerOutput' encoderOutput -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: EncoderDecoderTransformerOutput' encoderOutput
-&gt; EncoderDecoderTransformerOutput' encoderOutput -&gt; Bool
$c/= :: forall encoderOutput.
Eq encoderOutput =&gt;
EncoderDecoderTransformerOutput' encoderOutput
-&gt; EncoderDecoderTransformerOutput' encoderOutput -&gt; Bool
== :: EncoderDecoderTransformerOutput' encoderOutput
-&gt; EncoderDecoderTransformerOutput' encoderOutput -&gt; Bool
$c== :: forall encoderOutput.
Eq encoderOutput =&gt;
EncoderDecoderTransformerOutput' encoderOutput
-&gt; EncoderDecoderTransformerOutput' encoderOutput -&gt; Bool
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679718725"><span id="local-6989586621679718727"><span id="local-6989586621679718730"><span id="local-6989586621679718733"><span id="local-6989586621679718736"><span id="local-6989586621679718739"><span id="local-6989586621679718742"><span class="annot"><span class="annottext">EncoderDecoderTransformerOutput' encoderOutput
-&gt; EncoderDecoderTransformerOutput' encoderOutput -&gt; Bool
EncoderDecoderTransformerOutput' encoderOutput
-&gt; EncoderDecoderTransformerOutput' encoderOutput -&gt; Ordering
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall {encoderOutput}.
Ord encoderOutput =&gt;
Eq (EncoderDecoderTransformerOutput' encoderOutput)
forall encoderOutput.
Ord encoderOutput =&gt;
EncoderDecoderTransformerOutput' encoderOutput
-&gt; EncoderDecoderTransformerOutput' encoderOutput -&gt; Bool
forall encoderOutput.
Ord encoderOutput =&gt;
EncoderDecoderTransformerOutput' encoderOutput
-&gt; EncoderDecoderTransformerOutput' encoderOutput -&gt; Ordering
forall encoderOutput.
Ord encoderOutput =&gt;
EncoderDecoderTransformerOutput' encoderOutput
-&gt; EncoderDecoderTransformerOutput' encoderOutput
-&gt; EncoderDecoderTransformerOutput' encoderOutput
min :: EncoderDecoderTransformerOutput' encoderOutput
-&gt; EncoderDecoderTransformerOutput' encoderOutput
-&gt; EncoderDecoderTransformerOutput' encoderOutput
$cmin :: forall encoderOutput.
Ord encoderOutput =&gt;
EncoderDecoderTransformerOutput' encoderOutput
-&gt; EncoderDecoderTransformerOutput' encoderOutput
-&gt; EncoderDecoderTransformerOutput' encoderOutput
max :: EncoderDecoderTransformerOutput' encoderOutput
-&gt; EncoderDecoderTransformerOutput' encoderOutput
-&gt; EncoderDecoderTransformerOutput' encoderOutput
$cmax :: forall encoderOutput.
Ord encoderOutput =&gt;
EncoderDecoderTransformerOutput' encoderOutput
-&gt; EncoderDecoderTransformerOutput' encoderOutput
-&gt; EncoderDecoderTransformerOutput' encoderOutput
&gt;= :: EncoderDecoderTransformerOutput' encoderOutput
-&gt; EncoderDecoderTransformerOutput' encoderOutput -&gt; Bool
$c&gt;= :: forall encoderOutput.
Ord encoderOutput =&gt;
EncoderDecoderTransformerOutput' encoderOutput
-&gt; EncoderDecoderTransformerOutput' encoderOutput -&gt; Bool
&gt; :: EncoderDecoderTransformerOutput' encoderOutput
-&gt; EncoderDecoderTransformerOutput' encoderOutput -&gt; Bool
$c&gt; :: forall encoderOutput.
Ord encoderOutput =&gt;
EncoderDecoderTransformerOutput' encoderOutput
-&gt; EncoderDecoderTransformerOutput' encoderOutput -&gt; Bool
&lt;= :: EncoderDecoderTransformerOutput' encoderOutput
-&gt; EncoderDecoderTransformerOutput' encoderOutput -&gt; Bool
$c&lt;= :: forall encoderOutput.
Ord encoderOutput =&gt;
EncoderDecoderTransformerOutput' encoderOutput
-&gt; EncoderDecoderTransformerOutput' encoderOutput -&gt; Bool
&lt; :: EncoderDecoderTransformerOutput' encoderOutput
-&gt; EncoderDecoderTransformerOutput' encoderOutput -&gt; Bool
$c&lt; :: forall encoderOutput.
Ord encoderOutput =&gt;
EncoderDecoderTransformerOutput' encoderOutput
-&gt; EncoderDecoderTransformerOutput' encoderOutput -&gt; Bool
compare :: EncoderDecoderTransformerOutput' encoderOutput
-&gt; EncoderDecoderTransformerOutput' encoderOutput -&gt; Ordering
$ccompare :: forall encoderOutput.
Ord encoderOutput =&gt;
EncoderDecoderTransformerOutput' encoderOutput
-&gt; EncoderDecoderTransformerOutput' encoderOutput -&gt; Ordering
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679718717"><span id="local-6989586621679718719"><span id="local-6989586621679718723"><span class="annot"><span class="annottext">Int -&gt; EncoderDecoderTransformerOutput' encoderOutput -&gt; ShowS
forall encoderOutput.
Show encoderOutput =&gt;
Int -&gt; EncoderDecoderTransformerOutput' encoderOutput -&gt; ShowS
forall encoderOutput.
Show encoderOutput =&gt;
[EncoderDecoderTransformerOutput' encoderOutput] -&gt; ShowS
forall encoderOutput.
Show encoderOutput =&gt;
EncoderDecoderTransformerOutput' encoderOutput -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [EncoderDecoderTransformerOutput' encoderOutput] -&gt; ShowS
$cshowList :: forall encoderOutput.
Show encoderOutput =&gt;
[EncoderDecoderTransformerOutput' encoderOutput] -&gt; ShowS
show :: EncoderDecoderTransformerOutput' encoderOutput -&gt; String
$cshow :: forall encoderOutput.
Show encoderOutput =&gt;
EncoderDecoderTransformerOutput' encoderOutput -&gt; String
showsPrec :: Int -&gt; EncoderDecoderTransformerOutput' encoderOutput -&gt; ShowS
$cshowsPrec :: forall encoderOutput.
Show encoderOutput =&gt;
Int -&gt; EncoderDecoderTransformerOutput' encoderOutput -&gt; ShowS
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall encoderOutput x.
Rep (EncoderDecoderTransformerOutput' encoderOutput) x
-&gt; EncoderDecoderTransformerOutput' encoderOutput
forall encoderOutput x.
EncoderDecoderTransformerOutput' encoderOutput
-&gt; Rep (EncoderDecoderTransformerOutput' encoderOutput) x
$cto :: forall encoderOutput x.
Rep (EncoderDecoderTransformerOutput' encoderOutput) x
-&gt; EncoderDecoderTransformerOutput' encoderOutput
$cfrom :: forall encoderOutput x.
EncoderDecoderTransformerOutput' encoderOutput
-&gt; Rep (EncoderDecoderTransformerOutput' encoderOutput) x
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-456"></span><span>
</span><span id="line-457"></span><span id="local-6989586621679718712"><span id="local-6989586621679718713"></span></span><span class="hs-keyword">data</span><span> </span><span id="SimplifiedEncoderDecoderTransformerOutput"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerOutput"><span class="hs-identifier hs-var">SimplifiedEncoderDecoderTransformerOutput</span></a></span></span><span> </span><span id="local-6989586621679720671"><span class="annot"><a href="#local-6989586621679720671"><span class="hs-identifier hs-type">decoderOutput</span></a></span></span><span> </span><span id="local-6989586621679720670"><span class="annot"><a href="#local-6989586621679720670"><span class="hs-identifier hs-type">encoderOutput</span></a></span></span><span> </span><span id="local-6989586621679720669"><span class="annot"><a href="#local-6989586621679720669"><span class="hs-identifier hs-type">decoderInput</span></a></span></span><span> </span><span id="local-6989586621679720668"><span class="annot"><a href="#local-6989586621679720668"><span class="hs-identifier hs-type">inputPaddingMask</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-458"></span><span>  </span><span id="SimplifiedEncoderDecoderTransformerOutput"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerOutput"><span class="hs-identifier hs-var">SimplifiedEncoderDecoderTransformerOutput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-459"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679720691"><span class="annot"><a href="#local-6989586621679720691"><span class="hs-identifier hs-type">decoderOutput</span></a></span></span><span> </span><span id="local-6989586621679720690"><span class="annot"><a href="#local-6989586621679720690"><span class="hs-identifier hs-type">encoderOutput</span></a></span></span><span> </span><span id="local-6989586621679720689"><span class="annot"><a href="#local-6989586621679720689"><span class="hs-identifier hs-type">decoderInput</span></a></span></span><span> </span><span id="local-6989586621679720688"><span class="annot"><a href="#local-6989586621679720688"><span class="hs-identifier hs-type">inputPaddingMask</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-460"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="sedtDecoderOutput"><span class="annot"><span class="annottext">forall decoderOutput encoderOutput decoderInput inputPaddingMask.
SimplifiedEncoderDecoderTransformerOutput
  decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; decoderOutput
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtDecoderOutput"><span class="hs-identifier hs-var hs-var">sedtDecoderOutput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679720691"><span class="hs-identifier hs-type">decoderOutput</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-461"></span><span>      </span><span id="sedtEncoderOutput"><span class="annot"><span class="annottext">forall decoderOutput encoderOutput decoderInput inputPaddingMask.
SimplifiedEncoderDecoderTransformerOutput
  decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; encoderOutput
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtEncoderOutput"><span class="hs-identifier hs-var hs-var">sedtEncoderOutput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679720690"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-462"></span><span>      </span><span id="sedtOriginalDecoderInput"><span class="annot"><span class="annottext">forall decoderOutput encoderOutput decoderInput inputPaddingMask.
SimplifiedEncoderDecoderTransformerOutput
  decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; decoderInput
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtOriginalDecoderInput"><span class="hs-identifier hs-var hs-var">sedtOriginalDecoderInput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679720689"><span class="hs-identifier hs-type">decoderInput</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-463"></span><span>      </span><span id="sedtInputPaddingMask"><span class="annot"><span class="annottext">forall decoderOutput encoderOutput decoderInput inputPaddingMask.
SimplifiedEncoderDecoderTransformerOutput
  decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; inputPaddingMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtInputPaddingMask"><span class="hs-identifier hs-var hs-var">sedtInputPaddingMask</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679720688"><span class="hs-identifier hs-type">inputPaddingMask</span></a></span><span>
</span><span id="line-464"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-465"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerOutput"><span class="hs-identifier hs-type">SimplifiedEncoderDecoderTransformerOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720691"><span class="hs-identifier hs-type">decoderOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720690"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720689"><span class="hs-identifier hs-type">decoderInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720688"><span class="hs-identifier hs-type">inputPaddingMask</span></a></span><span>
</span><span id="line-466"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679718699"><span id="local-6989586621679718705"><span class="annot"><span class="annottext">SimplifiedEncoderDecoderTransformerOutput
  decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput
     decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall decoderOutput encoderOutput decoderInput inputPaddingMask.
(Eq decoderOutput, Eq encoderOutput, Eq decoderInput,
 Eq inputPaddingMask) =&gt;
SimplifiedEncoderDecoderTransformerOutput
  decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput
     decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; Bool
/= :: SimplifiedEncoderDecoderTransformerOutput
  decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput
     decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; Bool
$c/= :: forall decoderOutput encoderOutput decoderInput inputPaddingMask.
(Eq decoderOutput, Eq encoderOutput, Eq decoderInput,
 Eq inputPaddingMask) =&gt;
SimplifiedEncoderDecoderTransformerOutput
  decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput
     decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; Bool
== :: SimplifiedEncoderDecoderTransformerOutput
  decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput
     decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; Bool
$c== :: forall decoderOutput encoderOutput decoderInput inputPaddingMask.
(Eq decoderOutput, Eq encoderOutput, Eq decoderInput,
 Eq inputPaddingMask) =&gt;
SimplifiedEncoderDecoderTransformerOutput
  decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput
     decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; Bool
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679718672"><span id="local-6989586621679718674"><span id="local-6989586621679718677"><span id="local-6989586621679718680"><span id="local-6989586621679718683"><span id="local-6989586621679718689"><span id="local-6989586621679718695"><span class="annot"><span class="annottext">SimplifiedEncoderDecoderTransformerOutput
  decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput
     decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; Bool
SimplifiedEncoderDecoderTransformerOutput
  decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput
     decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; Ordering
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall {decoderOutput} {encoderOutput} {decoderInput}
       {inputPaddingMask}.
(Ord decoderOutput, Ord encoderOutput, Ord decoderInput,
 Ord inputPaddingMask) =&gt;
Eq
  (SimplifiedEncoderDecoderTransformerOutput
     decoderOutput encoderOutput decoderInput inputPaddingMask)
forall decoderOutput encoderOutput decoderInput inputPaddingMask.
(Ord decoderOutput, Ord encoderOutput, Ord decoderInput,
 Ord inputPaddingMask) =&gt;
SimplifiedEncoderDecoderTransformerOutput
  decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput
     decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; Bool
forall decoderOutput encoderOutput decoderInput inputPaddingMask.
(Ord decoderOutput, Ord encoderOutput, Ord decoderInput,
 Ord inputPaddingMask) =&gt;
SimplifiedEncoderDecoderTransformerOutput
  decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput
     decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; Ordering
forall decoderOutput encoderOutput decoderInput inputPaddingMask.
(Ord decoderOutput, Ord encoderOutput, Ord decoderInput,
 Ord inputPaddingMask) =&gt;
SimplifiedEncoderDecoderTransformerOutput
  decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput
     decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput
     decoderOutput encoderOutput decoderInput inputPaddingMask
min :: SimplifiedEncoderDecoderTransformerOutput
  decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput
     decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput
     decoderOutput encoderOutput decoderInput inputPaddingMask
$cmin :: forall decoderOutput encoderOutput decoderInput inputPaddingMask.
(Ord decoderOutput, Ord encoderOutput, Ord decoderInput,
 Ord inputPaddingMask) =&gt;
SimplifiedEncoderDecoderTransformerOutput
  decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput
     decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput
     decoderOutput encoderOutput decoderInput inputPaddingMask
max :: SimplifiedEncoderDecoderTransformerOutput
  decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput
     decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput
     decoderOutput encoderOutput decoderInput inputPaddingMask
$cmax :: forall decoderOutput encoderOutput decoderInput inputPaddingMask.
(Ord decoderOutput, Ord encoderOutput, Ord decoderInput,
 Ord inputPaddingMask) =&gt;
SimplifiedEncoderDecoderTransformerOutput
  decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput
     decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput
     decoderOutput encoderOutput decoderInput inputPaddingMask
&gt;= :: SimplifiedEncoderDecoderTransformerOutput
  decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput
     decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; Bool
$c&gt;= :: forall decoderOutput encoderOutput decoderInput inputPaddingMask.
(Ord decoderOutput, Ord encoderOutput, Ord decoderInput,
 Ord inputPaddingMask) =&gt;
SimplifiedEncoderDecoderTransformerOutput
  decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput
     decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; Bool
&gt; :: SimplifiedEncoderDecoderTransformerOutput
  decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput
     decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; Bool
$c&gt; :: forall decoderOutput encoderOutput decoderInput inputPaddingMask.
(Ord decoderOutput, Ord encoderOutput, Ord decoderInput,
 Ord inputPaddingMask) =&gt;
SimplifiedEncoderDecoderTransformerOutput
  decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput
     decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; Bool
&lt;= :: SimplifiedEncoderDecoderTransformerOutput
  decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput
     decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; Bool
$c&lt;= :: forall decoderOutput encoderOutput decoderInput inputPaddingMask.
(Ord decoderOutput, Ord encoderOutput, Ord decoderInput,
 Ord inputPaddingMask) =&gt;
SimplifiedEncoderDecoderTransformerOutput
  decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput
     decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; Bool
&lt; :: SimplifiedEncoderDecoderTransformerOutput
  decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput
     decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; Bool
$c&lt; :: forall decoderOutput encoderOutput decoderInput inputPaddingMask.
(Ord decoderOutput, Ord encoderOutput, Ord decoderInput,
 Ord inputPaddingMask) =&gt;
SimplifiedEncoderDecoderTransformerOutput
  decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput
     decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; Bool
compare :: SimplifiedEncoderDecoderTransformerOutput
  decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput
     decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; Ordering
$ccompare :: forall decoderOutput encoderOutput decoderInput inputPaddingMask.
(Ord decoderOutput, Ord encoderOutput, Ord decoderInput,
 Ord inputPaddingMask) =&gt;
SimplifiedEncoderDecoderTransformerOutput
  decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput
     decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; Ordering
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679718661"><span id="local-6989586621679718663"><span id="local-6989586621679718670"><span class="annot"><span class="annottext">Int
-&gt; SimplifiedEncoderDecoderTransformerOutput
     decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; ShowS
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall decoderOutput encoderOutput decoderInput inputPaddingMask.
(Show decoderOutput, Show encoderOutput, Show decoderInput,
 Show inputPaddingMask) =&gt;
Int
-&gt; SimplifiedEncoderDecoderTransformerOutput
     decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; ShowS
forall decoderOutput encoderOutput decoderInput inputPaddingMask.
(Show decoderOutput, Show encoderOutput, Show decoderInput,
 Show inputPaddingMask) =&gt;
[SimplifiedEncoderDecoderTransformerOutput
   decoderOutput encoderOutput decoderInput inputPaddingMask]
-&gt; ShowS
forall decoderOutput encoderOutput decoderInput inputPaddingMask.
(Show decoderOutput, Show encoderOutput, Show decoderInput,
 Show inputPaddingMask) =&gt;
SimplifiedEncoderDecoderTransformerOutput
  decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; String
showList :: [SimplifiedEncoderDecoderTransformerOutput
   decoderOutput encoderOutput decoderInput inputPaddingMask]
-&gt; ShowS
$cshowList :: forall decoderOutput encoderOutput decoderInput inputPaddingMask.
(Show decoderOutput, Show encoderOutput, Show decoderInput,
 Show inputPaddingMask) =&gt;
[SimplifiedEncoderDecoderTransformerOutput
   decoderOutput encoderOutput decoderInput inputPaddingMask]
-&gt; ShowS
show :: SimplifiedEncoderDecoderTransformerOutput
  decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; String
$cshow :: forall decoderOutput encoderOutput decoderInput inputPaddingMask.
(Show decoderOutput, Show encoderOutput, Show decoderInput,
 Show inputPaddingMask) =&gt;
SimplifiedEncoderDecoderTransformerOutput
  decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; String
showsPrec :: Int
-&gt; SimplifiedEncoderDecoderTransformerOutput
     decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; ShowS
$cshowsPrec :: forall decoderOutput encoderOutput decoderInput inputPaddingMask.
(Show decoderOutput, Show encoderOutput, Show decoderInput,
 Show inputPaddingMask) =&gt;
Int
-&gt; SimplifiedEncoderDecoderTransformerOutput
     decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; ShowS
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall decoderOutput encoderOutput decoderInput inputPaddingMask x.
Rep
  (SimplifiedEncoderDecoderTransformerOutput
     decoderOutput encoderOutput decoderInput inputPaddingMask)
  x
-&gt; SimplifiedEncoderDecoderTransformerOutput
     decoderOutput encoderOutput decoderInput inputPaddingMask
forall decoderOutput encoderOutput decoderInput inputPaddingMask x.
SimplifiedEncoderDecoderTransformerOutput
  decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; Rep
     (SimplifiedEncoderDecoderTransformerOutput
        decoderOutput encoderOutput decoderInput inputPaddingMask)
     x
$cto :: forall decoderOutput encoderOutput decoderInput inputPaddingMask x.
Rep
  (SimplifiedEncoderDecoderTransformerOutput
     decoderOutput encoderOutput decoderInput inputPaddingMask)
  x
-&gt; SimplifiedEncoderDecoderTransformerOutput
     decoderOutput encoderOutput decoderInput inputPaddingMask
$cfrom :: forall decoderOutput encoderOutput decoderInput inputPaddingMask x.
SimplifiedEncoderDecoderTransformerOutput
  decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; Rep
     (SimplifiedEncoderDecoderTransformerOutput
        decoderOutput encoderOutput decoderInput inputPaddingMask)
     x
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-467"></span><span>
</span><span id="line-468"></span><span id="local-6989586621679718656"><span id="local-6989586621679718657"></span></span><span class="hs-keyword">data</span><span> </span><span id="SimplifiedEncoderDecoderTransformerOutput%27"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerOutput%27"><span class="hs-identifier hs-var">SimplifiedEncoderDecoderTransformerOutput'</span></a></span></span><span> </span><span id="local-6989586621679720659"><span class="annot"><a href="#local-6989586621679720659"><span class="hs-identifier hs-type">encoderOutput</span></a></span></span><span> </span><span id="local-6989586621679720658"><span class="annot"><a href="#local-6989586621679720658"><span class="hs-identifier hs-type">inputPaddingMask</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-469"></span><span>  </span><span id="SimplifiedEncoderDecoderTransformerOutput%27"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerOutput%27"><span class="hs-identifier hs-var">SimplifiedEncoderDecoderTransformerOutput'</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-470"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679720665"><span class="annot"><a href="#local-6989586621679720665"><span class="hs-identifier hs-type">encoderOutput</span></a></span></span><span> </span><span id="local-6989586621679720664"><span class="annot"><a href="#local-6989586621679720664"><span class="hs-identifier hs-type">inputPaddingMask</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-471"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="sedtEncoderOutput%27"><span class="annot"><span class="annottext">forall encoderOutput inputPaddingMask.
SimplifiedEncoderDecoderTransformerOutput'
  encoderOutput inputPaddingMask
-&gt; encoderOutput
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtEncoderOutput%27"><span class="hs-identifier hs-var hs-var">sedtEncoderOutput'</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679720665"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-472"></span><span>      </span><span id="sedtInputPaddingMask%27"><span class="annot"><span class="annottext">forall encoderOutput inputPaddingMask.
SimplifiedEncoderDecoderTransformerOutput'
  encoderOutput inputPaddingMask
-&gt; inputPaddingMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtInputPaddingMask%27"><span class="hs-identifier hs-var hs-var">sedtInputPaddingMask'</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679720664"><span class="hs-identifier hs-type">inputPaddingMask</span></a></span><span>
</span><span id="line-473"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-474"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerOutput%27"><span class="hs-identifier hs-type">SimplifiedEncoderDecoderTransformerOutput'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720665"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720664"><span class="hs-identifier hs-type">inputPaddingMask</span></a></span><span>
</span><span id="line-475"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679718647"><span id="local-6989586621679718651"><span class="annot"><span class="annottext">SimplifiedEncoderDecoderTransformerOutput'
  encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput'
     encoderOutput inputPaddingMask
-&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall encoderOutput inputPaddingMask.
(Eq encoderOutput, Eq inputPaddingMask) =&gt;
SimplifiedEncoderDecoderTransformerOutput'
  encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput'
     encoderOutput inputPaddingMask
-&gt; Bool
/= :: SimplifiedEncoderDecoderTransformerOutput'
  encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput'
     encoderOutput inputPaddingMask
-&gt; Bool
$c/= :: forall encoderOutput inputPaddingMask.
(Eq encoderOutput, Eq inputPaddingMask) =&gt;
SimplifiedEncoderDecoderTransformerOutput'
  encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput'
     encoderOutput inputPaddingMask
-&gt; Bool
== :: SimplifiedEncoderDecoderTransformerOutput'
  encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput'
     encoderOutput inputPaddingMask
-&gt; Bool
$c== :: forall encoderOutput inputPaddingMask.
(Eq encoderOutput, Eq inputPaddingMask) =&gt;
SimplifiedEncoderDecoderTransformerOutput'
  encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput'
     encoderOutput inputPaddingMask
-&gt; Bool
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679718624"><span id="local-6989586621679718626"><span id="local-6989586621679718629"><span id="local-6989586621679718632"><span id="local-6989586621679718635"><span id="local-6989586621679718639"><span id="local-6989586621679718643"><span class="annot"><span class="annottext">SimplifiedEncoderDecoderTransformerOutput'
  encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput'
     encoderOutput inputPaddingMask
-&gt; Bool
SimplifiedEncoderDecoderTransformerOutput'
  encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput'
     encoderOutput inputPaddingMask
-&gt; Ordering
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall {encoderOutput} {inputPaddingMask}.
(Ord encoderOutput, Ord inputPaddingMask) =&gt;
Eq
  (SimplifiedEncoderDecoderTransformerOutput'
     encoderOutput inputPaddingMask)
forall encoderOutput inputPaddingMask.
(Ord encoderOutput, Ord inputPaddingMask) =&gt;
SimplifiedEncoderDecoderTransformerOutput'
  encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput'
     encoderOutput inputPaddingMask
-&gt; Bool
forall encoderOutput inputPaddingMask.
(Ord encoderOutput, Ord inputPaddingMask) =&gt;
SimplifiedEncoderDecoderTransformerOutput'
  encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput'
     encoderOutput inputPaddingMask
-&gt; Ordering
forall encoderOutput inputPaddingMask.
(Ord encoderOutput, Ord inputPaddingMask) =&gt;
SimplifiedEncoderDecoderTransformerOutput'
  encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput'
     encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput'
     encoderOutput inputPaddingMask
min :: SimplifiedEncoderDecoderTransformerOutput'
  encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput'
     encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput'
     encoderOutput inputPaddingMask
$cmin :: forall encoderOutput inputPaddingMask.
(Ord encoderOutput, Ord inputPaddingMask) =&gt;
SimplifiedEncoderDecoderTransformerOutput'
  encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput'
     encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput'
     encoderOutput inputPaddingMask
max :: SimplifiedEncoderDecoderTransformerOutput'
  encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput'
     encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput'
     encoderOutput inputPaddingMask
$cmax :: forall encoderOutput inputPaddingMask.
(Ord encoderOutput, Ord inputPaddingMask) =&gt;
SimplifiedEncoderDecoderTransformerOutput'
  encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput'
     encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput'
     encoderOutput inputPaddingMask
&gt;= :: SimplifiedEncoderDecoderTransformerOutput'
  encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput'
     encoderOutput inputPaddingMask
-&gt; Bool
$c&gt;= :: forall encoderOutput inputPaddingMask.
(Ord encoderOutput, Ord inputPaddingMask) =&gt;
SimplifiedEncoderDecoderTransformerOutput'
  encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput'
     encoderOutput inputPaddingMask
-&gt; Bool
&gt; :: SimplifiedEncoderDecoderTransformerOutput'
  encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput'
     encoderOutput inputPaddingMask
-&gt; Bool
$c&gt; :: forall encoderOutput inputPaddingMask.
(Ord encoderOutput, Ord inputPaddingMask) =&gt;
SimplifiedEncoderDecoderTransformerOutput'
  encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput'
     encoderOutput inputPaddingMask
-&gt; Bool
&lt;= :: SimplifiedEncoderDecoderTransformerOutput'
  encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput'
     encoderOutput inputPaddingMask
-&gt; Bool
$c&lt;= :: forall encoderOutput inputPaddingMask.
(Ord encoderOutput, Ord inputPaddingMask) =&gt;
SimplifiedEncoderDecoderTransformerOutput'
  encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput'
     encoderOutput inputPaddingMask
-&gt; Bool
&lt; :: SimplifiedEncoderDecoderTransformerOutput'
  encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput'
     encoderOutput inputPaddingMask
-&gt; Bool
$c&lt; :: forall encoderOutput inputPaddingMask.
(Ord encoderOutput, Ord inputPaddingMask) =&gt;
SimplifiedEncoderDecoderTransformerOutput'
  encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput'
     encoderOutput inputPaddingMask
-&gt; Bool
compare :: SimplifiedEncoderDecoderTransformerOutput'
  encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput'
     encoderOutput inputPaddingMask
-&gt; Ordering
$ccompare :: forall encoderOutput inputPaddingMask.
(Ord encoderOutput, Ord inputPaddingMask) =&gt;
SimplifiedEncoderDecoderTransformerOutput'
  encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput'
     encoderOutput inputPaddingMask
-&gt; Ordering
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679718615"><span id="local-6989586621679718617"><span id="local-6989586621679718622"><span class="annot"><span class="annottext">Int
-&gt; SimplifiedEncoderDecoderTransformerOutput'
     encoderOutput inputPaddingMask
-&gt; ShowS
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall encoderOutput inputPaddingMask.
(Show encoderOutput, Show inputPaddingMask) =&gt;
Int
-&gt; SimplifiedEncoderDecoderTransformerOutput'
     encoderOutput inputPaddingMask
-&gt; ShowS
forall encoderOutput inputPaddingMask.
(Show encoderOutput, Show inputPaddingMask) =&gt;
[SimplifiedEncoderDecoderTransformerOutput'
   encoderOutput inputPaddingMask]
-&gt; ShowS
forall encoderOutput inputPaddingMask.
(Show encoderOutput, Show inputPaddingMask) =&gt;
SimplifiedEncoderDecoderTransformerOutput'
  encoderOutput inputPaddingMask
-&gt; String
showList :: [SimplifiedEncoderDecoderTransformerOutput'
   encoderOutput inputPaddingMask]
-&gt; ShowS
$cshowList :: forall encoderOutput inputPaddingMask.
(Show encoderOutput, Show inputPaddingMask) =&gt;
[SimplifiedEncoderDecoderTransformerOutput'
   encoderOutput inputPaddingMask]
-&gt; ShowS
show :: SimplifiedEncoderDecoderTransformerOutput'
  encoderOutput inputPaddingMask
-&gt; String
$cshow :: forall encoderOutput inputPaddingMask.
(Show encoderOutput, Show inputPaddingMask) =&gt;
SimplifiedEncoderDecoderTransformerOutput'
  encoderOutput inputPaddingMask
-&gt; String
showsPrec :: Int
-&gt; SimplifiedEncoderDecoderTransformerOutput'
     encoderOutput inputPaddingMask
-&gt; ShowS
$cshowsPrec :: forall encoderOutput inputPaddingMask.
(Show encoderOutput, Show inputPaddingMask) =&gt;
Int
-&gt; SimplifiedEncoderDecoderTransformerOutput'
     encoderOutput inputPaddingMask
-&gt; ShowS
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall encoderOutput inputPaddingMask x.
Rep
  (SimplifiedEncoderDecoderTransformerOutput'
     encoderOutput inputPaddingMask)
  x
-&gt; SimplifiedEncoderDecoderTransformerOutput'
     encoderOutput inputPaddingMask
forall encoderOutput inputPaddingMask x.
SimplifiedEncoderDecoderTransformerOutput'
  encoderOutput inputPaddingMask
-&gt; Rep
     (SimplifiedEncoderDecoderTransformerOutput'
        encoderOutput inputPaddingMask)
     x
$cto :: forall encoderOutput inputPaddingMask x.
Rep
  (SimplifiedEncoderDecoderTransformerOutput'
     encoderOutput inputPaddingMask)
  x
-&gt; SimplifiedEncoderDecoderTransformerOutput'
     encoderOutput inputPaddingMask
$cfrom :: forall encoderOutput inputPaddingMask x.
SimplifiedEncoderDecoderTransformerOutput'
  encoderOutput inputPaddingMask
-&gt; Rep
     (SimplifiedEncoderDecoderTransformerOutput'
        encoderOutput inputPaddingMask)
     x
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-476"></span><span>
</span><span id="line-477"></span><span id="local-6989586621679718610"><span id="local-6989586621679718611"></span></span><span class="hs-keyword">data</span><span> </span><span id="SimplifiedEncoderDecoderTransformerTrainingOutput"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerTrainingOutput"><span class="hs-identifier hs-var">SimplifiedEncoderDecoderTransformerTrainingOutput</span></a></span></span><span> </span><span id="local-6989586621679720654"><span class="annot"><a href="#local-6989586621679720654"><span class="hs-identifier hs-type">loss</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-478"></span><span>  </span><span id="SimplifiedEncoderDecoderTransformerTrainingOutput"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerTrainingOutput"><span class="hs-identifier hs-var">SimplifiedEncoderDecoderTransformerTrainingOutput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-479"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679720656"><span class="annot"><a href="#local-6989586621679720656"><span class="hs-identifier hs-type">loss</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-480"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="sedtLoss"><span class="annot"><span class="annottext">forall loss.
SimplifiedEncoderDecoderTransformerTrainingOutput loss -&gt; loss
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtLoss"><span class="hs-identifier hs-var hs-var">sedtLoss</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679720656"><span class="hs-identifier hs-type">loss</span></a></span><span>
</span><span id="line-481"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-482"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerTrainingOutput"><span class="hs-identifier hs-type">SimplifiedEncoderDecoderTransformerTrainingOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720656"><span class="hs-identifier hs-type">loss</span></a></span><span>
</span><span id="line-483"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679718603"><span id="local-6989586621679718606"><span class="annot"><span class="annottext">SimplifiedEncoderDecoderTransformerTrainingOutput loss
-&gt; SimplifiedEncoderDecoderTransformerTrainingOutput loss -&gt; Bool
forall loss.
Eq loss =&gt;
SimplifiedEncoderDecoderTransformerTrainingOutput loss
-&gt; SimplifiedEncoderDecoderTransformerTrainingOutput loss -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: SimplifiedEncoderDecoderTransformerTrainingOutput loss
-&gt; SimplifiedEncoderDecoderTransformerTrainingOutput loss -&gt; Bool
$c/= :: forall loss.
Eq loss =&gt;
SimplifiedEncoderDecoderTransformerTrainingOutput loss
-&gt; SimplifiedEncoderDecoderTransformerTrainingOutput loss -&gt; Bool
== :: SimplifiedEncoderDecoderTransformerTrainingOutput loss
-&gt; SimplifiedEncoderDecoderTransformerTrainingOutput loss -&gt; Bool
$c== :: forall loss.
Eq loss =&gt;
SimplifiedEncoderDecoderTransformerTrainingOutput loss
-&gt; SimplifiedEncoderDecoderTransformerTrainingOutput loss -&gt; Bool
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679718582"><span id="local-6989586621679718584"><span id="local-6989586621679718587"><span id="local-6989586621679718590"><span id="local-6989586621679718593"><span id="local-6989586621679718596"><span id="local-6989586621679718599"><span class="annot"><span class="annottext">SimplifiedEncoderDecoderTransformerTrainingOutput loss
-&gt; SimplifiedEncoderDecoderTransformerTrainingOutput loss -&gt; Bool
SimplifiedEncoderDecoderTransformerTrainingOutput loss
-&gt; SimplifiedEncoderDecoderTransformerTrainingOutput loss
-&gt; Ordering
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall {loss}.
Ord loss =&gt;
Eq (SimplifiedEncoderDecoderTransformerTrainingOutput loss)
forall loss.
Ord loss =&gt;
SimplifiedEncoderDecoderTransformerTrainingOutput loss
-&gt; SimplifiedEncoderDecoderTransformerTrainingOutput loss -&gt; Bool
forall loss.
Ord loss =&gt;
SimplifiedEncoderDecoderTransformerTrainingOutput loss
-&gt; SimplifiedEncoderDecoderTransformerTrainingOutput loss
-&gt; Ordering
forall loss.
Ord loss =&gt;
SimplifiedEncoderDecoderTransformerTrainingOutput loss
-&gt; SimplifiedEncoderDecoderTransformerTrainingOutput loss
-&gt; SimplifiedEncoderDecoderTransformerTrainingOutput loss
min :: SimplifiedEncoderDecoderTransformerTrainingOutput loss
-&gt; SimplifiedEncoderDecoderTransformerTrainingOutput loss
-&gt; SimplifiedEncoderDecoderTransformerTrainingOutput loss
$cmin :: forall loss.
Ord loss =&gt;
SimplifiedEncoderDecoderTransformerTrainingOutput loss
-&gt; SimplifiedEncoderDecoderTransformerTrainingOutput loss
-&gt; SimplifiedEncoderDecoderTransformerTrainingOutput loss
max :: SimplifiedEncoderDecoderTransformerTrainingOutput loss
-&gt; SimplifiedEncoderDecoderTransformerTrainingOutput loss
-&gt; SimplifiedEncoderDecoderTransformerTrainingOutput loss
$cmax :: forall loss.
Ord loss =&gt;
SimplifiedEncoderDecoderTransformerTrainingOutput loss
-&gt; SimplifiedEncoderDecoderTransformerTrainingOutput loss
-&gt; SimplifiedEncoderDecoderTransformerTrainingOutput loss
&gt;= :: SimplifiedEncoderDecoderTransformerTrainingOutput loss
-&gt; SimplifiedEncoderDecoderTransformerTrainingOutput loss -&gt; Bool
$c&gt;= :: forall loss.
Ord loss =&gt;
SimplifiedEncoderDecoderTransformerTrainingOutput loss
-&gt; SimplifiedEncoderDecoderTransformerTrainingOutput loss -&gt; Bool
&gt; :: SimplifiedEncoderDecoderTransformerTrainingOutput loss
-&gt; SimplifiedEncoderDecoderTransformerTrainingOutput loss -&gt; Bool
$c&gt; :: forall loss.
Ord loss =&gt;
SimplifiedEncoderDecoderTransformerTrainingOutput loss
-&gt; SimplifiedEncoderDecoderTransformerTrainingOutput loss -&gt; Bool
&lt;= :: SimplifiedEncoderDecoderTransformerTrainingOutput loss
-&gt; SimplifiedEncoderDecoderTransformerTrainingOutput loss -&gt; Bool
$c&lt;= :: forall loss.
Ord loss =&gt;
SimplifiedEncoderDecoderTransformerTrainingOutput loss
-&gt; SimplifiedEncoderDecoderTransformerTrainingOutput loss -&gt; Bool
&lt; :: SimplifiedEncoderDecoderTransformerTrainingOutput loss
-&gt; SimplifiedEncoderDecoderTransformerTrainingOutput loss -&gt; Bool
$c&lt; :: forall loss.
Ord loss =&gt;
SimplifiedEncoderDecoderTransformerTrainingOutput loss
-&gt; SimplifiedEncoderDecoderTransformerTrainingOutput loss -&gt; Bool
compare :: SimplifiedEncoderDecoderTransformerTrainingOutput loss
-&gt; SimplifiedEncoderDecoderTransformerTrainingOutput loss
-&gt; Ordering
$ccompare :: forall loss.
Ord loss =&gt;
SimplifiedEncoderDecoderTransformerTrainingOutput loss
-&gt; SimplifiedEncoderDecoderTransformerTrainingOutput loss
-&gt; Ordering
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679718574"><span id="local-6989586621679718576"><span id="local-6989586621679718580"><span class="annot"><span class="annottext">Int
-&gt; SimplifiedEncoderDecoderTransformerTrainingOutput loss -&gt; ShowS
forall loss.
Show loss =&gt;
Int
-&gt; SimplifiedEncoderDecoderTransformerTrainingOutput loss -&gt; ShowS
forall loss.
Show loss =&gt;
[SimplifiedEncoderDecoderTransformerTrainingOutput loss] -&gt; ShowS
forall loss.
Show loss =&gt;
SimplifiedEncoderDecoderTransformerTrainingOutput loss -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [SimplifiedEncoderDecoderTransformerTrainingOutput loss] -&gt; ShowS
$cshowList :: forall loss.
Show loss =&gt;
[SimplifiedEncoderDecoderTransformerTrainingOutput loss] -&gt; ShowS
show :: SimplifiedEncoderDecoderTransformerTrainingOutput loss -&gt; String
$cshow :: forall loss.
Show loss =&gt;
SimplifiedEncoderDecoderTransformerTrainingOutput loss -&gt; String
showsPrec :: Int
-&gt; SimplifiedEncoderDecoderTransformerTrainingOutput loss -&gt; ShowS
$cshowsPrec :: forall loss.
Show loss =&gt;
Int
-&gt; SimplifiedEncoderDecoderTransformerTrainingOutput loss -&gt; ShowS
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall loss x.
Rep (SimplifiedEncoderDecoderTransformerTrainingOutput loss) x
-&gt; SimplifiedEncoderDecoderTransformerTrainingOutput loss
forall loss x.
SimplifiedEncoderDecoderTransformerTrainingOutput loss
-&gt; Rep (SimplifiedEncoderDecoderTransformerTrainingOutput loss) x
$cto :: forall loss x.
Rep (SimplifiedEncoderDecoderTransformerTrainingOutput loss) x
-&gt; SimplifiedEncoderDecoderTransformerTrainingOutput loss
$cfrom :: forall loss x.
SimplifiedEncoderDecoderTransformerTrainingOutput loss
-&gt; Rep (SimplifiedEncoderDecoderTransformerTrainingOutput loss) x
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-484"></span><span>
</span><span id="line-485"></span><span class="hs-comment">-- | Input data type for use with an encoder-decoder transformer.</span><span>
</span><span id="line-486"></span><span class="hs-comment">-- Use this for inference.</span><span>
</span><span id="line-487"></span><span id="local-6989586621679718569"><span id="local-6989586621679718570"></span></span><span class="hs-keyword">data</span><span> </span><span id="EncoderDecoderTransformerGenerationInput"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerGenerationInput"><span class="hs-identifier hs-var">EncoderDecoderTransformerGenerationInput</span></a></span></span><span> </span><span id="local-6989586621679720618"><span class="annot"><a href="#local-6989586621679720618"><span class="hs-identifier hs-type">decoderInput</span></a></span></span><span> </span><span id="local-6989586621679720617"><span class="annot"><a href="#local-6989586621679720617"><span class="hs-identifier hs-type">encoderOutput</span></a></span></span><span> </span><span id="local-6989586621679720616"><span class="annot"><a href="#local-6989586621679720616"><span class="hs-identifier hs-type">decoderPos</span></a></span></span><span> </span><span id="local-6989586621679720615"><span class="annot"><a href="#local-6989586621679720615"><span class="hs-identifier hs-type">decoderAttentionMask</span></a></span></span><span> </span><span id="local-6989586621679720614"><span class="annot"><a href="#local-6989586621679720614"><span class="hs-identifier hs-type">crossAttentionMask</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-488"></span><span>  </span><span id="EncoderDecoderTransformerGenerationInput"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerGenerationInput"><span class="hs-identifier hs-var">EncoderDecoderTransformerGenerationInput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-489"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679720648"><span class="annot"><a href="#local-6989586621679720648"><span class="hs-identifier hs-type">decoderInput</span></a></span></span><span> </span><span id="local-6989586621679720647"><span class="annot"><a href="#local-6989586621679720647"><span class="hs-identifier hs-type">encoderOutput</span></a></span></span><span> </span><span id="local-6989586621679720646"><span class="annot"><a href="#local-6989586621679720646"><span class="hs-identifier hs-type">decoderPos</span></a></span></span><span> </span><span id="local-6989586621679720645"><span class="annot"><a href="#local-6989586621679720645"><span class="hs-identifier hs-type">decoderAttentionMask</span></a></span></span><span> </span><span id="local-6989586621679720644"><span class="annot"><a href="#local-6989586621679720644"><span class="hs-identifier hs-type">crossAttentionMask</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-490"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="edtGenerationDecoderInput"><span class="annot"><span class="annottext">forall decoderInput encoderOutput decoderPos decoderAttentionMask
       crossAttentionMask.
EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; decoderInput
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtGenerationDecoderInput"><span class="hs-identifier hs-var hs-var">edtGenerationDecoderInput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679720648"><span class="hs-identifier hs-type">decoderInput</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-491"></span><span>      </span><span id="edtGenerationEncoderOutput"><span class="annot"><span class="annottext">forall decoderInput encoderOutput decoderPos decoderAttentionMask
       crossAttentionMask.
EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; encoderOutput
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtGenerationEncoderOutput"><span class="hs-identifier hs-var hs-var">edtGenerationEncoderOutput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679720647"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-492"></span><span>      </span><span id="edtGenerationDecoderPos"><span class="annot"><span class="annottext">forall decoderInput encoderOutput decoderPos decoderAttentionMask
       crossAttentionMask.
EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; decoderPos
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtGenerationDecoderPos"><span class="hs-identifier hs-var hs-var">edtGenerationDecoderPos</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679720646"><span class="hs-identifier hs-type">decoderPos</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-493"></span><span>      </span><span id="edtGenerationDecoderAttentionMask"><span class="annot"><span class="annottext">forall decoderInput encoderOutput decoderPos decoderAttentionMask
       crossAttentionMask.
EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; decoderAttentionMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtGenerationDecoderAttentionMask"><span class="hs-identifier hs-var hs-var">edtGenerationDecoderAttentionMask</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679720645"><span class="hs-identifier hs-type">decoderAttentionMask</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-494"></span><span>      </span><span id="edtGenerationCrossAttentionMask"><span class="annot"><span class="annottext">forall decoderInput encoderOutput decoderPos decoderAttentionMask
       crossAttentionMask.
EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; crossAttentionMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtGenerationCrossAttentionMask"><span class="hs-identifier hs-var hs-var">edtGenerationCrossAttentionMask</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679720644"><span class="hs-identifier hs-type">crossAttentionMask</span></a></span><span>
</span><span id="line-495"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-496"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerGenerationInput"><span class="hs-identifier hs-type">EncoderDecoderTransformerGenerationInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720648"><span class="hs-identifier hs-type">decoderInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720647"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720646"><span class="hs-identifier hs-type">decoderPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720645"><span class="hs-identifier hs-type">decoderAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720644"><span class="hs-identifier hs-type">crossAttentionMask</span></a></span><span>
</span><span id="line-497"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679718554"><span id="local-6989586621679718561"><span class="annot"><span class="annottext">EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerGenerationInput
     decoderInput
     encoderOutput
     decoderPos
     decoderAttentionMask
     crossAttentionMask
-&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall decoderInput encoderOutput decoderPos decoderAttentionMask
       crossAttentionMask.
(Eq decoderInput, Eq encoderOutput, Eq decoderPos,
 Eq decoderAttentionMask, Eq crossAttentionMask) =&gt;
EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerGenerationInput
     decoderInput
     encoderOutput
     decoderPos
     decoderAttentionMask
     crossAttentionMask
-&gt; Bool
/= :: EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerGenerationInput
     decoderInput
     encoderOutput
     decoderPos
     decoderAttentionMask
     crossAttentionMask
-&gt; Bool
$c/= :: forall decoderInput encoderOutput decoderPos decoderAttentionMask
       crossAttentionMask.
(Eq decoderInput, Eq encoderOutput, Eq decoderPos,
 Eq decoderAttentionMask, Eq crossAttentionMask) =&gt;
EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerGenerationInput
     decoderInput
     encoderOutput
     decoderPos
     decoderAttentionMask
     crossAttentionMask
-&gt; Bool
== :: EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerGenerationInput
     decoderInput
     encoderOutput
     decoderPos
     decoderAttentionMask
     crossAttentionMask
-&gt; Bool
$c== :: forall decoderInput encoderOutput decoderPos decoderAttentionMask
       crossAttentionMask.
(Eq decoderInput, Eq encoderOutput, Eq decoderPos,
 Eq decoderAttentionMask, Eq crossAttentionMask) =&gt;
EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerGenerationInput
     decoderInput
     encoderOutput
     decoderPos
     decoderAttentionMask
     crossAttentionMask
-&gt; Bool
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679718525"><span id="local-6989586621679718527"><span id="local-6989586621679718530"><span id="local-6989586621679718533"><span id="local-6989586621679718536"><span id="local-6989586621679718543"><span id="local-6989586621679718550"><span class="annot"><span class="annottext">EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerGenerationInput
     decoderInput
     encoderOutput
     decoderPos
     decoderAttentionMask
     crossAttentionMask
-&gt; Bool
EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerGenerationInput
     decoderInput
     encoderOutput
     decoderPos
     decoderAttentionMask
     crossAttentionMask
-&gt; Ordering
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall {decoderInput} {encoderOutput} {decoderPos}
       {decoderAttentionMask} {crossAttentionMask}.
(Ord decoderInput, Ord encoderOutput, Ord decoderPos,
 Ord decoderAttentionMask, Ord crossAttentionMask) =&gt;
Eq
  (EncoderDecoderTransformerGenerationInput
     decoderInput
     encoderOutput
     decoderPos
     decoderAttentionMask
     crossAttentionMask)
forall decoderInput encoderOutput decoderPos decoderAttentionMask
       crossAttentionMask.
(Ord decoderInput, Ord encoderOutput, Ord decoderPos,
 Ord decoderAttentionMask, Ord crossAttentionMask) =&gt;
EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerGenerationInput
     decoderInput
     encoderOutput
     decoderPos
     decoderAttentionMask
     crossAttentionMask
-&gt; Bool
forall decoderInput encoderOutput decoderPos decoderAttentionMask
       crossAttentionMask.
(Ord decoderInput, Ord encoderOutput, Ord decoderPos,
 Ord decoderAttentionMask, Ord crossAttentionMask) =&gt;
EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerGenerationInput
     decoderInput
     encoderOutput
     decoderPos
     decoderAttentionMask
     crossAttentionMask
-&gt; Ordering
forall decoderInput encoderOutput decoderPos decoderAttentionMask
       crossAttentionMask.
(Ord decoderInput, Ord encoderOutput, Ord decoderPos,
 Ord decoderAttentionMask, Ord crossAttentionMask) =&gt;
EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerGenerationInput
     decoderInput
     encoderOutput
     decoderPos
     decoderAttentionMask
     crossAttentionMask
-&gt; EncoderDecoderTransformerGenerationInput
     decoderInput
     encoderOutput
     decoderPos
     decoderAttentionMask
     crossAttentionMask
min :: EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerGenerationInput
     decoderInput
     encoderOutput
     decoderPos
     decoderAttentionMask
     crossAttentionMask
-&gt; EncoderDecoderTransformerGenerationInput
     decoderInput
     encoderOutput
     decoderPos
     decoderAttentionMask
     crossAttentionMask
$cmin :: forall decoderInput encoderOutput decoderPos decoderAttentionMask
       crossAttentionMask.
(Ord decoderInput, Ord encoderOutput, Ord decoderPos,
 Ord decoderAttentionMask, Ord crossAttentionMask) =&gt;
EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerGenerationInput
     decoderInput
     encoderOutput
     decoderPos
     decoderAttentionMask
     crossAttentionMask
-&gt; EncoderDecoderTransformerGenerationInput
     decoderInput
     encoderOutput
     decoderPos
     decoderAttentionMask
     crossAttentionMask
max :: EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerGenerationInput
     decoderInput
     encoderOutput
     decoderPos
     decoderAttentionMask
     crossAttentionMask
-&gt; EncoderDecoderTransformerGenerationInput
     decoderInput
     encoderOutput
     decoderPos
     decoderAttentionMask
     crossAttentionMask
$cmax :: forall decoderInput encoderOutput decoderPos decoderAttentionMask
       crossAttentionMask.
(Ord decoderInput, Ord encoderOutput, Ord decoderPos,
 Ord decoderAttentionMask, Ord crossAttentionMask) =&gt;
EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerGenerationInput
     decoderInput
     encoderOutput
     decoderPos
     decoderAttentionMask
     crossAttentionMask
-&gt; EncoderDecoderTransformerGenerationInput
     decoderInput
     encoderOutput
     decoderPos
     decoderAttentionMask
     crossAttentionMask
&gt;= :: EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerGenerationInput
     decoderInput
     encoderOutput
     decoderPos
     decoderAttentionMask
     crossAttentionMask
-&gt; Bool
$c&gt;= :: forall decoderInput encoderOutput decoderPos decoderAttentionMask
       crossAttentionMask.
(Ord decoderInput, Ord encoderOutput, Ord decoderPos,
 Ord decoderAttentionMask, Ord crossAttentionMask) =&gt;
EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerGenerationInput
     decoderInput
     encoderOutput
     decoderPos
     decoderAttentionMask
     crossAttentionMask
-&gt; Bool
&gt; :: EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerGenerationInput
     decoderInput
     encoderOutput
     decoderPos
     decoderAttentionMask
     crossAttentionMask
-&gt; Bool
$c&gt; :: forall decoderInput encoderOutput decoderPos decoderAttentionMask
       crossAttentionMask.
(Ord decoderInput, Ord encoderOutput, Ord decoderPos,
 Ord decoderAttentionMask, Ord crossAttentionMask) =&gt;
EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerGenerationInput
     decoderInput
     encoderOutput
     decoderPos
     decoderAttentionMask
     crossAttentionMask
-&gt; Bool
&lt;= :: EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerGenerationInput
     decoderInput
     encoderOutput
     decoderPos
     decoderAttentionMask
     crossAttentionMask
-&gt; Bool
$c&lt;= :: forall decoderInput encoderOutput decoderPos decoderAttentionMask
       crossAttentionMask.
(Ord decoderInput, Ord encoderOutput, Ord decoderPos,
 Ord decoderAttentionMask, Ord crossAttentionMask) =&gt;
EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerGenerationInput
     decoderInput
     encoderOutput
     decoderPos
     decoderAttentionMask
     crossAttentionMask
-&gt; Bool
&lt; :: EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerGenerationInput
     decoderInput
     encoderOutput
     decoderPos
     decoderAttentionMask
     crossAttentionMask
-&gt; Bool
$c&lt; :: forall decoderInput encoderOutput decoderPos decoderAttentionMask
       crossAttentionMask.
(Ord decoderInput, Ord encoderOutput, Ord decoderPos,
 Ord decoderAttentionMask, Ord crossAttentionMask) =&gt;
EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerGenerationInput
     decoderInput
     encoderOutput
     decoderPos
     decoderAttentionMask
     crossAttentionMask
-&gt; Bool
compare :: EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerGenerationInput
     decoderInput
     encoderOutput
     decoderPos
     decoderAttentionMask
     crossAttentionMask
-&gt; Ordering
$ccompare :: forall decoderInput encoderOutput decoderPos decoderAttentionMask
       crossAttentionMask.
(Ord decoderInput, Ord encoderOutput, Ord decoderPos,
 Ord decoderAttentionMask, Ord crossAttentionMask) =&gt;
EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; EncoderDecoderTransformerGenerationInput
     decoderInput
     encoderOutput
     decoderPos
     decoderAttentionMask
     crossAttentionMask
-&gt; Ordering
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679718513"><span id="local-6989586621679718515"><span id="local-6989586621679718523"><span class="annot"><span class="annottext">Int
-&gt; EncoderDecoderTransformerGenerationInput
     decoderInput
     encoderOutput
     decoderPos
     decoderAttentionMask
     crossAttentionMask
-&gt; ShowS
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall decoderInput encoderOutput decoderPos decoderAttentionMask
       crossAttentionMask.
(Show decoderInput, Show encoderOutput, Show decoderPos,
 Show decoderAttentionMask, Show crossAttentionMask) =&gt;
Int
-&gt; EncoderDecoderTransformerGenerationInput
     decoderInput
     encoderOutput
     decoderPos
     decoderAttentionMask
     crossAttentionMask
-&gt; ShowS
forall decoderInput encoderOutput decoderPos decoderAttentionMask
       crossAttentionMask.
(Show decoderInput, Show encoderOutput, Show decoderPos,
 Show decoderAttentionMask, Show crossAttentionMask) =&gt;
[EncoderDecoderTransformerGenerationInput
   decoderInput
   encoderOutput
   decoderPos
   decoderAttentionMask
   crossAttentionMask]
-&gt; ShowS
forall decoderInput encoderOutput decoderPos decoderAttentionMask
       crossAttentionMask.
(Show decoderInput, Show encoderOutput, Show decoderPos,
 Show decoderAttentionMask, Show crossAttentionMask) =&gt;
EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; String
showList :: [EncoderDecoderTransformerGenerationInput
   decoderInput
   encoderOutput
   decoderPos
   decoderAttentionMask
   crossAttentionMask]
-&gt; ShowS
$cshowList :: forall decoderInput encoderOutput decoderPos decoderAttentionMask
       crossAttentionMask.
(Show decoderInput, Show encoderOutput, Show decoderPos,
 Show decoderAttentionMask, Show crossAttentionMask) =&gt;
[EncoderDecoderTransformerGenerationInput
   decoderInput
   encoderOutput
   decoderPos
   decoderAttentionMask
   crossAttentionMask]
-&gt; ShowS
show :: EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; String
$cshow :: forall decoderInput encoderOutput decoderPos decoderAttentionMask
       crossAttentionMask.
(Show decoderInput, Show encoderOutput, Show decoderPos,
 Show decoderAttentionMask, Show crossAttentionMask) =&gt;
EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; String
showsPrec :: Int
-&gt; EncoderDecoderTransformerGenerationInput
     decoderInput
     encoderOutput
     decoderPos
     decoderAttentionMask
     crossAttentionMask
-&gt; ShowS
$cshowsPrec :: forall decoderInput encoderOutput decoderPos decoderAttentionMask
       crossAttentionMask.
(Show decoderInput, Show encoderOutput, Show decoderPos,
 Show decoderAttentionMask, Show crossAttentionMask) =&gt;
Int
-&gt; EncoderDecoderTransformerGenerationInput
     decoderInput
     encoderOutput
     decoderPos
     decoderAttentionMask
     crossAttentionMask
-&gt; ShowS
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall decoderInput encoderOutput decoderPos decoderAttentionMask
       crossAttentionMask x.
Rep
  (EncoderDecoderTransformerGenerationInput
     decoderInput
     encoderOutput
     decoderPos
     decoderAttentionMask
     crossAttentionMask)
  x
-&gt; EncoderDecoderTransformerGenerationInput
     decoderInput
     encoderOutput
     decoderPos
     decoderAttentionMask
     crossAttentionMask
forall decoderInput encoderOutput decoderPos decoderAttentionMask
       crossAttentionMask x.
EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; Rep
     (EncoderDecoderTransformerGenerationInput
        decoderInput
        encoderOutput
        decoderPos
        decoderAttentionMask
        crossAttentionMask)
     x
$cto :: forall decoderInput encoderOutput decoderPos decoderAttentionMask
       crossAttentionMask x.
Rep
  (EncoderDecoderTransformerGenerationInput
     decoderInput
     encoderOutput
     decoderPos
     decoderAttentionMask
     crossAttentionMask)
  x
-&gt; EncoderDecoderTransformerGenerationInput
     decoderInput
     encoderOutput
     decoderPos
     decoderAttentionMask
     crossAttentionMask
$cfrom :: forall decoderInput encoderOutput decoderPos decoderAttentionMask
       crossAttentionMask x.
EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; Rep
     (EncoderDecoderTransformerGenerationInput
        decoderInput
        encoderOutput
        decoderPos
        decoderAttentionMask
        crossAttentionMask)
     x
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-498"></span><span>
</span><span id="line-499"></span><span id="local-6989586621679718508"><span id="local-6989586621679718509"></span></span><span class="hs-keyword">data</span><span> </span><span id="SimplifiedEncoderDecoderTransformerGenerationInput"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerGenerationInput"><span class="hs-identifier hs-var">SimplifiedEncoderDecoderTransformerGenerationInput</span></a></span></span><span> </span><span id="local-6989586621679720598"><span class="annot"><a href="#local-6989586621679720598"><span class="hs-identifier hs-type">decoderInput</span></a></span></span><span> </span><span id="local-6989586621679720597"><span class="annot"><a href="#local-6989586621679720597"><span class="hs-identifier hs-type">encoderOutput</span></a></span></span><span> </span><span id="local-6989586621679720596"><span class="annot"><a href="#local-6989586621679720596"><span class="hs-identifier hs-type">inputPaddingMask</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-500"></span><span>  </span><span id="SimplifiedEncoderDecoderTransformerGenerationInput"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerGenerationInput"><span class="hs-identifier hs-var">SimplifiedEncoderDecoderTransformerGenerationInput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-501"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679720610"><span class="annot"><a href="#local-6989586621679720610"><span class="hs-identifier hs-type">decoderInput</span></a></span></span><span> </span><span id="local-6989586621679720609"><span class="annot"><a href="#local-6989586621679720609"><span class="hs-identifier hs-type">encoderOutput</span></a></span></span><span> </span><span id="local-6989586621679720608"><span class="annot"><a href="#local-6989586621679720608"><span class="hs-identifier hs-type">inputPaddingMask</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-502"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="sedtGenerationDecoderInput"><span class="annot"><span class="annottext">forall decoderInput encoderOutput inputPaddingMask.
SimplifiedEncoderDecoderTransformerGenerationInput
  decoderInput encoderOutput inputPaddingMask
-&gt; decoderInput
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtGenerationDecoderInput"><span class="hs-identifier hs-var hs-var">sedtGenerationDecoderInput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679720610"><span class="hs-identifier hs-type">decoderInput</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-503"></span><span>      </span><span id="sedtGenerationEncoderOutput"><span class="annot"><span class="annottext">forall decoderInput encoderOutput inputPaddingMask.
SimplifiedEncoderDecoderTransformerGenerationInput
  decoderInput encoderOutput inputPaddingMask
-&gt; encoderOutput
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtGenerationEncoderOutput"><span class="hs-identifier hs-var hs-var">sedtGenerationEncoderOutput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679720609"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-504"></span><span>      </span><span id="sedtGenerationInputPaddingMask"><span class="annot"><span class="annottext">forall decoderInput encoderOutput inputPaddingMask.
SimplifiedEncoderDecoderTransformerGenerationInput
  decoderInput encoderOutput inputPaddingMask
-&gt; inputPaddingMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtGenerationInputPaddingMask"><span class="hs-identifier hs-var hs-var">sedtGenerationInputPaddingMask</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679720608"><span class="hs-identifier hs-type">inputPaddingMask</span></a></span><span>
</span><span id="line-505"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-506"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerGenerationInput"><span class="hs-identifier hs-type">SimplifiedEncoderDecoderTransformerGenerationInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720610"><span class="hs-identifier hs-type">decoderInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720609"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720608"><span class="hs-identifier hs-type">inputPaddingMask</span></a></span><span>
</span><span id="line-507"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679718497"><span id="local-6989586621679718502"><span class="annot"><span class="annottext">SimplifiedEncoderDecoderTransformerGenerationInput
  decoderInput encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerGenerationInput
     decoderInput encoderOutput inputPaddingMask
-&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall decoderInput encoderOutput inputPaddingMask.
(Eq decoderInput, Eq encoderOutput, Eq inputPaddingMask) =&gt;
SimplifiedEncoderDecoderTransformerGenerationInput
  decoderInput encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerGenerationInput
     decoderInput encoderOutput inputPaddingMask
-&gt; Bool
/= :: SimplifiedEncoderDecoderTransformerGenerationInput
  decoderInput encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerGenerationInput
     decoderInput encoderOutput inputPaddingMask
-&gt; Bool
$c/= :: forall decoderInput encoderOutput inputPaddingMask.
(Eq decoderInput, Eq encoderOutput, Eq inputPaddingMask) =&gt;
SimplifiedEncoderDecoderTransformerGenerationInput
  decoderInput encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerGenerationInput
     decoderInput encoderOutput inputPaddingMask
-&gt; Bool
== :: SimplifiedEncoderDecoderTransformerGenerationInput
  decoderInput encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerGenerationInput
     decoderInput encoderOutput inputPaddingMask
-&gt; Bool
$c== :: forall decoderInput encoderOutput inputPaddingMask.
(Eq decoderInput, Eq encoderOutput, Eq inputPaddingMask) =&gt;
SimplifiedEncoderDecoderTransformerGenerationInput
  decoderInput encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerGenerationInput
     decoderInput encoderOutput inputPaddingMask
-&gt; Bool
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679718472"><span id="local-6989586621679718474"><span id="local-6989586621679718477"><span id="local-6989586621679718480"><span id="local-6989586621679718483"><span id="local-6989586621679718488"><span id="local-6989586621679718493"><span class="annot"><span class="annottext">SimplifiedEncoderDecoderTransformerGenerationInput
  decoderInput encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerGenerationInput
     decoderInput encoderOutput inputPaddingMask
-&gt; Bool
SimplifiedEncoderDecoderTransformerGenerationInput
  decoderInput encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerGenerationInput
     decoderInput encoderOutput inputPaddingMask
-&gt; Ordering
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall {decoderInput} {encoderOutput} {inputPaddingMask}.
(Ord decoderInput, Ord encoderOutput, Ord inputPaddingMask) =&gt;
Eq
  (SimplifiedEncoderDecoderTransformerGenerationInput
     decoderInput encoderOutput inputPaddingMask)
forall decoderInput encoderOutput inputPaddingMask.
(Ord decoderInput, Ord encoderOutput, Ord inputPaddingMask) =&gt;
SimplifiedEncoderDecoderTransformerGenerationInput
  decoderInput encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerGenerationInput
     decoderInput encoderOutput inputPaddingMask
-&gt; Bool
forall decoderInput encoderOutput inputPaddingMask.
(Ord decoderInput, Ord encoderOutput, Ord inputPaddingMask) =&gt;
SimplifiedEncoderDecoderTransformerGenerationInput
  decoderInput encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerGenerationInput
     decoderInput encoderOutput inputPaddingMask
-&gt; Ordering
forall decoderInput encoderOutput inputPaddingMask.
(Ord decoderInput, Ord encoderOutput, Ord inputPaddingMask) =&gt;
SimplifiedEncoderDecoderTransformerGenerationInput
  decoderInput encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerGenerationInput
     decoderInput encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerGenerationInput
     decoderInput encoderOutput inputPaddingMask
min :: SimplifiedEncoderDecoderTransformerGenerationInput
  decoderInput encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerGenerationInput
     decoderInput encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerGenerationInput
     decoderInput encoderOutput inputPaddingMask
$cmin :: forall decoderInput encoderOutput inputPaddingMask.
(Ord decoderInput, Ord encoderOutput, Ord inputPaddingMask) =&gt;
SimplifiedEncoderDecoderTransformerGenerationInput
  decoderInput encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerGenerationInput
     decoderInput encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerGenerationInput
     decoderInput encoderOutput inputPaddingMask
max :: SimplifiedEncoderDecoderTransformerGenerationInput
  decoderInput encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerGenerationInput
     decoderInput encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerGenerationInput
     decoderInput encoderOutput inputPaddingMask
$cmax :: forall decoderInput encoderOutput inputPaddingMask.
(Ord decoderInput, Ord encoderOutput, Ord inputPaddingMask) =&gt;
SimplifiedEncoderDecoderTransformerGenerationInput
  decoderInput encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerGenerationInput
     decoderInput encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerGenerationInput
     decoderInput encoderOutput inputPaddingMask
&gt;= :: SimplifiedEncoderDecoderTransformerGenerationInput
  decoderInput encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerGenerationInput
     decoderInput encoderOutput inputPaddingMask
-&gt; Bool
$c&gt;= :: forall decoderInput encoderOutput inputPaddingMask.
(Ord decoderInput, Ord encoderOutput, Ord inputPaddingMask) =&gt;
SimplifiedEncoderDecoderTransformerGenerationInput
  decoderInput encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerGenerationInput
     decoderInput encoderOutput inputPaddingMask
-&gt; Bool
&gt; :: SimplifiedEncoderDecoderTransformerGenerationInput
  decoderInput encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerGenerationInput
     decoderInput encoderOutput inputPaddingMask
-&gt; Bool
$c&gt; :: forall decoderInput encoderOutput inputPaddingMask.
(Ord decoderInput, Ord encoderOutput, Ord inputPaddingMask) =&gt;
SimplifiedEncoderDecoderTransformerGenerationInput
  decoderInput encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerGenerationInput
     decoderInput encoderOutput inputPaddingMask
-&gt; Bool
&lt;= :: SimplifiedEncoderDecoderTransformerGenerationInput
  decoderInput encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerGenerationInput
     decoderInput encoderOutput inputPaddingMask
-&gt; Bool
$c&lt;= :: forall decoderInput encoderOutput inputPaddingMask.
(Ord decoderInput, Ord encoderOutput, Ord inputPaddingMask) =&gt;
SimplifiedEncoderDecoderTransformerGenerationInput
  decoderInput encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerGenerationInput
     decoderInput encoderOutput inputPaddingMask
-&gt; Bool
&lt; :: SimplifiedEncoderDecoderTransformerGenerationInput
  decoderInput encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerGenerationInput
     decoderInput encoderOutput inputPaddingMask
-&gt; Bool
$c&lt; :: forall decoderInput encoderOutput inputPaddingMask.
(Ord decoderInput, Ord encoderOutput, Ord inputPaddingMask) =&gt;
SimplifiedEncoderDecoderTransformerGenerationInput
  decoderInput encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerGenerationInput
     decoderInput encoderOutput inputPaddingMask
-&gt; Bool
compare :: SimplifiedEncoderDecoderTransformerGenerationInput
  decoderInput encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerGenerationInput
     decoderInput encoderOutput inputPaddingMask
-&gt; Ordering
$ccompare :: forall decoderInput encoderOutput inputPaddingMask.
(Ord decoderInput, Ord encoderOutput, Ord inputPaddingMask) =&gt;
SimplifiedEncoderDecoderTransformerGenerationInput
  decoderInput encoderOutput inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerGenerationInput
     decoderInput encoderOutput inputPaddingMask
-&gt; Ordering
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679718462"><span id="local-6989586621679718464"><span id="local-6989586621679718470"><span class="annot"><span class="annottext">Int
-&gt; SimplifiedEncoderDecoderTransformerGenerationInput
     decoderInput encoderOutput inputPaddingMask
-&gt; ShowS
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall decoderInput encoderOutput inputPaddingMask.
(Show decoderInput, Show encoderOutput, Show inputPaddingMask) =&gt;
Int
-&gt; SimplifiedEncoderDecoderTransformerGenerationInput
     decoderInput encoderOutput inputPaddingMask
-&gt; ShowS
forall decoderInput encoderOutput inputPaddingMask.
(Show decoderInput, Show encoderOutput, Show inputPaddingMask) =&gt;
[SimplifiedEncoderDecoderTransformerGenerationInput
   decoderInput encoderOutput inputPaddingMask]
-&gt; ShowS
forall decoderInput encoderOutput inputPaddingMask.
(Show decoderInput, Show encoderOutput, Show inputPaddingMask) =&gt;
SimplifiedEncoderDecoderTransformerGenerationInput
  decoderInput encoderOutput inputPaddingMask
-&gt; String
showList :: [SimplifiedEncoderDecoderTransformerGenerationInput
   decoderInput encoderOutput inputPaddingMask]
-&gt; ShowS
$cshowList :: forall decoderInput encoderOutput inputPaddingMask.
(Show decoderInput, Show encoderOutput, Show inputPaddingMask) =&gt;
[SimplifiedEncoderDecoderTransformerGenerationInput
   decoderInput encoderOutput inputPaddingMask]
-&gt; ShowS
show :: SimplifiedEncoderDecoderTransformerGenerationInput
  decoderInput encoderOutput inputPaddingMask
-&gt; String
$cshow :: forall decoderInput encoderOutput inputPaddingMask.
(Show decoderInput, Show encoderOutput, Show inputPaddingMask) =&gt;
SimplifiedEncoderDecoderTransformerGenerationInput
  decoderInput encoderOutput inputPaddingMask
-&gt; String
showsPrec :: Int
-&gt; SimplifiedEncoderDecoderTransformerGenerationInput
     decoderInput encoderOutput inputPaddingMask
-&gt; ShowS
$cshowsPrec :: forall decoderInput encoderOutput inputPaddingMask.
(Show decoderInput, Show encoderOutput, Show inputPaddingMask) =&gt;
Int
-&gt; SimplifiedEncoderDecoderTransformerGenerationInput
     decoderInput encoderOutput inputPaddingMask
-&gt; ShowS
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall decoderInput encoderOutput inputPaddingMask x.
Rep
  (SimplifiedEncoderDecoderTransformerGenerationInput
     decoderInput encoderOutput inputPaddingMask)
  x
-&gt; SimplifiedEncoderDecoderTransformerGenerationInput
     decoderInput encoderOutput inputPaddingMask
forall decoderInput encoderOutput inputPaddingMask x.
SimplifiedEncoderDecoderTransformerGenerationInput
  decoderInput encoderOutput inputPaddingMask
-&gt; Rep
     (SimplifiedEncoderDecoderTransformerGenerationInput
        decoderInput encoderOutput inputPaddingMask)
     x
$cto :: forall decoderInput encoderOutput inputPaddingMask x.
Rep
  (SimplifiedEncoderDecoderTransformerGenerationInput
     decoderInput encoderOutput inputPaddingMask)
  x
-&gt; SimplifiedEncoderDecoderTransformerGenerationInput
     decoderInput encoderOutput inputPaddingMask
$cfrom :: forall decoderInput encoderOutput inputPaddingMask x.
SimplifiedEncoderDecoderTransformerGenerationInput
  decoderInput encoderOutput inputPaddingMask
-&gt; Rep
     (SimplifiedEncoderDecoderTransformerGenerationInput
        decoderInput encoderOutput inputPaddingMask)
     x
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-508"></span><span>
</span><span id="line-509"></span><span class="hs-comment">-- | 'HasForward' instance for encoder-decoder transformers with optional head.</span><span>
</span><span id="line-510"></span><span class="hs-comment">--</span><span>
</span><span id="line-511"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-512"></span><span class="hs-comment">--     &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-513"></span><span class="hs-comment">--     &#9474; input &#9474;  &#9474; pos &#9474;  &#9474; attentionMask &#9474;  &#9474; decoderInput &#9474;  &#9474; decoderPos &#9474;  &#9474; decoderAttentionMask &#9474;  &#9474; crossAttentionMask &#9474;</span><span>
</span><span id="line-514"></span><span class="hs-comment">--     &#9492;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9516;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-515"></span><span class="hs-comment">--         &#9474;         &#9474;            &#9474;                  &#9474;                &#9474;                    &#9474;                        &#9474;</span><span>
</span><span id="line-516"></span><span class="hs-comment">--         &#9660;         &#9474;            &#9474;                  &#9474;                &#9474;                    &#9474;                        &#9474;</span><span>
</span><span id="line-517"></span><span class="hs-comment">-- edtSharedEmbedding&#9474;            &#9474;                  &#9474;                &#9474;                    &#9474;                        &#9474;</span><span>
</span><span id="line-518"></span><span class="hs-comment">--         &#9660;         &#9474;            &#9474;                  &#9474;                &#9474;                    &#9474;                        &#9474;</span><span>
</span><span id="line-519"></span><span class="hs-comment">--   (embedScaling)  &#9474;            &#9474;                  &#9474;                &#9474;                    &#9474;                        &#9474;</span><span>
</span><span id="line-520"></span><span class="hs-comment">--         &#9660;         &#9474;            &#9474;                  &#9474;                &#9474;                    &#9474;                        &#9474;</span><span>
</span><span id="line-521"></span><span class="hs-comment">--     edtEncoder&#9668;&#9472;&#9472;&#9472;&#9496;&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;                  &#9660;                &#9474;                    &#9474;                        &#9474;</span><span>
</span><span id="line-522"></span><span class="hs-comment">--         &#9474;                                 edtSharedEmbedding       &#9474;                    &#9474;                        &#9474;</span><span>
</span><span id="line-523"></span><span class="hs-comment">--         &#9474;                                         &#9660;                &#9474;                    &#9474;                        &#9474;</span><span>
</span><span id="line-524"></span><span class="hs-comment">--         &#9474;                                   (embedScaling)         &#9474;                    &#9474;                        &#9474;</span><span>
</span><span id="line-525"></span><span class="hs-comment">--         &#9474;                                         &#9660;                &#9474;                    &#9474;                        &#9474;</span><span>
</span><span id="line-526"></span><span class="hs-comment">--         &#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9658;edtDecoder&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-527"></span><span class="hs-comment">--         &#9474;                                         &#9660;</span><span>
</span><span id="line-528"></span><span class="hs-comment">--         &#9474;                                     (edtHead)</span><span>
</span><span id="line-529"></span><span class="hs-comment">--         &#9474;                                         &#9474;</span><span>
</span><span id="line-530"></span><span class="hs-comment">--         &#9660;                                         &#9660;</span><span>
</span><span id="line-531"></span><span class="hs-comment">-- &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;                         &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-532"></span><span class="hs-comment">-- &#9474; encoderOutput &#9474;                         &#9474; decoderOutput &#9474;</span><span>
</span><span id="line-533"></span><span class="hs-comment">-- &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;                         &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-534"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-535"></span><span class="hs-keyword">instance</span><span>
</span><span id="line-536"></span><span>  </span><span id="local-6989586621679720555"><span id="local-6989586621679720556"><span id="local-6989586621679720557"><span id="local-6989586621679720558"><span id="local-6989586621679720559"><span id="local-6989586621679720560"><span id="local-6989586621679720561"><span id="local-6989586621679720562"><span id="local-6989586621679720563"><span id="local-6989586621679720564"><span id="local-6989586621679720565"><span id="local-6989586621679720566"><span id="local-6989586621679720567"><span id="local-6989586621679720568"><span id="local-6989586621679720569"><span id="local-6989586621679720570"><span id="local-6989586621679720571"><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-537"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GEncoderDecoderTransformer"><span class="hs-identifier hs-type">GEncoderDecoderTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720571"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720570"><span class="hs-identifier hs-type">encoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720569"><span class="hs-identifier hs-type">decoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720568"><span class="hs-identifier hs-type">sharedEmbedding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720567"><span class="hs-identifier hs-type">head</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-538"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerInput%27"><span class="hs-identifier hs-type">EncoderDecoderTransformerInput'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720566"><span class="hs-identifier hs-type">input</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720565"><span class="hs-identifier hs-type">pos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720564"><span class="hs-identifier hs-type">attentionMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-539"></span><span>      </span><span class="annot"><a href="#local-6989586621679720563"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-540"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerOutput%27"><span class="hs-identifier hs-type">EncoderDecoderTransformerOutput'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720562"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-541"></span><span>      </span><span class="annot"><a href="#local-6989586621679720561"><span class="hs-identifier hs-type">generatorDevice'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-542"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-543"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GEncoderDecoderTransformer"><span class="hs-identifier hs-type">GEncoderDecoderTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720571"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720570"><span class="hs-identifier hs-type">encoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720569"><span class="hs-identifier hs-type">decoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720568"><span class="hs-identifier hs-type">sharedEmbedding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720567"><span class="hs-identifier hs-type">head</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-544"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerGenerationInput"><span class="hs-identifier hs-type">EncoderDecoderTransformerGenerationInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720560"><span class="hs-identifier hs-type">decoderInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720562"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720559"><span class="hs-identifier hs-type">decoderPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720558"><span class="hs-identifier hs-type">decoderAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720557"><span class="hs-identifier hs-type">crossAttentionMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-545"></span><span>      </span><span class="annot"><a href="#local-6989586621679720561"><span class="hs-identifier hs-type">generatorDevice'</span></a></span><span>
</span><span id="line-546"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerOutput"><span class="hs-identifier hs-type">EncoderDecoderTransformerOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720556"><span class="hs-identifier hs-type">headOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720562"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-547"></span><span>      </span><span class="annot"><a href="#local-6989586621679720555"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-548"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-549"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-550"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GEncoderDecoderTransformer"><span class="hs-identifier hs-type">GEncoderDecoderTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720571"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720570"><span class="hs-identifier hs-type">encoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720569"><span class="hs-identifier hs-type">decoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720568"><span class="hs-identifier hs-type">sharedEmbedding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720567"><span class="hs-identifier hs-type">head</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-551"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerInput"><span class="hs-identifier hs-type">EncoderDecoderTransformerInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720566"><span class="hs-identifier hs-type">input</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720560"><span class="hs-identifier hs-type">decoderInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720565"><span class="hs-identifier hs-type">pos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720559"><span class="hs-identifier hs-type">decoderPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720564"><span class="hs-identifier hs-type">attentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720558"><span class="hs-identifier hs-type">decoderAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720557"><span class="hs-identifier hs-type">crossAttentionMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-552"></span><span>    </span><span class="annot"><a href="#local-6989586621679720563"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-553"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerOutput"><span class="hs-identifier hs-type">EncoderDecoderTransformerOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720556"><span class="hs-identifier hs-type">headOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720562"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-554"></span><span>    </span><span class="annot"><a href="#local-6989586621679720555"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-555"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-556"></span><span>  </span><span id="local-6989586621679718445"><span class="annot"><span class="annottext">forward :: forall (m :: * -&gt; *).
MonadThrow m =&gt;
GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; EncoderDecoderTransformerInput
     input
     decoderInput
     pos
     decoderPos
     attentionMask
     decoderAttentionMask
     crossAttentionMask
-&gt; Generator generatorDevice
-&gt; m (EncoderDecoderTransformerOutput headOutput encoderOutput,
      Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var hs-var hs-var hs-var">forward</span></a></span></span><span> </span><span id="local-6989586621679718443"><span class="annot"><span class="annottext">GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
</span><a href="#local-6989586621679718443"><span class="hs-identifier hs-var">model</span></a></span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerInput"><span class="hs-identifier hs-type">EncoderDecoderTransformerInput</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679718436"><span id="local-6989586621679718437"><span id="local-6989586621679718438"><span id="local-6989586621679718439"><span id="local-6989586621679718440"><span id="local-6989586621679718441"><span id="local-6989586621679718442"><span class="annot"><span class="annottext">input
pos
attentionMask
decoderInput
decoderPos
decoderAttentionMask
crossAttentionMask
edtCrossAttentionMask :: crossAttentionMask
edtDecoderAttentionMask :: decoderAttentionMask
edtAttentionMask :: attentionMask
edtDecoderPos :: decoderPos
edtPos :: pos
edtDecoderInput :: decoderInput
edtInput :: input
edtCrossAttentionMask :: forall input decoderInput pos decoderPos attentionMask
       decoderAttentionMask crossAttentionMask.
EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; crossAttentionMask
edtDecoderAttentionMask :: forall input decoderInput pos decoderPos attentionMask
       decoderAttentionMask crossAttentionMask.
EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; decoderAttentionMask
edtAttentionMask :: forall input decoderInput pos decoderPos attentionMask
       decoderAttentionMask crossAttentionMask.
EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; attentionMask
edtDecoderPos :: forall input decoderInput pos decoderPos attentionMask
       decoderAttentionMask crossAttentionMask.
EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; decoderPos
edtPos :: forall input decoderInput pos decoderPos attentionMask
       decoderAttentionMask crossAttentionMask.
EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; pos
edtDecoderInput :: forall input decoderInput pos decoderPos attentionMask
       decoderAttentionMask crossAttentionMask.
EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; decoderInput
edtInput :: forall input decoderInput pos decoderPos attentionMask
       decoderAttentionMask crossAttentionMask.
EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; input
</span><a href="#local-6989586621679718436"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-557"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) i j a. IxStateT m i j a -&gt; i -&gt; m (a, j)
</span><a href="../file:///nix/store/hlan16hghcygrr1n0fqljpsq2978pxwg-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">runIxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-558"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/hlan16hghcygrr1n0fqljpsq2978pxwg-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span>
</span><span id="line-559"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span>
</span><span id="line-560"></span><span>            </span><span class="annot"><span class="annottext">GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
</span><a href="#local-6989586621679718443"><span class="hs-identifier hs-var">model</span></a></span><span>
</span><span id="line-561"></span><span>            </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerInput%27"><span class="hs-identifier hs-type">EncoderDecoderTransformerInput'</span></a></span><span>
</span><span id="line-562"></span><span>              </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">edtInput' :: input
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtInput%27"><span class="hs-identifier hs-var">edtInput'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">input
</span><a href="#local-6989586621679718442"><span class="hs-identifier hs-var">edtInput</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-563"></span><span>                </span><span class="annot"><span class="annottext">edtPos' :: pos
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtPos%27"><span class="hs-identifier hs-var">edtPos'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">pos
</span><a href="#local-6989586621679718440"><span class="hs-identifier hs-var">edtPos</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-564"></span><span>                </span><span class="annot"><span class="annottext">edtAttentionMask' :: attentionMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtAttentionMask%27"><span class="hs-identifier hs-var">edtAttentionMask'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">attentionMask
</span><a href="#local-6989586621679718438"><span class="hs-identifier hs-var">edtAttentionMask</span></a></span><span>
</span><span id="line-565"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-566"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-567"></span><span>        </span><span class="annot"><span class="annottext">forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerOutput%27"><span class="hs-identifier hs-type">EncoderDecoderTransformerOutput'</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679718433"><span class="annot"><span class="annottext">encoderOutput
edtEncoderOutput' :: encoderOutput
edtEncoderOutput' :: forall encoderOutput.
EncoderDecoderTransformerOutput' encoderOutput -&gt; encoderOutput
</span><a href="#local-6989586621679718433"><span class="hs-glyph hs-var hs-var">..</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-568"></span><span>                 </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/hlan16hghcygrr1n0fqljpsq2978pxwg-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span>
</span><span id="line-569"></span><span>                   </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span>
</span><span id="line-570"></span><span>                       </span><span class="annot"><span class="annottext">GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
</span><a href="#local-6989586621679718443"><span class="hs-identifier hs-var">model</span></a></span><span>
</span><span id="line-571"></span><span>                       </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerGenerationInput"><span class="hs-identifier hs-type">EncoderDecoderTransformerGenerationInput</span></a></span><span>
</span><span id="line-572"></span><span>                         </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">edtGenerationDecoderInput :: decoderInput
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtGenerationDecoderInput"><span class="hs-identifier hs-var">edtGenerationDecoderInput</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">decoderInput
</span><a href="#local-6989586621679718441"><span class="hs-identifier hs-var">edtDecoderInput</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-573"></span><span>                           </span><span class="annot"><span class="annottext">edtGenerationEncoderOutput :: encoderOutput
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtGenerationEncoderOutput"><span class="hs-identifier hs-var">edtGenerationEncoderOutput</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">encoderOutput
</span><a href="#local-6989586621679718433"><span class="hs-identifier hs-var">edtEncoderOutput'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-574"></span><span>                           </span><span class="annot"><span class="annottext">edtGenerationDecoderPos :: decoderPos
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtGenerationDecoderPos"><span class="hs-identifier hs-var">edtGenerationDecoderPos</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">decoderPos
</span><a href="#local-6989586621679718439"><span class="hs-identifier hs-var">edtDecoderPos</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-575"></span><span>                           </span><span class="annot"><span class="annottext">edtGenerationDecoderAttentionMask :: decoderAttentionMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtGenerationDecoderAttentionMask"><span class="hs-identifier hs-var">edtGenerationDecoderAttentionMask</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">decoderAttentionMask
</span><a href="#local-6989586621679718437"><span class="hs-identifier hs-var">edtDecoderAttentionMask</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-576"></span><span>                           </span><span class="annot"><span class="annottext">edtGenerationCrossAttentionMask :: crossAttentionMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtGenerationCrossAttentionMask"><span class="hs-identifier hs-var">edtGenerationCrossAttentionMask</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">crossAttentionMask
</span><a href="#local-6989586621679718436"><span class="hs-identifier hs-var">edtCrossAttentionMask</span></a></span><span>
</span><span id="line-577"></span><span>                         </span><span class="hs-special">}</span><span>
</span><span id="line-578"></span><span>                   </span><span class="hs-special">)</span><span>
</span><span id="line-579"></span><span>             </span><span class="hs-special">)</span><span>
</span><span id="line-580"></span><span>
</span><span id="line-581"></span><span class="hs-keyword">instance</span><span>
</span><span id="line-582"></span><span>  </span><span id="local-6989586621679720499"><span id="local-6989586621679720500"><span id="local-6989586621679720501"><span id="local-6989586621679720502"><span id="local-6989586621679720503"><span id="local-6989586621679720504"><span id="local-6989586621679720505"><span id="local-6989586621679720506"><span id="local-6989586621679720507"><span id="local-6989586621679720508"><span id="local-6989586621679720509"><span id="local-6989586621679720510"><span id="local-6989586621679720511"><span id="local-6989586621679720512"><span id="local-6989586621679720513"><span id="local-6989586621679720514"><span id="local-6989586621679720515"><span id="local-6989586621679720516"><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-583"></span><span>      </span><span class="annot"><a href="#local-6989586621679720516"><span class="hs-identifier hs-type">sharedEmbedding</span></a></span><span>
</span><span id="line-584"></span><span>      </span><span class="annot"><a href="#local-6989586621679720515"><span class="hs-identifier hs-type">input</span></a></span><span>
</span><span id="line-585"></span><span>      </span><span class="annot"><a href="#local-6989586621679720514"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-586"></span><span>      </span><span class="annot"><a href="#local-6989586621679720513"><span class="hs-identifier hs-type">embeddingOutput</span></a></span><span>
</span><span id="line-587"></span><span>      </span><span class="annot"><a href="#local-6989586621679720512"><span class="hs-identifier hs-type">embeddingGeneratorOutputDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-588"></span><span>    </span><span class="annot"><a href="#local-6989586621679720513"><span class="hs-identifier hs-type">embeddingOutput</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720511"><span class="hs-identifier hs-type">requiresGradient'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720510"><span class="hs-identifier hs-type">layout'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720509"><span class="hs-identifier hs-type">device'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720508"><span class="hs-identifier hs-type">dataType'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720507"><span class="hs-identifier hs-type">shape'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-589"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-590"></span><span>      </span><span class="annot"><a href="#local-6989586621679720506"><span class="hs-identifier hs-type">encoder</span></a></span><span>
</span><span id="line-591"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679720513"><span class="hs-identifier hs-type">embeddingOutput</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679720505"><span class="hs-identifier hs-type">pos</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679720504"><span class="hs-identifier hs-type">attentionMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-592"></span><span>      </span><span class="annot"><a href="#local-6989586621679720512"><span class="hs-identifier hs-type">embeddingGeneratorOutputDevice</span></a></span><span>
</span><span id="line-593"></span><span>      </span><span class="annot"><a href="#local-6989586621679720503"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span>
</span><span id="line-594"></span><span>      </span><span class="annot"><a href="#local-6989586621679720502"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-595"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-596"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-597"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GEncoderDecoderTransformer"><span class="hs-identifier hs-type">GEncoderDecoderTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720501"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720506"><span class="hs-identifier hs-type">encoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720500"><span class="hs-identifier hs-type">decoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720516"><span class="hs-identifier hs-type">sharedEmbedding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720499"><span class="hs-identifier hs-type">head</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-598"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerInput%27"><span class="hs-identifier hs-type">EncoderDecoderTransformerInput'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720515"><span class="hs-identifier hs-type">input</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720505"><span class="hs-identifier hs-type">pos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720504"><span class="hs-identifier hs-type">attentionMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-599"></span><span>    </span><span class="annot"><a href="#local-6989586621679720514"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-600"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerOutput%27"><span class="hs-identifier hs-type">EncoderDecoderTransformerOutput'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720503"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-601"></span><span>    </span><span class="annot"><a href="#local-6989586621679720502"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-602"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-603"></span><span>  </span><span id="local-6989586621679718395"><span class="annot"><span class="annottext">forward :: forall (m :: * -&gt; *).
MonadThrow m =&gt;
GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; EncoderDecoderTransformerInput' input pos attentionMask
-&gt; Generator generatorDevice
-&gt; m (EncoderDecoderTransformerOutput' encoderOutput,
      Generator generatorOutputDevice)
</span><a href="#local-6989586621679718395"><span class="hs-identifier hs-var hs-var hs-var hs-var">forward</span></a></span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GEncoderDecoderTransformer"><span class="hs-identifier hs-type">GEncoderDecoderTransformer</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679718389"><span id="local-6989586621679718390"><span id="local-6989586621679718391"><span id="local-6989586621679718392"><span id="local-6989586621679718393"><span id="local-6989586621679718394"><span class="annot"><span class="annottext">sharedEmbedding
encoder
decoder
head
SDim inputEmbedDim
EncoderDecoderTransformerHasEmbedScaling
edtEmbedScaling :: EncoderDecoderTransformerHasEmbedScaling
edtHead :: head
edtSharedEmbedding :: sharedEmbedding
edtDecoder :: decoder
edtEncoder :: encoder
edtInputEmbedDim :: SDim inputEmbedDim
edtEmbedScaling :: forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head.
GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; EncoderDecoderTransformerHasEmbedScaling
edtHead :: forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head.
GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; head
edtSharedEmbedding :: forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head.
GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; sharedEmbedding
edtDecoder :: forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head.
GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; decoder
edtEncoder :: forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head.
GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; encoder
edtInputEmbedDim :: forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head.
GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; SDim inputEmbedDim
</span><a href="#local-6989586621679718389"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerInput%27"><span class="hs-identifier hs-type">EncoderDecoderTransformerInput'</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679718386"><span id="local-6989586621679718387"><span id="local-6989586621679718388"><span class="annot"><span class="annottext">input
pos
attentionMask
edtAttentionMask' :: attentionMask
edtPos' :: pos
edtInput' :: input
edtAttentionMask' :: forall input pos attentionMask.
EncoderDecoderTransformerInput' input pos attentionMask
-&gt; attentionMask
edtPos' :: forall input pos attentionMask.
EncoderDecoderTransformerInput' input pos attentionMask -&gt; pos
edtInput' :: forall input pos attentionMask.
EncoderDecoderTransformerInput' input pos attentionMask -&gt; input
</span><a href="#local-6989586621679718386"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-604"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679718385"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679718385"><span class="hs-identifier hs-var">scaling</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">sqrt</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsChecked a -&gt; a
</span><a href="Torch.GraduallyTyped.Prelude.html#forgetIsChecked"><span class="hs-identifier hs-var">forgetIsChecked</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall name size. Dim name size -&gt; size
</span><a href="Torch.GraduallyTyped.Shape.Type.html#dimSize"><span class="hs-identifier hs-var">dimSize</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall k (a :: k). SingKind k =&gt; Sing a -&gt; Demote k
</span><a href="../file:///nix/store/53aqqxvip62j3fkmz3ijr9pig0rgbrmg-singletons-lib-singletons-3.0.1-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">fromSing</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SDim inputEmbedDim
</span><a href="#local-6989586621679718394"><span class="hs-identifier hs-var">edtInputEmbedDim</span></a></span><span>
</span><span id="line-605"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) i j a. IxStateT m i j a -&gt; i -&gt; m (a, j)
</span><a href="../file:///nix/store/hlan16hghcygrr1n0fqljpsq2978pxwg-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">runIxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-606"></span><span>          </span><span class="annot"><span class="annottext">forall {k} (m :: k -&gt; k -&gt; * -&gt; *) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">input
</span><a href="#local-6989586621679718388"><span class="hs-identifier hs-var">edtInput'</span></a></span><span>
</span><span id="line-607"></span><span>            </span><span class="annot"><span class="annottext">forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/hlan16hghcygrr1n0fqljpsq2978pxwg-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">sharedEmbedding
</span><a href="#local-6989586621679718391"><span class="hs-identifier hs-var">edtSharedEmbedding</span></a></span><span>
</span><span id="line-608"></span><span>            </span><span class="annot"><span class="annottext">forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (t :: (* -&gt; *) -&gt; k -&gt; k -&gt; * -&gt; *) (m :: * -&gt; *) a
       (i :: k).
(IxMonadTrans t, Monad m) =&gt;
m a -&gt; t m i i a
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ilift</span></a></span><span>
</span><span id="line-609"></span><span>              </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-610"></span><span>                    </span><span class="annot"><span class="annottext">EncoderDecoderTransformerHasEmbedScaling
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerWithoutEmbedScaling"><span class="hs-identifier hs-var">EncoderDecoderTransformerWithoutEmbedScaling</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-611"></span><span>                    </span><span class="annot"><span class="annottext">EncoderDecoderTransformerHasEmbedScaling
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerWithEmbedScaling"><span class="hs-identifier hs-var">EncoderDecoderTransformerWithEmbedScaling</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">forall other (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)]) (m :: * -&gt; *).
(Scalar other, MonadThrow m) =&gt;
Tensor gradient layout device dataType shape
-&gt; other -&gt; m (Tensor gradient layout device dataType shape)
</span><a href="Torch.GraduallyTyped.Tensor.MathOperations.Pointwise.html#mulScalar"><span class="hs-identifier hs-var">mulScalar</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679718385"><span class="hs-identifier hs-var">scaling</span></a></span><span>
</span><span id="line-612"></span><span>                </span><span class="hs-special">)</span><span>
</span><span id="line-613"></span><span>                </span><span class="annot"><span class="annottext">EncoderDecoderTransformerHasEmbedScaling
</span><a href="#local-6989586621679718389"><span class="hs-identifier hs-var">edtEmbedScaling</span></a></span><span>
</span><span id="line-614"></span><span>            </span><span class="annot"><span class="annottext">forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679718380"><span class="annot"><span class="annottext">Tensor requiresGradient' layout' device' dataType' shape'
</span><a href="#local-6989586621679718380"><span class="hs-identifier hs-var">input'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/hlan16hghcygrr1n0fqljpsq2978pxwg-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">encoder
</span><a href="#local-6989586621679718393"><span class="hs-identifier hs-var">edtEncoder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tensor requiresGradient' layout' device' dataType' shape'
</span><a href="#local-6989586621679718380"><span class="hs-identifier hs-var">input'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">pos
</span><a href="#local-6989586621679718387"><span class="hs-identifier hs-var">edtPos'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">attentionMask
</span><a href="#local-6989586621679718386"><span class="hs-identifier hs-var">edtAttentionMask'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-615"></span><span>            </span><span class="annot"><span class="annottext">forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679718379"><span class="annot"><span class="annottext">encoderOutput
</span><a href="#local-6989586621679718379"><span class="hs-identifier hs-var">encoderOutput</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall {k} (m :: k -&gt; k -&gt; * -&gt; *) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall encoderOutput.
encoderOutput -&gt; EncoderDecoderTransformerOutput' encoderOutput
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerOutput%27"><span class="hs-identifier hs-var">EncoderDecoderTransformerOutput'</span></a></span><span> </span><span class="annot"><span class="annottext">encoderOutput
</span><a href="#local-6989586621679718379"><span class="hs-identifier hs-var">encoderOutput</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-616"></span><span>
</span><span id="line-617"></span><span class="hs-comment">-- | 'HasForward' instance for encoder-decoder transformers with optional head.</span><span>
</span><span id="line-618"></span><span class="hs-comment">-- Use this instance for sequence generation once the encoder's output is available.</span><span>
</span><span id="line-619"></span><span class="hs-comment">--</span><span>
</span><span id="line-620"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-621"></span><span class="hs-comment">-- &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-622"></span><span class="hs-comment">-- &#9474; encoderOutput &#9474;  &#9474; decoderInput &#9474;  &#9474; decoderPos &#9474;  &#9474; decoderAttentionMask &#9474;  &#9474; crossAttentionMask &#9474;</span><span>
</span><span id="line-623"></span><span class="hs-comment">-- &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-624"></span><span class="hs-comment">--         &#9474;                  &#9474;                &#9474;                    &#9474;                        &#9474;</span><span>
</span><span id="line-625"></span><span class="hs-comment">--         &#9474;                  &#9660;                &#9474;                    &#9474;                        &#9474;</span><span>
</span><span id="line-626"></span><span class="hs-comment">--         &#9474;          edtSharedEmbedding       &#9474;                    &#9474;                        &#9474;</span><span>
</span><span id="line-627"></span><span class="hs-comment">--         &#9474;                  &#9660;                &#9474;                    &#9474;                        &#9474;</span><span>
</span><span id="line-628"></span><span class="hs-comment">--         &#9474;            (embedScaling)         &#9474;                    &#9474;                        &#9474;</span><span>
</span><span id="line-629"></span><span class="hs-comment">--         &#9474;                  &#9660;                &#9474;                    &#9474;                        &#9474;</span><span>
</span><span id="line-630"></span><span class="hs-comment">--         &#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9658;edtDecoder&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-631"></span><span class="hs-comment">--         &#9474;                  &#9474;</span><span>
</span><span id="line-632"></span><span class="hs-comment">--         &#9474;              (edtHead)</span><span>
</span><span id="line-633"></span><span class="hs-comment">--         &#9474;                  &#9474;</span><span>
</span><span id="line-634"></span><span class="hs-comment">--         &#9660;                  &#9660;</span><span>
</span><span id="line-635"></span><span class="hs-comment">-- &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-636"></span><span class="hs-comment">-- &#9474; encoderOutput &#9474;  &#9474; decoderOutput &#9474;</span><span>
</span><span id="line-637"></span><span class="hs-comment">-- &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-638"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-639"></span><span class="hs-keyword">instance</span><span>
</span><span id="line-640"></span><span>  </span><span id="local-6989586621679720416"><span id="local-6989586621679720417"><span id="local-6989586621679720418"><span id="local-6989586621679720419"><span id="local-6989586621679720420"><span id="local-6989586621679720421"><span id="local-6989586621679720422"><span id="local-6989586621679720423"><span id="local-6989586621679720424"><span id="local-6989586621679720425"><span id="local-6989586621679720426"><span id="local-6989586621679720427"><span id="local-6989586621679720428"><span id="local-6989586621679720429"><span id="local-6989586621679720430"><span id="local-6989586621679720431"><span id="local-6989586621679720432"><span id="local-6989586621679720433"><span id="local-6989586621679720434"><span id="local-6989586621679720435"><span id="local-6989586621679720436"><span id="local-6989586621679720437"><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-641"></span><span>      </span><span class="annot"><a href="#local-6989586621679720437"><span class="hs-identifier hs-type">sharedEmbedding</span></a></span><span>
</span><span id="line-642"></span><span>      </span><span class="annot"><a href="#local-6989586621679720436"><span class="hs-identifier hs-type">decoderInput</span></a></span><span>
</span><span id="line-643"></span><span>      </span><span class="annot"><a href="#local-6989586621679720435"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-644"></span><span>      </span><span class="annot"><a href="#local-6989586621679720434"><span class="hs-identifier hs-type">embeddingOutput'</span></a></span><span>
</span><span id="line-645"></span><span>      </span><span class="annot"><a href="#local-6989586621679720433"><span class="hs-identifier hs-type">embeddingGeneratorOutputDevice'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-646"></span><span>    </span><span class="annot"><a href="#local-6989586621679720434"><span class="hs-identifier hs-type">embeddingOutput'</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720432"><span class="hs-identifier hs-type">requiresGradient''</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720431"><span class="hs-identifier hs-type">layout''</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720430"><span class="hs-identifier hs-type">device''</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720429"><span class="hs-identifier hs-type">dataType''</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720428"><span class="hs-identifier hs-type">shape''</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-647"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-648"></span><span>      </span><span class="annot"><a href="#local-6989586621679720427"><span class="hs-identifier hs-type">decoder</span></a></span><span>
</span><span id="line-649"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="#local-6989586621679720434"><span class="hs-identifier hs-type">embeddingOutput'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-650"></span><span>        </span><span class="annot"><a href="#local-6989586621679720426"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-651"></span><span>        </span><span class="annot"><a href="#local-6989586621679720425"><span class="hs-identifier hs-type">decoderPos</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-652"></span><span>        </span><span class="annot"><a href="#local-6989586621679720424"><span class="hs-identifier hs-type">decoderAttentionMask</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-653"></span><span>        </span><span class="annot"><a href="#local-6989586621679720423"><span class="hs-identifier hs-type">crossAttentionMask</span></a></span><span>
</span><span id="line-654"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-655"></span><span>      </span><span class="annot"><a href="#local-6989586621679720433"><span class="hs-identifier hs-type">embeddingGeneratorOutputDevice'</span></a></span><span>
</span><span id="line-656"></span><span>      </span><span class="annot"><a href="#local-6989586621679720422"><span class="hs-identifier hs-type">decoderOutput</span></a></span><span>
</span><span id="line-657"></span><span>      </span><span class="annot"><a href="#local-6989586621679720421"><span class="hs-identifier hs-type">decoderGeneratorOutputDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-658"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-659"></span><span>      </span><span class="annot"><a href="#local-6989586621679720420"><span class="hs-identifier hs-type">head</span></a></span><span>
</span><span id="line-660"></span><span>      </span><span class="annot"><a href="#local-6989586621679720422"><span class="hs-identifier hs-type">decoderOutput</span></a></span><span>
</span><span id="line-661"></span><span>      </span><span class="annot"><a href="#local-6989586621679720421"><span class="hs-identifier hs-type">decoderGeneratorOutputDevice</span></a></span><span>
</span><span id="line-662"></span><span>      </span><span class="annot"><a href="#local-6989586621679720419"><span class="hs-identifier hs-type">headOutput</span></a></span><span>
</span><span id="line-663"></span><span>      </span><span class="annot"><a href="#local-6989586621679720418"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-664"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-665"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-666"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GEncoderDecoderTransformer"><span class="hs-identifier hs-type">GEncoderDecoderTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720417"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720416"><span class="hs-identifier hs-type">encoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720427"><span class="hs-identifier hs-type">decoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720437"><span class="hs-identifier hs-type">sharedEmbedding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720420"><span class="hs-identifier hs-type">head</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-667"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerGenerationInput"><span class="hs-identifier hs-type">EncoderDecoderTransformerGenerationInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720436"><span class="hs-identifier hs-type">decoderInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720426"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720425"><span class="hs-identifier hs-type">decoderPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720424"><span class="hs-identifier hs-type">decoderAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720423"><span class="hs-identifier hs-type">crossAttentionMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-668"></span><span>    </span><span class="annot"><a href="#local-6989586621679720435"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-669"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerOutput"><span class="hs-identifier hs-type">EncoderDecoderTransformerOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720419"><span class="hs-identifier hs-type">headOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720426"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-670"></span><span>    </span><span class="annot"><a href="#local-6989586621679720418"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-671"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-672"></span><span>  </span><span id="local-6989586621679718344"><span class="annot"><span class="annottext">forward :: forall (m :: * -&gt; *).
MonadThrow m =&gt;
GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; EncoderDecoderTransformerGenerationInput
     decoderInput
     encoderOutput
     decoderPos
     decoderAttentionMask
     crossAttentionMask
-&gt; Generator generatorDevice
-&gt; m (EncoderDecoderTransformerOutput headOutput encoderOutput,
      Generator generatorOutputDevice)
</span><a href="#local-6989586621679718344"><span class="hs-identifier hs-var hs-var hs-var hs-var">forward</span></a></span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GEncoderDecoderTransformer"><span class="hs-identifier hs-type">GEncoderDecoderTransformer</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679718338"><span id="local-6989586621679718339"><span id="local-6989586621679718340"><span id="local-6989586621679718341"><span id="local-6989586621679718342"><span id="local-6989586621679718343"><span class="annot"><span class="annottext">sharedEmbedding
decoder
head
encoder
SDim inputEmbedDim
EncoderDecoderTransformerHasEmbedScaling
edtEmbedScaling :: EncoderDecoderTransformerHasEmbedScaling
edtHead :: head
edtSharedEmbedding :: sharedEmbedding
edtDecoder :: decoder
edtEncoder :: encoder
edtInputEmbedDim :: SDim inputEmbedDim
edtEmbedScaling :: forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head.
GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; EncoderDecoderTransformerHasEmbedScaling
edtHead :: forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head.
GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; head
edtSharedEmbedding :: forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head.
GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; sharedEmbedding
edtDecoder :: forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head.
GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; decoder
edtEncoder :: forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head.
GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; encoder
edtInputEmbedDim :: forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head.
GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; SDim inputEmbedDim
</span><a href="#local-6989586621679718338"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerGenerationInput"><span class="hs-identifier hs-type">EncoderDecoderTransformerGenerationInput</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679718333"><span id="local-6989586621679718334"><span id="local-6989586621679718335"><span id="local-6989586621679718336"><span id="local-6989586621679718337"><span class="annot"><span class="annottext">decoderInput
encoderOutput
decoderPos
decoderAttentionMask
crossAttentionMask
edtGenerationCrossAttentionMask :: crossAttentionMask
edtGenerationDecoderAttentionMask :: decoderAttentionMask
edtGenerationDecoderPos :: decoderPos
edtGenerationEncoderOutput :: encoderOutput
edtGenerationDecoderInput :: decoderInput
edtGenerationCrossAttentionMask :: forall decoderInput encoderOutput decoderPos decoderAttentionMask
       crossAttentionMask.
EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; crossAttentionMask
edtGenerationDecoderAttentionMask :: forall decoderInput encoderOutput decoderPos decoderAttentionMask
       crossAttentionMask.
EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; decoderAttentionMask
edtGenerationDecoderPos :: forall decoderInput encoderOutput decoderPos decoderAttentionMask
       crossAttentionMask.
EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; decoderPos
edtGenerationEncoderOutput :: forall decoderInput encoderOutput decoderPos decoderAttentionMask
       crossAttentionMask.
EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; encoderOutput
edtGenerationDecoderInput :: forall decoderInput encoderOutput decoderPos decoderAttentionMask
       crossAttentionMask.
EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; decoderInput
</span><a href="#local-6989586621679718333"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-673"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679718332"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679718332"><span class="hs-identifier hs-var">scaling</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">sqrt</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsChecked a -&gt; a
</span><a href="Torch.GraduallyTyped.Prelude.html#forgetIsChecked"><span class="hs-identifier hs-var">forgetIsChecked</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall name size. Dim name size -&gt; size
</span><a href="Torch.GraduallyTyped.Shape.Type.html#dimSize"><span class="hs-identifier hs-var">dimSize</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall k (a :: k). SingKind k =&gt; Sing a -&gt; Demote k
</span><a href="../file:///nix/store/53aqqxvip62j3fkmz3ijr9pig0rgbrmg-singletons-lib-singletons-3.0.1-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">fromSing</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SDim inputEmbedDim
</span><a href="#local-6989586621679718343"><span class="hs-identifier hs-var">edtInputEmbedDim</span></a></span><span>
</span><span id="line-674"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) i j a. IxStateT m i j a -&gt; i -&gt; m (a, j)
</span><a href="../file:///nix/store/hlan16hghcygrr1n0fqljpsq2978pxwg-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">runIxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-675"></span><span>          </span><span class="annot"><span class="annottext">forall {k} (m :: k -&gt; k -&gt; * -&gt; *) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">decoderInput
</span><a href="#local-6989586621679718337"><span class="hs-identifier hs-var">edtGenerationDecoderInput</span></a></span><span>
</span><span id="line-676"></span><span>            </span><span class="annot"><span class="annottext">forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/hlan16hghcygrr1n0fqljpsq2978pxwg-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">sharedEmbedding
</span><a href="#local-6989586621679718340"><span class="hs-identifier hs-var">edtSharedEmbedding</span></a></span><span>
</span><span id="line-677"></span><span>            </span><span class="annot"><span class="annottext">forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (t :: (* -&gt; *) -&gt; k -&gt; k -&gt; * -&gt; *) (m :: * -&gt; *) a
       (i :: k).
(IxMonadTrans t, Monad m) =&gt;
m a -&gt; t m i i a
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ilift</span></a></span><span>
</span><span id="line-678"></span><span>              </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-679"></span><span>                    </span><span class="annot"><span class="annottext">EncoderDecoderTransformerHasEmbedScaling
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerWithoutEmbedScaling"><span class="hs-identifier hs-var">EncoderDecoderTransformerWithoutEmbedScaling</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-680"></span><span>                    </span><span class="annot"><span class="annottext">EncoderDecoderTransformerHasEmbedScaling
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerWithEmbedScaling"><span class="hs-identifier hs-var">EncoderDecoderTransformerWithEmbedScaling</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">forall other (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)]) (m :: * -&gt; *).
(Scalar other, MonadThrow m) =&gt;
Tensor gradient layout device dataType shape
-&gt; other -&gt; m (Tensor gradient layout device dataType shape)
</span><a href="Torch.GraduallyTyped.Tensor.MathOperations.Pointwise.html#mulScalar"><span class="hs-identifier hs-var">mulScalar</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679718332"><span class="hs-identifier hs-var">scaling</span></a></span><span>
</span><span id="line-681"></span><span>                </span><span class="hs-special">)</span><span>
</span><span id="line-682"></span><span>                </span><span class="annot"><span class="annottext">EncoderDecoderTransformerHasEmbedScaling
</span><a href="#local-6989586621679718338"><span class="hs-identifier hs-var">edtEmbedScaling</span></a></span><span>
</span><span id="line-683"></span><span>            </span><span class="annot"><span class="annottext">forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679718331"><span class="annot"><span class="annottext">Tensor requiresGradient'' layout'' device'' dataType'' shape''
</span><a href="#local-6989586621679718331"><span class="hs-identifier hs-var">decoderInput'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-684"></span><span>                     </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/hlan16hghcygrr1n0fqljpsq2978pxwg-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">decoder
</span><a href="#local-6989586621679718341"><span class="hs-identifier hs-var">edtDecoder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tensor requiresGradient'' layout'' device'' dataType'' shape''
</span><a href="#local-6989586621679718331"><span class="hs-identifier hs-var">decoderInput'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">encoderOutput
</span><a href="#local-6989586621679718336"><span class="hs-identifier hs-var">edtGenerationEncoderOutput</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">decoderPos
</span><a href="#local-6989586621679718335"><span class="hs-identifier hs-var">edtGenerationDecoderPos</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">decoderAttentionMask
</span><a href="#local-6989586621679718334"><span class="hs-identifier hs-var">edtGenerationDecoderAttentionMask</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">crossAttentionMask
</span><a href="#local-6989586621679718333"><span class="hs-identifier hs-var">edtGenerationCrossAttentionMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-685"></span><span>                 </span><span class="hs-special">)</span><span>
</span><span id="line-686"></span><span>            </span><span class="annot"><span class="annottext">forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/hlan16hghcygrr1n0fqljpsq2978pxwg-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">head
</span><a href="#local-6989586621679718339"><span class="hs-identifier hs-var">edtHead</span></a></span><span>
</span><span id="line-687"></span><span>            </span><span class="annot"><span class="annottext">forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679718330"><span class="annot"><span class="annottext">headOutput
</span><a href="#local-6989586621679718330"><span class="hs-identifier hs-var">decoderOutput</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall {k} (m :: k -&gt; k -&gt; * -&gt; *) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall decoderOutput encoderOutput.
decoderOutput
-&gt; encoderOutput
-&gt; EncoderDecoderTransformerOutput decoderOutput encoderOutput
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerOutput"><span class="hs-identifier hs-var">EncoderDecoderTransformerOutput</span></a></span><span> </span><span class="annot"><span class="annottext">headOutput
</span><a href="#local-6989586621679718330"><span class="hs-identifier hs-var">decoderOutput</span></a></span><span> </span><span class="annot"><span class="annottext">encoderOutput
</span><a href="#local-6989586621679718336"><span class="hs-identifier hs-var">edtGenerationEncoderOutput</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-688"></span><span>
</span><span id="line-689"></span><span class="hs-comment">-- | 'HasForward' instance for simplified encoder-decoder models.</span><span>
</span><span id="line-690"></span><span>
</span><span id="line-691"></span><span class="hs-comment">-- This instance shifts decoder inputs by one token to the right by adding</span><span>
</span><span id="line-692"></span><span class="hs-comment">-- a model-specific sequence initialization token at the beginning.</span><span>
</span><span id="line-693"></span><span class="hs-keyword">instance</span><span>
</span><span id="line-694"></span><span>  </span><span id="local-6989586621679720385"><span id="local-6989586621679720386"><span id="local-6989586621679720387"><span id="local-6989586621679720388"><span id="local-6989586621679720389"><span id="local-6989586621679720390"><span id="local-6989586621679720391"><span id="local-6989586621679720392"><span id="local-6989586621679720393"><span id="local-6989586621679720394"><span id="local-6989586621679720395"><span id="local-6989586621679720396"><span id="local-6989586621679720397"><span id="local-6989586621679720398"><span id="local-6989586621679720399"><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-695"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier hs-type">GSimplifiedEncoderDecoderTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720399"><span class="hs-identifier hs-type">model</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720398"><span class="hs-identifier hs-type">mkPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720397"><span class="hs-identifier hs-type">mkDecoderPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720396"><span class="hs-identifier hs-type">mkPaddingMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720395"><span class="hs-identifier hs-type">mkAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720394"><span class="hs-identifier hs-type">mkCrossAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720393"><span class="hs-identifier hs-type">mkDecoderAttentionMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-696"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerInput%27"><span class="hs-identifier hs-type">SimplifiedEncoderDecoderTransformerInput'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720392"><span class="hs-identifier hs-type">input</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-697"></span><span>      </span><span class="annot"><a href="#local-6989586621679720391"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-698"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerOutput%27"><span class="hs-identifier hs-type">SimplifiedEncoderDecoderTransformerOutput'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720390"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720389"><span class="hs-identifier hs-type">inputPaddingMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-699"></span><span>      </span><span class="annot"><a href="#local-6989586621679720388"><span class="hs-identifier hs-type">generatorDevice'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-700"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-701"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier hs-type">GSimplifiedEncoderDecoderTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720399"><span class="hs-identifier hs-type">model</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720398"><span class="hs-identifier hs-type">mkPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720397"><span class="hs-identifier hs-type">mkDecoderPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720396"><span class="hs-identifier hs-type">mkPaddingMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720395"><span class="hs-identifier hs-type">mkAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720394"><span class="hs-identifier hs-type">mkCrossAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720393"><span class="hs-identifier hs-type">mkDecoderAttentionMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-702"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerGenerationInput"><span class="hs-identifier hs-type">SimplifiedEncoderDecoderTransformerGenerationInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720387"><span class="hs-identifier hs-type">decoderInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720390"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720389"><span class="hs-identifier hs-type">inputPaddingMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-703"></span><span>      </span><span class="annot"><a href="#local-6989586621679720388"><span class="hs-identifier hs-type">generatorDevice'</span></a></span><span>
</span><span id="line-704"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerOutput"><span class="hs-identifier hs-type">SimplifiedEncoderDecoderTransformerOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720386"><span class="hs-identifier hs-type">decoderOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720390"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720387"><span class="hs-identifier hs-type">decoderInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720389"><span class="hs-identifier hs-type">inputPaddingMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-705"></span><span>      </span><span class="annot"><a href="#local-6989586621679720385"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-706"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-707"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-708"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier hs-type">GSimplifiedEncoderDecoderTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720399"><span class="hs-identifier hs-type">model</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720398"><span class="hs-identifier hs-type">mkPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720397"><span class="hs-identifier hs-type">mkDecoderPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720396"><span class="hs-identifier hs-type">mkPaddingMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720395"><span class="hs-identifier hs-type">mkAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720394"><span class="hs-identifier hs-type">mkCrossAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720393"><span class="hs-identifier hs-type">mkDecoderAttentionMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-709"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerInput"><span class="hs-identifier hs-type">SimplifiedEncoderDecoderTransformerInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720392"><span class="hs-identifier hs-type">input</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720387"><span class="hs-identifier hs-type">decoderInput</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-710"></span><span>    </span><span class="annot"><a href="#local-6989586621679720391"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-711"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerOutput"><span class="hs-identifier hs-type">SimplifiedEncoderDecoderTransformerOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720386"><span class="hs-identifier hs-type">decoderOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720390"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720387"><span class="hs-identifier hs-type">decoderInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720389"><span class="hs-identifier hs-type">inputPaddingMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-712"></span><span>    </span><span class="annot"><a href="#local-6989586621679720385"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-713"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-714"></span><span>  </span><span id="local-6989586621679718316"><span class="annot"><span class="annottext">forward :: forall (m :: * -&gt; *).
MonadThrow m =&gt;
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; Generator generatorDevice
-&gt; m (SimplifiedEncoderDecoderTransformerOutput
        decoderOutput encoderOutput decoderInput inputPaddingMask,
      Generator generatorOutputDevice)
</span><a href="#local-6989586621679718316"><span class="hs-identifier hs-var hs-var hs-var hs-var">forward</span></a></span></span><span> </span><span id="local-6989586621679718315"><span class="annot"><span class="annottext">GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
</span><a href="#local-6989586621679718315"><span class="hs-identifier hs-var">model</span></a></span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerInput"><span class="hs-identifier hs-type">SimplifiedEncoderDecoderTransformerInput</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679718313"><span id="local-6989586621679718314"><span class="annot"><span class="annottext">input
decoderInput
sedtDecoderInput :: decoderInput
sedtInput :: input
sedtDecoderInput :: forall input decoderInput.
SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; decoderInput
sedtInput :: forall input decoderInput.
SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; input
</span><a href="#local-6989586621679718313"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-715"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) i j a. IxStateT m i j a -&gt; i -&gt; m (a, j)
</span><a href="../file:///nix/store/hlan16hghcygrr1n0fqljpsq2978pxwg-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">runIxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-716"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/hlan16hghcygrr1n0fqljpsq2978pxwg-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
</span><a href="#local-6989586621679718315"><span class="hs-identifier hs-var">model</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerInput%27"><span class="hs-identifier hs-type">SimplifiedEncoderDecoderTransformerInput'</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">sedtInput' :: input
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtInput%27"><span class="hs-identifier hs-var">sedtInput'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">input
</span><a href="#local-6989586621679718314"><span class="hs-identifier hs-var">sedtInput</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-717"></span><span>        </span><span class="annot"><span class="annottext">forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerOutput%27"><span class="hs-identifier hs-type">SimplifiedEncoderDecoderTransformerOutput'</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679718311"><span id="local-6989586621679718312"><span class="annot"><span class="annottext">encoderOutput
inputPaddingMask
sedtInputPaddingMask' :: inputPaddingMask
sedtEncoderOutput' :: encoderOutput
sedtInputPaddingMask' :: forall encoderOutput inputPaddingMask.
SimplifiedEncoderDecoderTransformerOutput'
  encoderOutput inputPaddingMask
-&gt; inputPaddingMask
sedtEncoderOutput' :: forall encoderOutput inputPaddingMask.
SimplifiedEncoderDecoderTransformerOutput'
  encoderOutput inputPaddingMask
-&gt; encoderOutput
</span><a href="#local-6989586621679718311"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-718"></span><span>                 </span><span class="annot"><span class="annottext">forall {k} (m :: k -&gt; k -&gt; * -&gt; *) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-719"></span><span>                   </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerGenerationInput"><span class="hs-identifier hs-type">SimplifiedEncoderDecoderTransformerGenerationInput</span></a></span><span>
</span><span id="line-720"></span><span>                     </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">sedtGenerationDecoderInput :: decoderInput
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtGenerationDecoderInput"><span class="hs-identifier hs-var">sedtGenerationDecoderInput</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">decoderInput
</span><a href="#local-6989586621679718313"><span class="hs-identifier hs-var">sedtDecoderInput</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-721"></span><span>                       </span><span class="annot"><span class="annottext">sedtGenerationEncoderOutput :: encoderOutput
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtGenerationEncoderOutput"><span class="hs-identifier hs-var">sedtGenerationEncoderOutput</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">encoderOutput
</span><a href="#local-6989586621679718312"><span class="hs-identifier hs-var">sedtEncoderOutput'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-722"></span><span>                       </span><span class="annot"><span class="annottext">sedtGenerationInputPaddingMask :: inputPaddingMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtGenerationInputPaddingMask"><span class="hs-identifier hs-var">sedtGenerationInputPaddingMask</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">inputPaddingMask
</span><a href="#local-6989586621679718311"><span class="hs-identifier hs-var">sedtInputPaddingMask'</span></a></span><span>
</span><span id="line-723"></span><span>                     </span><span class="hs-special">}</span><span>
</span><span id="line-724"></span><span>             </span><span class="hs-special">)</span><span>
</span><span id="line-725"></span><span>        </span><span class="annot"><span class="annottext">forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/hlan16hghcygrr1n0fqljpsq2978pxwg-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
</span><a href="#local-6989586621679718315"><span class="hs-identifier hs-var">model</span></a></span><span>
</span><span id="line-726"></span><span>
</span><span id="line-727"></span><span class="hs-keyword">instance</span><span>
</span><span id="line-728"></span><span>  </span><span id="local-6989586621679720356"><span id="local-6989586621679720357"><span id="local-6989586621679720358"><span id="local-6989586621679720359"><span id="local-6989586621679720360"><span id="local-6989586621679720361"><span id="local-6989586621679720362"><span id="local-6989586621679720363"><span id="local-6989586621679720364"><span id="local-6989586621679720365"><span id="local-6989586621679720366"><span id="local-6989586621679720367"><span id="local-6989586621679720368"><span id="local-6989586621679720369"><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-729"></span><span>      </span><span class="annot"><a href="#local-6989586621679720369"><span class="hs-identifier hs-type">mkPaddingMask</span></a></span><span>
</span><span id="line-730"></span><span>      </span><span class="annot"><a href="#local-6989586621679720368"><span class="hs-identifier hs-type">input</span></a></span><span>
</span><span id="line-731"></span><span>      </span><span class="annot"><a href="#local-6989586621679720367"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-732"></span><span>      </span><span class="annot"><a href="#local-6989586621679720366"><span class="hs-identifier hs-type">inputPaddingMask</span></a></span><span>
</span><span id="line-733"></span><span>      </span><span class="annot"><a href="#local-6989586621679720367"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-734"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-735"></span><span>      </span><span class="annot"><a href="#local-6989586621679720365"><span class="hs-identifier hs-type">mkAttentionMask</span></a></span><span>
</span><span id="line-736"></span><span>      </span><span class="annot"><a href="#local-6989586621679720366"><span class="hs-identifier hs-type">inputPaddingMask</span></a></span><span>
</span><span id="line-737"></span><span>      </span><span class="annot"><a href="#local-6989586621679720367"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-738"></span><span>      </span><span class="annot"><a href="#local-6989586621679720364"><span class="hs-identifier hs-type">attentionMask</span></a></span><span>
</span><span id="line-739"></span><span>      </span><span class="annot"><a href="#local-6989586621679720367"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-740"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-741"></span><span>      </span><span class="annot"><a href="#local-6989586621679720363"><span class="hs-identifier hs-type">mkPos</span></a></span><span>
</span><span id="line-742"></span><span>      </span><span class="annot"><a href="#local-6989586621679720368"><span class="hs-identifier hs-type">input</span></a></span><span>
</span><span id="line-743"></span><span>      </span><span class="annot"><a href="#local-6989586621679720367"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-744"></span><span>      </span><span class="annot"><a href="#local-6989586621679720362"><span class="hs-identifier hs-type">pos</span></a></span><span>
</span><span id="line-745"></span><span>      </span><span class="annot"><a href="#local-6989586621679720367"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-746"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-747"></span><span>      </span><span class="annot"><a href="#local-6989586621679720361"><span class="hs-identifier hs-type">model</span></a></span><span>
</span><span id="line-748"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerInput%27"><span class="hs-identifier hs-type">EncoderDecoderTransformerInput'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720368"><span class="hs-identifier hs-type">input</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720362"><span class="hs-identifier hs-type">pos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720364"><span class="hs-identifier hs-type">attentionMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-749"></span><span>      </span><span class="annot"><a href="#local-6989586621679720367"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-750"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerOutput%27"><span class="hs-identifier hs-type">EncoderDecoderTransformerOutput'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720360"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-751"></span><span>      </span><span class="annot"><a href="#local-6989586621679720359"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-752"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-753"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-754"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier hs-type">GSimplifiedEncoderDecoderTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720361"><span class="hs-identifier hs-type">model</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720363"><span class="hs-identifier hs-type">mkPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720358"><span class="hs-identifier hs-type">mkDecoderPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720369"><span class="hs-identifier hs-type">mkPaddingMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720365"><span class="hs-identifier hs-type">mkAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720357"><span class="hs-identifier hs-type">mkCrossAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720356"><span class="hs-identifier hs-type">mkDecoderAttentionMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-755"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerInput%27"><span class="hs-identifier hs-type">SimplifiedEncoderDecoderTransformerInput'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720368"><span class="hs-identifier hs-type">input</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-756"></span><span>    </span><span class="annot"><a href="#local-6989586621679720367"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-757"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerOutput%27"><span class="hs-identifier hs-type">SimplifiedEncoderDecoderTransformerOutput'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720360"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720366"><span class="hs-identifier hs-type">inputPaddingMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-758"></span><span>    </span><span class="annot"><a href="#local-6989586621679720359"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-759"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-760"></span><span>  </span><span id="local-6989586621679718286"><span class="annot"><span class="annottext">forward :: forall (m :: * -&gt; *).
MonadThrow m =&gt;
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; SimplifiedEncoderDecoderTransformerInput' input
-&gt; Generator generatorDevice
-&gt; m (SimplifiedEncoderDecoderTransformerOutput'
        encoderOutput inputPaddingMask,
      Generator generatorOutputDevice)
</span><a href="#local-6989586621679718286"><span class="hs-identifier hs-var hs-var hs-var hs-var">forward</span></a></span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier hs-type">GSimplifiedEncoderDecoderTransformer</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679718277"><span id="local-6989586621679718278"><span id="local-6989586621679718279"><span id="local-6989586621679718280"><span id="local-6989586621679718281"><span id="local-6989586621679718282"><span id="local-6989586621679718283"><span id="local-6989586621679718284"><span id="local-6989586621679718285"><span class="annot"><span class="annottext">mkPaddingMask
mkAttentionMask
mkPos
model
mkDecoderPos
mkCrossAttentionMask
mkDecoderAttentionMask
ShiftRight Int
sedtMkDecoderAttentionMask :: mkDecoderAttentionMask
sedtMkCrossAttentionMask :: mkCrossAttentionMask
sedtMkAttentionMask :: mkAttentionMask
sedtMkPaddingMask :: mkPaddingMask
sedtMkDecoderPos :: mkDecoderPos
sedtMkPos :: mkPos
sedtPaddingMaskShift :: ShiftRight Int
sedtDecoderInputShift :: ShiftRight Int
sedtModel :: model
sedtMkDecoderAttentionMask :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; mkDecoderAttentionMask
sedtMkCrossAttentionMask :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; mkCrossAttentionMask
sedtMkAttentionMask :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; mkAttentionMask
sedtMkPaddingMask :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; mkPaddingMask
sedtMkDecoderPos :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; mkDecoderPos
sedtMkPos :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; mkPos
sedtPaddingMaskShift :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; ShiftRight Int
sedtDecoderInputShift :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; ShiftRight Int
sedtModel :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; model
</span><a href="#local-6989586621679718277"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerInput%27"><span class="hs-identifier hs-type">SimplifiedEncoderDecoderTransformerInput'</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679718276"><span class="annot"><span class="annottext">input
sedtInput' :: input
sedtInput' :: forall input.
SimplifiedEncoderDecoderTransformerInput' input -&gt; input
</span><a href="#local-6989586621679718276"><span class="hs-glyph hs-var hs-var">..</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-761"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) i j a. IxStateT m i j a -&gt; i -&gt; m (a, j)
</span><a href="../file:///nix/store/hlan16hghcygrr1n0fqljpsq2978pxwg-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">runIxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-762"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/hlan16hghcygrr1n0fqljpsq2978pxwg-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">mkPaddingMask
</span><a href="#local-6989586621679718280"><span class="hs-identifier hs-var">sedtMkPaddingMask</span></a></span><span> </span><span class="annot"><span class="annottext">input
</span><a href="#local-6989586621679718276"><span class="hs-identifier hs-var">sedtInput'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-763"></span><span>        </span><span class="annot"><span class="annottext">forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679718275"><span class="annot"><span class="annottext">inputPaddingMask
</span><a href="#local-6989586621679718275"><span class="hs-identifier hs-var">inputPaddingMask</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-764"></span><span>                 </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679718274"><span class="annot"><span class="annottext">pos :: IxStateT
  m (Generator generatorDevice) (Generator generatorDevice) pos
</span><a href="#local-6989586621679718274"><span class="hs-identifier hs-var hs-var">pos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/hlan16hghcygrr1n0fqljpsq2978pxwg-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">mkPos
</span><a href="#local-6989586621679718282"><span class="hs-identifier hs-var">sedtMkPos</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">input
</span><a href="#local-6989586621679718276"><span class="hs-identifier hs-var">sedtInput'</span></a></span><span>
</span><span id="line-765"></span><span>                     </span><span id="local-6989586621679718273"><span class="annot"><span class="annottext">attentionMask :: IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  attentionMask
</span><a href="#local-6989586621679718273"><span class="hs-identifier hs-var hs-var">attentionMask</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/hlan16hghcygrr1n0fqljpsq2978pxwg-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">mkAttentionMask
</span><a href="#local-6989586621679718279"><span class="hs-identifier hs-var">sedtMkAttentionMask</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">inputPaddingMask
</span><a href="#local-6989586621679718275"><span class="hs-identifier hs-var">inputPaddingMask</span></a></span><span>
</span><span id="line-766"></span><span>                  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall input pos attentionMask.
input
-&gt; pos
-&gt; attentionMask
-&gt; EncoderDecoderTransformerInput' input pos attentionMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerInput%27"><span class="hs-identifier hs-var">EncoderDecoderTransformerInput'</span></a></span><span>
</span><span id="line-767"></span><span>                       </span><span class="annot"><span class="annottext">input
</span><a href="#local-6989586621679718276"><span class="hs-identifier hs-var">sedtInput'</span></a></span><span>
</span><span id="line-768"></span><span>                       </span><span class="annot"><span class="annottext">forall {k1} {k2} (f :: k1 -&gt; k2 -&gt; * -&gt; *) a b (j :: k1)
       (k3 :: k2).
IxFunctor f =&gt;
(a -&gt; b) -&gt; f j k3 a -&gt; f j k3 b
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;$&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice) pos
</span><a href="#local-6989586621679718274"><span class="hs-identifier hs-var">pos</span></a></span><span>
</span><span id="line-769"></span><span>                       </span><span class="annot"><span class="annottext">forall {k1} (f :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  attentionMask
</span><a href="#local-6989586621679718273"><span class="hs-identifier hs-var">attentionMask</span></a></span><span>
</span><span id="line-770"></span><span>                       </span><span class="annot"><span class="annottext">forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/hlan16hghcygrr1n0fqljpsq2978pxwg-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">model
</span><a href="#local-6989586621679718285"><span class="hs-identifier hs-var">sedtModel</span></a></span><span>
</span><span id="line-771"></span><span>                       </span><span class="annot"><span class="annottext">forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerOutput%27"><span class="hs-identifier hs-type">EncoderDecoderTransformerOutput'</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679718272"><span class="annot"><span class="annottext">encoderOutput
edtEncoderOutput' :: encoderOutput
edtEncoderOutput' :: forall encoderOutput.
EncoderDecoderTransformerOutput' encoderOutput -&gt; encoderOutput
</span><a href="#local-6989586621679718272"><span class="hs-glyph hs-var hs-var">..</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-772"></span><span>                                </span><span class="annot"><span class="annottext">forall {k} (m :: k -&gt; k -&gt; * -&gt; *) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-773"></span><span>                                  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerOutput%27"><span class="hs-identifier hs-type">SimplifiedEncoderDecoderTransformerOutput'</span></a></span><span>
</span><span id="line-774"></span><span>                                    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">sedtEncoderOutput' :: encoderOutput
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtEncoderOutput%27"><span class="hs-identifier hs-var">sedtEncoderOutput'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">encoderOutput
</span><a href="#local-6989586621679718272"><span class="hs-identifier hs-var">edtEncoderOutput'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-775"></span><span>                                      </span><span class="annot"><span class="annottext">sedtInputPaddingMask' :: inputPaddingMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtInputPaddingMask%27"><span class="hs-identifier hs-var">sedtInputPaddingMask'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">inputPaddingMask
</span><a href="#local-6989586621679718275"><span class="hs-identifier hs-var">inputPaddingMask</span></a></span><span>
</span><span id="line-776"></span><span>                                    </span><span class="hs-special">}</span><span>
</span><span id="line-777"></span><span>                            </span><span class="hs-special">)</span><span>
</span><span id="line-778"></span><span>             </span><span class="hs-special">)</span><span>
</span><span id="line-779"></span><span>
</span><span id="line-780"></span><span class="hs-comment">-- | 'HasForward' instance for simplified encoder-decoder models.</span><span>
</span><span id="line-781"></span><span class="hs-comment">-- Use this instance for sequence generation once the encoder's output is available.</span><span>
</span><span id="line-782"></span><span>
</span><span id="line-783"></span><span class="hs-comment">-- This instance shifts decoder inputs by one token to the right by adding</span><span>
</span><span id="line-784"></span><span class="hs-comment">-- a model-specific sequence initialization token at the beginning.</span><span>
</span><span id="line-785"></span><span class="hs-keyword">instance</span><span>
</span><span id="line-786"></span><span>  </span><span id="local-6989586621679720299"><span id="local-6989586621679720300"><span id="local-6989586621679720301"><span id="local-6989586621679720302"><span id="local-6989586621679720303"><span id="local-6989586621679720304"><span id="local-6989586621679720305"><span id="local-6989586621679720306"><span id="local-6989586621679720307"><span id="local-6989586621679720308"><span id="local-6989586621679720309"><span id="local-6989586621679720310"><span id="local-6989586621679720311"><span id="local-6989586621679720312"><span id="local-6989586621679720313"><span id="local-6989586621679720314"><span id="local-6989586621679720315"><span id="local-6989586621679720316"><span id="local-6989586621679720317"><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-787"></span><span>      </span><span class="annot"><a href="#local-6989586621679720317"><span class="hs-identifier hs-type">mkPaddingMask</span></a></span><span>
</span><span id="line-788"></span><span>      </span><span class="annot"><a href="#local-6989586621679720316"><span class="hs-identifier hs-type">decoderInput</span></a></span><span>
</span><span id="line-789"></span><span>      </span><span class="annot"><a href="#local-6989586621679720315"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-790"></span><span>      </span><span class="annot"><a href="#local-6989586621679720314"><span class="hs-identifier hs-type">decoderInputPaddingMask</span></a></span><span>
</span><span id="line-791"></span><span>      </span><span class="annot"><a href="#local-6989586621679720315"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-792"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-793"></span><span>      </span><span class="annot"><a href="#local-6989586621679720313"><span class="hs-identifier hs-type">mkCrossAttentionMask</span></a></span><span>
</span><span id="line-794"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679720312"><span class="hs-identifier hs-type">rightShiftedDecoderInput</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679720311"><span class="hs-identifier hs-type">inputPaddingMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-795"></span><span>      </span><span class="annot"><a href="#local-6989586621679720315"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-796"></span><span>      </span><span class="annot"><a href="#local-6989586621679720310"><span class="hs-identifier hs-type">crossAttentionMask</span></a></span><span>
</span><span id="line-797"></span><span>      </span><span class="annot"><a href="#local-6989586621679720315"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-798"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-799"></span><span>      </span><span class="annot"><a href="#local-6989586621679720309"><span class="hs-identifier hs-type">mkDecoderAttentionMask</span></a></span><span>
</span><span id="line-800"></span><span>      </span><span class="annot"><a href="#local-6989586621679720308"><span class="hs-identifier hs-type">rightShiftedDecoderInputPaddingMask</span></a></span><span>
</span><span id="line-801"></span><span>      </span><span class="annot"><a href="#local-6989586621679720315"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-802"></span><span>      </span><span class="annot"><a href="#local-6989586621679720307"><span class="hs-identifier hs-type">decoderAttentionMask</span></a></span><span>
</span><span id="line-803"></span><span>      </span><span class="annot"><a href="#local-6989586621679720315"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-804"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-805"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ShiftRight"><span class="hs-identifier hs-type">ShiftRight</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-806"></span><span>      </span><span class="annot"><a href="#local-6989586621679720316"><span class="hs-identifier hs-type">decoderInput</span></a></span><span>
</span><span id="line-807"></span><span>      </span><span class="annot"><a href="#local-6989586621679720315"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-808"></span><span>      </span><span class="annot"><a href="#local-6989586621679720312"><span class="hs-identifier hs-type">rightShiftedDecoderInput</span></a></span><span>
</span><span id="line-809"></span><span>      </span><span class="annot"><a href="#local-6989586621679720315"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-810"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-811"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ShiftRight"><span class="hs-identifier hs-type">ShiftRight</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-812"></span><span>      </span><span class="annot"><a href="#local-6989586621679720314"><span class="hs-identifier hs-type">decoderInputPaddingMask</span></a></span><span>
</span><span id="line-813"></span><span>      </span><span class="annot"><a href="#local-6989586621679720315"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-814"></span><span>      </span><span class="annot"><a href="#local-6989586621679720308"><span class="hs-identifier hs-type">rightShiftedDecoderInputPaddingMask</span></a></span><span>
</span><span id="line-815"></span><span>      </span><span class="annot"><a href="#local-6989586621679720315"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-816"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-817"></span><span>      </span><span class="annot"><a href="#local-6989586621679720306"><span class="hs-identifier hs-type">mkDecoderPos</span></a></span><span>
</span><span id="line-818"></span><span>      </span><span class="annot"><a href="#local-6989586621679720312"><span class="hs-identifier hs-type">rightShiftedDecoderInput</span></a></span><span>
</span><span id="line-819"></span><span>      </span><span class="annot"><a href="#local-6989586621679720315"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-820"></span><span>      </span><span class="annot"><a href="#local-6989586621679720305"><span class="hs-identifier hs-type">decoderPos</span></a></span><span>
</span><span id="line-821"></span><span>      </span><span class="annot"><a href="#local-6989586621679720315"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-822"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-823"></span><span>      </span><span class="annot"><a href="#local-6989586621679720304"><span class="hs-identifier hs-type">model</span></a></span><span>
</span><span id="line-824"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerGenerationInput"><span class="hs-identifier hs-type">EncoderDecoderTransformerGenerationInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720312"><span class="hs-identifier hs-type">rightShiftedDecoderInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720303"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720305"><span class="hs-identifier hs-type">decoderPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720307"><span class="hs-identifier hs-type">decoderAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720310"><span class="hs-identifier hs-type">crossAttentionMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-825"></span><span>      </span><span class="annot"><a href="#local-6989586621679720315"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-826"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerOutput"><span class="hs-identifier hs-type">EncoderDecoderTransformerOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720302"><span class="hs-identifier hs-type">decoderOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720303"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-827"></span><span>      </span><span class="annot"><a href="#local-6989586621679720301"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-828"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-829"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-830"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier hs-type">GSimplifiedEncoderDecoderTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720304"><span class="hs-identifier hs-type">model</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720300"><span class="hs-identifier hs-type">mkPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720306"><span class="hs-identifier hs-type">mkDecoderPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720317"><span class="hs-identifier hs-type">mkPaddingMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720299"><span class="hs-identifier hs-type">mkAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720313"><span class="hs-identifier hs-type">mkCrossAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720309"><span class="hs-identifier hs-type">mkDecoderAttentionMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-831"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerGenerationInput"><span class="hs-identifier hs-type">SimplifiedEncoderDecoderTransformerGenerationInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720316"><span class="hs-identifier hs-type">decoderInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720303"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720311"><span class="hs-identifier hs-type">inputPaddingMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-832"></span><span>    </span><span class="annot"><a href="#local-6989586621679720315"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-833"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerOutput"><span class="hs-identifier hs-type">SimplifiedEncoderDecoderTransformerOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720302"><span class="hs-identifier hs-type">decoderOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720303"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720316"><span class="hs-identifier hs-type">decoderInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720311"><span class="hs-identifier hs-type">inputPaddingMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-834"></span><span>    </span><span class="annot"><a href="#local-6989586621679720301"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-835"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-836"></span><span>  </span><span id="local-6989586621679718234"><span class="annot"><span class="annottext">forward :: forall (m :: * -&gt; *).
MonadThrow m =&gt;
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; SimplifiedEncoderDecoderTransformerGenerationInput
     decoderInput encoderOutput inputPaddingMask
-&gt; Generator generatorDevice
-&gt; m (SimplifiedEncoderDecoderTransformerOutput
        decoderOutput encoderOutput decoderInput inputPaddingMask,
      Generator generatorOutputDevice)
</span><a href="#local-6989586621679718234"><span class="hs-identifier hs-var hs-var hs-var hs-var">forward</span></a></span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier hs-type">GSimplifiedEncoderDecoderTransformer</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679718225"><span id="local-6989586621679718226"><span id="local-6989586621679718227"><span id="local-6989586621679718228"><span id="local-6989586621679718229"><span id="local-6989586621679718230"><span id="local-6989586621679718231"><span id="local-6989586621679718232"><span id="local-6989586621679718233"><span class="annot"><span class="annottext">mkPaddingMask
mkCrossAttentionMask
mkDecoderAttentionMask
mkDecoderPos
model
mkPos
mkAttentionMask
ShiftRight Int
sedtMkDecoderAttentionMask :: mkDecoderAttentionMask
sedtMkCrossAttentionMask :: mkCrossAttentionMask
sedtMkAttentionMask :: mkAttentionMask
sedtMkPaddingMask :: mkPaddingMask
sedtMkDecoderPos :: mkDecoderPos
sedtMkPos :: mkPos
sedtPaddingMaskShift :: ShiftRight Int
sedtDecoderInputShift :: ShiftRight Int
sedtModel :: model
sedtMkDecoderAttentionMask :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; mkDecoderAttentionMask
sedtMkCrossAttentionMask :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; mkCrossAttentionMask
sedtMkAttentionMask :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; mkAttentionMask
sedtMkPaddingMask :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; mkPaddingMask
sedtMkDecoderPos :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; mkDecoderPos
sedtMkPos :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; mkPos
sedtPaddingMaskShift :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; ShiftRight Int
sedtDecoderInputShift :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; ShiftRight Int
sedtModel :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; model
</span><a href="#local-6989586621679718225"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerGenerationInput"><span class="hs-identifier hs-type">SimplifiedEncoderDecoderTransformerGenerationInput</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679718222"><span id="local-6989586621679718223"><span id="local-6989586621679718224"><span class="annot"><span class="annottext">decoderInput
inputPaddingMask
encoderOutput
sedtGenerationInputPaddingMask :: inputPaddingMask
sedtGenerationEncoderOutput :: encoderOutput
sedtGenerationDecoderInput :: decoderInput
sedtGenerationInputPaddingMask :: forall decoderInput encoderOutput inputPaddingMask.
SimplifiedEncoderDecoderTransformerGenerationInput
  decoderInput encoderOutput inputPaddingMask
-&gt; inputPaddingMask
sedtGenerationEncoderOutput :: forall decoderInput encoderOutput inputPaddingMask.
SimplifiedEncoderDecoderTransformerGenerationInput
  decoderInput encoderOutput inputPaddingMask
-&gt; encoderOutput
sedtGenerationDecoderInput :: forall decoderInput encoderOutput inputPaddingMask.
SimplifiedEncoderDecoderTransformerGenerationInput
  decoderInput encoderOutput inputPaddingMask
-&gt; decoderInput
</span><a href="#local-6989586621679718222"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-837"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) i j a. IxStateT m i j a -&gt; i -&gt; m (a, j)
</span><a href="../file:///nix/store/hlan16hghcygrr1n0fqljpsq2978pxwg-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">runIxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-838"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679718221"><span class="annot"><span class="annottext">rightShiftedDecoderInput :: IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  rightShiftedDecoderInput
</span><a href="#local-6989586621679718221"><span class="hs-identifier hs-var hs-var">rightShiftedDecoderInput</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/hlan16hghcygrr1n0fqljpsq2978pxwg-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">ShiftRight Int
</span><a href="#local-6989586621679718232"><span class="hs-identifier hs-var">sedtDecoderInputShift</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">decoderInput
</span><a href="#local-6989586621679718224"><span class="hs-identifier hs-var">sedtGenerationDecoderInput</span></a></span><span>
</span><span id="line-839"></span><span>            </span><span id="local-6989586621679718220"><span class="annot"><span class="annottext">rightShiftedDecoderInputPaddingMask :: IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  rightShiftedDecoderInputPaddingMask
</span><a href="#local-6989586621679718220"><span class="hs-identifier hs-var hs-var">rightShiftedDecoderInputPaddingMask</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-840"></span><span>              </span><span class="annot"><span class="annottext">forall {k} (m :: k -&gt; k -&gt; * -&gt; *) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">decoderInput
</span><a href="#local-6989586621679718224"><span class="hs-identifier hs-var">sedtGenerationDecoderInput</span></a></span><span>
</span><span id="line-841"></span><span>                </span><span class="annot"><span class="annottext">forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/hlan16hghcygrr1n0fqljpsq2978pxwg-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">mkPaddingMask
</span><a href="#local-6989586621679718228"><span class="hs-identifier hs-var">sedtMkPaddingMask</span></a></span><span>
</span><span id="line-842"></span><span>                </span><span class="annot"><span class="annottext">forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/hlan16hghcygrr1n0fqljpsq2978pxwg-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">ShiftRight Int
</span><a href="#local-6989586621679718231"><span class="hs-identifier hs-var">sedtPaddingMaskShift</span></a></span><span>
</span><span id="line-843"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span>
</span><span id="line-844"></span><span>              </span><span class="annot"><span class="annottext">forall {k1} {k2} (f :: k1 -&gt; k2 -&gt; * -&gt; *) a b (j :: k1)
       (k3 :: k2).
IxFunctor f =&gt;
(a -&gt; b) -&gt; f j k3 a -&gt; f j k3 b
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;$&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  rightShiftedDecoderInput
</span><a href="#local-6989586621679718221"><span class="hs-identifier hs-var">rightShiftedDecoderInput</span></a></span><span>
</span><span id="line-845"></span><span>              </span><span class="annot"><span class="annottext">forall {k1} (f :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  rightShiftedDecoderInputPaddingMask
</span><a href="#local-6989586621679718220"><span class="hs-identifier hs-var">rightShiftedDecoderInputPaddingMask</span></a></span><span>
</span><span id="line-846"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-847"></span><span>        </span><span class="annot"><span class="annottext">forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679718219"><span class="annot"><span class="annottext">rightShiftedDecoderInput
</span><a href="#local-6989586621679718219"><span class="hs-identifier hs-var">rightShiftedDecoderInput</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679718218"><span class="annot"><span class="annottext">rightShiftedDecoderInputPaddingMask
</span><a href="#local-6989586621679718218"><span class="hs-identifier hs-var">rightShiftedDecoderInputPaddingMask</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-848"></span><span>                 </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679718217"><span class="annot"><span class="annottext">decoderPos :: IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  decoderPos
</span><a href="#local-6989586621679718217"><span class="hs-identifier hs-var hs-var">decoderPos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/hlan16hghcygrr1n0fqljpsq2978pxwg-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">mkDecoderPos
</span><a href="#local-6989586621679718229"><span class="hs-identifier hs-var">sedtMkDecoderPos</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">rightShiftedDecoderInput
</span><a href="#local-6989586621679718219"><span class="hs-identifier hs-var">rightShiftedDecoderInput</span></a></span><span>
</span><span id="line-849"></span><span>                     </span><span id="local-6989586621679718216"><span class="annot"><span class="annottext">crossAttentionMask :: IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  crossAttentionMask
</span><a href="#local-6989586621679718216"><span class="hs-identifier hs-var hs-var">crossAttentionMask</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/hlan16hghcygrr1n0fqljpsq2978pxwg-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">mkCrossAttentionMask
</span><a href="#local-6989586621679718226"><span class="hs-identifier hs-var">sedtMkCrossAttentionMask</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">rightShiftedDecoderInput
</span><a href="#local-6989586621679718219"><span class="hs-identifier hs-var">rightShiftedDecoderInput</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">inputPaddingMask
</span><a href="#local-6989586621679718222"><span class="hs-identifier hs-var">sedtGenerationInputPaddingMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-850"></span><span>                     </span><span id="local-6989586621679718215"><span class="annot"><span class="annottext">decoderAttentionMask :: IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  decoderAttentionMask
</span><a href="#local-6989586621679718215"><span class="hs-identifier hs-var hs-var">decoderAttentionMask</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/hlan16hghcygrr1n0fqljpsq2978pxwg-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">mkDecoderAttentionMask
</span><a href="#local-6989586621679718225"><span class="hs-identifier hs-var">sedtMkDecoderAttentionMask</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">rightShiftedDecoderInputPaddingMask
</span><a href="#local-6989586621679718218"><span class="hs-identifier hs-var">rightShiftedDecoderInputPaddingMask</span></a></span><span>
</span><span id="line-851"></span><span>                  </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">forall decoderInput encoderOutput decoderPos decoderAttentionMask
       crossAttentionMask.
decoderInput
-&gt; encoderOutput
-&gt; decoderPos
-&gt; decoderAttentionMask
-&gt; crossAttentionMask
-&gt; EncoderDecoderTransformerGenerationInput
     decoderInput
     encoderOutput
     decoderPos
     decoderAttentionMask
     crossAttentionMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerGenerationInput"><span class="hs-identifier hs-var">EncoderDecoderTransformerGenerationInput</span></a></span><span>
</span><span id="line-852"></span><span>                         </span><span class="annot"><span class="annottext">rightShiftedDecoderInput
</span><a href="#local-6989586621679718219"><span class="hs-identifier hs-var">rightShiftedDecoderInput</span></a></span><span>
</span><span id="line-853"></span><span>                         </span><span class="annot"><span class="annottext">encoderOutput
</span><a href="#local-6989586621679718223"><span class="hs-identifier hs-var">sedtGenerationEncoderOutput</span></a></span><span>
</span><span id="line-854"></span><span>                         </span><span class="annot"><span class="annottext">forall {k1} {k2} (f :: k1 -&gt; k2 -&gt; * -&gt; *) a b (j :: k1)
       (k3 :: k2).
IxFunctor f =&gt;
(a -&gt; b) -&gt; f j k3 a -&gt; f j k3 b
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;$&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  decoderPos
</span><a href="#local-6989586621679718217"><span class="hs-identifier hs-var">decoderPos</span></a></span><span>
</span><span id="line-855"></span><span>                         </span><span class="annot"><span class="annottext">forall {k1} (f :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  decoderAttentionMask
</span><a href="#local-6989586621679718215"><span class="hs-identifier hs-var">decoderAttentionMask</span></a></span><span>
</span><span id="line-856"></span><span>                         </span><span class="annot"><span class="annottext">forall {k1} (f :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  crossAttentionMask
</span><a href="#local-6989586621679718216"><span class="hs-identifier hs-var">crossAttentionMask</span></a></span><span>
</span><span id="line-857"></span><span>                     </span><span class="hs-special">)</span><span>
</span><span id="line-858"></span><span>                       </span><span class="annot"><span class="annottext">forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/hlan16hghcygrr1n0fqljpsq2978pxwg-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">model
</span><a href="#local-6989586621679718233"><span class="hs-identifier hs-var">sedtModel</span></a></span><span>
</span><span id="line-859"></span><span>                       </span><span class="annot"><span class="annottext">forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerOutput"><span class="hs-identifier hs-type">EncoderDecoderTransformerOutput</span></a></span><span> </span><span id="local-6989586621679718214"><span class="annot"><span class="annottext">decoderOutput
</span><a href="#local-6989586621679718214"><span class="hs-identifier hs-var">decoderOutput</span></a></span></span><span> </span><span id="local-6989586621679718213"><span class="annot"><span class="annottext">encoderOutput
</span><a href="#local-6989586621679718213"><span class="hs-identifier hs-var">encoderOutput</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-860"></span><span>                                </span><span class="annot"><span class="annottext">forall {k} (m :: k -&gt; k -&gt; * -&gt; *) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall decoderOutput encoderOutput decoderInput inputPaddingMask.
decoderOutput
-&gt; encoderOutput
-&gt; decoderInput
-&gt; inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput
     decoderOutput encoderOutput decoderInput inputPaddingMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerOutput"><span class="hs-identifier hs-var">SimplifiedEncoderDecoderTransformerOutput</span></a></span><span> </span><span class="annot"><span class="annottext">decoderOutput
</span><a href="#local-6989586621679718214"><span class="hs-identifier hs-var">decoderOutput</span></a></span><span> </span><span class="annot"><span class="annottext">encoderOutput
</span><a href="#local-6989586621679718213"><span class="hs-identifier hs-var">encoderOutput</span></a></span><span> </span><span class="annot"><span class="annottext">decoderInput
</span><a href="#local-6989586621679718224"><span class="hs-identifier hs-var">sedtGenerationDecoderInput</span></a></span><span> </span><span class="annot"><span class="annottext">inputPaddingMask
</span><a href="#local-6989586621679718222"><span class="hs-identifier hs-var">sedtGenerationInputPaddingMask</span></a></span><span>
</span><span id="line-861"></span><span>                            </span><span class="hs-special">)</span><span>
</span><span id="line-862"></span><span>             </span><span class="hs-special">)</span><span>
</span><span id="line-863"></span><span>
</span><span id="line-864"></span><span class="hs-keyword">instance</span><span>
</span><span id="line-865"></span><span>  </span><span id="local-6989586621679720218"><span id="local-6989586621679720219"><span id="local-6989586621679720220"><span id="local-6989586621679720221"><span id="local-6989586621679720222"><span id="local-6989586621679720223"><span id="local-6989586621679720224"><span id="local-6989586621679720225"><span id="local-6989586621679720226"><span id="local-6989586621679720227"><span id="local-6989586621679720228"><span id="local-6989586621679720229"><span id="local-6989586621679720230"><span id="local-6989586621679720231"><span id="local-6989586621679720232"><span id="local-6989586621679720233"><span id="local-6989586621679720234"><span id="local-6989586621679720235"><span id="local-6989586621679720236"><span id="local-6989586621679720237"><span id="local-6989586621679720238"><span id="local-6989586621679720239"><span id="local-6989586621679720240"><span id="local-6989586621679720241"><span id="local-6989586621679720242"><span id="local-6989586621679720243"><span id="local-6989586621679720244"><span id="local-6989586621679720245"><span id="local-6989586621679720246"><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-866"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier hs-type">GSimplifiedEncoderDecoderTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720246"><span class="hs-identifier hs-type">model</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720245"><span class="hs-identifier hs-type">mkPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720244"><span class="hs-identifier hs-type">mkDecoderPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720243"><span class="hs-identifier hs-type">mkPaddingMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720242"><span class="hs-identifier hs-type">mkAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720241"><span class="hs-identifier hs-type">mkCrossAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720240"><span class="hs-identifier hs-type">mkDecoderAttentionMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-867"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerInput"><span class="hs-identifier hs-type">SimplifiedEncoderDecoderTransformerInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720239"><span class="hs-identifier hs-type">input</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720238"><span class="hs-identifier hs-type">decoderInput</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-868"></span><span>      </span><span class="annot"><a href="#local-6989586621679720237"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-869"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerOutput"><span class="hs-identifier hs-type">SimplifiedEncoderDecoderTransformerOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720236"><span class="hs-identifier hs-type">decoderOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720235"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720238"><span class="hs-identifier hs-type">decoderInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720234"><span class="hs-identifier hs-type">inputPaddingMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-870"></span><span>      </span><span class="annot"><a href="#local-6989586621679720233"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-871"></span><span>    </span><span class="annot"><a href="#local-6989586621679720238"><span class="hs-identifier hs-type">decoderInput</span></a></span><span>
</span><span id="line-872"></span><span>      </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span>
</span><span id="line-873"></span><span>          </span><span class="annot"><a href="#local-6989586621679720232"><span class="hs-identifier hs-type">targetGradient</span></a></span><span>
</span><span id="line-874"></span><span>          </span><span class="annot"><a href="#local-6989586621679720231"><span class="hs-identifier hs-type">targetLayout</span></a></span><span>
</span><span id="line-875"></span><span>          </span><span class="annot"><a href="#local-6989586621679720230"><span class="hs-identifier hs-type">targetDevice</span></a></span><span>
</span><span id="line-876"></span><span>          </span><span class="annot"><a href="#local-6989586621679720229"><span class="hs-identifier hs-type">targetDataType</span></a></span><span>
</span><span id="line-877"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Indexing.html#IndexDims"><span class="hs-identifier hs-type">IndexDims</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Indexing.html#Indices"><span class="hs-identifier hs-type">Indices</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Indexing.html#SliceAll"><span class="hs-identifier hs-type">SliceAll</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Indexing.html#SliceUpTo"><span class="hs-identifier hs-type">SliceUpTo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Index.Type.html#NegativeIndex"><span class="hs-identifier hs-type">NegativeIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679720228"><span class="hs-identifier hs-type">targetShape</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-878"></span><span>    </span><span class="annot"><a href="#local-6989586621679720236"><span class="hs-identifier hs-type">decoderOutput</span></a></span><span>
</span><span id="line-879"></span><span>      </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span>
</span><span id="line-880"></span><span>          </span><span class="annot"><a href="#local-6989586621679720227"><span class="hs-identifier hs-type">doGradient</span></a></span><span>
</span><span id="line-881"></span><span>          </span><span class="annot"><a href="#local-6989586621679720226"><span class="hs-identifier hs-type">doLayout</span></a></span><span>
</span><span id="line-882"></span><span>          </span><span class="annot"><a href="#local-6989586621679720225"><span class="hs-identifier hs-type">doDevice</span></a></span><span>
</span><span id="line-883"></span><span>          </span><span class="annot"><a href="#local-6989586621679720224"><span class="hs-identifier hs-type">doDataType</span></a></span><span>
</span><span id="line-884"></span><span>          </span><span class="annot"><a href="#local-6989586621679720223"><span class="hs-identifier hs-type">doShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-885"></span><span>    </span><span class="annot"><a href="#local-6989586621679720222"><span class="hs-identifier hs-type">logProbsShape</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.NonLinearActivation.html#SoftmaxF"><span class="hs-identifier hs-type">SoftmaxF</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679720223"><span class="hs-identifier hs-type">doShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-886"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html#Catch"><span class="hs-identifier hs-type">Catch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720222"><span class="hs-identifier hs-type">logProbsShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-887"></span><span>    </span><span class="annot"><a href="#local-6989586621679720221"><span class="hs-identifier hs-type">unsqueezedTargetShape</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#UnsqueezeF"><span class="hs-identifier hs-type">UnsqueezeF</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679720228"><span class="hs-identifier hs-type">targetShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-888"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html#Catch"><span class="hs-identifier hs-type">Catch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720221"><span class="hs-identifier hs-type">unsqueezedTargetShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-889"></span><span>    </span><span class="annot"><a href="#local-6989586621679720220"><span class="hs-identifier hs-type">gatheredLogProbsShape</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#GatherDimF"><span class="hs-identifier hs-type">GatherDimF</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679720221"><span class="hs-identifier hs-type">unsqueezedTargetShape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720222"><span class="hs-identifier hs-type">logProbsShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-890"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html#Catch"><span class="hs-identifier hs-type">Catch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720220"><span class="hs-identifier hs-type">gatheredLogProbsShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-891"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html#Catch"><span class="hs-identifier hs-type">Catch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679720229"><span class="hs-identifier hs-type">targetDataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#Int64"><span class="hs-identifier hs-type">Int64</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-892"></span><span>    </span><span class="annot"><a href="#local-6989586621679720219"><span class="hs-identifier hs-type">logLikelihoodShape</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#SqueezeDimF"><span class="hs-identifier hs-type">SqueezeDimF</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679720220"><span class="hs-identifier hs-type">gatheredLogProbsShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-893"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html#Catch"><span class="hs-identifier hs-type">Catch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720219"><span class="hs-identifier hs-type">logLikelihoodShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-894"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.MathOperations.Reduction.html#MeanAllCheckF"><span class="hs-identifier hs-type">MeanAllCheckF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720219"><span class="hs-identifier hs-type">logLikelihoodShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-895"></span><span>    </span><span class="annot"><a href="#local-6989586621679720218"><span class="hs-identifier hs-type">loss</span></a></span><span>
</span><span id="line-896"></span><span>      </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span>
</span><span id="line-897"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679720232"><span class="hs-identifier hs-type">targetGradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%7C%3E"><span class="hs-operator hs-type">&lt;|&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720227"><span class="hs-identifier hs-type">doGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-898"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679720231"><span class="hs-identifier hs-type">targetLayout</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720226"><span class="hs-identifier hs-type">doLayout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-899"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679720230"><span class="hs-identifier hs-type">targetDevice</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720225"><span class="hs-identifier hs-type">doDevice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-900"></span><span>          </span><span class="annot"><a href="#local-6989586621679720224"><span class="hs-identifier hs-type">doDataType</span></a></span><span>
</span><span id="line-901"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-902"></span><span>    </span><span class="annot"><a href="#local-6989586621679720233"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720237"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-903"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-904"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-905"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier hs-type">GSimplifiedEncoderDecoderTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720246"><span class="hs-identifier hs-type">model</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720245"><span class="hs-identifier hs-type">mkPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720244"><span class="hs-identifier hs-type">mkDecoderPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720243"><span class="hs-identifier hs-type">mkPaddingMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720242"><span class="hs-identifier hs-type">mkAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720241"><span class="hs-identifier hs-type">mkCrossAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720240"><span class="hs-identifier hs-type">mkDecoderAttentionMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-906"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerTrainingInput"><span class="hs-identifier hs-type">SimplifiedEncoderDecoderTransformerTrainingInput</span></a></span><span>
</span><span id="line-907"></span><span>        </span><span class="annot"><a href="#local-6989586621679720239"><span class="hs-identifier hs-type">input</span></a></span><span>
</span><span id="line-908"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720232"><span class="hs-identifier hs-type">targetGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720231"><span class="hs-identifier hs-type">targetLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720230"><span class="hs-identifier hs-type">targetDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720229"><span class="hs-identifier hs-type">targetDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720228"><span class="hs-identifier hs-type">targetShape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-909"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-910"></span><span>    </span><span class="annot"><a href="#local-6989586621679720237"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-911"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerTrainingOutput"><span class="hs-identifier hs-type">SimplifiedEncoderDecoderTransformerTrainingOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720218"><span class="hs-identifier hs-type">loss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-912"></span><span>    </span><span class="annot"><a href="#local-6989586621679720233"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-913"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-914"></span><span>  </span><span id="local-6989586621679718129"><span class="annot"><span class="annottext">forward :: forall (m :: * -&gt; *).
MonadThrow m =&gt;
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; SimplifiedEncoderDecoderTransformerTrainingInput
     input
     (Tensor
        targetGradient
        targetLayout
        targetDevice
        targetDataType
        targetShape)
-&gt; Generator generatorDevice
-&gt; m (SimplifiedEncoderDecoderTransformerTrainingOutput loss,
      Generator generatorOutputDevice)
</span><a href="#local-6989586621679718129"><span class="hs-identifier hs-var hs-var hs-var hs-var">forward</span></a></span></span><span> </span><span id="local-6989586621679718128"><span class="annot"><span class="annottext">GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
</span><a href="#local-6989586621679718128"><span class="hs-identifier hs-var">eot</span></a></span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerTrainingInput"><span class="hs-identifier hs-type">SimplifiedEncoderDecoderTransformerTrainingInput</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679718126"><span id="local-6989586621679718127"><span class="annot"><span class="annottext">input
Tensor
  targetGradient targetLayout targetDevice targetDataType targetShape
sedtTarget :: Tensor
  targetGradient targetLayout targetDevice targetDataType targetShape
sedtTrainingInput :: input
sedtTarget :: forall input target.
SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; target
sedtTrainingInput :: forall input target.
SimplifiedEncoderDecoderTransformerTrainingInput input target
-&gt; input
</span><a href="#local-6989586621679718126"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-915"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) i j a. IxStateT m i j a -&gt; i -&gt; m (a, j)
</span><a href="../file:///nix/store/hlan16hghcygrr1n0fqljpsq2978pxwg-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">runIxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-916"></span><span>      </span><span class="annot"><span class="annottext">forall {k} (m :: k -&gt; k -&gt; * -&gt; *) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  targetGradient targetLayout targetDevice targetDataType targetShape
</span><a href="#local-6989586621679718126"><span class="hs-identifier hs-var">sedtTarget</span></a></span><span>
</span><span id="line-917"></span><span>        </span><span class="annot"><span class="annottext">forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (t :: (* -&gt; *) -&gt; k -&gt; k -&gt; * -&gt; *) (m :: * -&gt; *) a
       (i :: k).
(IxMonadTrans t, Monad m) =&gt;
m a -&gt; t m i i a
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ilift</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (indices :: Indices [IndexType (Index Nat)])
       (requiresGradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)]) (m :: * -&gt; *).
MonadThrow m =&gt;
Tensor requiresGradient layout device dataType shape
-&gt; SIndices indices
-&gt; m (Tensor
        requiresGradient layout device dataType (IndexDims indices shape))
</span><a href="Torch.GraduallyTyped.Tensor.Indexing.html#%21"><span class="hs-operator hs-var">!</span></a></span><span> </span><span class="annot"><span class="annottext">forall (indexTypes :: [IndexType (Index Nat)]).
SList indexTypes -&gt; SIndices ('Indices indexTypes)
</span><a href="Torch.GraduallyTyped.Tensor.Indexing.html#SIndices"><span class="hs-identifier hs-var">SIndices</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. SIndexType 'SliceAll
</span><a href="Torch.GraduallyTyped.Tensor.Indexing.html#SSliceAll"><span class="hs-identifier hs-var">SSliceAll</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (a :: k) (as :: [k]).
Sing a -&gt; SList as -&gt; SList (a : as)
</span><a href="Torch.GraduallyTyped.Prelude.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">forall a (n :: a). Sing n -&gt; SIndexType ('SliceUpTo n)
</span><a href="Torch.GraduallyTyped.Tensor.Indexing.html#SSliceUpTo"><span class="hs-identifier hs-var">SSliceUpTo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (index1 :: Nat).
KnownNat index1 =&gt;
SIndex ('NegativeIndex index1)
</span><a href="Torch.GraduallyTyped.Index.Type.html#SNegativeIndex"><span class="hs-identifier hs-var">SNegativeIndex</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall {k} (a :: k) (as :: [k]).
Sing a -&gt; SList as -&gt; SList (a : as)
</span><a href="Torch.GraduallyTyped.Prelude.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. SList '[]
</span><a href="../file:///nix/store/cmxygbwkg9vwm5iizgff5i2x5awqcjjn-singletons-base-lib-singletons-base-3.1-haddock-doc/share/doc/singletons-base/html/src"><span class="hs-identifier hs-var">SNil</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-918"></span><span>        </span><span class="annot"><span class="annottext">forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679718121"><span class="annot"><span class="annottext">Tensor
  targetGradient
  targetLayout
  targetDevice
  targetDataType
  (IndexDims
     ('Indices '[ 'SliceAll, 'SliceUpTo ('NegativeIndex 1)])
     targetShape)
</span><a href="#local-6989586621679718121"><span class="hs-identifier hs-var">sedtDecoderInput</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/hlan16hghcygrr1n0fqljpsq2978pxwg-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
</span><a href="#local-6989586621679718128"><span class="hs-identifier hs-var">eot</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerInput"><span class="hs-identifier hs-type">SimplifiedEncoderDecoderTransformerInput</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">sedtInput :: input
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtInput"><span class="hs-identifier hs-var">sedtInput</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">input
</span><a href="#local-6989586621679718127"><span class="hs-identifier hs-var">sedtTrainingInput</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Tensor
  targetGradient
  targetLayout
  targetDevice
  targetDataType
  (IndexDims
     ('Indices '[ 'SliceAll, 'SliceUpTo ('NegativeIndex 1)])
     targetShape)
sedtDecoderInput :: Tensor
  targetGradient
  targetLayout
  targetDevice
  targetDataType
  (IndexDims
     ('Indices '[ 'SliceAll, 'SliceUpTo ('NegativeIndex 1)])
     targetShape)
sedtDecoderInput :: Tensor
  targetGradient
  targetLayout
  targetDevice
  targetDataType
  (IndexDims
     ('Indices '[ 'SliceAll, 'SliceUpTo ('NegativeIndex 1)])
     targetShape)
</span><a href="#local-6989586621679718121"><span class="hs-identifier hs-var hs-var">sedtDecoderInput</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-919"></span><span>        </span><span class="annot"><span class="annottext">forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (m :: k -&gt; k -&gt; * -&gt; *) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall decoderOutput encoderOutput decoderInput inputPaddingMask.
SimplifiedEncoderDecoderTransformerOutput
  decoderOutput encoderOutput decoderInput inputPaddingMask
-&gt; decoderOutput
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtDecoderOutput"><span class="hs-identifier hs-var">sedtDecoderOutput</span></a></span><span>
</span><span id="line-920"></span><span>        </span><span class="annot"><span class="annottext">forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (t :: (* -&gt; *) -&gt; k -&gt; k -&gt; * -&gt; *) (m :: * -&gt; *) a
       (i :: k).
(IxMonadTrans t, Monad m) =&gt;
m a -&gt; t m i i a
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ilift</span></a></span><span>
</span><span id="line-921"></span><span>          </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679718120"><span class="annot"><span class="annottext">Tensor doGradient doLayout doDevice doDataType doShape
</span><a href="#local-6989586621679718120"><span class="hs-identifier hs-var">logits</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-922"></span><span>                </span><span id="local-6989586621679718119"><span class="annot"><span class="annottext">Tensor
  doGradient
  doLayout
  doDevice
  doDataType
  (SoftmaxF ('SelectDim ('ByIndex 2)) doShape)
</span><a href="#local-6989586621679718119"><span class="hs-identifier hs-var">logProbs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (selectDim :: SelectDim (By Symbol Nat))
       (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)]) (m :: * -&gt; *).
(MonadThrow m, shape' ~ SoftmaxF selectDim shape, Catch shape') =&gt;
SSelectDim selectDim
-&gt; Tensor gradient layout device dataType shape
-&gt; m (Tensor gradient layout device dataType shape')
</span><a href="Torch.GraduallyTyped.NN.Functional.NonLinearActivation.html#logSoftmax"><span class="hs-identifier hs-var">logSoftmax</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (by :: By Symbol Nat). SBy by -&gt; SSelectDim ('SelectDim by)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SSelectDim"><span class="hs-identifier hs-var">SSelectDim</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (index :: Nat). KnownNat index =&gt; SBy ('ByIndex index)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SByIndex"><span class="hs-identifier hs-var">SByIndex</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Tensor doGradient doLayout doDevice doDataType doShape
</span><a href="#local-6989586621679718120"><span class="hs-identifier hs-var">logits</span></a></span><span>
</span><span id="line-923"></span><span>                </span><span id="local-6989586621679718116"><span class="annot"><span class="annottext">Tensor
  targetGradient
  targetLayout
  targetDevice
  targetDataType
  unsqueezedTargetShape
</span><a href="#local-6989586621679718116"><span class="hs-identifier hs-var">target'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (selectDim :: SelectDim (By Symbol Nat))
       (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)]) (m :: * -&gt; *).
(shape' ~ UnsqueezeF selectDim shape, Catch shape',
 MonadThrow m) =&gt;
SSelectDim selectDim
-&gt; Tensor gradient layout device dataType shape
-&gt; m (Tensor gradient layout device dataType shape')
</span><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#sUnsqueeze"><span class="hs-identifier hs-var">sUnsqueeze</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (by :: By Symbol Nat). SBy by -&gt; SSelectDim ('SelectDim by)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SSelectDim"><span class="hs-identifier hs-var">SSelectDim</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (index :: Nat). KnownNat index =&gt; SBy ('ByIndex index)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SByIndex"><span class="hs-identifier hs-var">SByIndex</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Tensor
  targetGradient targetLayout targetDevice targetDataType targetShape
</span><a href="#local-6989586621679718126"><span class="hs-identifier hs-var">sedtTarget</span></a></span><span>
</span><span id="line-924"></span><span>                </span><span id="local-6989586621679718115"><span class="annot"><span class="annottext">Tensor
  (Or (Gradient RequiresGradient) targetGradient doGradient)
  (Unify (Layout LayoutType) targetLayout doLayout)
  (Unify (Device (DeviceType Nat)) targetDevice doDevice)
  doDataType
  (GatherDimF
     ('SelectDim ('ByIndex 2))
     unsqueezedTargetShape
     (SoftmaxF ('SelectDim ('ByIndex 2)) doShape))
</span><a href="#local-6989586621679718115"><span class="hs-identifier hs-var">gatheredLogProbs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (selectDim :: SelectDim (By Symbol Nat))
       (indexGradient :: Gradient RequiresGradient)
       (inputGradient :: Gradient RequiresGradient)
       (indexLayout :: Layout LayoutType)
       (inputLayout :: Layout LayoutType)
       (indexDevice :: Device (DeviceType Nat))
       (inputDevice :: Device (DeviceType Nat))
       (indexDataType :: DataType DType) (inputDataType :: DataType DType)
       (indexShape :: Shape [Dim (Name Symbol) (Size Nat)])
       (inputShape :: Shape [Dim (Name Symbol) (Size Nat)])
       (outputShape :: Shape [Dim (Name Symbol) (Size Nat)])
       (m :: * -&gt; *).
(MonadThrow m,
 outputShape ~ GatherDimF selectDim indexShape inputShape,
 Catch outputShape, Catch (indexDataType &lt;+&gt; 'DataType 'Int64)) =&gt;
SSelectDim selectDim
-&gt; Tensor
     indexGradient indexLayout indexDevice indexDataType indexShape
-&gt; Tensor
     inputGradient inputLayout inputDevice inputDataType inputShape
-&gt; m (Tensor
        (indexGradient &lt;|&gt; inputGradient)
        (indexLayout &lt;+&gt; inputLayout)
        (indexDevice &lt;+&gt; inputDevice)
        inputDataType
        outputShape)
</span><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#sGatherDim"><span class="hs-identifier hs-var">sGatherDim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (by :: By Symbol Nat). SBy by -&gt; SSelectDim ('SelectDim by)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SSelectDim"><span class="hs-identifier hs-var">SSelectDim</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (index :: Nat). KnownNat index =&gt; SBy ('ByIndex index)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SByIndex"><span class="hs-identifier hs-var">SByIndex</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Tensor
  targetGradient
  targetLayout
  targetDevice
  targetDataType
  unsqueezedTargetShape
</span><a href="#local-6989586621679718116"><span class="hs-identifier hs-var">target'</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  doGradient
  doLayout
  doDevice
  doDataType
  (SoftmaxF ('SelectDim ('ByIndex 2)) doShape)
</span><a href="#local-6989586621679718119"><span class="hs-identifier hs-var">logProbs</span></a></span><span>
</span><span id="line-925"></span><span>                </span><span id="local-6989586621679718114"><span class="annot"><span class="annottext">Tensor
  (Or (Gradient RequiresGradient) targetGradient doGradient)
  (Unify (Layout LayoutType) targetLayout doLayout)
  (Unify (Device (DeviceType Nat)) targetDevice doDevice)
  doDataType
  (SqueezeDimF
     ('SelectDim ('ByIndex 2))
     (GatherDimF
        ('SelectDim ('ByIndex 2))
        unsqueezedTargetShape
        (SoftmaxF ('SelectDim ('ByIndex 2)) doShape)))
</span><a href="#local-6989586621679718114"><span class="hs-identifier hs-var">logLikelihood</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (selectDim :: SelectDim (By Symbol Nat))
       (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)]) (m :: * -&gt; *).
(MonadThrow m, shape' ~ SqueezeDimF selectDim shape,
 Catch shape') =&gt;
SSelectDim selectDim
-&gt; Tensor gradient layout device dataType shape
-&gt; m (Tensor gradient layout device dataType shape')
</span><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#sSqueezeDim"><span class="hs-identifier hs-var">sSqueezeDim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (by :: By Symbol Nat). SBy by -&gt; SSelectDim ('SelectDim by)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SSelectDim"><span class="hs-identifier hs-var">SSelectDim</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (index :: Nat). KnownNat index =&gt; SBy ('ByIndex index)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SByIndex"><span class="hs-identifier hs-var">SByIndex</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Tensor
  (Or (Gradient RequiresGradient) targetGradient doGradient)
  (Unify (Layout LayoutType) targetLayout doLayout)
  (Unify (Device (DeviceType Nat)) targetDevice doDevice)
  doDataType
  (GatherDimF
     ('SelectDim ('ByIndex 2))
     unsqueezedTargetShape
     (SoftmaxF ('SelectDim ('ByIndex 2)) doShape))
</span><a href="#local-6989586621679718115"><span class="hs-identifier hs-var">gatheredLogProbs</span></a></span><span>
</span><span id="line-926"></span><span>                </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">negate</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)]).
MeanAllCheckF shape =&gt;
Tensor gradient layout device dataType shape
-&gt; Tensor gradient layout device dataType ('Shape '[])
</span><a href="Torch.GraduallyTyped.Tensor.MathOperations.Reduction.html#meanAll"><span class="hs-identifier hs-var">meanAll</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  (Or (Gradient RequiresGradient) targetGradient doGradient)
  (Unify (Layout LayoutType) targetLayout doLayout)
  (Unify (Device (DeviceType Nat)) targetDevice doDevice)
  doDataType
  (SqueezeDimF
     ('SelectDim ('ByIndex 2))
     (GatherDimF
        ('SelectDim ('ByIndex 2))
        unsqueezedTargetShape
        (SoftmaxF ('SelectDim ('ByIndex 2)) doShape)))
</span><a href="#local-6989586621679718114"><span class="hs-identifier hs-var">logLikelihood</span></a></span><span>
</span><span id="line-927"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-928"></span><span>        </span><span class="annot"><span class="annottext">forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (m :: k -&gt; k -&gt; * -&gt; *) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall loss.
loss -&gt; SimplifiedEncoderDecoderTransformerTrainingOutput loss
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerTrainingOutput"><span class="hs-identifier hs-var">SimplifiedEncoderDecoderTransformerTrainingOutput</span></a></span><span>
</span><span id="line-929"></span></pre></body></html>