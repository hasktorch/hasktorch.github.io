<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE PartialTypeSignatures #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE PatternSynonyms #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# OPTIONS_GHC -v2 #-}</span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.BERT</span><span>
</span><span id="line-9"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.BERT.Common.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.BERT.Common</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>    </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.BERT.BaseUncased.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.BERT.BaseUncased</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.BERT.html#testForwardBERTBaseUncased"><span class="hs-identifier">testForwardBERTBaseUncased</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span class="hs-keyword">where</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">evalStateT</span></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">Data.Singletons.Prelude.List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">SList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">SNil</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/d9rc2h31drxy3swyhm4cw2wjq41c1s43-HUnit-approx-lib-HUnit-approx-1.1.1.1-haddock-doc/share/doc/HUnit-approx/html/src"><span class="hs-identifier">Test.HUnit.Approx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/d9rc2h31drxy3swyhm4cw2wjq41c1s43-HUnit-approx-lib-HUnit-approx-1.1.1.1-haddock-doc/share/doc/HUnit-approx/html/src"><span class="hs-identifier">assertApproxEqual</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///nix/store/dlcs5qms427bs47cbn98gjkr7lmzcmdh-tokenizers-lib-tokenizers-0.1.0.0-haddock-doc/share/doc/tokenizers/html/src"><span class="hs-identifier">Tokenizers</span></a></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html"><span class="hs-identifier">Torch.GraduallyTyped.DType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#SDType"><span class="hs-identifier">SDType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#SDataType"><span class="hs-identifier">SDataType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html"><span class="hs-identifier">Torch.GraduallyTyped.Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#SDevice"><span class="hs-identifier">SDevice</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#SDeviceType"><span class="hs-identifier">SDeviceType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html"><span class="hs-identifier">Torch.GraduallyTyped.Layout</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#SLayout"><span class="hs-identifier">SLayout</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#SLayoutType"><span class="hs-identifier">SLayoutType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Class</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier">HasForward</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier">HasStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier">fromStateDict</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#stateDictFromFile"><span class="hs-identifier">stateDictFromFile</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.BERT.BaseUncased.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.BERT.BaseUncased</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.BERT.Common.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.BERT.Common</span></a></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.GEncoderOnly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EncoderOnlyTransformerInput"><span class="hs-identifier">EncoderOnlyTransformerInput</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EncoderOnlyTransformerOutput"><span class="hs-identifier">EncoderOnlyTransformerOutput</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#STransformerHead"><span class="hs-identifier">STransformerHead</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SWithLMHead"><span class="hs-identifier">SWithLMHead</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#mkTransformerAttentionMask"><span class="hs-identifier">mkTransformerAttentionMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Random.html"><span class="hs-identifier">Torch.GraduallyTyped.Random</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Random.html#sMkGenerator"><span class="hs-identifier">sMkGenerator</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html"><span class="hs-identifier">Torch.GraduallyTyped.RequiresGradient</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#SGradient"><span class="hs-identifier">SGradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#SRequiresGradient"><span class="hs-identifier">SRequiresGradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.Shape.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SName"><span class="hs-identifier">SName</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SShape"><span class="hs-identifier">SShape</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SSize"><span class="hs-identifier">SSize</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%26%3A"><span class="hs-operator">(:&amp;:)</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator">(:|:)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Creation.html"><span class="hs-identifier">Torch.GraduallyTyped.Tensor.Creation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Creation.html#sArangeNaturals"><span class="hs-identifier">sArangeNaturals</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Creation.html#sZeros"><span class="hs-identifier">sZeros</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.Tensor.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier">Tensor</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#TensorSpec"><span class="hs-identifier">TensorSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../hasktorch/html/src"><span class="hs-identifier">Torch.Tensor</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Tensor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../hasktorch/html/src"><span class="hs-identifier">Tensor</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../hasktorch/html/src"><span class="hs-identifier">asValue</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span id="local-6989586621679582685"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.BERT.html#withTokenizer"><span class="hs-identifier hs-type">withTokenizer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/dlcs5qms427bs47cbn98gjkr7lmzcmdh-tokenizers-lib-tokenizers-0.1.0.0-haddock-doc/share/doc/tokenizers/html/src"><span class="hs-identifier hs-type">Tokenizers.Tokenizer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679582685"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679582685"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-35"></span><span id="withTokenizer"><span class="annot"><span class="annottext">withTokenizer :: (Tokenizer -&gt; IO a) -&gt; IO a
</span><a href="Torch.GraduallyTyped.NN.Transformer.BERT.html#withTokenizer"><span class="hs-identifier hs-var hs-var">withTokenizer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-36"></span><span>  </span><span class="annot"><span class="annottext">FilePath -&gt; (Tokenizer -&gt; IO a) -&gt; IO a
forall a. FilePath -&gt; (Tokenizer -&gt; IO a) -&gt; IO a
</span><a href="../file:///nix/store/dlcs5qms427bs47cbn98gjkr7lmzcmdh-tokenizers-lib-tokenizers-0.1.0.0-haddock-doc/share/doc/tokenizers/html/src"><span class="hs-identifier hs-var">Tokenizers.withTokenizerFromConfigFile</span></a></span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;/tmp/bert-base-uncased-tokenizer.json&quot;</span></span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.BERT.html#testForwardBERTBaseUncased"><span class="hs-identifier hs-type">testForwardBERTBaseUncased</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span id="testForwardBERTBaseUncased"><span class="annot"><span class="annottext">testForwardBERTBaseUncased :: IO ()
</span><a href="Torch.GraduallyTyped.NN.Transformer.BERT.html#testForwardBERTBaseUncased"><span class="hs-identifier hs-var hs-var">testForwardBERTBaseUncased</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-keyword">do</span><span>
</span><span id="line-42"></span><span>    </span><span id="local-6989586621679582555"><span class="annot"><span class="annottext">StateDict
</span><a href="#local-6989586621679582555"><span class="hs-identifier hs-var">stateDict</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO StateDict
</span><a href="Torch.GraduallyTyped.NN.Class.html#stateDictFromFile"><span class="hs-identifier hs-var">stateDictFromFile</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;/tmp/bert-base-uncased-state-dict.pt&quot;</span></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679582554"><span class="annot"><span class="annottext">device :: SDevice ('Device ('CUDA 0))
</span><a href="#local-6989586621679582554"><span class="hs-identifier hs-var hs-var">device</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDeviceType ('CUDA 0) -&gt; SDevice ('Device ('CUDA 0))
forall (deviceType :: DeviceType Nat).
SDeviceType deviceType -&gt; SDevice ('Device deviceType)
</span><a href="Torch.GraduallyTyped.Device.html#SDevice"><span class="hs-identifier hs-var">SDevice</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KnownNat 0 =&gt; SDeviceType ('CUDA 0)
forall (deviceId :: Nat).
KnownNat deviceId =&gt;
SDeviceType ('CUDA deviceId)
</span><a href="Torch.GraduallyTyped.Device.html#SCUDA"><span class="hs-identifier hs-var">SCUDA</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679582551"><span class="annot"><span class="annottext">spec :: ModelSpec
  (BERTBaseUncased
     'WithLMHead ('Gradient 'WithGradient) ('Device ('CUDA 0)))
</span><a href="#local-6989586621679582551"><span class="hs-identifier hs-var hs-var">spec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STransformerHead 'WithLMHead
-&gt; SGradient ('Gradient 'WithGradient)
-&gt; SDevice ('Device ('CUDA 0))
-&gt; ModelSpec
     (BERTBaseUncased
        'WithLMHead ('Gradient 'WithGradient) ('Device ('CUDA 0)))
forall (transformerHead :: TransformerHead)
       (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)).
STransformerHead transformerHead
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; ModelSpec (BERTBaseUncased transformerHead gradient device)
</span><a href="Torch.GraduallyTyped.NN.Transformer.BERT.BaseUncased.html#bertBaseUnchasedSpec"><span class="hs-identifier hs-var">bertBaseUnchasedSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerHead 'WithLMHead
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SWithLMHead"><span class="hs-identifier hs-var">SWithLMHead</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SRequiresGradient 'WithGradient
-&gt; SGradient ('Gradient 'WithGradient)
forall (requiresGradient :: RequiresGradient).
SRequiresGradient requiresGradient
-&gt; SGradient ('Gradient requiresGradient)
</span><a href="Torch.GraduallyTyped.RequiresGradient.html#SGradient"><span class="hs-identifier hs-var">SGradient</span></a></span><span> </span><span class="annot"><span class="annottext">SRequiresGradient 'WithGradient
</span><a href="Torch.GraduallyTyped.RequiresGradient.html#SWithGradient"><span class="hs-identifier hs-var">SWithGradient</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDevice ('Device ('CUDA 0))
</span><a href="#local-6989586621679582554"><span class="hs-identifier hs-var">device</span></a></span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.BERT.Common.html#GBERTModel"><span class="hs-identifier hs-type">GBERTModel</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679582546"><span class="annot"><span class="annottext">GEncoderOnlyTransformer
  ('Dim ('Name &quot;*&quot;) ('Size 768))
  (NamedModel
     (GTransformer
        (NamedModel
           (Embedding
              ('Gradient 'WithGradient)
              ('Layout 'Dense)
              ('Device ('CUDA 0))
              ('DataType BERTDType)
              ('Dim ('Name &quot;*&quot;) ('Size 512))
              ('Dim ('Name &quot;*&quot;) ('Size 768))
              'Nothing))
        ()
        (NamedModel
           (LayerNorm
              'WithBias
              ('Gradient 'WithGradient)
              ('Device ('CUDA 0))
              ('DataType BERTDType)
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))
        Dropout
        (NamedModel
           (GTransformerStack
              (Vector
                 12
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          ()
                          (NamedModel
                             (GMultiHeadAttention
                                ('Dim ('Name &quot;*&quot;) ('Size 12))
                                ('Dim ('Name &quot;*&quot;) ('Size 64))
                                ('Dim ('Name &quot;*&quot;) ('Size 768))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device ('CUDA 0))
                                            ('DataType BERTDType)
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                  'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device ('CUDA 0))
                                            ('DataType BERTDType)
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device ('CUDA 0))
                                            ('DataType BERTDType)
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                  'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device ('CUDA 0))
                                            ('DataType BERTDType)
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device ('CUDA 0))
                                            ('DataType BERTDType)
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                  'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device ('CUDA 0))
                                            ('DataType BERTDType)
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device ('CUDA 0))
                                            ('DataType BERTDType)
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                  'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device ('CUDA 0))
                                            ('DataType BERTDType)
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                Dropout))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                ('Gradient 'WithGradient)
                                ('Device ('CUDA 0))
                                ('DataType BERTDType)
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                    ()
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          ()
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device ('CUDA 0))
                                      ('DataType BERTDType)
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 3072),
                                            'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device ('CUDA 0))
                                      ('DataType BERTDType)
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3072)])))))
                          Gelu
                          ()
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device ('CUDA 0))
                                      ('DataType BERTDType)
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                            'Dim ('Name &quot;*&quot;) ('Size 3072)])))
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device ('CUDA 0))
                                      ('DataType BERTDType)
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                ('Gradient 'WithGradient)
                                ('Device ('CUDA 0))
                                ('DataType BERTDType)
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))))))
        ()
        ()))
  (NamedModel
     (Embedding
        ('Gradient 'WithGradient)
        ('Layout 'Dense)
        ('Device ('CUDA 0))
        ('DataType BERTDType)
        ('Dim ('Name &quot;*&quot;) ('Size 30522))
        ('Dim ('Name &quot;*&quot;) ('Size 768))
        'Nothing))
  (NamedModel
     (Embedding
        ('Gradient 'WithGradient)
        ('Layout 'Dense)
        ('Device ('CUDA 0))
        ('DataType BERTDType)
        ('Dim ('Name &quot;*&quot;) ('Size 2))
        ('Dim ('Name &quot;*&quot;) ('Size 768))
        'Nothing))
  (NamedModel
     (GLMHead
        ('Dim ('Name &quot;*&quot;) ('Size 768))
        (NamedModel
           (GLinear
              (NamedModel
                 (Tensor
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device ('CUDA 0))
                    ('DataType BERTDType)
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 768), 'Dim ('Name &quot;*&quot;) ('Size 768)])))
              (NamedModel
                 (Tensor
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device ('CUDA 0))
                    ('DataType BERTDType)
                    ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
        Gelu
        (NamedModel
           (LayerNorm
              'WithBias
              ('Gradient 'WithGradient)
              ('Device ('CUDA 0))
              ('DataType BERTDType)
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))
        (NamedModel
           (GLinear
              (NamedModel
                 (Tensor
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device ('CUDA 0))
                    ('DataType BERTDType)
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 30522), 'Dim ('Name &quot;*&quot;) ('Size 768)])))
              (NamedModel
                 (Tensor
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device ('CUDA 0))
                    ('DataType BERTDType)
                    ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 30522)])))))
        (GBias ())))
bertModel :: forall bertModel. GBERTModel bertModel -&gt; bertModel
bertModel :: GEncoderOnlyTransformer
  ('Dim ('Name &quot;*&quot;) ('Size 768))
  (NamedModel
     (GTransformer
        (NamedModel
           (Embedding
              ('Gradient 'WithGradient)
              ('Layout 'Dense)
              ('Device ('CUDA 0))
              ('DataType BERTDType)
              ('Dim ('Name &quot;*&quot;) ('Size 512))
              ('Dim ('Name &quot;*&quot;) ('Size 768))
              'Nothing))
        ()
        (NamedModel
           (LayerNorm
              'WithBias
              ('Gradient 'WithGradient)
              ('Device ('CUDA 0))
              ('DataType BERTDType)
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))
        Dropout
        (NamedModel
           (GTransformerStack
              (Vector
                 12
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          ()
                          (NamedModel
                             (GMultiHeadAttention
                                ('Dim ('Name &quot;*&quot;) ('Size 12))
                                ('Dim ('Name &quot;*&quot;) ('Size 64))
                                ('Dim ('Name &quot;*&quot;) ('Size 768))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device ('CUDA 0))
                                            ('DataType BERTDType)
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                  'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device ('CUDA 0))
                                            ('DataType BERTDType)
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device ('CUDA 0))
                                            ('DataType BERTDType)
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                  'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device ('CUDA 0))
                                            ('DataType BERTDType)
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device ('CUDA 0))
                                            ('DataType BERTDType)
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                  'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device ('CUDA 0))
                                            ('DataType BERTDType)
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device ('CUDA 0))
                                            ('DataType BERTDType)
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                  'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device ('CUDA 0))
                                            ('DataType BERTDType)
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                Dropout))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                ('Gradient 'WithGradient)
                                ('Device ('CUDA 0))
                                ('DataType BERTDType)
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                    ()
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          ()
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device ('CUDA 0))
                                      ('DataType BERTDType)
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 3072),
                                            'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device ('CUDA 0))
                                      ('DataType BERTDType)
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3072)])))))
                          Gelu
                          ()
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device ('CUDA 0))
                                      ('DataType BERTDType)
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                            'Dim ('Name &quot;*&quot;) ('Size 3072)])))
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device ('CUDA 0))
                                      ('DataType BERTDType)
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                ('Gradient 'WithGradient)
                                ('Device ('CUDA 0))
                                ('DataType BERTDType)
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))))))
        ()
        ()))
  (NamedModel
     (Embedding
        ('Gradient 'WithGradient)
        ('Layout 'Dense)
        ('Device ('CUDA 0))
        ('DataType BERTDType)
        ('Dim ('Name &quot;*&quot;) ('Size 30522))
        ('Dim ('Name &quot;*&quot;) ('Size 768))
        'Nothing))
  (NamedModel
     (Embedding
        ('Gradient 'WithGradient)
        ('Layout 'Dense)
        ('Device ('CUDA 0))
        ('DataType BERTDType)
        ('Dim ('Name &quot;*&quot;) ('Size 2))
        ('Dim ('Name &quot;*&quot;) ('Size 768))
        'Nothing))
  (NamedModel
     (GLMHead
        ('Dim ('Name &quot;*&quot;) ('Size 768))
        (NamedModel
           (GLinear
              (NamedModel
                 (Tensor
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device ('CUDA 0))
                    ('DataType BERTDType)
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 768), 'Dim ('Name &quot;*&quot;) ('Size 768)])))
              (NamedModel
                 (Tensor
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device ('CUDA 0))
                    ('DataType BERTDType)
                    ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
        Gelu
        (NamedModel
           (LayerNorm
              'WithBias
              ('Gradient 'WithGradient)
              ('Device ('CUDA 0))
              ('DataType BERTDType)
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))
        (NamedModel
           (GLinear
              (NamedModel
                 (Tensor
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device ('CUDA 0))
                    ('DataType BERTDType)
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 30522), 'Dim ('Name &quot;*&quot;) ('Size 768)])))
              (NamedModel
                 (Tensor
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device ('CUDA 0))
                    ('DataType BERTDType)
                    ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 30522)])))))
        (GBias ())))
</span><a href="Torch.GraduallyTyped.NN.Transformer.BERT.Common.html#bertModel"><span class="hs-glyph hs-var hs-var">..</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(StateT
   StateDict
   IO
   (GBERTModel
      (GEncoderOnlyTransformer
         ('Dim ('Name &quot;*&quot;) ('Size 768))
         (NamedModel
            (GTransformer
               (NamedModel
                  (Embedding
                     ('Gradient 'WithGradient)
                     ('Layout 'Dense)
                     ('Device ('CUDA 0))
                     ('DataType BERTDType)
                     ('Dim ('Name &quot;*&quot;) ('Size 512))
                     ('Dim ('Name &quot;*&quot;) ('Size 768))
                     'Nothing))
               ()
               (NamedModel
                  (LayerNorm
                     'WithBias
                     ('Gradient 'WithGradient)
                     ('Device ('CUDA 0))
                     ('DataType BERTDType)
                     ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))
               Dropout
               (NamedModel
                  (GTransformerStack
                     (Vector
                        12
                        (GTransformerBlock
                           (NamedModel
                              (GSelfAttention
                                 ()
                                 (NamedModel
                                    (GMultiHeadAttention
                                       ('Dim ('Name &quot;*&quot;) ('Size 12))
                                       ('Dim ('Name &quot;*&quot;) ('Size 64))
                                       ('Dim ('Name &quot;*&quot;) ('Size 768))
                                       (NamedModel
                                          (GLinear
                                             (NamedModel
                                                (Tensor
                                                   ('Gradient 'WithGradient)
                                                   ('Layout 'Dense)
                                                   ('Device ('CUDA 0))
                                                   ('DataType BERTDType)
                                                   ('Shape
                                                      '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                         'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                             (NamedModel
                                                (Tensor
                                                   ('Gradient 'WithGradient)
                                                   ('Layout 'Dense)
                                                   ('Device ('CUDA 0))
                                                   ('DataType BERTDType)
                                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                       (NamedModel
                                          (GLinear
                                             (NamedModel
                                                (Tensor
                                                   ('Gradient 'WithGradient)
                                                   ('Layout 'Dense)
                                                   ('Device ('CUDA 0))
                                                   ('DataType BERTDType)
                                                   ('Shape
                                                      '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                         'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                             (NamedModel
                                                (Tensor
                                                   ('Gradient 'WithGradient)
                                                   ('Layout 'Dense)
                                                   ('Device ('CUDA 0))
                                                   ('DataType BERTDType)
                                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                       (NamedModel
                                          (GLinear
                                             (NamedModel
                                                (Tensor
                                                   ('Gradient 'WithGradient)
                                                   ('Layout 'Dense)
                                                   ('Device ('CUDA 0))
                                                   ('DataType BERTDType)
                                                   ('Shape
                                                      '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                         'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                             (NamedModel
                                                (Tensor
                                                   ('Gradient 'WithGradient)
                                                   ('Layout 'Dense)
                                                   ('Device ('CUDA 0))
                                                   ('DataType BERTDType)
                                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                       (NamedModel
                                          (GLinear
                                             (NamedModel
                                                (Tensor
                                                   ('Gradient 'WithGradient)
                                                   ('Layout 'Dense)
                                                   ('Device ('CUDA 0))
                                                   ('DataType BERTDType)
                                                   ('Shape
                                                      '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                         'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                             (NamedModel
                                                (Tensor
                                                   ('Gradient 'WithGradient)
                                                   ('Layout 'Dense)
                                                   ('Device ('CUDA 0))
                                                   ('DataType BERTDType)
                                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                       Dropout))
                                 Dropout
                                 (NamedModel
                                    (LayerNorm
                                       'WithBias
                                       ('Gradient 'WithGradient)
                                       ('Device ('CUDA 0))
                                       ('DataType BERTDType)
                                       ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                           ()
                           (NamedModel
                              (GTransformerFeedForwardNetwork
                                 ()
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             ('Gradient 'WithGradient)
                                             ('Layout 'Dense)
                                             ('Device ('CUDA 0))
                                             ('DataType BERTDType)
                                             ('Shape
                                                '[ 'Dim ('Name &quot;*&quot;) ('Size 3072),
                                                   'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                       (NamedModel
                                          (Tensor
                                             ('Gradient 'WithGradient)
                                             ('Layout 'Dense)
                                             ('Device ('CUDA 0))
                                             ('DataType BERTDType)
                                             ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3072)])))))
                                 Gelu
                                 ()
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             ('Gradient 'WithGradient)
                                             ('Layout 'Dense)
                                             ('Device ('CUDA 0))
                                             ('DataType BERTDType)
                                             ('Shape
                                                '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                   'Dim ('Name &quot;*&quot;) ('Size 3072)])))
                                       (NamedModel
                                          (Tensor
                                             ('Gradient 'WithGradient)
                                             ('Layout 'Dense)
                                             ('Device ('CUDA 0))
                                             ('DataType BERTDType)
                                             ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                 Dropout
                                 (NamedModel
                                    (LayerNorm
                                       'WithBias
                                       ('Gradient 'WithGradient)
                                       ('Device ('CUDA 0))
                                       ('DataType BERTDType)
                                       ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))))))
               ()
               ()))
         (NamedModel
            (Embedding
               ('Gradient 'WithGradient)
               ('Layout 'Dense)
               ('Device ('CUDA 0))
               ('DataType BERTDType)
               ('Dim ('Name &quot;*&quot;) ('Size 30522))
               ('Dim ('Name &quot;*&quot;) ('Size 768))
               'Nothing))
         (NamedModel
            (Embedding
               ('Gradient 'WithGradient)
               ('Layout 'Dense)
               ('Device ('CUDA 0))
               ('DataType BERTDType)
               ('Dim ('Name &quot;*&quot;) ('Size 2))
               ('Dim ('Name &quot;*&quot;) ('Size 768))
               'Nothing))
         (NamedModel
            (GLMHead
               ('Dim ('Name &quot;*&quot;) ('Size 768))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           ('Gradient 'WithGradient)
                           ('Layout 'Dense)
                           ('Device ('CUDA 0))
                           ('DataType BERTDType)
                           ('Shape
                              '[ 'Dim ('Name &quot;*&quot;) ('Size 768), 'Dim ('Name &quot;*&quot;) ('Size 768)])))
                     (NamedModel
                        (Tensor
                           ('Gradient 'WithGradient)
                           ('Layout 'Dense)
                           ('Device ('CUDA 0))
                           ('DataType BERTDType)
                           ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
               Gelu
               (NamedModel
                  (LayerNorm
                     'WithBias
                     ('Gradient 'WithGradient)
                     ('Device ('CUDA 0))
                     ('DataType BERTDType)
                     ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           ('Gradient 'WithGradient)
                           ('Layout 'Dense)
                           ('Device ('CUDA 0))
                           ('DataType BERTDType)
                           ('Shape
                              '[ 'Dim ('Name &quot;*&quot;) ('Size 30522), 'Dim ('Name &quot;*&quot;) ('Size 768)])))
                     (NamedModel
                        (Tensor
                           ('Gradient 'WithGradient)
                           ('Layout 'Dense)
                           ('Device ('CUDA 0))
                           ('DataType BERTDType)
                           ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 30522)])))))
               (GBias ())))))
 -&gt; StateDict
 -&gt; IO
      (GBERTModel
         (GEncoderOnlyTransformer
            ('Dim ('Name &quot;*&quot;) ('Size 768))
            (NamedModel
               (GTransformer
                  (NamedModel
                     (Embedding
                        ('Gradient 'WithGradient)
                        ('Layout 'Dense)
                        ('Device ('CUDA 0))
                        ('DataType BERTDType)
                        ('Dim ('Name &quot;*&quot;) ('Size 512))
                        ('Dim ('Name &quot;*&quot;) ('Size 768))
                        'Nothing))
                  ()
                  (NamedModel
                     (LayerNorm
                        'WithBias
                        ('Gradient 'WithGradient)
                        ('Device ('CUDA 0))
                        ('DataType BERTDType)
                        ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))
                  Dropout
                  (NamedModel
                     (GTransformerStack
                        (Vector
                           12
                           (GTransformerBlock
                              (NamedModel
                                 (GSelfAttention
                                    ()
                                    (NamedModel
                                       (GMultiHeadAttention
                                          ('Dim ('Name &quot;*&quot;) ('Size 12))
                                          ('Dim ('Name &quot;*&quot;) ('Size 64))
                                          ('Dim ('Name &quot;*&quot;) ('Size 768))
                                          (NamedModel
                                             (GLinear
                                                (NamedModel
                                                   (Tensor
                                                      ('Gradient 'WithGradient)
                                                      ('Layout 'Dense)
                                                      ('Device ('CUDA 0))
                                                      ('DataType BERTDType)
                                                      ('Shape
                                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                            'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                                (NamedModel
                                                   (Tensor
                                                      ('Gradient 'WithGradient)
                                                      ('Layout 'Dense)
                                                      ('Device ('CUDA 0))
                                                      ('DataType BERTDType)
                                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                          (NamedModel
                                             (GLinear
                                                (NamedModel
                                                   (Tensor
                                                      ('Gradient 'WithGradient)
                                                      ('Layout 'Dense)
                                                      ('Device ('CUDA 0))
                                                      ('DataType BERTDType)
                                                      ('Shape
                                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                            'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                                (NamedModel
                                                   (Tensor
                                                      ('Gradient 'WithGradient)
                                                      ('Layout 'Dense)
                                                      ('Device ('CUDA 0))
                                                      ('DataType BERTDType)
                                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                          (NamedModel
                                             (GLinear
                                                (NamedModel
                                                   (Tensor
                                                      ('Gradient 'WithGradient)
                                                      ('Layout 'Dense)
                                                      ('Device ('CUDA 0))
                                                      ('DataType BERTDType)
                                                      ('Shape
                                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                            'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                                (NamedModel
                                                   (Tensor
                                                      ('Gradient 'WithGradient)
                                                      ('Layout 'Dense)
                                                      ('Device ('CUDA 0))
                                                      ('DataType BERTDType)
                                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                          (NamedModel
                                             (GLinear
                                                (NamedModel
                                                   (Tensor
                                                      ('Gradient 'WithGradient)
                                                      ('Layout 'Dense)
                                                      ('Device ('CUDA 0))
                                                      ('DataType BERTDType)
                                                      ('Shape
                                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                            'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                                (NamedModel
                                                   (Tensor
                                                      ('Gradient 'WithGradient)
                                                      ('Layout 'Dense)
                                                      ('Device ('CUDA 0))
                                                      ('DataType BERTDType)
                                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                          Dropout))
                                    Dropout
                                    (NamedModel
                                       (LayerNorm
                                          'WithBias
                                          ('Gradient 'WithGradient)
                                          ('Device ('CUDA 0))
                                          ('DataType BERTDType)
                                          ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                              ()
                              (NamedModel
                                 (GTransformerFeedForwardNetwork
                                    ()
                                    (NamedModel
                                       (GLinear
                                          (NamedModel
                                             (Tensor
                                                ('Gradient 'WithGradient)
                                                ('Layout 'Dense)
                                                ('Device ('CUDA 0))
                                                ('DataType BERTDType)
                                                ('Shape
                                                   '[ 'Dim ('Name &quot;*&quot;) ('Size 3072),
                                                      'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                          (NamedModel
                                             (Tensor
                                                ('Gradient 'WithGradient)
                                                ('Layout 'Dense)
                                                ('Device ('CUDA 0))
                                                ('DataType BERTDType)
                                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3072)])))))
                                    Gelu
                                    ()
                                    (NamedModel
                                       (GLinear
                                          (NamedModel
                                             (Tensor
                                                ('Gradient 'WithGradient)
                                                ('Layout 'Dense)
                                                ('Device ('CUDA 0))
                                                ('DataType BERTDType)
                                                ('Shape
                                                   '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                      'Dim ('Name &quot;*&quot;) ('Size 3072)])))
                                          (NamedModel
                                             (Tensor
                                                ('Gradient 'WithGradient)
                                                ('Layout 'Dense)
                                                ('Device ('CUDA 0))
                                                ('DataType BERTDType)
                                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                    Dropout
                                    (NamedModel
                                       (LayerNorm
                                          'WithBias
                                          ('Gradient 'WithGradient)
                                          ('Device ('CUDA 0))
                                          ('DataType BERTDType)
                                          ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))))))
                  ()
                  ()))
            (NamedModel
               (Embedding
                  ('Gradient 'WithGradient)
                  ('Layout 'Dense)
                  ('Device ('CUDA 0))
                  ('DataType BERTDType)
                  ('Dim ('Name &quot;*&quot;) ('Size 30522))
                  ('Dim ('Name &quot;*&quot;) ('Size 768))
                  'Nothing))
            (NamedModel
               (Embedding
                  ('Gradient 'WithGradient)
                  ('Layout 'Dense)
                  ('Device ('CUDA 0))
                  ('DataType BERTDType)
                  ('Dim ('Name &quot;*&quot;) ('Size 2))
                  ('Dim ('Name &quot;*&quot;) ('Size 768))
                  'Nothing))
            (NamedModel
               (GLMHead
                  ('Dim ('Name &quot;*&quot;) ('Size 768))
                  (NamedModel
                     (GLinear
                        (NamedModel
                           (Tensor
                              ('Gradient 'WithGradient)
                              ('Layout 'Dense)
                              ('Device ('CUDA 0))
                              ('DataType BERTDType)
                              ('Shape
                                 '[ 'Dim ('Name &quot;*&quot;) ('Size 768), 'Dim ('Name &quot;*&quot;) ('Size 768)])))
                        (NamedModel
                           (Tensor
                              ('Gradient 'WithGradient)
                              ('Layout 'Dense)
                              ('Device ('CUDA 0))
                              ('DataType BERTDType)
                              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                  Gelu
                  (NamedModel
                     (LayerNorm
                        'WithBias
                        ('Gradient 'WithGradient)
                        ('Device ('CUDA 0))
                        ('DataType BERTDType)
                        ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))
                  (NamedModel
                     (GLinear
                        (NamedModel
                           (Tensor
                              ('Gradient 'WithGradient)
                              ('Layout 'Dense)
                              ('Device ('CUDA 0))
                              ('DataType BERTDType)
                              ('Shape
                                 '[ 'Dim ('Name &quot;*&quot;) ('Size 30522), 'Dim ('Name &quot;*&quot;) ('Size 768)])))
                        (NamedModel
                           (Tensor
                              ('Gradient 'WithGradient)
                              ('Layout 'Dense)
                              ('Device ('CUDA 0))
                              ('DataType BERTDType)
                              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 30522)])))))
                  (GBias ()))))))
-&gt; StateDict
-&gt; StateT
     StateDict
     IO
     (GBERTModel
        (GEncoderOnlyTransformer
           ('Dim ('Name &quot;*&quot;) ('Size 768))
           (NamedModel
              (GTransformer
                 (NamedModel
                    (Embedding
                       ('Gradient 'WithGradient)
                       ('Layout 'Dense)
                       ('Device ('CUDA 0))
                       ('DataType BERTDType)
                       ('Dim ('Name &quot;*&quot;) ('Size 512))
                       ('Dim ('Name &quot;*&quot;) ('Size 768))
                       'Nothing))
                 ()
                 (NamedModel
                    (LayerNorm
                       'WithBias
                       ('Gradient 'WithGradient)
                       ('Device ('CUDA 0))
                       ('DataType BERTDType)
                       ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))
                 Dropout
                 (NamedModel
                    (GTransformerStack
                       (Vector
                          12
                          (GTransformerBlock
                             (NamedModel
                                (GSelfAttention
                                   ()
                                   (NamedModel
                                      (GMultiHeadAttention
                                         ('Dim ('Name &quot;*&quot;) ('Size 12))
                                         ('Dim ('Name &quot;*&quot;) ('Size 64))
                                         ('Dim ('Name &quot;*&quot;) ('Size 768))
                                         (NamedModel
                                            (GLinear
                                               (NamedModel
                                                  (Tensor
                                                     ('Gradient 'WithGradient)
                                                     ('Layout 'Dense)
                                                     ('Device ('CUDA 0))
                                                     ('DataType BERTDType)
                                                     ('Shape
                                                        '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                           'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                               (NamedModel
                                                  (Tensor
                                                     ('Gradient 'WithGradient)
                                                     ('Layout 'Dense)
                                                     ('Device ('CUDA 0))
                                                     ('DataType BERTDType)
                                                     ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                         (NamedModel
                                            (GLinear
                                               (NamedModel
                                                  (Tensor
                                                     ('Gradient 'WithGradient)
                                                     ('Layout 'Dense)
                                                     ('Device ('CUDA 0))
                                                     ('DataType BERTDType)
                                                     ('Shape
                                                        '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                           'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                               (NamedModel
                                                  (Tensor
                                                     ('Gradient 'WithGradient)
                                                     ('Layout 'Dense)
                                                     ('Device ('CUDA 0))
                                                     ('DataType BERTDType)
                                                     ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                         (NamedModel
                                            (GLinear
                                               (NamedModel
                                                  (Tensor
                                                     ('Gradient 'WithGradient)
                                                     ('Layout 'Dense)
                                                     ('Device ('CUDA 0))
                                                     ('DataType BERTDType)
                                                     ('Shape
                                                        '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                           'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                               (NamedModel
                                                  (Tensor
                                                     ('Gradient 'WithGradient)
                                                     ('Layout 'Dense)
                                                     ('Device ('CUDA 0))
                                                     ('DataType BERTDType)
                                                     ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                         (NamedModel
                                            (GLinear
                                               (NamedModel
                                                  (Tensor
                                                     ('Gradient 'WithGradient)
                                                     ('Layout 'Dense)
                                                     ('Device ('CUDA 0))
                                                     ('DataType BERTDType)
                                                     ('Shape
                                                        '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                           'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                               (NamedModel
                                                  (Tensor
                                                     ('Gradient 'WithGradient)
                                                     ('Layout 'Dense)
                                                     ('Device ('CUDA 0))
                                                     ('DataType BERTDType)
                                                     ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                         Dropout))
                                   Dropout
                                   (NamedModel
                                      (LayerNorm
                                         'WithBias
                                         ('Gradient 'WithGradient)
                                         ('Device ('CUDA 0))
                                         ('DataType BERTDType)
                                         ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                             ()
                             (NamedModel
                                (GTransformerFeedForwardNetwork
                                   ()
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device ('CUDA 0))
                                               ('DataType BERTDType)
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 3072),
                                                     'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device ('CUDA 0))
                                               ('DataType BERTDType)
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3072)])))))
                                   Gelu
                                   ()
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device ('CUDA 0))
                                               ('DataType BERTDType)
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                     'Dim ('Name &quot;*&quot;) ('Size 3072)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device ('CUDA 0))
                                               ('DataType BERTDType)
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                   Dropout
                                   (NamedModel
                                      (LayerNorm
                                         'WithBias
                                         ('Gradient 'WithGradient)
                                         ('Device ('CUDA 0))
                                         ('DataType BERTDType)
                                         ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))))))
                 ()
                 ()))
           (NamedModel
              (Embedding
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device ('CUDA 0))
                 ('DataType BERTDType)
                 ('Dim ('Name &quot;*&quot;) ('Size 30522))
                 ('Dim ('Name &quot;*&quot;) ('Size 768))
                 'Nothing))
           (NamedModel
              (Embedding
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device ('CUDA 0))
                 ('DataType BERTDType)
                 ('Dim ('Name &quot;*&quot;) ('Size 2))
                 ('Dim ('Name &quot;*&quot;) ('Size 768))
                 'Nothing))
           (NamedModel
              (GLMHead
                 ('Dim ('Name &quot;*&quot;) ('Size 768))
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             ('Gradient 'WithGradient)
                             ('Layout 'Dense)
                             ('Device ('CUDA 0))
                             ('DataType BERTDType)
                             ('Shape
                                '[ 'Dim ('Name &quot;*&quot;) ('Size 768), 'Dim ('Name &quot;*&quot;) ('Size 768)])))
                       (NamedModel
                          (Tensor
                             ('Gradient 'WithGradient)
                             ('Layout 'Dense)
                             ('Device ('CUDA 0))
                             ('DataType BERTDType)
                             ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                 Gelu
                 (NamedModel
                    (LayerNorm
                       'WithBias
                       ('Gradient 'WithGradient)
                       ('Device ('CUDA 0))
                       ('DataType BERTDType)
                       ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             ('Gradient 'WithGradient)
                             ('Layout 'Dense)
                             ('Device ('CUDA 0))
                             ('DataType BERTDType)
                             ('Shape
                                '[ 'Dim ('Name &quot;*&quot;) ('Size 30522), 'Dim ('Name &quot;*&quot;) ('Size 768)])))
                       (NamedModel
                          (Tensor
                             ('Gradient 'WithGradient)
                             ('Layout 'Dense)
                             ('Device ('CUDA 0))
                             ('DataType BERTDType)
                             ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 30522)])))))
                 (GBias ())))))
-&gt; IO
     (GBERTModel
        (GEncoderOnlyTransformer
           ('Dim ('Name &quot;*&quot;) ('Size 768))
           (NamedModel
              (GTransformer
                 (NamedModel
                    (Embedding
                       ('Gradient 'WithGradient)
                       ('Layout 'Dense)
                       ('Device ('CUDA 0))
                       ('DataType BERTDType)
                       ('Dim ('Name &quot;*&quot;) ('Size 512))
                       ('Dim ('Name &quot;*&quot;) ('Size 768))
                       'Nothing))
                 ()
                 (NamedModel
                    (LayerNorm
                       'WithBias
                       ('Gradient 'WithGradient)
                       ('Device ('CUDA 0))
                       ('DataType BERTDType)
                       ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))
                 Dropout
                 (NamedModel
                    (GTransformerStack
                       (Vector
                          12
                          (GTransformerBlock
                             (NamedModel
                                (GSelfAttention
                                   ()
                                   (NamedModel
                                      (GMultiHeadAttention
                                         ('Dim ('Name &quot;*&quot;) ('Size 12))
                                         ('Dim ('Name &quot;*&quot;) ('Size 64))
                                         ('Dim ('Name &quot;*&quot;) ('Size 768))
                                         (NamedModel
                                            (GLinear
                                               (NamedModel
                                                  (Tensor
                                                     ('Gradient 'WithGradient)
                                                     ('Layout 'Dense)
                                                     ('Device ('CUDA 0))
                                                     ('DataType BERTDType)
                                                     ('Shape
                                                        '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                           'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                               (NamedModel
                                                  (Tensor
                                                     ('Gradient 'WithGradient)
                                                     ('Layout 'Dense)
                                                     ('Device ('CUDA 0))
                                                     ('DataType BERTDType)
                                                     ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                         (NamedModel
                                            (GLinear
                                               (NamedModel
                                                  (Tensor
                                                     ('Gradient 'WithGradient)
                                                     ('Layout 'Dense)
                                                     ('Device ('CUDA 0))
                                                     ('DataType BERTDType)
                                                     ('Shape
                                                        '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                           'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                               (NamedModel
                                                  (Tensor
                                                     ('Gradient 'WithGradient)
                                                     ('Layout 'Dense)
                                                     ('Device ('CUDA 0))
                                                     ('DataType BERTDType)
                                                     ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                         (NamedModel
                                            (GLinear
                                               (NamedModel
                                                  (Tensor
                                                     ('Gradient 'WithGradient)
                                                     ('Layout 'Dense)
                                                     ('Device ('CUDA 0))
                                                     ('DataType BERTDType)
                                                     ('Shape
                                                        '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                           'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                               (NamedModel
                                                  (Tensor
                                                     ('Gradient 'WithGradient)
                                                     ('Layout 'Dense)
                                                     ('Device ('CUDA 0))
                                                     ('DataType BERTDType)
                                                     ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                         (NamedModel
                                            (GLinear
                                               (NamedModel
                                                  (Tensor
                                                     ('Gradient 'WithGradient)
                                                     ('Layout 'Dense)
                                                     ('Device ('CUDA 0))
                                                     ('DataType BERTDType)
                                                     ('Shape
                                                        '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                           'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                               (NamedModel
                                                  (Tensor
                                                     ('Gradient 'WithGradient)
                                                     ('Layout 'Dense)
                                                     ('Device ('CUDA 0))
                                                     ('DataType BERTDType)
                                                     ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                         Dropout))
                                   Dropout
                                   (NamedModel
                                      (LayerNorm
                                         'WithBias
                                         ('Gradient 'WithGradient)
                                         ('Device ('CUDA 0))
                                         ('DataType BERTDType)
                                         ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                             ()
                             (NamedModel
                                (GTransformerFeedForwardNetwork
                                   ()
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device ('CUDA 0))
                                               ('DataType BERTDType)
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 3072),
                                                     'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device ('CUDA 0))
                                               ('DataType BERTDType)
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3072)])))))
                                   Gelu
                                   ()
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device ('CUDA 0))
                                               ('DataType BERTDType)
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                     'Dim ('Name &quot;*&quot;) ('Size 3072)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device ('CUDA 0))
                                               ('DataType BERTDType)
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                   Dropout
                                   (NamedModel
                                      (LayerNorm
                                         'WithBias
                                         ('Gradient 'WithGradient)
                                         ('Device ('CUDA 0))
                                         ('DataType BERTDType)
                                         ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))))))
                 ()
                 ()))
           (NamedModel
              (Embedding
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device ('CUDA 0))
                 ('DataType BERTDType)
                 ('Dim ('Name &quot;*&quot;) ('Size 30522))
                 ('Dim ('Name &quot;*&quot;) ('Size 768))
                 'Nothing))
           (NamedModel
              (Embedding
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device ('CUDA 0))
                 ('DataType BERTDType)
                 ('Dim ('Name &quot;*&quot;) ('Size 2))
                 ('Dim ('Name &quot;*&quot;) ('Size 768))
                 'Nothing))
           (NamedModel
              (GLMHead
                 ('Dim ('Name &quot;*&quot;) ('Size 768))
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             ('Gradient 'WithGradient)
                             ('Layout 'Dense)
                             ('Device ('CUDA 0))
                             ('DataType BERTDType)
                             ('Shape
                                '[ 'Dim ('Name &quot;*&quot;) ('Size 768), 'Dim ('Name &quot;*&quot;) ('Size 768)])))
                       (NamedModel
                          (Tensor
                             ('Gradient 'WithGradient)
                             ('Layout 'Dense)
                             ('Device ('CUDA 0))
                             ('DataType BERTDType)
                             ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                 Gelu
                 (NamedModel
                    (LayerNorm
                       'WithBias
                       ('Gradient 'WithGradient)
                       ('Device ('CUDA 0))
                       ('DataType BERTDType)
                       ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             ('Gradient 'WithGradient)
                             ('Layout 'Dense)
                             ('Device ('CUDA 0))
                             ('DataType BERTDType)
                             ('Shape
                                '[ 'Dim ('Name &quot;*&quot;) ('Size 30522), 'Dim ('Name &quot;*&quot;) ('Size 768)])))
                       (NamedModel
                          (Tensor
                             ('Gradient 'WithGradient)
                             ('Layout 'Dense)
                             ('Device ('CUDA 0))
                             ('DataType BERTDType)
                             ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 30522)])))))
                 (GBias ())))))
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">StateT
  StateDict
  IO
  (GBERTModel
     (GEncoderOnlyTransformer
        ('Dim ('Name &quot;*&quot;) ('Size 768))
        (NamedModel
           (GTransformer
              (NamedModel
                 (Embedding
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device ('CUDA 0))
                    ('DataType BERTDType)
                    ('Dim ('Name &quot;*&quot;) ('Size 512))
                    ('Dim ('Name &quot;*&quot;) ('Size 768))
                    'Nothing))
              ()
              (NamedModel
                 (LayerNorm
                    'WithBias
                    ('Gradient 'WithGradient)
                    ('Device ('CUDA 0))
                    ('DataType BERTDType)
                    ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))
              Dropout
              (NamedModel
                 (GTransformerStack
                    (Vector
                       12
                       (GTransformerBlock
                          (NamedModel
                             (GSelfAttention
                                ()
                                (NamedModel
                                   (GMultiHeadAttention
                                      ('Dim ('Name &quot;*&quot;) ('Size 12))
                                      ('Dim ('Name &quot;*&quot;) ('Size 64))
                                      ('Dim ('Name &quot;*&quot;) ('Size 768))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device ('CUDA 0))
                                                  ('DataType BERTDType)
                                                  ('Shape
                                                     '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                        'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device ('CUDA 0))
                                                  ('DataType BERTDType)
                                                  ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device ('CUDA 0))
                                                  ('DataType BERTDType)
                                                  ('Shape
                                                     '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                        'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device ('CUDA 0))
                                                  ('DataType BERTDType)
                                                  ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device ('CUDA 0))
                                                  ('DataType BERTDType)
                                                  ('Shape
                                                     '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                        'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device ('CUDA 0))
                                                  ('DataType BERTDType)
                                                  ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device ('CUDA 0))
                                                  ('DataType BERTDType)
                                                  ('Shape
                                                     '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                        'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device ('CUDA 0))
                                                  ('DataType BERTDType)
                                                  ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                      Dropout))
                                Dropout
                                (NamedModel
                                   (LayerNorm
                                      'WithBias
                                      ('Gradient 'WithGradient)
                                      ('Device ('CUDA 0))
                                      ('DataType BERTDType)
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                          ()
                          (NamedModel
                             (GTransformerFeedForwardNetwork
                                ()
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device ('CUDA 0))
                                            ('DataType BERTDType)
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 3072),
                                                  'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device ('CUDA 0))
                                            ('DataType BERTDType)
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3072)])))))
                                Gelu
                                ()
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device ('CUDA 0))
                                            ('DataType BERTDType)
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                  'Dim ('Name &quot;*&quot;) ('Size 3072)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device ('CUDA 0))
                                            ('DataType BERTDType)
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                Dropout
                                (NamedModel
                                   (LayerNorm
                                      'WithBias
                                      ('Gradient 'WithGradient)
                                      ('Device ('CUDA 0))
                                      ('DataType BERTDType)
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))))))
              ()
              ()))
        (NamedModel
           (Embedding
              ('Gradient 'WithGradient)
              ('Layout 'Dense)
              ('Device ('CUDA 0))
              ('DataType BERTDType)
              ('Dim ('Name &quot;*&quot;) ('Size 30522))
              ('Dim ('Name &quot;*&quot;) ('Size 768))
              'Nothing))
        (NamedModel
           (Embedding
              ('Gradient 'WithGradient)
              ('Layout 'Dense)
              ('Device ('CUDA 0))
              ('DataType BERTDType)
              ('Dim ('Name &quot;*&quot;) ('Size 2))
              ('Dim ('Name &quot;*&quot;) ('Size 768))
              'Nothing))
        (NamedModel
           (GLMHead
              ('Dim ('Name &quot;*&quot;) ('Size 768))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (Tensor
                          ('Gradient 'WithGradient)
                          ('Layout 'Dense)
                          ('Device ('CUDA 0))
                          ('DataType BERTDType)
                          ('Shape
                             '[ 'Dim ('Name &quot;*&quot;) ('Size 768), 'Dim ('Name &quot;*&quot;) ('Size 768)])))
                    (NamedModel
                       (Tensor
                          ('Gradient 'WithGradient)
                          ('Layout 'Dense)
                          ('Device ('CUDA 0))
                          ('DataType BERTDType)
                          ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
              Gelu
              (NamedModel
                 (LayerNorm
                    'WithBias
                    ('Gradient 'WithGradient)
                    ('Device ('CUDA 0))
                    ('DataType BERTDType)
                    ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (Tensor
                          ('Gradient 'WithGradient)
                          ('Layout 'Dense)
                          ('Device ('CUDA 0))
                          ('DataType BERTDType)
                          ('Shape
                             '[ 'Dim ('Name &quot;*&quot;) ('Size 30522), 'Dim ('Name &quot;*&quot;) ('Size 768)])))
                    (NamedModel
                       (Tensor
                          ('Gradient 'WithGradient)
                          ('Layout 'Dense)
                          ('Device ('CUDA 0))
                          ('DataType BERTDType)
                          ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 30522)])))))
              (GBias ())))))
-&gt; StateDict
-&gt; IO
     (GBERTModel
        (GEncoderOnlyTransformer
           ('Dim ('Name &quot;*&quot;) ('Size 768))
           (NamedModel
              (GTransformer
                 (NamedModel
                    (Embedding
                       ('Gradient 'WithGradient)
                       ('Layout 'Dense)
                       ('Device ('CUDA 0))
                       ('DataType BERTDType)
                       ('Dim ('Name &quot;*&quot;) ('Size 512))
                       ('Dim ('Name &quot;*&quot;) ('Size 768))
                       'Nothing))
                 ()
                 (NamedModel
                    (LayerNorm
                       'WithBias
                       ('Gradient 'WithGradient)
                       ('Device ('CUDA 0))
                       ('DataType BERTDType)
                       ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))
                 Dropout
                 (NamedModel
                    (GTransformerStack
                       (Vector
                          12
                          (GTransformerBlock
                             (NamedModel
                                (GSelfAttention
                                   ()
                                   (NamedModel
                                      (GMultiHeadAttention
                                         ('Dim ('Name &quot;*&quot;) ('Size 12))
                                         ('Dim ('Name &quot;*&quot;) ('Size 64))
                                         ('Dim ('Name &quot;*&quot;) ('Size 768))
                                         (NamedModel
                                            (GLinear
                                               (NamedModel
                                                  (Tensor
                                                     ('Gradient 'WithGradient)
                                                     ('Layout 'Dense)
                                                     ('Device ('CUDA 0))
                                                     ('DataType BERTDType)
                                                     ('Shape
                                                        '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                           'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                               (NamedModel
                                                  (Tensor
                                                     ('Gradient 'WithGradient)
                                                     ('Layout 'Dense)
                                                     ('Device ('CUDA 0))
                                                     ('DataType BERTDType)
                                                     ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                         (NamedModel
                                            (GLinear
                                               (NamedModel
                                                  (Tensor
                                                     ('Gradient 'WithGradient)
                                                     ('Layout 'Dense)
                                                     ('Device ('CUDA 0))
                                                     ('DataType BERTDType)
                                                     ('Shape
                                                        '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                           'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                               (NamedModel
                                                  (Tensor
                                                     ('Gradient 'WithGradient)
                                                     ('Layout 'Dense)
                                                     ('Device ('CUDA 0))
                                                     ('DataType BERTDType)
                                                     ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                         (NamedModel
                                            (GLinear
                                               (NamedModel
                                                  (Tensor
                                                     ('Gradient 'WithGradient)
                                                     ('Layout 'Dense)
                                                     ('Device ('CUDA 0))
                                                     ('DataType BERTDType)
                                                     ('Shape
                                                        '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                           'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                               (NamedModel
                                                  (Tensor
                                                     ('Gradient 'WithGradient)
                                                     ('Layout 'Dense)
                                                     ('Device ('CUDA 0))
                                                     ('DataType BERTDType)
                                                     ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                         (NamedModel
                                            (GLinear
                                               (NamedModel
                                                  (Tensor
                                                     ('Gradient 'WithGradient)
                                                     ('Layout 'Dense)
                                                     ('Device ('CUDA 0))
                                                     ('DataType BERTDType)
                                                     ('Shape
                                                        '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                           'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                               (NamedModel
                                                  (Tensor
                                                     ('Gradient 'WithGradient)
                                                     ('Layout 'Dense)
                                                     ('Device ('CUDA 0))
                                                     ('DataType BERTDType)
                                                     ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                         Dropout))
                                   Dropout
                                   (NamedModel
                                      (LayerNorm
                                         'WithBias
                                         ('Gradient 'WithGradient)
                                         ('Device ('CUDA 0))
                                         ('DataType BERTDType)
                                         ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                             ()
                             (NamedModel
                                (GTransformerFeedForwardNetwork
                                   ()
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device ('CUDA 0))
                                               ('DataType BERTDType)
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 3072),
                                                     'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device ('CUDA 0))
                                               ('DataType BERTDType)
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3072)])))))
                                   Gelu
                                   ()
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device ('CUDA 0))
                                               ('DataType BERTDType)
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                     'Dim ('Name &quot;*&quot;) ('Size 3072)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device ('CUDA 0))
                                               ('DataType BERTDType)
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                   Dropout
                                   (NamedModel
                                      (LayerNorm
                                         'WithBias
                                         ('Gradient 'WithGradient)
                                         ('Device ('CUDA 0))
                                         ('DataType BERTDType)
                                         ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))))))
                 ()
                 ()))
           (NamedModel
              (Embedding
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device ('CUDA 0))
                 ('DataType BERTDType)
                 ('Dim ('Name &quot;*&quot;) ('Size 30522))
                 ('Dim ('Name &quot;*&quot;) ('Size 768))
                 'Nothing))
           (NamedModel
              (Embedding
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device ('CUDA 0))
                 ('DataType BERTDType)
                 ('Dim ('Name &quot;*&quot;) ('Size 2))
                 ('Dim ('Name &quot;*&quot;) ('Size 768))
                 'Nothing))
           (NamedModel
              (GLMHead
                 ('Dim ('Name &quot;*&quot;) ('Size 768))
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             ('Gradient 'WithGradient)
                             ('Layout 'Dense)
                             ('Device ('CUDA 0))
                             ('DataType BERTDType)
                             ('Shape
                                '[ 'Dim ('Name &quot;*&quot;) ('Size 768), 'Dim ('Name &quot;*&quot;) ('Size 768)])))
                       (NamedModel
                          (Tensor
                             ('Gradient 'WithGradient)
                             ('Layout 'Dense)
                             ('Device ('CUDA 0))
                             ('DataType BERTDType)
                             ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                 Gelu
                 (NamedModel
                    (LayerNorm
                       'WithBias
                       ('Gradient 'WithGradient)
                       ('Device ('CUDA 0))
                       ('DataType BERTDType)
                       ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             ('Gradient 'WithGradient)
                             ('Layout 'Dense)
                             ('Device ('CUDA 0))
                             ('DataType BERTDType)
                             ('Shape
                                '[ 'Dim ('Name &quot;*&quot;) ('Size 30522), 'Dim ('Name &quot;*&quot;) ('Size 768)])))
                       (NamedModel
                          (Tensor
                             ('Gradient 'WithGradient)
                             ('Layout 'Dense)
                             ('Device ('CUDA 0))
                             ('DataType BERTDType)
                             ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 30522)])))))
                 (GBias ())))))
forall (m :: * -&gt; *) s a. Monad m =&gt; StateT s m a -&gt; s -&gt; m a
</span><span class="hs-identifier hs-var">evalStateT</span></span><span> </span><span class="annot"><span class="annottext">StateDict
</span><a href="#local-6989586621679582555"><span class="hs-identifier hs-var">stateDict</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT
   StateDict
   IO
   (GBERTModel
      (GEncoderOnlyTransformer
         ('Dim ('Name &quot;*&quot;) ('Size 768))
         (NamedModel
            (GTransformer
               (NamedModel
                  (Embedding
                     ('Gradient 'WithGradient)
                     ('Layout 'Dense)
                     ('Device ('CUDA 0))
                     ('DataType BERTDType)
                     ('Dim ('Name &quot;*&quot;) ('Size 512))
                     ('Dim ('Name &quot;*&quot;) ('Size 768))
                     'Nothing))
               ()
               (NamedModel
                  (LayerNorm
                     'WithBias
                     ('Gradient 'WithGradient)
                     ('Device ('CUDA 0))
                     ('DataType BERTDType)
                     ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))
               Dropout
               (NamedModel
                  (GTransformerStack
                     (Vector
                        12
                        (GTransformerBlock
                           (NamedModel
                              (GSelfAttention
                                 ()
                                 (NamedModel
                                    (GMultiHeadAttention
                                       ('Dim ('Name &quot;*&quot;) ('Size 12))
                                       ('Dim ('Name &quot;*&quot;) ('Size 64))
                                       ('Dim ('Name &quot;*&quot;) ('Size 768))
                                       (NamedModel
                                          (GLinear
                                             (NamedModel
                                                (Tensor
                                                   ('Gradient 'WithGradient)
                                                   ('Layout 'Dense)
                                                   ('Device ('CUDA 0))
                                                   ('DataType BERTDType)
                                                   ('Shape
                                                      '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                         'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                             (NamedModel
                                                (Tensor
                                                   ('Gradient 'WithGradient)
                                                   ('Layout 'Dense)
                                                   ('Device ('CUDA 0))
                                                   ('DataType BERTDType)
                                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                       (NamedModel
                                          (GLinear
                                             (NamedModel
                                                (Tensor
                                                   ('Gradient 'WithGradient)
                                                   ('Layout 'Dense)
                                                   ('Device ('CUDA 0))
                                                   ('DataType BERTDType)
                                                   ('Shape
                                                      '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                         'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                             (NamedModel
                                                (Tensor
                                                   ('Gradient 'WithGradient)
                                                   ('Layout 'Dense)
                                                   ('Device ('CUDA 0))
                                                   ('DataType BERTDType)
                                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                       (NamedModel
                                          (GLinear
                                             (NamedModel
                                                (Tensor
                                                   ('Gradient 'WithGradient)
                                                   ('Layout 'Dense)
                                                   ('Device ('CUDA 0))
                                                   ('DataType BERTDType)
                                                   ('Shape
                                                      '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                         'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                             (NamedModel
                                                (Tensor
                                                   ('Gradient 'WithGradient)
                                                   ('Layout 'Dense)
                                                   ('Device ('CUDA 0))
                                                   ('DataType BERTDType)
                                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                       (NamedModel
                                          (GLinear
                                             (NamedModel
                                                (Tensor
                                                   ('Gradient 'WithGradient)
                                                   ('Layout 'Dense)
                                                   ('Device ('CUDA 0))
                                                   ('DataType BERTDType)
                                                   ('Shape
                                                      '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                         'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                             (NamedModel
                                                (Tensor
                                                   ('Gradient 'WithGradient)
                                                   ('Layout 'Dense)
                                                   ('Device ('CUDA 0))
                                                   ('DataType BERTDType)
                                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                       Dropout))
                                 Dropout
                                 (NamedModel
                                    (LayerNorm
                                       'WithBias
                                       ('Gradient 'WithGradient)
                                       ('Device ('CUDA 0))
                                       ('DataType BERTDType)
                                       ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                           ()
                           (NamedModel
                              (GTransformerFeedForwardNetwork
                                 ()
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             ('Gradient 'WithGradient)
                                             ('Layout 'Dense)
                                             ('Device ('CUDA 0))
                                             ('DataType BERTDType)
                                             ('Shape
                                                '[ 'Dim ('Name &quot;*&quot;) ('Size 3072),
                                                   'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                       (NamedModel
                                          (Tensor
                                             ('Gradient 'WithGradient)
                                             ('Layout 'Dense)
                                             ('Device ('CUDA 0))
                                             ('DataType BERTDType)
                                             ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3072)])))))
                                 Gelu
                                 ()
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             ('Gradient 'WithGradient)
                                             ('Layout 'Dense)
                                             ('Device ('CUDA 0))
                                             ('DataType BERTDType)
                                             ('Shape
                                                '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                   'Dim ('Name &quot;*&quot;) ('Size 3072)])))
                                       (NamedModel
                                          (Tensor
                                             ('Gradient 'WithGradient)
                                             ('Layout 'Dense)
                                             ('Device ('CUDA 0))
                                             ('DataType BERTDType)
                                             ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                 Dropout
                                 (NamedModel
                                    (LayerNorm
                                       'WithBias
                                       ('Gradient 'WithGradient)
                                       ('Device ('CUDA 0))
                                       ('DataType BERTDType)
                                       ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))))))
               ()
               ()))
         (NamedModel
            (Embedding
               ('Gradient 'WithGradient)
               ('Layout 'Dense)
               ('Device ('CUDA 0))
               ('DataType BERTDType)
               ('Dim ('Name &quot;*&quot;) ('Size 30522))
               ('Dim ('Name &quot;*&quot;) ('Size 768))
               'Nothing))
         (NamedModel
            (Embedding
               ('Gradient 'WithGradient)
               ('Layout 'Dense)
               ('Device ('CUDA 0))
               ('DataType BERTDType)
               ('Dim ('Name &quot;*&quot;) ('Size 2))
               ('Dim ('Name &quot;*&quot;) ('Size 768))
               'Nothing))
         (NamedModel
            (GLMHead
               ('Dim ('Name &quot;*&quot;) ('Size 768))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           ('Gradient 'WithGradient)
                           ('Layout 'Dense)
                           ('Device ('CUDA 0))
                           ('DataType BERTDType)
                           ('Shape
                              '[ 'Dim ('Name &quot;*&quot;) ('Size 768), 'Dim ('Name &quot;*&quot;) ('Size 768)])))
                     (NamedModel
                        (Tensor
                           ('Gradient 'WithGradient)
                           ('Layout 'Dense)
                           ('Device ('CUDA 0))
                           ('DataType BERTDType)
                           ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
               Gelu
               (NamedModel
                  (LayerNorm
                     'WithBias
                     ('Gradient 'WithGradient)
                     ('Device ('CUDA 0))
                     ('DataType BERTDType)
                     ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           ('Gradient 'WithGradient)
                           ('Layout 'Dense)
                           ('Device ('CUDA 0))
                           ('DataType BERTDType)
                           ('Shape
                              '[ 'Dim ('Name &quot;*&quot;) ('Size 30522), 'Dim ('Name &quot;*&quot;) ('Size 768)])))
                     (NamedModel
                        (Tensor
                           ('Gradient 'WithGradient)
                           ('Layout 'Dense)
                           ('Device ('CUDA 0))
                           ('DataType BERTDType)
                           ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 30522)])))))
               (GBias ())))))
 -&gt; IO
      (GBERTModel
         (GEncoderOnlyTransformer
            ('Dim ('Name &quot;*&quot;) ('Size 768))
            (NamedModel
               (GTransformer
                  (NamedModel
                     (Embedding
                        ('Gradient 'WithGradient)
                        ('Layout 'Dense)
                        ('Device ('CUDA 0))
                        ('DataType BERTDType)
                        ('Dim ('Name &quot;*&quot;) ('Size 512))
                        ('Dim ('Name &quot;*&quot;) ('Size 768))
                        'Nothing))
                  ()
                  (NamedModel
                     (LayerNorm
                        'WithBias
                        ('Gradient 'WithGradient)
                        ('Device ('CUDA 0))
                        ('DataType BERTDType)
                        ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))
                  Dropout
                  (NamedModel
                     (GTransformerStack
                        (Vector
                           12
                           (GTransformerBlock
                              (NamedModel
                                 (GSelfAttention
                                    ()
                                    (NamedModel
                                       (GMultiHeadAttention
                                          ('Dim ('Name &quot;*&quot;) ('Size 12))
                                          ('Dim ('Name &quot;*&quot;) ('Size 64))
                                          ('Dim ('Name &quot;*&quot;) ('Size 768))
                                          (NamedModel
                                             (GLinear
                                                (NamedModel
                                                   (Tensor
                                                      ('Gradient 'WithGradient)
                                                      ('Layout 'Dense)
                                                      ('Device ('CUDA 0))
                                                      ('DataType BERTDType)
                                                      ('Shape
                                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                            'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                                (NamedModel
                                                   (Tensor
                                                      ('Gradient 'WithGradient)
                                                      ('Layout 'Dense)
                                                      ('Device ('CUDA 0))
                                                      ('DataType BERTDType)
                                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                          (NamedModel
                                             (GLinear
                                                (NamedModel
                                                   (Tensor
                                                      ('Gradient 'WithGradient)
                                                      ('Layout 'Dense)
                                                      ('Device ('CUDA 0))
                                                      ('DataType BERTDType)
                                                      ('Shape
                                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                            'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                                (NamedModel
                                                   (Tensor
                                                      ('Gradient 'WithGradient)
                                                      ('Layout 'Dense)
                                                      ('Device ('CUDA 0))
                                                      ('DataType BERTDType)
                                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                          (NamedModel
                                             (GLinear
                                                (NamedModel
                                                   (Tensor
                                                      ('Gradient 'WithGradient)
                                                      ('Layout 'Dense)
                                                      ('Device ('CUDA 0))
                                                      ('DataType BERTDType)
                                                      ('Shape
                                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                            'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                                (NamedModel
                                                   (Tensor
                                                      ('Gradient 'WithGradient)
                                                      ('Layout 'Dense)
                                                      ('Device ('CUDA 0))
                                                      ('DataType BERTDType)
                                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                          (NamedModel
                                             (GLinear
                                                (NamedModel
                                                   (Tensor
                                                      ('Gradient 'WithGradient)
                                                      ('Layout 'Dense)
                                                      ('Device ('CUDA 0))
                                                      ('DataType BERTDType)
                                                      ('Shape
                                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                            'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                                (NamedModel
                                                   (Tensor
                                                      ('Gradient 'WithGradient)
                                                      ('Layout 'Dense)
                                                      ('Device ('CUDA 0))
                                                      ('DataType BERTDType)
                                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                          Dropout))
                                    Dropout
                                    (NamedModel
                                       (LayerNorm
                                          'WithBias
                                          ('Gradient 'WithGradient)
                                          ('Device ('CUDA 0))
                                          ('DataType BERTDType)
                                          ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                              ()
                              (NamedModel
                                 (GTransformerFeedForwardNetwork
                                    ()
                                    (NamedModel
                                       (GLinear
                                          (NamedModel
                                             (Tensor
                                                ('Gradient 'WithGradient)
                                                ('Layout 'Dense)
                                                ('Device ('CUDA 0))
                                                ('DataType BERTDType)
                                                ('Shape
                                                   '[ 'Dim ('Name &quot;*&quot;) ('Size 3072),
                                                      'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                          (NamedModel
                                             (Tensor
                                                ('Gradient 'WithGradient)
                                                ('Layout 'Dense)
                                                ('Device ('CUDA 0))
                                                ('DataType BERTDType)
                                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3072)])))))
                                    Gelu
                                    ()
                                    (NamedModel
                                       (GLinear
                                          (NamedModel
                                             (Tensor
                                                ('Gradient 'WithGradient)
                                                ('Layout 'Dense)
                                                ('Device ('CUDA 0))
                                                ('DataType BERTDType)
                                                ('Shape
                                                   '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                      'Dim ('Name &quot;*&quot;) ('Size 3072)])))
                                          (NamedModel
                                             (Tensor
                                                ('Gradient 'WithGradient)
                                                ('Layout 'Dense)
                                                ('Device ('CUDA 0))
                                                ('DataType BERTDType)
                                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                    Dropout
                                    (NamedModel
                                       (LayerNorm
                                          'WithBias
                                          ('Gradient 'WithGradient)
                                          ('Device ('CUDA 0))
                                          ('DataType BERTDType)
                                          ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))))))
                  ()
                  ()))
            (NamedModel
               (Embedding
                  ('Gradient 'WithGradient)
                  ('Layout 'Dense)
                  ('Device ('CUDA 0))
                  ('DataType BERTDType)
                  ('Dim ('Name &quot;*&quot;) ('Size 30522))
                  ('Dim ('Name &quot;*&quot;) ('Size 768))
                  'Nothing))
            (NamedModel
               (Embedding
                  ('Gradient 'WithGradient)
                  ('Layout 'Dense)
                  ('Device ('CUDA 0))
                  ('DataType BERTDType)
                  ('Dim ('Name &quot;*&quot;) ('Size 2))
                  ('Dim ('Name &quot;*&quot;) ('Size 768))
                  'Nothing))
            (NamedModel
               (GLMHead
                  ('Dim ('Name &quot;*&quot;) ('Size 768))
                  (NamedModel
                     (GLinear
                        (NamedModel
                           (Tensor
                              ('Gradient 'WithGradient)
                              ('Layout 'Dense)
                              ('Device ('CUDA 0))
                              ('DataType BERTDType)
                              ('Shape
                                 '[ 'Dim ('Name &quot;*&quot;) ('Size 768), 'Dim ('Name &quot;*&quot;) ('Size 768)])))
                        (NamedModel
                           (Tensor
                              ('Gradient 'WithGradient)
                              ('Layout 'Dense)
                              ('Device ('CUDA 0))
                              ('DataType BERTDType)
                              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                  Gelu
                  (NamedModel
                     (LayerNorm
                        'WithBias
                        ('Gradient 'WithGradient)
                        ('Device ('CUDA 0))
                        ('DataType BERTDType)
                        ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))
                  (NamedModel
                     (GLinear
                        (NamedModel
                           (Tensor
                              ('Gradient 'WithGradient)
                              ('Layout 'Dense)
                              ('Device ('CUDA 0))
                              ('DataType BERTDType)
                              ('Shape
                                 '[ 'Dim ('Name &quot;*&quot;) ('Size 30522), 'Dim ('Name &quot;*&quot;) ('Size 768)])))
                        (NamedModel
                           (Tensor
                              ('Gradient 'WithGradient)
                              ('Layout 'Dense)
                              ('Device ('CUDA 0))
                              ('DataType BERTDType)
                              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 30522)])))))
                  (GBias ()))))))
-&gt; StateT
     StateDict
     IO
     (GBERTModel
        (GEncoderOnlyTransformer
           ('Dim ('Name &quot;*&quot;) ('Size 768))
           (NamedModel
              (GTransformer
                 (NamedModel
                    (Embedding
                       ('Gradient 'WithGradient)
                       ('Layout 'Dense)
                       ('Device ('CUDA 0))
                       ('DataType BERTDType)
                       ('Dim ('Name &quot;*&quot;) ('Size 512))
                       ('Dim ('Name &quot;*&quot;) ('Size 768))
                       'Nothing))
                 ()
                 (NamedModel
                    (LayerNorm
                       'WithBias
                       ('Gradient 'WithGradient)
                       ('Device ('CUDA 0))
                       ('DataType BERTDType)
                       ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))
                 Dropout
                 (NamedModel
                    (GTransformerStack
                       (Vector
                          12
                          (GTransformerBlock
                             (NamedModel
                                (GSelfAttention
                                   ()
                                   (NamedModel
                                      (GMultiHeadAttention
                                         ('Dim ('Name &quot;*&quot;) ('Size 12))
                                         ('Dim ('Name &quot;*&quot;) ('Size 64))
                                         ('Dim ('Name &quot;*&quot;) ('Size 768))
                                         (NamedModel
                                            (GLinear
                                               (NamedModel
                                                  (Tensor
                                                     ('Gradient 'WithGradient)
                                                     ('Layout 'Dense)
                                                     ('Device ('CUDA 0))
                                                     ('DataType BERTDType)
                                                     ('Shape
                                                        '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                           'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                               (NamedModel
                                                  (Tensor
                                                     ('Gradient 'WithGradient)
                                                     ('Layout 'Dense)
                                                     ('Device ('CUDA 0))
                                                     ('DataType BERTDType)
                                                     ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                         (NamedModel
                                            (GLinear
                                               (NamedModel
                                                  (Tensor
                                                     ('Gradient 'WithGradient)
                                                     ('Layout 'Dense)
                                                     ('Device ('CUDA 0))
                                                     ('DataType BERTDType)
                                                     ('Shape
                                                        '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                           'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                               (NamedModel
                                                  (Tensor
                                                     ('Gradient 'WithGradient)
                                                     ('Layout 'Dense)
                                                     ('Device ('CUDA 0))
                                                     ('DataType BERTDType)
                                                     ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                         (NamedModel
                                            (GLinear
                                               (NamedModel
                                                  (Tensor
                                                     ('Gradient 'WithGradient)
                                                     ('Layout 'Dense)
                                                     ('Device ('CUDA 0))
                                                     ('DataType BERTDType)
                                                     ('Shape
                                                        '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                           'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                               (NamedModel
                                                  (Tensor
                                                     ('Gradient 'WithGradient)
                                                     ('Layout 'Dense)
                                                     ('Device ('CUDA 0))
                                                     ('DataType BERTDType)
                                                     ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                         (NamedModel
                                            (GLinear
                                               (NamedModel
                                                  (Tensor
                                                     ('Gradient 'WithGradient)
                                                     ('Layout 'Dense)
                                                     ('Device ('CUDA 0))
                                                     ('DataType BERTDType)
                                                     ('Shape
                                                        '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                           'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                               (NamedModel
                                                  (Tensor
                                                     ('Gradient 'WithGradient)
                                                     ('Layout 'Dense)
                                                     ('Device ('CUDA 0))
                                                     ('DataType BERTDType)
                                                     ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                         Dropout))
                                   Dropout
                                   (NamedModel
                                      (LayerNorm
                                         'WithBias
                                         ('Gradient 'WithGradient)
                                         ('Device ('CUDA 0))
                                         ('DataType BERTDType)
                                         ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                             ()
                             (NamedModel
                                (GTransformerFeedForwardNetwork
                                   ()
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device ('CUDA 0))
                                               ('DataType BERTDType)
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 3072),
                                                     'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device ('CUDA 0))
                                               ('DataType BERTDType)
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3072)])))))
                                   Gelu
                                   ()
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device ('CUDA 0))
                                               ('DataType BERTDType)
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                     'Dim ('Name &quot;*&quot;) ('Size 3072)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device ('CUDA 0))
                                               ('DataType BERTDType)
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                   Dropout
                                   (NamedModel
                                      (LayerNorm
                                         'WithBias
                                         ('Gradient 'WithGradient)
                                         ('Device ('CUDA 0))
                                         ('DataType BERTDType)
                                         ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))))))
                 ()
                 ()))
           (NamedModel
              (Embedding
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device ('CUDA 0))
                 ('DataType BERTDType)
                 ('Dim ('Name &quot;*&quot;) ('Size 30522))
                 ('Dim ('Name &quot;*&quot;) ('Size 768))
                 'Nothing))
           (NamedModel
              (Embedding
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device ('CUDA 0))
                 ('DataType BERTDType)
                 ('Dim ('Name &quot;*&quot;) ('Size 2))
                 ('Dim ('Name &quot;*&quot;) ('Size 768))
                 'Nothing))
           (NamedModel
              (GLMHead
                 ('Dim ('Name &quot;*&quot;) ('Size 768))
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             ('Gradient 'WithGradient)
                             ('Layout 'Dense)
                             ('Device ('CUDA 0))
                             ('DataType BERTDType)
                             ('Shape
                                '[ 'Dim ('Name &quot;*&quot;) ('Size 768), 'Dim ('Name &quot;*&quot;) ('Size 768)])))
                       (NamedModel
                          (Tensor
                             ('Gradient 'WithGradient)
                             ('Layout 'Dense)
                             ('Device ('CUDA 0))
                             ('DataType BERTDType)
                             ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                 Gelu
                 (NamedModel
                    (LayerNorm
                       'WithBias
                       ('Gradient 'WithGradient)
                       ('Device ('CUDA 0))
                       ('DataType BERTDType)
                       ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             ('Gradient 'WithGradient)
                             ('Layout 'Dense)
                             ('Device ('CUDA 0))
                             ('DataType BERTDType)
                             ('Shape
                                '[ 'Dim ('Name &quot;*&quot;) ('Size 30522), 'Dim ('Name &quot;*&quot;) ('Size 768)])))
                       (NamedModel
                          (Tensor
                             ('Gradient 'WithGradient)
                             ('Layout 'Dense)
                             ('Device ('CUDA 0))
                             ('DataType BERTDType)
                             ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 30522)])))))
                 (GBias ())))))
-&gt; IO
     (GBERTModel
        (GEncoderOnlyTransformer
           ('Dim ('Name &quot;*&quot;) ('Size 768))
           (NamedModel
              (GTransformer
                 (NamedModel
                    (Embedding
                       ('Gradient 'WithGradient)
                       ('Layout 'Dense)
                       ('Device ('CUDA 0))
                       ('DataType BERTDType)
                       ('Dim ('Name &quot;*&quot;) ('Size 512))
                       ('Dim ('Name &quot;*&quot;) ('Size 768))
                       'Nothing))
                 ()
                 (NamedModel
                    (LayerNorm
                       'WithBias
                       ('Gradient 'WithGradient)
                       ('Device ('CUDA 0))
                       ('DataType BERTDType)
                       ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))
                 Dropout
                 (NamedModel
                    (GTransformerStack
                       (Vector
                          12
                          (GTransformerBlock
                             (NamedModel
                                (GSelfAttention
                                   ()
                                   (NamedModel
                                      (GMultiHeadAttention
                                         ('Dim ('Name &quot;*&quot;) ('Size 12))
                                         ('Dim ('Name &quot;*&quot;) ('Size 64))
                                         ('Dim ('Name &quot;*&quot;) ('Size 768))
                                         (NamedModel
                                            (GLinear
                                               (NamedModel
                                                  (Tensor
                                                     ('Gradient 'WithGradient)
                                                     ('Layout 'Dense)
                                                     ('Device ('CUDA 0))
                                                     ('DataType BERTDType)
                                                     ('Shape
                                                        '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                           'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                               (NamedModel
                                                  (Tensor
                                                     ('Gradient 'WithGradient)
                                                     ('Layout 'Dense)
                                                     ('Device ('CUDA 0))
                                                     ('DataType BERTDType)
                                                     ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                         (NamedModel
                                            (GLinear
                                               (NamedModel
                                                  (Tensor
                                                     ('Gradient 'WithGradient)
                                                     ('Layout 'Dense)
                                                     ('Device ('CUDA 0))
                                                     ('DataType BERTDType)
                                                     ('Shape
                                                        '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                           'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                               (NamedModel
                                                  (Tensor
                                                     ('Gradient 'WithGradient)
                                                     ('Layout 'Dense)
                                                     ('Device ('CUDA 0))
                                                     ('DataType BERTDType)
                                                     ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                         (NamedModel
                                            (GLinear
                                               (NamedModel
                                                  (Tensor
                                                     ('Gradient 'WithGradient)
                                                     ('Layout 'Dense)
                                                     ('Device ('CUDA 0))
                                                     ('DataType BERTDType)
                                                     ('Shape
                                                        '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                           'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                               (NamedModel
                                                  (Tensor
                                                     ('Gradient 'WithGradient)
                                                     ('Layout 'Dense)
                                                     ('Device ('CUDA 0))
                                                     ('DataType BERTDType)
                                                     ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                         (NamedModel
                                            (GLinear
                                               (NamedModel
                                                  (Tensor
                                                     ('Gradient 'WithGradient)
                                                     ('Layout 'Dense)
                                                     ('Device ('CUDA 0))
                                                     ('DataType BERTDType)
                                                     ('Shape
                                                        '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                           'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                               (NamedModel
                                                  (Tensor
                                                     ('Gradient 'WithGradient)
                                                     ('Layout 'Dense)
                                                     ('Device ('CUDA 0))
                                                     ('DataType BERTDType)
                                                     ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                         Dropout))
                                   Dropout
                                   (NamedModel
                                      (LayerNorm
                                         'WithBias
                                         ('Gradient 'WithGradient)
                                         ('Device ('CUDA 0))
                                         ('DataType BERTDType)
                                         ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                             ()
                             (NamedModel
                                (GTransformerFeedForwardNetwork
                                   ()
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device ('CUDA 0))
                                               ('DataType BERTDType)
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 3072),
                                                     'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device ('CUDA 0))
                                               ('DataType BERTDType)
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3072)])))))
                                   Gelu
                                   ()
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device ('CUDA 0))
                                               ('DataType BERTDType)
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                     'Dim ('Name &quot;*&quot;) ('Size 3072)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device ('CUDA 0))
                                               ('DataType BERTDType)
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                   Dropout
                                   (NamedModel
                                      (LayerNorm
                                         'WithBias
                                         ('Gradient 'WithGradient)
                                         ('Device ('CUDA 0))
                                         ('DataType BERTDType)
                                         ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))))))
                 ()
                 ()))
           (NamedModel
              (Embedding
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device ('CUDA 0))
                 ('DataType BERTDType)
                 ('Dim ('Name &quot;*&quot;) ('Size 30522))
                 ('Dim ('Name &quot;*&quot;) ('Size 768))
                 'Nothing))
           (NamedModel
              (Embedding
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device ('CUDA 0))
                 ('DataType BERTDType)
                 ('Dim ('Name &quot;*&quot;) ('Size 2))
                 ('Dim ('Name &quot;*&quot;) ('Size 768))
                 'Nothing))
           (NamedModel
              (GLMHead
                 ('Dim ('Name &quot;*&quot;) ('Size 768))
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             ('Gradient 'WithGradient)
                             ('Layout 'Dense)
                             ('Device ('CUDA 0))
                             ('DataType BERTDType)
                             ('Shape
                                '[ 'Dim ('Name &quot;*&quot;) ('Size 768), 'Dim ('Name &quot;*&quot;) ('Size 768)])))
                       (NamedModel
                          (Tensor
                             ('Gradient 'WithGradient)
                             ('Layout 'Dense)
                             ('Device ('CUDA 0))
                             ('DataType BERTDType)
                             ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                 Gelu
                 (NamedModel
                    (LayerNorm
                       'WithBias
                       ('Gradient 'WithGradient)
                       ('Device ('CUDA 0))
                       ('DataType BERTDType)
                       ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             ('Gradient 'WithGradient)
                             ('Layout 'Dense)
                             ('Device ('CUDA 0))
                             ('DataType BERTDType)
                             ('Shape
                                '[ 'Dim ('Name &quot;*&quot;) ('Size 30522), 'Dim ('Name &quot;*&quot;) ('Size 768)])))
                       (NamedModel
                          (Tensor
                             ('Gradient 'WithGradient)
                             ('Layout 'Dense)
                             ('Device ('CUDA 0))
                             ('DataType BERTDType)
                             ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 30522)])))))
                 (GBias ())))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (GBERTModel
     (GEncoderOnlyTransformer
        ('Dim ('Name &quot;*&quot;) ('Size 768))
        (NamedModel
           (GTransformer
              (NamedModel
                 (Embedding
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device ('CUDA 0))
                    ('DataType BERTDType)
                    ('Dim ('Name &quot;*&quot;) ('Size 512))
                    ('Dim ('Name &quot;*&quot;) ('Size 768))
                    'Nothing))
              ()
              (NamedModel
                 (LayerNorm
                    'WithBias
                    ('Gradient 'WithGradient)
                    ('Device ('CUDA 0))
                    ('DataType BERTDType)
                    ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))
              Dropout
              (NamedModel
                 (GTransformerStack
                    (Vector
                       12
                       (GTransformerBlock
                          (NamedModel
                             (GSelfAttention
                                ()
                                (NamedModel
                                   (GMultiHeadAttention
                                      ('Dim ('Name &quot;*&quot;) ('Size 12))
                                      ('Dim ('Name &quot;*&quot;) ('Size 64))
                                      ('Dim ('Name &quot;*&quot;) ('Size 768))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device ('CUDA 0))
                                                  ('DataType BERTDType)
                                                  ('Shape
                                                     '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                        'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device ('CUDA 0))
                                                  ('DataType BERTDType)
                                                  ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device ('CUDA 0))
                                                  ('DataType BERTDType)
                                                  ('Shape
                                                     '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                        'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device ('CUDA 0))
                                                  ('DataType BERTDType)
                                                  ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device ('CUDA 0))
                                                  ('DataType BERTDType)
                                                  ('Shape
                                                     '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                        'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device ('CUDA 0))
                                                  ('DataType BERTDType)
                                                  ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device ('CUDA 0))
                                                  ('DataType BERTDType)
                                                  ('Shape
                                                     '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                        'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device ('CUDA 0))
                                                  ('DataType BERTDType)
                                                  ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                      Dropout))
                                Dropout
                                (NamedModel
                                   (LayerNorm
                                      'WithBias
                                      ('Gradient 'WithGradient)
                                      ('Device ('CUDA 0))
                                      ('DataType BERTDType)
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                          ()
                          (NamedModel
                             (GTransformerFeedForwardNetwork
                                ()
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device ('CUDA 0))
                                            ('DataType BERTDType)
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 3072),
                                                  'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device ('CUDA 0))
                                            ('DataType BERTDType)
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3072)])))))
                                Gelu
                                ()
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device ('CUDA 0))
                                            ('DataType BERTDType)
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                  'Dim ('Name &quot;*&quot;) ('Size 3072)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device ('CUDA 0))
                                            ('DataType BERTDType)
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                Dropout
                                (NamedModel
                                   (LayerNorm
                                      'WithBias
                                      ('Gradient 'WithGradient)
                                      ('Device ('CUDA 0))
                                      ('DataType BERTDType)
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))))))
              ()
              ()))
        (NamedModel
           (Embedding
              ('Gradient 'WithGradient)
              ('Layout 'Dense)
              ('Device ('CUDA 0))
              ('DataType BERTDType)
              ('Dim ('Name &quot;*&quot;) ('Size 30522))
              ('Dim ('Name &quot;*&quot;) ('Size 768))
              'Nothing))
        (NamedModel
           (Embedding
              ('Gradient 'WithGradient)
              ('Layout 'Dense)
              ('Device ('CUDA 0))
              ('DataType BERTDType)
              ('Dim ('Name &quot;*&quot;) ('Size 2))
              ('Dim ('Name &quot;*&quot;) ('Size 768))
              'Nothing))
        (NamedModel
           (GLMHead
              ('Dim ('Name &quot;*&quot;) ('Size 768))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (Tensor
                          ('Gradient 'WithGradient)
                          ('Layout 'Dense)
                          ('Device ('CUDA 0))
                          ('DataType BERTDType)
                          ('Shape
                             '[ 'Dim ('Name &quot;*&quot;) ('Size 768), 'Dim ('Name &quot;*&quot;) ('Size 768)])))
                    (NamedModel
                       (Tensor
                          ('Gradient 'WithGradient)
                          ('Layout 'Dense)
                          ('Device ('CUDA 0))
                          ('DataType BERTDType)
                          ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
              Gelu
              (NamedModel
                 (LayerNorm
                    'WithBias
                    ('Gradient 'WithGradient)
                    ('Device ('CUDA 0))
                    ('DataType BERTDType)
                    ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (Tensor
                          ('Gradient 'WithGradient)
                          ('Layout 'Dense)
                          ('Device ('CUDA 0))
                          ('DataType BERTDType)
                          ('Shape
                             '[ 'Dim ('Name &quot;*&quot;) ('Size 30522), 'Dim ('Name &quot;*&quot;) ('Size 768)])))
                    (NamedModel
                       (Tensor
                          ('Gradient 'WithGradient)
                          ('Layout 'Dense)
                          ('Device ('CUDA 0))
                          ('DataType BERTDType)
                          ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 30522)])))))
              (GBias ())))))
-&gt; StateDictKey
-&gt; StateT
     StateDict
     IO
     (GBERTModel
        (GEncoderOnlyTransformer
           ('Dim ('Name &quot;*&quot;) ('Size 768))
           (NamedModel
              (GTransformer
                 (NamedModel
                    (Embedding
                       ('Gradient 'WithGradient)
                       ('Layout 'Dense)
                       ('Device ('CUDA 0))
                       ('DataType BERTDType)
                       ('Dim ('Name &quot;*&quot;) ('Size 512))
                       ('Dim ('Name &quot;*&quot;) ('Size 768))
                       'Nothing))
                 ()
                 (NamedModel
                    (LayerNorm
                       'WithBias
                       ('Gradient 'WithGradient)
                       ('Device ('CUDA 0))
                       ('DataType BERTDType)
                       ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))
                 Dropout
                 (NamedModel
                    (GTransformerStack
                       (Vector
                          12
                          (GTransformerBlock
                             (NamedModel
                                (GSelfAttention
                                   ()
                                   (NamedModel
                                      (GMultiHeadAttention
                                         ('Dim ('Name &quot;*&quot;) ('Size 12))
                                         ('Dim ('Name &quot;*&quot;) ('Size 64))
                                         ('Dim ('Name &quot;*&quot;) ('Size 768))
                                         (NamedModel
                                            (GLinear
                                               (NamedModel
                                                  (Tensor
                                                     ('Gradient 'WithGradient)
                                                     ('Layout 'Dense)
                                                     ('Device ('CUDA 0))
                                                     ('DataType BERTDType)
                                                     ('Shape
                                                        '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                           'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                               (NamedModel
                                                  (Tensor
                                                     ('Gradient 'WithGradient)
                                                     ('Layout 'Dense)
                                                     ('Device ('CUDA 0))
                                                     ('DataType BERTDType)
                                                     ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                         (NamedModel
                                            (GLinear
                                               (NamedModel
                                                  (Tensor
                                                     ('Gradient 'WithGradient)
                                                     ('Layout 'Dense)
                                                     ('Device ('CUDA 0))
                                                     ('DataType BERTDType)
                                                     ('Shape
                                                        '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                           'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                               (NamedModel
                                                  (Tensor
                                                     ('Gradient 'WithGradient)
                                                     ('Layout 'Dense)
                                                     ('Device ('CUDA 0))
                                                     ('DataType BERTDType)
                                                     ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                         (NamedModel
                                            (GLinear
                                               (NamedModel
                                                  (Tensor
                                                     ('Gradient 'WithGradient)
                                                     ('Layout 'Dense)
                                                     ('Device ('CUDA 0))
                                                     ('DataType BERTDType)
                                                     ('Shape
                                                        '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                           'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                               (NamedModel
                                                  (Tensor
                                                     ('Gradient 'WithGradient)
                                                     ('Layout 'Dense)
                                                     ('Device ('CUDA 0))
                                                     ('DataType BERTDType)
                                                     ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                         (NamedModel
                                            (GLinear
                                               (NamedModel
                                                  (Tensor
                                                     ('Gradient 'WithGradient)
                                                     ('Layout 'Dense)
                                                     ('Device ('CUDA 0))
                                                     ('DataType BERTDType)
                                                     ('Shape
                                                        '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                           'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                               (NamedModel
                                                  (Tensor
                                                     ('Gradient 'WithGradient)
                                                     ('Layout 'Dense)
                                                     ('Device ('CUDA 0))
                                                     ('DataType BERTDType)
                                                     ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                         Dropout))
                                   Dropout
                                   (NamedModel
                                      (LayerNorm
                                         'WithBias
                                         ('Gradient 'WithGradient)
                                         ('Device ('CUDA 0))
                                         ('DataType BERTDType)
                                         ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                             ()
                             (NamedModel
                                (GTransformerFeedForwardNetwork
                                   ()
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device ('CUDA 0))
                                               ('DataType BERTDType)
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 3072),
                                                     'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device ('CUDA 0))
                                               ('DataType BERTDType)
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3072)])))))
                                   Gelu
                                   ()
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device ('CUDA 0))
                                               ('DataType BERTDType)
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                     'Dim ('Name &quot;*&quot;) ('Size 3072)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device ('CUDA 0))
                                               ('DataType BERTDType)
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                   Dropout
                                   (NamedModel
                                      (LayerNorm
                                         'WithBias
                                         ('Gradient 'WithGradient)
                                         ('Device ('CUDA 0))
                                         ('DataType BERTDType)
                                         ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))))))
                 ()
                 ()))
           (NamedModel
              (Embedding
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device ('CUDA 0))
                 ('DataType BERTDType)
                 ('Dim ('Name &quot;*&quot;) ('Size 30522))
                 ('Dim ('Name &quot;*&quot;) ('Size 768))
                 'Nothing))
           (NamedModel
              (Embedding
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device ('CUDA 0))
                 ('DataType BERTDType)
                 ('Dim ('Name &quot;*&quot;) ('Size 2))
                 ('Dim ('Name &quot;*&quot;) ('Size 768))
                 'Nothing))
           (NamedModel
              (GLMHead
                 ('Dim ('Name &quot;*&quot;) ('Size 768))
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             ('Gradient 'WithGradient)
                             ('Layout 'Dense)
                             ('Device ('CUDA 0))
                             ('DataType BERTDType)
                             ('Shape
                                '[ 'Dim ('Name &quot;*&quot;) ('Size 768), 'Dim ('Name &quot;*&quot;) ('Size 768)])))
                       (NamedModel
                          (Tensor
                             ('Gradient 'WithGradient)
                             ('Layout 'Dense)
                             ('Device ('CUDA 0))
                             ('DataType BERTDType)
                             ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                 Gelu
                 (NamedModel
                    (LayerNorm
                       'WithBias
                       ('Gradient 'WithGradient)
                       ('Device ('CUDA 0))
                       ('DataType BERTDType)
                       ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             ('Gradient 'WithGradient)
                             ('Layout 'Dense)
                             ('Device ('CUDA 0))
                             ('DataType BERTDType)
                             ('Shape
                                '[ 'Dim ('Name &quot;*&quot;) ('Size 30522), 'Dim ('Name &quot;*&quot;) ('Size 768)])))
                       (NamedModel
                          (Tensor
                             ('Gradient 'WithGradient)
                             ('Layout 'Dense)
                             ('Device ('CUDA 0))
                             ('DataType BERTDType)
                             ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 30522)])))))
                 (GBias ())))))
forall model (m :: * -&gt; *).
(HasStateDict model, MonadIO m, MonadThrow m,
 MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (GBERTModel
     (GEncoderOnlyTransformer
        ('Dim ('Name &quot;*&quot;) ('Size 768))
        (NamedModel
           (GTransformer
              (NamedModel
                 (Embedding
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device ('CUDA 0))
                    ('DataType BERTDType)
                    ('Dim ('Name &quot;*&quot;) ('Size 512))
                    ('Dim ('Name &quot;*&quot;) ('Size 768))
                    'Nothing))
              ()
              (NamedModel
                 (LayerNorm
                    'WithBias
                    ('Gradient 'WithGradient)
                    ('Device ('CUDA 0))
                    ('DataType BERTDType)
                    ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))
              Dropout
              (NamedModel
                 (GTransformerStack
                    (Vector
                       12
                       (GTransformerBlock
                          (NamedModel
                             (GSelfAttention
                                ()
                                (NamedModel
                                   (GMultiHeadAttention
                                      ('Dim ('Name &quot;*&quot;) ('Size 12))
                                      ('Dim ('Name &quot;*&quot;) ('Size 64))
                                      ('Dim ('Name &quot;*&quot;) ('Size 768))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device ('CUDA 0))
                                                  ('DataType BERTDType)
                                                  ('Shape
                                                     '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                        'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device ('CUDA 0))
                                                  ('DataType BERTDType)
                                                  ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device ('CUDA 0))
                                                  ('DataType BERTDType)
                                                  ('Shape
                                                     '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                        'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device ('CUDA 0))
                                                  ('DataType BERTDType)
                                                  ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device ('CUDA 0))
                                                  ('DataType BERTDType)
                                                  ('Shape
                                                     '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                        'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device ('CUDA 0))
                                                  ('DataType BERTDType)
                                                  ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device ('CUDA 0))
                                                  ('DataType BERTDType)
                                                  ('Shape
                                                     '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                        'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device ('CUDA 0))
                                                  ('DataType BERTDType)
                                                  ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                      Dropout))
                                Dropout
                                (NamedModel
                                   (LayerNorm
                                      'WithBias
                                      ('Gradient 'WithGradient)
                                      ('Device ('CUDA 0))
                                      ('DataType BERTDType)
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                          ()
                          (NamedModel
                             (GTransformerFeedForwardNetwork
                                ()
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device ('CUDA 0))
                                            ('DataType BERTDType)
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 3072),
                                                  'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device ('CUDA 0))
                                            ('DataType BERTDType)
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3072)])))))
                                Gelu
                                ()
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device ('CUDA 0))
                                            ('DataType BERTDType)
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                  'Dim ('Name &quot;*&quot;) ('Size 3072)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device ('CUDA 0))
                                            ('DataType BERTDType)
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                Dropout
                                (NamedModel
                                   (LayerNorm
                                      'WithBias
                                      ('Gradient 'WithGradient)
                                      ('Device ('CUDA 0))
                                      ('DataType BERTDType)
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))))))
              ()
              ()))
        (NamedModel
           (Embedding
              ('Gradient 'WithGradient)
              ('Layout 'Dense)
              ('Device ('CUDA 0))
              ('DataType BERTDType)
              ('Dim ('Name &quot;*&quot;) ('Size 30522))
              ('Dim ('Name &quot;*&quot;) ('Size 768))
              'Nothing))
        (NamedModel
           (Embedding
              ('Gradient 'WithGradient)
              ('Layout 'Dense)
              ('Device ('CUDA 0))
              ('DataType BERTDType)
              ('Dim ('Name &quot;*&quot;) ('Size 2))
              ('Dim ('Name &quot;*&quot;) ('Size 768))
              'Nothing))
        (NamedModel
           (GLMHead
              ('Dim ('Name &quot;*&quot;) ('Size 768))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (Tensor
                          ('Gradient 'WithGradient)
                          ('Layout 'Dense)
                          ('Device ('CUDA 0))
                          ('DataType BERTDType)
                          ('Shape
                             '[ 'Dim ('Name &quot;*&quot;) ('Size 768), 'Dim ('Name &quot;*&quot;) ('Size 768)])))
                    (NamedModel
                       (Tensor
                          ('Gradient 'WithGradient)
                          ('Layout 'Dense)
                          ('Device ('CUDA 0))
                          ('DataType BERTDType)
                          ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
              Gelu
              (NamedModel
                 (LayerNorm
                    'WithBias
                    ('Gradient 'WithGradient)
                    ('Device ('CUDA 0))
                    ('DataType BERTDType)
                    ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (Tensor
                          ('Gradient 'WithGradient)
                          ('Layout 'Dense)
                          ('Device ('CUDA 0))
                          ('DataType BERTDType)
                          ('Shape
                             '[ 'Dim ('Name &quot;*&quot;) ('Size 30522), 'Dim ('Name &quot;*&quot;) ('Size 768)])))
                    (NamedModel
                       (Tensor
                          ('Gradient 'WithGradient)
                          ('Layout 'Dense)
                          ('Device ('CUDA 0))
                          ('DataType BERTDType)
                          ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 30522)])))))
              (GBias ())))))
GBERTModel
  (GEncoderOnlyTransformer
     ('Dim ('Name &quot;*&quot;) ('Size 768))
     (NamedModel
        (GTransformer
           (NamedModel
              (EmbeddingSpec
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device ('CUDA 0))
                 ('DataType BERTDType)
                 ('Dim ('Name &quot;*&quot;) ('Size 512))
                 ('Dim ('Name &quot;*&quot;) ('Size 768))
                 'Nothing))
           ()
           (NamedModel
              (LayerNormSpec
                 'WithBias
                 ('Gradient 'WithGradient)
                 ('Device ('CUDA 0))
                 ('DataType BERTDType)
                 ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))
           Dropout
           (NamedModel
              (GTransformerStack
                 (VectorSpec
                    12
                    (GTransformerBlock
                       (NamedModel
                          (GSelfAttention
                             ()
                             (NamedModel
                                (GMultiHeadAttention
                                   ('Dim ('Name &quot;*&quot;) ('Size 12))
                                   ('Dim ('Name &quot;*&quot;) ('Size 64))
                                   ('Dim ('Name &quot;*&quot;) ('Size 768))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device ('CUDA 0))
                                               ('DataType BERTDType)
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                     'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device ('CUDA 0))
                                               ('DataType BERTDType)
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device ('CUDA 0))
                                               ('DataType BERTDType)
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                     'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device ('CUDA 0))
                                               ('DataType BERTDType)
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device ('CUDA 0))
                                               ('DataType BERTDType)
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                     'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device ('CUDA 0))
                                               ('DataType BERTDType)
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device ('CUDA 0))
                                               ('DataType BERTDType)
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                     'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device ('CUDA 0))
                                               ('DataType BERTDType)
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                   Dropout))
                             Dropout
                             (NamedModel
                                (LayerNorm
                                   'WithBias
                                   ('Gradient 'WithGradient)
                                   ('Device ('CUDA 0))
                                   ('DataType BERTDType)
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                       ()
                       (NamedModel
                          (GTransformerFeedForwardNetwork
                             ()
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device ('CUDA 0))
                                         ('DataType BERTDType)
                                         ('Shape
                                            '[ 'Dim ('Name &quot;*&quot;) ('Size 3072),
                                               'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device ('CUDA 0))
                                         ('DataType BERTDType)
                                         ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3072)])))))
                             Gelu
                             ()
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device ('CUDA 0))
                                         ('DataType BERTDType)
                                         ('Shape
                                            '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                               'Dim ('Name &quot;*&quot;) ('Size 3072)])))
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device ('CUDA 0))
                                         ('DataType BERTDType)
                                         ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                             Dropout
                             (NamedModel
                                (LayerNorm
                                   'WithBias
                                   ('Gradient 'WithGradient)
                                   ('Device ('CUDA 0))
                                   ('DataType BERTDType)
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))))))
           ()
           ()))
     (NamedModel
        (EmbeddingSpec
           ('Gradient 'WithGradient)
           ('Layout 'Dense)
           ('Device ('CUDA 0))
           ('DataType BERTDType)
           ('Dim ('Name &quot;*&quot;) ('Size 30522))
           ('Dim ('Name &quot;*&quot;) ('Size 768))
           'Nothing))
     (NamedModel
        (EmbeddingSpec
           ('Gradient 'WithGradient)
           ('Layout 'Dense)
           ('Device ('CUDA 0))
           ('DataType BERTDType)
           ('Dim ('Name &quot;*&quot;) ('Size 2))
           ('Dim ('Name &quot;*&quot;) ('Size 768))
           'Nothing))
     (NamedModel
        (GLMHead
           ('Dim ('Name &quot;*&quot;) ('Size 768))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       ('Gradient 'WithGradient)
                       ('Layout 'Dense)
                       ('Device ('CUDA 0))
                       ('DataType BERTDType)
                       ('Shape
                          '[ 'Dim ('Name &quot;*&quot;) ('Size 768), 'Dim ('Name &quot;*&quot;) ('Size 768)])))
                 (NamedModel
                    (TensorSpec
                       ('Gradient 'WithGradient)
                       ('Layout 'Dense)
                       ('Device ('CUDA 0))
                       ('DataType BERTDType)
                       ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
           Gelu
           (NamedModel
              (LayerNormSpec
                 'WithBias
                 ('Gradient 'WithGradient)
                 ('Device ('CUDA 0))
                 ('DataType BERTDType)
                 ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       ('Gradient 'WithGradient)
                       ('Layout 'Dense)
                       ('Device ('CUDA 0))
                       ('DataType BERTDType)
                       ('Shape
                          '[ 'Dim ('Name &quot;*&quot;) ('Size 30522), 'Dim ('Name &quot;*&quot;) ('Size 768)])))
                 (NamedModel
                    (TensorSpec
                       ('Gradient 'WithGradient)
                       ('Layout 'Dense)
                       ('Device ('CUDA 0))
                       ('DataType BERTDType)
                       ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 30522)])))))
           (GBias ()))))
</span><a href="#local-6989586621679582551"><span class="hs-identifier hs-var">spec</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679582543"><span class="annot"><span class="annottext">g :: Generator ('Device ('CUDA 0))
</span><a href="#local-6989586621679582543"><span class="hs-identifier hs-var hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDevice ('Device ('CUDA 0))
-&gt; Word64 -&gt; Generator ('Device ('CUDA 0))
forall (device :: Device (DeviceType Nat)).
SDevice device -&gt; Word64 -&gt; Generator device
</span><a href="Torch.GraduallyTyped.Random.html#sMkGenerator"><span class="hs-identifier hs-var">sMkGenerator</span></a></span><span> </span><span class="annot"><span class="annottext">SDevice ('Device ('CUDA 0))
</span><a href="#local-6989586621679582554"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span>    </span><span id="local-6989586621679582542"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679582542"><span class="hs-identifier hs-var">ids</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Tokenizer -&gt; IO [Int]) -&gt; IO [Int]
forall a. (Tokenizer -&gt; IO a) -&gt; IO a
</span><a href="Torch.GraduallyTyped.NN.Transformer.BERT.html#withTokenizer"><span class="hs-identifier hs-var">withTokenizer</span></a></span><span> </span><span class="annot"><span class="annottext">((Tokenizer -&gt; IO [Int]) -&gt; IO [Int])
-&gt; (Tokenizer -&gt; IO [Int]) -&gt; IO [Int]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679582541"><span class="annot"><span class="annottext">Tokenizer
</span><a href="#local-6989586621679582541"><span class="hs-identifier hs-var">tokenizer</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-52"></span><span>      </span><span id="local-6989586621679582540"><span class="annot"><span class="annottext">Encoding
</span><a href="#local-6989586621679582540"><span class="hs-identifier hs-var">encoding</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Tokenizer -&gt; FilePath -&gt; IO Encoding
</span><a href="../file:///nix/store/dlcs5qms427bs47cbn98gjkr7lmzcmdh-tokenizers-lib-tokenizers-0.1.0.0-haddock-doc/share/doc/tokenizers/html/src"><span class="hs-identifier hs-var">Tokenizers.encode</span></a></span><span> </span><span class="annot"><span class="annottext">Tokenizer
</span><a href="#local-6989586621679582541"><span class="hs-identifier hs-var">tokenizer</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;[CLS] the capital of france is [MASK]. [SEP]&quot;</span></span><span>
</span><span id="line-53"></span><span>      </span><span class="annot"><span class="annottext">Encoding -&gt; IO [Int]
</span><a href="../file:///nix/store/dlcs5qms427bs47cbn98gjkr7lmzcmdh-tokenizers-lib-tokenizers-0.1.0.0-haddock-doc/share/doc/tokenizers/html/src"><span class="hs-identifier hs-var">Tokenizers.getIDs</span></a></span><span> </span><span class="annot"><span class="annottext">Encoding
</span><a href="#local-6989586621679582540"><span class="hs-identifier hs-var">encoding</span></a></span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679582537"><span class="annot"><span class="annottext">seqSize :: SSize 'UncheckedSize
</span><a href="#local-6989586621679582537"><span class="hs-identifier hs-var hs-var">seqSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; SSize 'UncheckedSize
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SUncheckedSize"><span class="hs-identifier hs-var">SUncheckedSize</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; SSize 'UncheckedSize)
-&gt; (Int -&gt; Integer) -&gt; Int -&gt; SSize 'UncheckedSize
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; SSize 'UncheckedSize) -&gt; Int -&gt; SSize 'UncheckedSize
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679582542"><span class="hs-identifier hs-var">ids</span></a></span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span>    </span><span id="local-6989586621679582533"><span class="annot"><span class="annottext">Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device ('CUDA 0))
  ('DataType 'Int64)
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize])
</span><a href="#local-6989586621679582533"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-57"></span><span>      </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 1))
-&gt; SDim ('Dim ('Name &quot;*&quot;) 'UncheckedSize)
-&gt; SDevice ('Device ('CUDA 0))
-&gt; [[Int]]
-&gt; IO
     (Tensor
        ('Gradient 'WithoutGradient)
        ('Layout 'Dense)
        ('Device ('CUDA 0))
        ('DataType 'Int64)
        ('Shape
           '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize]))
forall (batchDim :: Dim (Name Symbol) (Size Nat))
       (seqDim :: Dim (Name Symbol) (Size Nat))
       (device :: Device (DeviceType Nat)) (m :: * -&gt; *) output.
(MonadThrow m, SGetDim batchDim, SGetDim seqDim,
 'Shape '[batchDim, seqDim]
 ~ Seq
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) 'UncheckedSize,
           'Dim ('Name &quot;*&quot;) 'UncheckedSize]
      &lt;+&gt; 'Shape '[batchDim, seqDim])
     ('Shape '[batchDim, seqDim]),
 output
 ~ Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     device
     ('DataType 'Int64)
     ('Shape '[batchDim, seqDim])) =&gt;
SDim batchDim
-&gt; SDim seqDim -&gt; SDevice device -&gt; [[Int]] -&gt; m output
</span><a href="Torch.GraduallyTyped.NN.Transformer.BERT.Common.html#mkBERTInput"><span class="hs-identifier hs-var">mkBERTInput</span></a></span><span>
</span><span id="line-58"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KnownSymbol &quot;*&quot; =&gt; SName ('Name &quot;*&quot;)
forall (name :: Symbol). KnownSymbol name =&gt; SName ('Name name)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SName"><span class="hs-identifier hs-var">SName</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span> </span><span class="annot"><span class="annottext">SName ('Name &quot;*&quot;)
-&gt; SSize ('Size 1) -&gt; SDim ('Dim ('Name &quot;*&quot;) ('Size 1))
forall (name :: Name Symbol) (size :: Size Nat).
SName name -&gt; SSize size -&gt; SDim ('Dim name size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%26%3A"><span class="hs-operator hs-var">:&amp;:</span></a></span><span> </span><span class="annot"><span class="annottext">KnownNat 1 =&gt; SSize ('Size 1)
forall (size :: Nat). KnownNat size =&gt; SSize ('Size size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SSize"><span class="hs-identifier hs-var">SSize</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KnownSymbol &quot;*&quot; =&gt; SName ('Name &quot;*&quot;)
forall (name :: Symbol). KnownSymbol name =&gt; SName ('Name name)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SName"><span class="hs-identifier hs-var">SName</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span> </span><span class="annot"><span class="annottext">SName ('Name &quot;*&quot;)
-&gt; SSize 'UncheckedSize -&gt; SDim ('Dim ('Name &quot;*&quot;) 'UncheckedSize)
forall (name :: Name Symbol) (size :: Size Nat).
SName name -&gt; SSize size -&gt; SDim ('Dim name size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%26%3A"><span class="hs-operator hs-var">:&amp;:</span></a></span><span> </span><span class="annot"><span class="annottext">SSize 'UncheckedSize
</span><a href="#local-6989586621679582537"><span class="hs-identifier hs-var">seqSize</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span>        </span><span class="annot"><span class="annottext">SDevice ('Device ('CUDA 0))
</span><a href="#local-6989586621679582554"><span class="hs-identifier hs-var">device</span></a></span><span>
</span><span id="line-61"></span><span>        </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679582542"><span class="hs-identifier hs-var">ids</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679582529"><span class="annot"><span class="annottext">inputType :: Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device ('CUDA 0))
  ('DataType 'Int64)
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize])
</span><a href="#local-6989586621679582529"><span class="hs-identifier hs-var hs-var">inputType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-63"></span><span>          </span><span class="annot"><span class="annottext">TensorSpec
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device ('CUDA 0))
  ('DataType 'Int64)
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize])
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device ('CUDA 0))
     ('DataType 'Int64)
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize])
forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)]).
TensorSpec gradient layout device dataType shape
-&gt; Tensor gradient layout device dataType shape
</span><a href="Torch.GraduallyTyped.Tensor.Creation.html#sZeros"><span class="hs-identifier hs-var">sZeros</span></a></span><span> </span><span class="annot"><span class="annottext">(TensorSpec
   ('Gradient 'WithoutGradient)
   ('Layout 'Dense)
   ('Device ('CUDA 0))
   ('DataType 'Int64)
   ('Shape
      '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize])
 -&gt; Tensor
      ('Gradient 'WithoutGradient)
      ('Layout 'Dense)
      ('Device ('CUDA 0))
      ('DataType 'Int64)
      ('Shape
         '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize]))
-&gt; TensorSpec
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device ('CUDA 0))
     ('DataType 'Int64)
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize])
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device ('CUDA 0))
     ('DataType 'Int64)
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-64"></span><span>            </span><span class="annot"><span class="annottext">SGradient ('Gradient 'WithoutGradient)
-&gt; SLayout ('Layout 'Dense)
-&gt; SDevice ('Device ('CUDA 0))
-&gt; SDataType ('DataType 'Int64)
-&gt; SShape
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize])
-&gt; TensorSpec
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device ('CUDA 0))
     ('DataType 'Int64)
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize])
forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)]).
SGradient gradient
-&gt; SLayout layout
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SShape shape
-&gt; TensorSpec gradient layout device dataType shape
</span><a href="Torch.GraduallyTyped.Tensor.Type.html#TensorSpec"><span class="hs-identifier hs-var">TensorSpec</span></a></span><span>
</span><span id="line-65"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SRequiresGradient 'WithoutGradient
-&gt; SGradient ('Gradient 'WithoutGradient)
forall (requiresGradient :: RequiresGradient).
SRequiresGradient requiresGradient
-&gt; SGradient ('Gradient requiresGradient)
</span><a href="Torch.GraduallyTyped.RequiresGradient.html#SGradient"><span class="hs-identifier hs-var">SGradient</span></a></span><span> </span><span class="annot"><span class="annottext">SRequiresGradient 'WithoutGradient
</span><a href="Torch.GraduallyTyped.RequiresGradient.html#SWithoutGradient"><span class="hs-identifier hs-var">SWithoutGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SLayoutType 'Dense -&gt; SLayout ('Layout 'Dense)
forall (layoutType :: LayoutType).
SLayoutType layoutType -&gt; SLayout ('Layout layoutType)
</span><a href="Torch.GraduallyTyped.Layout.html#SLayout"><span class="hs-identifier hs-var">SLayout</span></a></span><span> </span><span class="annot"><span class="annottext">SLayoutType 'Dense
</span><a href="Torch.GraduallyTyped.Layout.html#SDense"><span class="hs-identifier hs-var">SDense</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>              </span><span class="annot"><span class="annottext">SDevice ('Device ('CUDA 0))
</span><a href="#local-6989586621679582554"><span class="hs-identifier hs-var">device</span></a></span><span>
</span><span id="line-68"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDType 'Int64 -&gt; SDataType ('DataType 'Int64)
forall (dType :: DType).
SDType dType -&gt; SDataType ('DataType dType)
</span><a href="Torch.GraduallyTyped.DType.html#SDataType"><span class="hs-identifier hs-var">SDataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDType 'Int64
</span><a href="Torch.GraduallyTyped.DType.html#SInt64"><span class="hs-identifier hs-var">SInt64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SList
  '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize]
-&gt; SShape
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize])
forall (dims :: [Dim (Name Symbol) (Size Nat)]).
SList dims -&gt; SShape ('Shape dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SShape"><span class="hs-identifier hs-var">SShape</span></a></span><span> </span><span class="annot"><span class="annottext">(SList
   '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize]
 -&gt; SShape
      ('Shape
         '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize]))
-&gt; SList
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize]
-&gt; SShape
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">KnownSymbol &quot;*&quot; =&gt; SName ('Name &quot;*&quot;)
forall (name :: Symbol). KnownSymbol name =&gt; SName ('Name name)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SName"><span class="hs-identifier hs-var">SName</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span> </span><span class="annot"><span class="annottext">SName ('Name &quot;*&quot;)
-&gt; SSize ('Size 1) -&gt; SDim ('Dim ('Name &quot;*&quot;) ('Size 1))
forall (name :: Name Symbol) (size :: Size Nat).
SName name -&gt; SSize size -&gt; SDim ('Dim name size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%26%3A"><span class="hs-operator hs-var">:&amp;:</span></a></span><span> </span><span class="annot"><span class="annottext">KnownNat 1 =&gt; SSize ('Size 1)
forall (size :: Nat). KnownNat size =&gt; SSize ('Size size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SSize"><span class="hs-identifier hs-var">SSize</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 1))
-&gt; SList '[ 'Dim ('Name &quot;*&quot;) 'UncheckedSize]
-&gt; SList
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">KnownSymbol &quot;*&quot; =&gt; SName ('Name &quot;*&quot;)
forall (name :: Symbol). KnownSymbol name =&gt; SName ('Name name)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SName"><span class="hs-identifier hs-var">SName</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span> </span><span class="annot"><span class="annottext">SName ('Name &quot;*&quot;)
-&gt; SSize 'UncheckedSize -&gt; SDim ('Dim ('Name &quot;*&quot;) 'UncheckedSize)
forall (name :: Name Symbol) (size :: Size Nat).
SName name -&gt; SSize size -&gt; SDim ('Dim name size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%26%3A"><span class="hs-operator hs-var">:&amp;:</span></a></span><span> </span><span class="annot"><span class="annottext">SSize 'UncheckedSize
</span><a href="#local-6989586621679582537"><span class="hs-identifier hs-var">seqSize</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) 'UncheckedSize)
-&gt; SList '[] -&gt; SList '[ 'Dim ('Name &quot;*&quot;) 'UncheckedSize]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SList '[]
forall a. SList '[]
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">SNil</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>        </span><span id="local-6989586621679582521"><span class="annot"><span class="annottext">pos :: Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device ('CUDA 0))
  ('DataType 'Int64)
  ('Shape '[ 'Dim ('Name &quot;*&quot;) 'UncheckedSize])
</span><a href="#local-6989586621679582521"><span class="hs-identifier hs-var hs-var">pos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-71"></span><span>          </span><span class="annot"><span class="annottext">SGradient ('Gradient 'WithoutGradient)
-&gt; SLayout ('Layout 'Dense)
-&gt; SDevice ('Device ('CUDA 0))
-&gt; SDataType ('DataType 'Int64)
-&gt; SSize 'UncheckedSize
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device ('CUDA 0))
     ('DataType 'Int64)
     ('Shape '[ 'Dim ('Name &quot;*&quot;) 'UncheckedSize])
forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType) (size :: Size Nat)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)]).
(shape ~ 'Shape '[ 'Dim ('Name &quot;*&quot;) size]) =&gt;
SGradient gradient
-&gt; SLayout layout
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SSize size
-&gt; Tensor gradient layout device dataType shape
</span><a href="Torch.GraduallyTyped.Tensor.Creation.html#sArangeNaturals"><span class="hs-identifier hs-var">sArangeNaturals</span></a></span><span>
</span><span id="line-72"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SRequiresGradient 'WithoutGradient
-&gt; SGradient ('Gradient 'WithoutGradient)
forall (requiresGradient :: RequiresGradient).
SRequiresGradient requiresGradient
-&gt; SGradient ('Gradient requiresGradient)
</span><a href="Torch.GraduallyTyped.RequiresGradient.html#SGradient"><span class="hs-identifier hs-var">SGradient</span></a></span><span> </span><span class="annot"><span class="annottext">SRequiresGradient 'WithoutGradient
</span><a href="Torch.GraduallyTyped.RequiresGradient.html#SWithoutGradient"><span class="hs-identifier hs-var">SWithoutGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SLayoutType 'Dense -&gt; SLayout ('Layout 'Dense)
forall (layoutType :: LayoutType).
SLayoutType layoutType -&gt; SLayout ('Layout layoutType)
</span><a href="Torch.GraduallyTyped.Layout.html#SLayout"><span class="hs-identifier hs-var">SLayout</span></a></span><span> </span><span class="annot"><span class="annottext">SLayoutType 'Dense
</span><a href="Torch.GraduallyTyped.Layout.html#SDense"><span class="hs-identifier hs-var">SDense</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>            </span><span class="annot"><span class="annottext">SDevice ('Device ('CUDA 0))
</span><a href="#local-6989586621679582554"><span class="hs-identifier hs-var">device</span></a></span><span>
</span><span id="line-75"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDType 'Int64 -&gt; SDataType ('DataType 'Int64)
forall (dType :: DType).
SDType dType -&gt; SDataType ('DataType dType)
</span><a href="Torch.GraduallyTyped.DType.html#SDataType"><span class="hs-identifier hs-var">SDataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDType 'Int64
</span><a href="Torch.GraduallyTyped.DType.html#SInt64"><span class="hs-identifier hs-var">SInt64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span>            </span><span class="annot"><span class="annottext">SSize 'UncheckedSize
</span><a href="#local-6989586621679582537"><span class="hs-identifier hs-var">seqSize</span></a></span><span>
</span><span id="line-77"></span><span>        </span><span id="local-6989586621679582520"><span class="annot"><span class="annottext">paddingMask :: Tensor
  ('Gradient 'WithoutGradient)
  (Unify (Layout LayoutType) ('Layout 'Dense) ('Layout 'Dense))
  ('Device ('CUDA 0))
  (Seq
     (Unify (DataType DType) ('DataType 'Int64) ('DataType 'Int64))
     ('DataType 'Bool))
  (BroadcastShapesF
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize])
     ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 1)]))
</span><a href="#local-6989586621679582520"><span class="hs-identifier hs-var hs-var">paddingMask</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device ('CUDA 0))
  ('DataType 'Int64)
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize])
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) ('Layout 'Dense))
     ('Device ('CUDA 0))
     (Seq
        (Unify (DataType DType) ('DataType 'Int64) ('DataType 'Int64))
        ('DataType 'Bool))
     (BroadcastShapesF
        ('Shape
           '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize])
        ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 1)]))
forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)]) output.
MkTransformerPaddingMaskC layout device dataType shape output =&gt;
Tensor gradient layout device dataType shape -&gt; output
</span><a href="Torch.GraduallyTyped.NN.Transformer.BERT.Common.html#mkBERTPaddingMask"><span class="hs-identifier hs-var">mkBERTPaddingMask</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device ('CUDA 0))
  ('DataType 'Int64)
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize])
</span><a href="#local-6989586621679582533"><span class="hs-identifier hs-var">input</span></a></span><span>
</span><span id="line-78"></span><span>    </span><span id="local-6989586621679582518"><span class="annot"><span class="annottext">Tensor
  ('Gradient 'WithoutGradient)
  (Unify
     (Layout LayoutType)
     (Unify (Layout LayoutType) ('Layout 'Dense) ('Layout 'Dense))
     ('Layout 'Dense))
  ('Device ('CUDA 0))
  (Seq
     (Unify
        (DataType DType)
        (Seq
           (Unify (DataType DType) ('DataType 'Int64) ('DataType 'Int64))
           ('DataType 'Bool))
        ('DataType 'Bool))
     ('DataType BERTDType))
  (BroadcastShapesF
     (UnsqueezeF
        ('SelectDim ('ByIndex 1))
        (BroadcastShapesF
           ('Shape
              '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize])
           ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 1)])))
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 1),
           GetDimF
             ('SelectDim ('ByIndex 1))
             (BroadcastShapesF
                ('Shape
                   '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize])
                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 1)])),
           GetDimF
             ('SelectDim ('ByIndex 1))
             (BroadcastShapesF
                ('Shape
                   '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize])
                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 1)]))]))
</span><a href="#local-6989586621679582518"><span class="hs-identifier hs-var">attentionMask</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SDataType ('DataType BERTDType)
-&gt; Double
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) ('Layout 'Dense))
     ('Device ('CUDA 0))
     (Seq
        (Unify (DataType DType) ('DataType 'Int64) ('DataType 'Int64))
        ('DataType 'Bool))
     (BroadcastShapesF
        ('Shape
           '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize])
        ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 1)]))
-&gt; IO
     (Tensor
        ('Gradient 'WithoutGradient)
        (Unify
           (Layout LayoutType)
           (Unify (Layout LayoutType) ('Layout 'Dense) ('Layout 'Dense))
           ('Layout 'Dense))
        ('Device ('CUDA 0))
        (Seq
           (Unify
              (DataType DType)
              (Seq
                 (Unify (DataType DType) ('DataType 'Int64) ('DataType 'Int64))
                 ('DataType 'Bool))
              ('DataType 'Bool))
           ('DataType BERTDType))
        (BroadcastShapesF
           (UnsqueezeF
              ('SelectDim ('ByIndex 1))
              (BroadcastShapesF
                 ('Shape
                    '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize])
                 ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 1)])))
           ('Shape
              '[ 'Dim ('Name &quot;*&quot;) ('Size 1),
                 GetDimF
                   ('SelectDim ('ByIndex 1))
                   (BroadcastShapesF
                      ('Shape
                         '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize])
                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 1)])),
                 GetDimF
                   ('SelectDim ('ByIndex 1))
                   (BroadcastShapesF
                      ('Shape
                         '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize])
                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 1)]))])))
forall (m :: * -&gt; *) (transformerDataType :: DataType DType)
       (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (seqDim :: Dim (Name Symbol) (Size Nat)) output.
(MonadThrow m,
 MkTransformerAttentionMaskC
   transformerDataType
   gradient
   layout
   device
   dataType
   shape
   seqDim
   output) =&gt;
SDataType transformerDataType
-&gt; Double
-&gt; Tensor gradient layout device dataType shape
-&gt; m output
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#mkTransformerAttentionMask"><span class="hs-identifier hs-var">mkTransformerAttentionMask</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType ('DataType BERTDType)
</span><a href="Torch.GraduallyTyped.NN.Transformer.BERT.Common.html#bertDataType"><span class="hs-identifier hs-var">bertDataType</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.BERT.Common.html#bertAttentionMaskBias"><span class="hs-identifier hs-var">bertAttentionMaskBias</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  ('Gradient 'WithoutGradient)
  (Unify (Layout LayoutType) ('Layout 'Dense) ('Layout 'Dense))
  ('Device ('CUDA 0))
  (Seq
     (Unify (DataType DType) ('DataType 'Int64) ('DataType 'Int64))
     ('DataType 'Bool))
  (BroadcastShapesF
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize])
     ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 1)]))
</span><a href="#local-6989586621679582520"><span class="hs-identifier hs-var">paddingMask</span></a></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679582515"><span class="annot"><span class="annottext">eotInput :: EncoderOnlyTransformerInput
  (Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device ('CUDA 0))
     ('DataType 'Int64)
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize]))
  (Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device ('CUDA 0))
     ('DataType 'Int64)
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize]))
  (Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device ('CUDA 0))
     ('DataType 'Int64)
     ('Shape '[ 'Dim ('Name &quot;*&quot;) 'UncheckedSize]))
  (Tensor
     ('Gradient 'WithoutGradient)
     (Unify
        (Layout LayoutType)
        (Unify (Layout LayoutType) ('Layout 'Dense) ('Layout 'Dense))
        ('Layout 'Dense))
     ('Device ('CUDA 0))
     (Seq
        (Unify
           (DataType DType)
           (Seq
              (Unify (DataType DType) ('DataType 'Int64) ('DataType 'Int64))
              ('DataType 'Bool))
           ('DataType 'Bool))
        ('DataType BERTDType))
     (BroadcastShapesF
        (UnsqueezeF
           ('SelectDim ('ByIndex 1))
           (BroadcastShapesF
              ('Shape
                 '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize])
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 1)])))
        ('Shape
           '[ 'Dim ('Name &quot;*&quot;) ('Size 1),
              GetDimF
                ('SelectDim ('ByIndex 1))
                (BroadcastShapesF
                   ('Shape
                      '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize])
                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 1)])),
              GetDimF
                ('SelectDim ('ByIndex 1))
                (BroadcastShapesF
                   ('Shape
                      '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize])
                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 1)]))])))
</span><a href="#local-6989586621679582515"><span class="hs-identifier hs-var hs-var">eotInput</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device ('CUDA 0))
  ('DataType 'Int64)
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize])
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device ('CUDA 0))
     ('DataType 'Int64)
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize])
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device ('CUDA 0))
     ('DataType 'Int64)
     ('Shape '[ 'Dim ('Name &quot;*&quot;) 'UncheckedSize])
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     (Unify
        (Layout LayoutType)
        (Unify (Layout LayoutType) ('Layout 'Dense) ('Layout 'Dense))
        ('Layout 'Dense))
     ('Device ('CUDA 0))
     (Seq
        (Unify
           (DataType DType)
           (Seq
              (Unify (DataType DType) ('DataType 'Int64) ('DataType 'Int64))
              ('DataType 'Bool))
           ('DataType 'Bool))
        ('DataType BERTDType))
     (BroadcastShapesF
        (UnsqueezeF
           ('SelectDim ('ByIndex 1))
           (BroadcastShapesF
              ('Shape
                 '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize])
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 1)])))
        ('Shape
           '[ 'Dim ('Name &quot;*&quot;) ('Size 1),
              GetDimF
                ('SelectDim ('ByIndex 1))
                (BroadcastShapesF
                   ('Shape
                      '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize])
                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 1)])),
              GetDimF
                ('SelectDim ('ByIndex 1))
                (BroadcastShapesF
                   ('Shape
                      '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize])
                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 1)]))]))
-&gt; EncoderOnlyTransformerInput
     (Tensor
        ('Gradient 'WithoutGradient)
        ('Layout 'Dense)
        ('Device ('CUDA 0))
        ('DataType 'Int64)
        ('Shape
           '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize]))
     (Tensor
        ('Gradient 'WithoutGradient)
        ('Layout 'Dense)
        ('Device ('CUDA 0))
        ('DataType 'Int64)
        ('Shape
           '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize]))
     (Tensor
        ('Gradient 'WithoutGradient)
        ('Layout 'Dense)
        ('Device ('CUDA 0))
        ('DataType 'Int64)
        ('Shape '[ 'Dim ('Name &quot;*&quot;) 'UncheckedSize]))
     (Tensor
        ('Gradient 'WithoutGradient)
        (Unify
           (Layout LayoutType)
           (Unify (Layout LayoutType) ('Layout 'Dense) ('Layout 'Dense))
           ('Layout 'Dense))
        ('Device ('CUDA 0))
        (Seq
           (Unify
              (DataType DType)
              (Seq
                 (Unify (DataType DType) ('DataType 'Int64) ('DataType 'Int64))
                 ('DataType 'Bool))
              ('DataType 'Bool))
           ('DataType BERTDType))
        (BroadcastShapesF
           (UnsqueezeF
              ('SelectDim ('ByIndex 1))
              (BroadcastShapesF
                 ('Shape
                    '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize])
                 ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 1)])))
           ('Shape
              '[ 'Dim ('Name &quot;*&quot;) ('Size 1),
                 GetDimF
                   ('SelectDim ('ByIndex 1))
                   (BroadcastShapesF
                      ('Shape
                         '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize])
                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 1)])),
                 GetDimF
                   ('SelectDim ('ByIndex 1))
                   (BroadcastShapesF
                      ('Shape
                         '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize])
                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 1)]))])))
forall input inputType pos attentionMask.
input
-&gt; inputType
-&gt; pos
-&gt; attentionMask
-&gt; EncoderOnlyTransformerInput input inputType pos attentionMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EncoderOnlyTransformerInput"><span class="hs-identifier hs-var">EncoderOnlyTransformerInput</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device ('CUDA 0))
  ('DataType 'Int64)
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize])
</span><a href="#local-6989586621679582533"><span class="hs-identifier hs-var">input</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device ('CUDA 0))
  ('DataType 'Int64)
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize])
</span><a href="#local-6989586621679582529"><span class="hs-identifier hs-var">inputType</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device ('CUDA 0))
  ('DataType 'Int64)
  ('Shape '[ 'Dim ('Name &quot;*&quot;) 'UncheckedSize])
</span><a href="#local-6989586621679582521"><span class="hs-identifier hs-var">pos</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  ('Gradient 'WithoutGradient)
  (Unify
     (Layout LayoutType)
     (Unify (Layout LayoutType) ('Layout 'Dense) ('Layout 'Dense))
     ('Layout 'Dense))
  ('Device ('CUDA 0))
  (Seq
     (Unify
        (DataType DType)
        (Seq
           (Unify (DataType DType) ('DataType 'Int64) ('DataType 'Int64))
           ('DataType 'Bool))
        ('DataType 'Bool))
     ('DataType BERTDType))
  (BroadcastShapesF
     (UnsqueezeF
        ('SelectDim ('ByIndex 1))
        (BroadcastShapesF
           ('Shape
              '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize])
           ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 1)])))
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 1),
           GetDimF
             ('SelectDim ('ByIndex 1))
             (BroadcastShapesF
                ('Shape
                   '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize])
                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 1)])),
           GetDimF
             ('SelectDim ('ByIndex 1))
             (BroadcastShapesF
                ('Shape
                   '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize])
                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 1)]))]))
</span><a href="#local-6989586621679582518"><span class="hs-identifier hs-var">attentionMask</span></a></span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EncoderOnlyTransformerOutput"><span class="hs-identifier hs-type">EncoderOnlyTransformerOutput</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679582512"><span class="annot"><span class="annottext">Tensor
  ('Gradient 'WithGradient)
  (Unify
     (Layout LayoutType)
     ('Layout 'Dense)
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify
                 (Layout LayoutType)
                 (Unify
                    (Layout LayoutType)
                    ('Layout 'Dense)
                    (Unify
                       (Layout LayoutType)
                       (Unify
                          (Layout LayoutType)
                          ('Layout 'Dense)
                          (Unify
                             (Layout LayoutType)
                             (Unify
                                (Layout LayoutType)
                                ('Layout 'Dense)
                                (Unify
                                   (Layout LayoutType)
                                   ('Layout 'Dense)
                                   (Unify
                                      (Layout LayoutType)
                                      ('Layout 'Dense)
                                      (Unify
                                         (Layout LayoutType)
                                         (Unify
                                            (Layout LayoutType)
                                            ('Layout 'Dense)
                                            (Unify
                                               (Layout LayoutType)
                                               ('Layout 'Dense)
                                               (Unify
                                                  (Layout LayoutType)
                                                  (Unify
                                                     (Layout LayoutType)
                                                     ('Layout 'Dense)
                                                     ('Layout 'Dense))
                                                  ('Layout 'Dense))))
                                         ('Layout 'Dense)))))
                             (Unify
                                (Layout LayoutType)
                                ('Layout 'Dense)
                                (Unify
                                   (Layout LayoutType)
                                   ('Layout 'Dense)
                                   (Unify
                                      (Layout LayoutType)
                                      ('Layout 'Dense)
                                      (Unify
                                         (Layout LayoutType)
                                         ('Layout 'Dense)
                                         (Unify
                                            (Layout LayoutType)
                                            ('Layout 'Dense)
                                            (Unify
                                               (Layout LayoutType)
                                               (Unify
                                                  (Layout LayoutType)
                                                  ('Layout 'Dense)
                                                  (Unify
                                                     (Layout LayoutType)
                                                     ('Layout 'Dense)
                                                     (Unify
                                                        (Layout LayoutType)
                                                        (Unify
                                                           (Layout LayoutType)
                                                           ('Layout 'Dense)
                                                           ('Layout 'Dense))
                                                        ('Layout 'Dense))))
                                               ('Layout 'Dense)))))))))
                       ('Layout 'Dense)))
                 (Unify
                    (Layout LayoutType)
                    ('Layout 'Dense)
                    (Unify
                       (Layout LayoutType)
                       ('Layout 'Dense)
                       (Unify
                          (Layout LayoutType)
                          ('Layout 'Dense)
                          (Unify
                             (Layout LayoutType)
                             (Unify
                                (Layout LayoutType)
                                ('Layout 'Dense)
                                (Unify
                                   (Layout LayoutType)
                                   (Unify
                                      (Layout LayoutType)
                                      ('Layout 'Dense)
                                      (Unify
                                         (Layout LayoutType)
                                         ('Layout 'Dense)
                                         (Unify
                                            (Layout LayoutType)
                                            ('Layout 'Dense)
                                            (Unify
                                               (Layout LayoutType)
                                               (Unify
                                                  (Layout LayoutType)
                                                  ('Layout 'Dense)
                                                  (Unify
                                                     (Layout LayoutType)
                                                     ('Layout 'Dense)
                                                     (Unify
                                                        (Layout LayoutType)
                                                        (Unify
                                                           (Layout LayoutType)
                                                           ('Layout 'Dense)
                                                           ('Layout 'Dense))
                                                        ('Layout 'Dense))))
                                               ('Layout 'Dense)))))
                                   (Unify
                                      (Layout LayoutType)
                                      ('Layout 'Dense)
                                      (Unify
                                         (Layout LayoutType)
                                         ('Layout 'Dense)
                                         (Unify
                                            (Layout LayoutType)
                                            ('Layout 'Dense)
                                            (Unify
                                               (Layout LayoutType)
                                               ('Layout 'Dense)
                                               (Unify
                                                  (Layout LayoutType)
                                                  ('Layout 'Dense)
                                                  (Unify
                                                     (Layout LayoutType)
                                                     (Unify
                                                        (Layout LayoutType)
                                                        ('Layout 'Dense)
                                                        (Unify
                                                           (Layout LayoutType)
                                                           ('Layout 'Dense)
                                                           (Unify
                                                              (Layout LayoutType)
                                                              (Unify
                                                                 (Layout LayoutType)
                                                                 ('Layout 'Dense)
                                                                 ('Layout 'Dense))
                                                              ('Layout 'Dense))))
                                                     ('Layout 'Dense)))))))))
                             ('Layout 'Dense))))))))))
  (Unify
     (Device (DeviceType Nat))
     ('Device ('CUDA 0))
     (Unify
        (Device (DeviceType Nat))
        ('Device ('CUDA 0))
        (Unify
           (Device (DeviceType Nat))
           ('Device ('CUDA 0))
           (Unify
              (Device (DeviceType Nat))
              ('Device ('CUDA 0))
              (Unify
                 (Device (DeviceType Nat))
                 (Unify
                    (Device (DeviceType Nat))
                    ('Device ('CUDA 0))
                    (Unify
                       (Device (DeviceType Nat))
                       ('Device ('CUDA 0))
                       (Unify
                          (Device (DeviceType Nat))
                          (Unify
                             (Device (DeviceType Nat))
                             ('Device ('CUDA 0))
                             (Unify
                                (Device (DeviceType Nat))
                                (Unify
                                   (Device (DeviceType Nat))
                                   (Unify
                                      (Device (DeviceType Nat))
                                      ('Device ('CUDA 0))
                                      (Unify
                                         (Device (DeviceType Nat))
                                         ('Device ('CUDA 0))
                                         ('Device ('CUDA 0))))
                                   ('Device ('CUDA 0)))
                                ('Device ('CUDA 0))))
                          (Unify
                             (Device (DeviceType Nat))
                             (Unify
                                (Device (DeviceType Nat))
                                ('Device ('CUDA 0))
                                (Unify
                                   (Device (DeviceType Nat))
                                   ('Device ('CUDA 0))
                                   ('Device ('CUDA 0))))
                             ('Device ('CUDA 0))))))
                 (Unify
                    (Device (DeviceType Nat))
                    (Unify
                       (Device (DeviceType Nat))
                       ('Device ('CUDA 0))
                       (Unify
                          (Device (DeviceType Nat))
                          ('Device ('CUDA 0))
                          (Unify
                             (Device (DeviceType Nat))
                             ('Device ('CUDA 0))
                             (Unify
                                (Device (DeviceType Nat))
                                ('Device ('CUDA 0))
                                (Unify
                                   (Device (DeviceType Nat))
                                   (Unify
                                      (Device (DeviceType Nat))
                                      ('Device ('CUDA 0))
                                      (Unify
                                         (Device (DeviceType Nat))
                                         (Unify
                                            (Device (DeviceType Nat))
                                            (Unify
                                               (Device (DeviceType Nat))
                                               ('Device ('CUDA 0))
                                               (Unify
                                                  (Device (DeviceType Nat))
                                                  ('Device ('CUDA 0))
                                                  ('Device ('CUDA 0))))
                                            ('Device ('CUDA 0)))
                                         ('Device ('CUDA 0))))
                                   (Unify
                                      (Device (DeviceType Nat))
                                      (Unify
                                         (Device (DeviceType Nat))
                                         ('Device ('CUDA 0))
                                         (Unify
                                            (Device (DeviceType Nat))
                                            ('Device ('CUDA 0))
                                            ('Device ('CUDA 0))))
                                      ('Device ('CUDA 0))))))))
                    (Unify
                       (Device (DeviceType Nat))
                       (Unify
                          (Device (DeviceType Nat))
                          ('Device ('CUDA 0))
                          (Unify
                             (Device (DeviceType Nat))
                             (Unify
                                (Device (DeviceType Nat))
                                (Unify
                                   (Device (DeviceType Nat))
                                   ('Device ('CUDA 0))
                                   (Unify
                                      (Device (DeviceType Nat))
                                      ('Device ('CUDA 0))
                                      ('Device ('CUDA 0))))
                                ('Device ('CUDA 0)))
                             ('Device ('CUDA 0))))
                       (Unify
                          (Device (DeviceType Nat))
                          (Unify
                             (Device (DeviceType Nat))
                             ('Device ('CUDA 0))
                             (Unify
                                (Device (DeviceType Nat)) ('Device ('CUDA 0)) ('Device ('CUDA 0))))
                          ('Device ('CUDA 0))))))))))
  (Unify
     (DataType DType)
     ('DataType BERTDType)
     (Unify
        (DataType DType)
        ('DataType BERTDType)
        (Unify
           (DataType DType)
           ('DataType BERTDType)
           (Unify
              (DataType DType)
              ('DataType BERTDType)
              (Unify
                 (DataType DType)
                 (Unify
                    (DataType DType)
                    ('DataType BERTDType)
                    (Unify
                       (DataType DType)
                       (Unify
                          (DataType DType)
                          ('DataType BERTDType)
                          (Unify
                             (DataType DType)
                             (Unify
                                (DataType DType)
                                ('DataType BERTDType)
                                (Unify
                                   (DataType DType)
                                   ('DataType BERTDType)
                                   (Unify
                                      (DataType DType)
                                      ('DataType BERTDType)
                                      (Unify
                                         (DataType DType)
                                         (Unify
                                            (DataType DType)
                                            ('DataType BERTDType)
                                            (Unify
                                               (DataType DType)
                                               ('DataType BERTDType)
                                               (Seq
                                                  (Unify
                                                     (DataType DType)
                                                     (Seq
                                                        (Unify
                                                           (DataType DType)
                                                           ('DataType 'Int64)
                                                           ('DataType 'Int64))
                                                        ('DataType 'Bool))
                                                     ('DataType 'Bool))
                                                  ('DataType BERTDType))))
                                         ('DataType BERTDType)))))
                             (Unify
                                (DataType DType)
                                ('DataType BERTDType)
                                (Unify
                                   (DataType DType)
                                   ('DataType BERTDType)
                                   (Unify
                                      (DataType DType)
                                      ('DataType BERTDType)
                                      (Unify
                                         (DataType DType)
                                         ('DataType BERTDType)
                                         (Unify
                                            (DataType DType)
                                            ('DataType BERTDType)
                                            (Unify
                                               (DataType DType)
                                               (Unify
                                                  (DataType DType)
                                                  ('DataType BERTDType)
                                                  (Unify
                                                     (DataType DType)
                                                     ('DataType BERTDType)
                                                     (Seq
                                                        (Unify
                                                           (DataType DType)
                                                           (Seq
                                                              (Unify
                                                                 (DataType DType)
                                                                 ('DataType 'Int64)
                                                                 ('DataType 'Int64))
                                                              ('DataType 'Bool))
                                                           ('DataType 'Bool))
                                                        ('DataType BERTDType))))
                                               ('DataType BERTDType)))))))))
                       ('DataType BERTDType)))
                 (Unify
                    (DataType DType)
                    ('DataType BERTDType)
                    (Unify
                       (DataType DType)
                       ('DataType BERTDType)
                       (Unify
                          (DataType DType)
                          ('DataType BERTDType)
                          (Unify
                             (DataType DType)
                             (Unify
                                (DataType DType)
                                ('DataType BERTDType)
                                (Unify
                                   (DataType DType)
                                   (Unify
                                      (DataType DType)
                                      ('DataType BERTDType)
                                      (Unify
                                         (DataType DType)
                                         ('DataType BERTDType)
                                         (Unify
                                            (DataType DType)
                                            ('DataType BERTDType)
                                            (Unify
                                               (DataType DType)
                                               (Unify
                                                  (DataType DType)
                                                  ('DataType BERTDType)
                                                  (Unify
                                                     (DataType DType)
                                                     ('DataType BERTDType)
                                                     (Seq
                                                        (Unify
                                                           (DataType DType)
                                                           (Seq
                                                              (Unify
                                                                 (DataType DType)
                                                                 ('DataType 'Int64)
                                                                 ('DataType 'Int64))
                                                              ('DataType 'Bool))
                                                           ('DataType 'Bool))
                                                        ('DataType BERTDType))))
                                               ('DataType BERTDType)))))
                                   (Unify
                                      (DataType DType)
                                      ('DataType BERTDType)
                                      (Unify
                                         (DataType DType)
                                         ('DataType BERTDType)
                                         (Unify
                                            (DataType DType)
                                            ('DataType BERTDType)
                                            (Unify
                                               (DataType DType)
                                               ('DataType BERTDType)
                                               (Unify
                                                  (DataType DType)
                                                  ('DataType BERTDType)
                                                  (Unify
                                                     (DataType DType)
                                                     (Unify
                                                        (DataType DType)
                                                        ('DataType BERTDType)
                                                        (Unify
                                                           (DataType DType)
                                                           ('DataType BERTDType)
                                                           (Seq
                                                              (Unify
                                                                 (DataType DType)
                                                                 (Seq
                                                                    (Unify
                                                                       (DataType DType)
                                                                       ('DataType 'Int64)
                                                                       ('DataType 'Int64))
                                                                    ('DataType 'Bool))
                                                                 ('DataType 'Bool))
                                                              ('DataType BERTDType))))
                                                     ('DataType BERTDType)))))))))
                             ('DataType BERTDType))))))))))
  'UncheckedShape
eoEncoderOutput :: forall encoderOutput.
EncoderOnlyTransformerOutput encoderOutput -&gt; encoderOutput
eoEncoderOutput :: Tensor
  ('Gradient 'WithGradient)
  (Unify
     (Layout LayoutType)
     ('Layout 'Dense)
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify
                 (Layout LayoutType)
                 (Unify
                    (Layout LayoutType)
                    ('Layout 'Dense)
                    (Unify
                       (Layout LayoutType)
                       (Unify
                          (Layout LayoutType)
                          ('Layout 'Dense)
                          (Unify
                             (Layout LayoutType)
                             (Unify
                                (Layout LayoutType)
                                ('Layout 'Dense)
                                (Unify
                                   (Layout LayoutType)
                                   ('Layout 'Dense)
                                   (Unify
                                      (Layout LayoutType)
                                      ('Layout 'Dense)
                                      (Unify
                                         (Layout LayoutType)
                                         (Unify
                                            (Layout LayoutType)
                                            ('Layout 'Dense)
                                            (Unify
                                               (Layout LayoutType)
                                               ('Layout 'Dense)
                                               (Unify
                                                  (Layout LayoutType)
                                                  (Unify
                                                     (Layout LayoutType)
                                                     ('Layout 'Dense)
                                                     ('Layout 'Dense))
                                                  ('Layout 'Dense))))
                                         ('Layout 'Dense)))))
                             (Unify
                                (Layout LayoutType)
                                ('Layout 'Dense)
                                (Unify
                                   (Layout LayoutType)
                                   ('Layout 'Dense)
                                   (Unify
                                      (Layout LayoutType)
                                      ('Layout 'Dense)
                                      (Unify
                                         (Layout LayoutType)
                                         ('Layout 'Dense)
                                         (Unify
                                            (Layout LayoutType)
                                            ('Layout 'Dense)
                                            (Unify
                                               (Layout LayoutType)
                                               (Unify
                                                  (Layout LayoutType)
                                                  ('Layout 'Dense)
                                                  (Unify
                                                     (Layout LayoutType)
                                                     ('Layout 'Dense)
                                                     (Unify
                                                        (Layout LayoutType)
                                                        (Unify
                                                           (Layout LayoutType)
                                                           ('Layout 'Dense)
                                                           ('Layout 'Dense))
                                                        ('Layout 'Dense))))
                                               ('Layout 'Dense)))))))))
                       ('Layout 'Dense)))
                 (Unify
                    (Layout LayoutType)
                    ('Layout 'Dense)
                    (Unify
                       (Layout LayoutType)
                       ('Layout 'Dense)
                       (Unify
                          (Layout LayoutType)
                          ('Layout 'Dense)
                          (Unify
                             (Layout LayoutType)
                             (Unify
                                (Layout LayoutType)
                                ('Layout 'Dense)
                                (Unify
                                   (Layout LayoutType)
                                   (Unify
                                      (Layout LayoutType)
                                      ('Layout 'Dense)
                                      (Unify
                                         (Layout LayoutType)
                                         ('Layout 'Dense)
                                         (Unify
                                            (Layout LayoutType)
                                            ('Layout 'Dense)
                                            (Unify
                                               (Layout LayoutType)
                                               (Unify
                                                  (Layout LayoutType)
                                                  ('Layout 'Dense)
                                                  (Unify
                                                     (Layout LayoutType)
                                                     ('Layout 'Dense)
                                                     (Unify
                                                        (Layout LayoutType)
                                                        (Unify
                                                           (Layout LayoutType)
                                                           ('Layout 'Dense)
                                                           ('Layout 'Dense))
                                                        ('Layout 'Dense))))
                                               ('Layout 'Dense)))))
                                   (Unify
                                      (Layout LayoutType)
                                      ('Layout 'Dense)
                                      (Unify
                                         (Layout LayoutType)
                                         ('Layout 'Dense)
                                         (Unify
                                            (Layout LayoutType)
                                            ('Layout 'Dense)
                                            (Unify
                                               (Layout LayoutType)
                                               ('Layout 'Dense)
                                               (Unify
                                                  (Layout LayoutType)
                                                  ('Layout 'Dense)
                                                  (Unify
                                                     (Layout LayoutType)
                                                     (Unify
                                                        (Layout LayoutType)
                                                        ('Layout 'Dense)
                                                        (Unify
                                                           (Layout LayoutType)
                                                           ('Layout 'Dense)
                                                           (Unify
                                                              (Layout LayoutType)
                                                              (Unify
                                                                 (Layout LayoutType)
                                                                 ('Layout 'Dense)
                                                                 ('Layout 'Dense))
                                                              ('Layout 'Dense))))
                                                     ('Layout 'Dense)))))))))
                             ('Layout 'Dense))))))))))
  (Unify
     (Device (DeviceType Nat))
     ('Device ('CUDA 0))
     (Unify
        (Device (DeviceType Nat))
        ('Device ('CUDA 0))
        (Unify
           (Device (DeviceType Nat))
           ('Device ('CUDA 0))
           (Unify
              (Device (DeviceType Nat))
              ('Device ('CUDA 0))
              (Unify
                 (Device (DeviceType Nat))
                 (Unify
                    (Device (DeviceType Nat))
                    ('Device ('CUDA 0))
                    (Unify
                       (Device (DeviceType Nat))
                       ('Device ('CUDA 0))
                       (Unify
                          (Device (DeviceType Nat))
                          (Unify
                             (Device (DeviceType Nat))
                             ('Device ('CUDA 0))
                             (Unify
                                (Device (DeviceType Nat))
                                (Unify
                                   (Device (DeviceType Nat))
                                   (Unify
                                      (Device (DeviceType Nat))
                                      ('Device ('CUDA 0))
                                      (Unify
                                         (Device (DeviceType Nat))
                                         ('Device ('CUDA 0))
                                         ('Device ('CUDA 0))))
                                   ('Device ('CUDA 0)))
                                ('Device ('CUDA 0))))
                          (Unify
                             (Device (DeviceType Nat))
                             (Unify
                                (Device (DeviceType Nat))
                                ('Device ('CUDA 0))
                                (Unify
                                   (Device (DeviceType Nat))
                                   ('Device ('CUDA 0))
                                   ('Device ('CUDA 0))))
                             ('Device ('CUDA 0))))))
                 (Unify
                    (Device (DeviceType Nat))
                    (Unify
                       (Device (DeviceType Nat))
                       ('Device ('CUDA 0))
                       (Unify
                          (Device (DeviceType Nat))
                          ('Device ('CUDA 0))
                          (Unify
                             (Device (DeviceType Nat))
                             ('Device ('CUDA 0))
                             (Unify
                                (Device (DeviceType Nat))
                                ('Device ('CUDA 0))
                                (Unify
                                   (Device (DeviceType Nat))
                                   (Unify
                                      (Device (DeviceType Nat))
                                      ('Device ('CUDA 0))
                                      (Unify
                                         (Device (DeviceType Nat))
                                         (Unify
                                            (Device (DeviceType Nat))
                                            (Unify
                                               (Device (DeviceType Nat))
                                               ('Device ('CUDA 0))
                                               (Unify
                                                  (Device (DeviceType Nat))
                                                  ('Device ('CUDA 0))
                                                  ('Device ('CUDA 0))))
                                            ('Device ('CUDA 0)))
                                         ('Device ('CUDA 0))))
                                   (Unify
                                      (Device (DeviceType Nat))
                                      (Unify
                                         (Device (DeviceType Nat))
                                         ('Device ('CUDA 0))
                                         (Unify
                                            (Device (DeviceType Nat))
                                            ('Device ('CUDA 0))
                                            ('Device ('CUDA 0))))
                                      ('Device ('CUDA 0))))))))
                    (Unify
                       (Device (DeviceType Nat))
                       (Unify
                          (Device (DeviceType Nat))
                          ('Device ('CUDA 0))
                          (Unify
                             (Device (DeviceType Nat))
                             (Unify
                                (Device (DeviceType Nat))
                                (Unify
                                   (Device (DeviceType Nat))
                                   ('Device ('CUDA 0))
                                   (Unify
                                      (Device (DeviceType Nat))
                                      ('Device ('CUDA 0))
                                      ('Device ('CUDA 0))))
                                ('Device ('CUDA 0)))
                             ('Device ('CUDA 0))))
                       (Unify
                          (Device (DeviceType Nat))
                          (Unify
                             (Device (DeviceType Nat))
                             ('Device ('CUDA 0))
                             (Unify
                                (Device (DeviceType Nat)) ('Device ('CUDA 0)) ('Device ('CUDA 0))))
                          ('Device ('CUDA 0))))))))))
  (Unify
     (DataType DType)
     ('DataType BERTDType)
     (Unify
        (DataType DType)
        ('DataType BERTDType)
        (Unify
           (DataType DType)
           ('DataType BERTDType)
           (Unify
              (DataType DType)
              ('DataType BERTDType)
              (Unify
                 (DataType DType)
                 (Unify
                    (DataType DType)
                    ('DataType BERTDType)
                    (Unify
                       (DataType DType)
                       (Unify
                          (DataType DType)
                          ('DataType BERTDType)
                          (Unify
                             (DataType DType)
                             (Unify
                                (DataType DType)
                                ('DataType BERTDType)
                                (Unify
                                   (DataType DType)
                                   ('DataType BERTDType)
                                   (Unify
                                      (DataType DType)
                                      ('DataType BERTDType)
                                      (Unify
                                         (DataType DType)
                                         (Unify
                                            (DataType DType)
                                            ('DataType BERTDType)
                                            (Unify
                                               (DataType DType)
                                               ('DataType BERTDType)
                                               (Seq
                                                  (Unify
                                                     (DataType DType)
                                                     (Seq
                                                        (Unify
                                                           (DataType DType)
                                                           ('DataType 'Int64)
                                                           ('DataType 'Int64))
                                                        ('DataType 'Bool))
                                                     ('DataType 'Bool))
                                                  ('DataType BERTDType))))
                                         ('DataType BERTDType)))))
                             (Unify
                                (DataType DType)
                                ('DataType BERTDType)
                                (Unify
                                   (DataType DType)
                                   ('DataType BERTDType)
                                   (Unify
                                      (DataType DType)
                                      ('DataType BERTDType)
                                      (Unify
                                         (DataType DType)
                                         ('DataType BERTDType)
                                         (Unify
                                            (DataType DType)
                                            ('DataType BERTDType)
                                            (Unify
                                               (DataType DType)
                                               (Unify
                                                  (DataType DType)
                                                  ('DataType BERTDType)
                                                  (Unify
                                                     (DataType DType)
                                                     ('DataType BERTDType)
                                                     (Seq
                                                        (Unify
                                                           (DataType DType)
                                                           (Seq
                                                              (Unify
                                                                 (DataType DType)
                                                                 ('DataType 'Int64)
                                                                 ('DataType 'Int64))
                                                              ('DataType 'Bool))
                                                           ('DataType 'Bool))
                                                        ('DataType BERTDType))))
                                               ('DataType BERTDType)))))))))
                       ('DataType BERTDType)))
                 (Unify
                    (DataType DType)
                    ('DataType BERTDType)
                    (Unify
                       (DataType DType)
                       ('DataType BERTDType)
                       (Unify
                          (DataType DType)
                          ('DataType BERTDType)
                          (Unify
                             (DataType DType)
                             (Unify
                                (DataType DType)
                                ('DataType BERTDType)
                                (Unify
                                   (DataType DType)
                                   (Unify
                                      (DataType DType)
                                      ('DataType BERTDType)
                                      (Unify
                                         (DataType DType)
                                         ('DataType BERTDType)
                                         (Unify
                                            (DataType DType)
                                            ('DataType BERTDType)
                                            (Unify
                                               (DataType DType)
                                               (Unify
                                                  (DataType DType)
                                                  ('DataType BERTDType)
                                                  (Unify
                                                     (DataType DType)
                                                     ('DataType BERTDType)
                                                     (Seq
                                                        (Unify
                                                           (DataType DType)
                                                           (Seq
                                                              (Unify
                                                                 (DataType DType)
                                                                 ('DataType 'Int64)
                                                                 ('DataType 'Int64))
                                                              ('DataType 'Bool))
                                                           ('DataType 'Bool))
                                                        ('DataType BERTDType))))
                                               ('DataType BERTDType)))))
                                   (Unify
                                      (DataType DType)
                                      ('DataType BERTDType)
                                      (Unify
                                         (DataType DType)
                                         ('DataType BERTDType)
                                         (Unify
                                            (DataType DType)
                                            ('DataType BERTDType)
                                            (Unify
                                               (DataType DType)
                                               ('DataType BERTDType)
                                               (Unify
                                                  (DataType DType)
                                                  ('DataType BERTDType)
                                                  (Unify
                                                     (DataType DType)
                                                     (Unify
                                                        (DataType DType)
                                                        ('DataType BERTDType)
                                                        (Unify
                                                           (DataType DType)
                                                           ('DataType BERTDType)
                                                           (Seq
                                                              (Unify
                                                                 (DataType DType)
                                                                 (Seq
                                                                    (Unify
                                                                       (DataType DType)
                                                                       ('DataType 'Int64)
                                                                       ('DataType 'Int64))
                                                                    ('DataType 'Bool))
                                                                 ('DataType 'Bool))
                                                              ('DataType BERTDType))))
                                                     ('DataType BERTDType)))))))))
                             ('DataType BERTDType))))))))))
  'UncheckedShape
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#eoEncoderOutput"><span class="hs-glyph hs-var hs-var">..</span></a></span></span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Generator
  (Unify
     (Device (DeviceType Nat))
     (Unify
        (Device (DeviceType Nat))
        ('Device ('CUDA 0))
        (Unify
           (Device (DeviceType Nat))
           ('Device ('CUDA 0))
           (Unify
              (Device (DeviceType Nat))
              ('Device ('CUDA 0))
              (Unify
                 (Device (DeviceType Nat))
                 ('Device ('CUDA 0))
                 (Unify
                    (Device (DeviceType Nat))
                    (Unify
                       (Device (DeviceType Nat))
                       ('Device ('CUDA 0))
                       (Unify
                          (Device (DeviceType Nat))
                          (Unify
                             (Device (DeviceType Nat))
                             (Unify
                                (Device (DeviceType Nat))
                                ('Device ('CUDA 0))
                                (Unify
                                   (Device (DeviceType Nat))
                                   ('Device ('CUDA 0))
                                   ('Device ('CUDA 0))))
                             ('Device ('CUDA 0)))
                          ('Device ('CUDA 0))))
                    (Unify
                       (Device (DeviceType Nat))
                       (Unify
                          (Device (DeviceType Nat))
                          ('Device ('CUDA 0))
                          (Unify
                             (Device (DeviceType Nat)) ('Device ('CUDA 0)) ('Device ('CUDA 0))))
                       ('Device ('CUDA 0))))))))
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           ('Device ('CUDA 0))
           (Unify
              (Device (DeviceType Nat))
              (Unify
                 (Device (DeviceType Nat))
                 (Unify
                    (Device (DeviceType Nat))
                    ('Device ('CUDA 0))
                    (Unify
                       (Device (DeviceType Nat)) ('Device ('CUDA 0)) ('Device ('CUDA 0))))
                 ('Device ('CUDA 0)))
              ('Device ('CUDA 0))))
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              ('Device ('CUDA 0))
              (Unify
                 (Device (DeviceType Nat)) ('Device ('CUDA 0)) ('Device ('CUDA 0))))
           ('Device ('CUDA 0)))))
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GEncoderOnlyTransformer
  ('Dim ('Name &quot;*&quot;) ('Size 768))
  (NamedModel
     (GTransformer
        (NamedModel
           (Embedding
              ('Gradient 'WithGradient)
              ('Layout 'Dense)
              ('Device ('CUDA 0))
              ('DataType BERTDType)
              ('Dim ('Name &quot;*&quot;) ('Size 512))
              ('Dim ('Name &quot;*&quot;) ('Size 768))
              'Nothing))
        ()
        (NamedModel
           (LayerNorm
              'WithBias
              ('Gradient 'WithGradient)
              ('Device ('CUDA 0))
              ('DataType BERTDType)
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))
        Dropout
        (NamedModel
           (GTransformerStack
              (Vector
                 12
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          ()
                          (NamedModel
                             (GMultiHeadAttention
                                ('Dim ('Name &quot;*&quot;) ('Size 12))
                                ('Dim ('Name &quot;*&quot;) ('Size 64))
                                ('Dim ('Name &quot;*&quot;) ('Size 768))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device ('CUDA 0))
                                            ('DataType BERTDType)
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                  'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device ('CUDA 0))
                                            ('DataType BERTDType)
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device ('CUDA 0))
                                            ('DataType BERTDType)
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                  'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device ('CUDA 0))
                                            ('DataType BERTDType)
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device ('CUDA 0))
                                            ('DataType BERTDType)
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                  'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device ('CUDA 0))
                                            ('DataType BERTDType)
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device ('CUDA 0))
                                            ('DataType BERTDType)
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                  'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device ('CUDA 0))
                                            ('DataType BERTDType)
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                Dropout))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                ('Gradient 'WithGradient)
                                ('Device ('CUDA 0))
                                ('DataType BERTDType)
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                    ()
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          ()
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device ('CUDA 0))
                                      ('DataType BERTDType)
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 3072),
                                            'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device ('CUDA 0))
                                      ('DataType BERTDType)
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3072)])))))
                          Gelu
                          ()
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device ('CUDA 0))
                                      ('DataType BERTDType)
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                            'Dim ('Name &quot;*&quot;) ('Size 3072)])))
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device ('CUDA 0))
                                      ('DataType BERTDType)
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                ('Gradient 'WithGradient)
                                ('Device ('CUDA 0))
                                ('DataType BERTDType)
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))))))
        ()
        ()))
  (NamedModel
     (Embedding
        ('Gradient 'WithGradient)
        ('Layout 'Dense)
        ('Device ('CUDA 0))
        ('DataType BERTDType)
        ('Dim ('Name &quot;*&quot;) ('Size 30522))
        ('Dim ('Name &quot;*&quot;) ('Size 768))
        'Nothing))
  (NamedModel
     (Embedding
        ('Gradient 'WithGradient)
        ('Layout 'Dense)
        ('Device ('CUDA 0))
        ('DataType BERTDType)
        ('Dim ('Name &quot;*&quot;) ('Size 2))
        ('Dim ('Name &quot;*&quot;) ('Size 768))
        'Nothing))
  (NamedModel
     (GLMHead
        ('Dim ('Name &quot;*&quot;) ('Size 768))
        (NamedModel
           (GLinear
              (NamedModel
                 (Tensor
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device ('CUDA 0))
                    ('DataType BERTDType)
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 768), 'Dim ('Name &quot;*&quot;) ('Size 768)])))
              (NamedModel
                 (Tensor
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device ('CUDA 0))
                    ('DataType BERTDType)
                    ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
        Gelu
        (NamedModel
           (LayerNorm
              'WithBias
              ('Gradient 'WithGradient)
              ('Device ('CUDA 0))
              ('DataType BERTDType)
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))
        (NamedModel
           (GLinear
              (NamedModel
                 (Tensor
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device ('CUDA 0))
                    ('DataType BERTDType)
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 30522), 'Dim ('Name &quot;*&quot;) ('Size 768)])))
              (NamedModel
                 (Tensor
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device ('CUDA 0))
                    ('DataType BERTDType)
                    ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 30522)])))))
        (GBias ())))
-&gt; EncoderOnlyTransformerInput
     (Tensor
        ('Gradient 'WithoutGradient)
        ('Layout 'Dense)
        ('Device ('CUDA 0))
        ('DataType 'Int64)
        ('Shape
           '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize]))
     (Tensor
        ('Gradient 'WithoutGradient)
        ('Layout 'Dense)
        ('Device ('CUDA 0))
        ('DataType 'Int64)
        ('Shape
           '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize]))
     (Tensor
        ('Gradient 'WithoutGradient)
        ('Layout 'Dense)
        ('Device ('CUDA 0))
        ('DataType 'Int64)
        ('Shape '[ 'Dim ('Name &quot;*&quot;) 'UncheckedSize]))
     (Tensor
        ('Gradient 'WithoutGradient)
        (Unify
           (Layout LayoutType)
           (Unify (Layout LayoutType) ('Layout 'Dense) ('Layout 'Dense))
           ('Layout 'Dense))
        ('Device ('CUDA 0))
        (Seq
           (Unify
              (DataType DType)
              (Seq
                 (Unify (DataType DType) ('DataType 'Int64) ('DataType 'Int64))
                 ('DataType 'Bool))
              ('DataType 'Bool))
           ('DataType BERTDType))
        (BroadcastShapesF
           (UnsqueezeF
              ('SelectDim ('ByIndex 1))
              (BroadcastShapesF
                 ('Shape
                    '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize])
                 ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 1)])))
           ('Shape
              '[ 'Dim ('Name &quot;*&quot;) ('Size 1),
                 GetDimF
                   ('SelectDim ('ByIndex 1))
                   (BroadcastShapesF
                      ('Shape
                         '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize])
                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 1)])),
                 GetDimF
                   ('SelectDim ('ByIndex 1))
                   (BroadcastShapesF
                      ('Shape
                         '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize])
                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 1)]))])))
-&gt; Generator ('Device ('CUDA 0))
-&gt; IO
     (EncoderOnlyTransformerOutput
        (Tensor
           ('Gradient 'WithGradient)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify
                 (Layout LayoutType)
                 ('Layout 'Dense)
                 (Unify
                    (Layout LayoutType)
                    ('Layout 'Dense)
                    (Unify
                       (Layout LayoutType)
                       ('Layout 'Dense)
                       (Unify
                          (Layout LayoutType)
                          (Unify
                             (Layout LayoutType)
                             ('Layout 'Dense)
                             (Unify
                                (Layout LayoutType)
                                (Unify
                                   (Layout LayoutType)
                                   ('Layout 'Dense)
                                   (Unify
                                      (Layout LayoutType)
                                      (Unify
                                         (Layout LayoutType)
                                         ('Layout 'Dense)
                                         (Unify
                                            (Layout LayoutType)
                                            ('Layout 'Dense)
                                            (Unify
                                               (Layout LayoutType)
                                               ('Layout 'Dense)
                                               (Unify
                                                  (Layout LayoutType)
                                                  (Unify
                                                     (Layout LayoutType)
                                                     ('Layout 'Dense)
                                                     (Unify
                                                        (Layout LayoutType)
                                                        ('Layout 'Dense)
                                                        (Unify
                                                           (Layout LayoutType)
                                                           (Unify
                                                              (Layout LayoutType)
                                                              ('Layout 'Dense)
                                                              ('Layout 'Dense))
                                                           ('Layout 'Dense))))
                                                  ('Layout 'Dense)))))
                                      (Unify
                                         (Layout LayoutType)
                                         ('Layout 'Dense)
                                         (Unify
                                            (Layout LayoutType)
                                            ('Layout 'Dense)
                                            (Unify
                                               (Layout LayoutType)
                                               ('Layout 'Dense)
                                               (Unify
                                                  (Layout LayoutType)
                                                  ('Layout 'Dense)
                                                  (Unify
                                                     (Layout LayoutType)
                                                     ('Layout 'Dense)
                                                     (Unify
                                                        (Layout LayoutType)
                                                        (Unify
                                                           (Layout LayoutType)
                                                           ('Layout 'Dense)
                                                           (Unify
                                                              (Layout LayoutType)
                                                              ('Layout 'Dense)
                                                              (Unify
                                                                 (Layout LayoutType)
                                                                 (Unify
                                                                    (Layout LayoutType)
                                                                    ('Layout 'Dense)
                                                                    ('Layout 'Dense))
                                                                 ('Layout 'Dense))))
                                                        ('Layout 'Dense)))))))))
                                ('Layout 'Dense)))
                          (Unify
                             (Layout LayoutType)
                             ('Layout 'Dense)
                             (Unify
                                (Layout LayoutType)
                                ('Layout 'Dense)
                                (Unify
                                   (Layout LayoutType)
                                   ('Layout 'Dense)
                                   (Unify
                                      (Layout LayoutType)
                                      (Unify
                                         (Layout LayoutType)
                                         ('Layout 'Dense)
                                         (Unify
                                            (Layout LayoutType)
                                            (Unify
                                               (Layout LayoutType)
                                               ('Layout 'Dense)
                                               (Unify
                                                  (Layout LayoutType)
                                                  ('Layout 'Dense)
                                                  (Unify
                                                     (Layout LayoutType)
                                                     ('Layout 'Dense)
                                                     (Unify
                                                        (Layout LayoutType)
                                                        (Unify
                                                           (Layout LayoutType)
                                                           ('Layout 'Dense)
                                                           (Unify
                                                              (Layout LayoutType)
                                                              ('Layout 'Dense)
                                                              (Unify
                                                                 (Layout LayoutType)
                                                                 (Unify
                                                                    (Layout LayoutType)
                                                                    ('Layout 'Dense)
                                                                    ('Layout 'Dense))
                                                                 ('Layout 'Dense))))
                                                        ('Layout 'Dense)))))
                                            (Unify
                                               (Layout LayoutType)
                                               ('Layout 'Dense)
                                               (Unify
                                                  (Layout LayoutType)
                                                  ('Layout 'Dense)
                                                  (Unify
                                                     (Layout LayoutType)
                                                     ('Layout 'Dense)
                                                     (Unify
                                                        (Layout LayoutType)
                                                        ('Layout 'Dense)
                                                        (Unify
                                                           (Layout LayoutType)
                                                           ('Layout 'Dense)
                                                           (Unify
                                                              (Layout LayoutType)
                                                              (Unify
                                                                 (Layout LayoutType)
                                                                 ('Layout 'Dense)
                                                                 (Unify
                                                                    (Layout LayoutType)
                                                                    ('Layout 'Dense)
                                                                    (Unify
                                                                       (Layout LayoutType)
                                                                       (Unify
                                                                          (Layout LayoutType)
                                                                          ('Layout 'Dense)
                                                                          ('Layout 'Dense))
                                                                       ('Layout 'Dense))))
                                                              ('Layout 'Dense)))))))))
                                      ('Layout 'Dense))))))))))
           (Unify
              (Device (DeviceType Nat))
              ('Device ('CUDA 0))
              (Unify
                 (Device (DeviceType Nat))
                 ('Device ('CUDA 0))
                 (Unify
                    (Device (DeviceType Nat))
                    ('Device ('CUDA 0))
                    (Unify
                       (Device (DeviceType Nat))
                       ('Device ('CUDA 0))
                       (Unify
                          (Device (DeviceType Nat))
                          (Unify
                             (Device (DeviceType Nat))
                             ('Device ('CUDA 0))
                             (Unify
                                (Device (DeviceType Nat))
                                ('Device ('CUDA 0))
                                (Unify
                                   (Device (DeviceType Nat))
                                   (Unify
                                      (Device (DeviceType Nat))
                                      ('Device ('CUDA 0))
                                      (Unify
                                         (Device (DeviceType Nat))
                                         (Unify
                                            (Device (DeviceType Nat))
                                            (Unify
                                               (Device (DeviceType Nat))
                                               ('Device ('CUDA 0))
                                               (Unify
                                                  (Device (DeviceType Nat))
                                                  ('Device ('CUDA 0))
                                                  ('Device ('CUDA 0))))
                                            ('Device ('CUDA 0)))
                                         ('Device ('CUDA 0))))
                                   (Unify
                                      (Device (DeviceType Nat))
                                      (Unify
                                         (Device (DeviceType Nat))
                                         ('Device ('CUDA 0))
                                         (Unify
                                            (Device (DeviceType Nat))
                                            ('Device ('CUDA 0))
                                            ('Device ('CUDA 0))))
                                      ('Device ('CUDA 0))))))
                          (Unify
                             (Device (DeviceType Nat))
                             (Unify
                                (Device (DeviceType Nat))
                                ('Device ('CUDA 0))
                                (Unify
                                   (Device (DeviceType Nat))
                                   ('Device ('CUDA 0))
                                   (Unify
                                      (Device (DeviceType Nat))
                                      ('Device ('CUDA 0))
                                      (Unify
                                         (Device (DeviceType Nat))
                                         ('Device ('CUDA 0))
                                         (Unify
                                            (Device (DeviceType Nat))
                                            (Unify
                                               (Device (DeviceType Nat))
                                               ('Device ('CUDA 0))
                                               (Unify
                                                  (Device (DeviceType Nat))
                                                  (Unify
                                                     (Device (DeviceType Nat))
                                                     (Unify
                                                        (Device (DeviceType Nat))
                                                        ('Device ('CUDA 0))
                                                        (Unify
                                                           (Device (DeviceType Nat))
                                                           ('Device ('CUDA 0))
                                                           ('Device ('CUDA 0))))
                                                     ('Device ('CUDA 0)))
                                                  ('Device ('CUDA 0))))
                                            (Unify
                                               (Device (DeviceType Nat))
                                               (Unify
                                                  (Device (DeviceType Nat))
                                                  ('Device ('CUDA 0))
                                                  (Unify
                                                     (Device (DeviceType Nat))
                                                     ('Device ('CUDA 0))
                                                     ('Device ('CUDA 0))))
                                               ('Device ('CUDA 0))))))))
                             (Unify
                                (Device (DeviceType Nat))
                                (Unify
                                   (Device (DeviceType Nat))
                                   ('Device ('CUDA 0))
                                   (Unify
                                      (Device (DeviceType Nat))
                                      (Unify
                                         (Device (DeviceType Nat))
                                         (Unify
                                            (Device (DeviceType Nat))
                                            ('Device ('CUDA 0))
                                            (Unify
                                               (Device (DeviceType Nat))
                                               ('Device ('CUDA 0))
                                               ('Device ('CUDA 0))))
                                         ('Device ('CUDA 0)))
                                      ('Device ('CUDA 0))))
                                (Unify
                                   (Device (DeviceType Nat))
                                   (Unify
                                      (Device (DeviceType Nat))
                                      ('Device ('CUDA 0))
                                      (Unify
                                         (Device (DeviceType Nat))
                                         ('Device ('CUDA 0))
                                         ('Device ('CUDA 0))))
                                   ('Device ('CUDA 0))))))))))
           (Unify
              (DataType DType)
              ('DataType BERTDType)
              (Unify
                 (DataType DType)
                 ('DataType BERTDType)
                 (Unify
                    (DataType DType)
                    ('DataType BERTDType)
                    (Unify
                       (DataType DType)
                       ('DataType BERTDType)
                       (Unify
                          (DataType DType)
                          (Unify
                             (DataType DType)
                             ('DataType BERTDType)
                             (Unify
                                (DataType DType)
                                (Unify
                                   (DataType DType)
                                   ('DataType BERTDType)
                                   (Unify
                                      (DataType DType)
                                      (Unify
                                         (DataType DType)
                                         ('DataType BERTDType)
                                         (Unify
                                            (DataType DType)
                                            ('DataType BERTDType)
                                            (Unify
                                               (DataType DType)
                                               ('DataType BERTDType)
                                               (Unify
                                                  (DataType DType)
                                                  (Unify
                                                     (DataType DType)
                                                     ('DataType BERTDType)
                                                     (Unify
                                                        (DataType DType)
                                                        ('DataType BERTDType)
                                                        (Seq
                                                           (Unify
                                                              (DataType DType)
                                                              (Seq
                                                                 (Unify
                                                                    (DataType DType)
                                                                    ('DataType 'Int64)
                                                                    ('DataType 'Int64))
                                                                 ('DataType 'Bool))
                                                              ('DataType 'Bool))
                                                           ('DataType BERTDType))))
                                                  ('DataType BERTDType)))))
                                      (Unify
                                         (DataType DType)
                                         ('DataType BERTDType)
                                         (Unify
                                            (DataType DType)
                                            ('DataType BERTDType)
                                            (Unify
                                               (DataType DType)
                                               ('DataType BERTDType)
                                               (Unify
                                                  (DataType DType)
                                                  ('DataType BERTDType)
                                                  (Unify
                                                     (DataType DType)
                                                     ('DataType BERTDType)
                                                     (Unify
                                                        (DataType DType)
                                                        (Unify
                                                           (DataType DType)
                                                           ('DataType BERTDType)
                                                           (Unify
                                                              (DataType DType)
                                                              ('DataType BERTDType)
                                                              (Seq
                                                                 (Unify
                                                                    (DataType DType)
                                                                    (Seq
                                                                       (Unify
                                                                          (DataType DType)
                                                                          ('DataType 'Int64)
                                                                          ('DataType 'Int64))
                                                                       ('DataType 'Bool))
                                                                    ('DataType 'Bool))
                                                                 ('DataType BERTDType))))
                                                        ('DataType BERTDType)))))))))
                                ('DataType BERTDType)))
                          (Unify
                             (DataType DType)
                             ('DataType BERTDType)
                             (Unify
                                (DataType DType)
                                ('DataType BERTDType)
                                (Unify
                                   (DataType DType)
                                   ('DataType BERTDType)
                                   (Unify
                                      (DataType DType)
                                      (Unify
                                         (DataType DType)
                                         ('DataType BERTDType)
                                         (Unify
                                            (DataType DType)
                                            (Unify
                                               (DataType DType)
                                               ('DataType BERTDType)
                                               (Unify
                                                  (DataType DType)
                                                  ('DataType BERTDType)
                                                  (Unify
                                                     (DataType DType)
                                                     ('DataType BERTDType)
                                                     (Unify
                                                        (DataType DType)
                                                        (Unify
                                                           (DataType DType)
                                                           ('DataType BERTDType)
                                                           (Unify
                                                              (DataType DType)
                                                              ('DataType BERTDType)
                                                              (Seq
                                                                 (Unify
                                                                    (DataType DType)
                                                                    (Seq
                                                                       (Unify
                                                                          (DataType DType)
                                                                          ('DataType 'Int64)
                                                                          ('DataType 'Int64))
                                                                       ('DataType 'Bool))
                                                                    ('DataType 'Bool))
                                                                 ('DataType BERTDType))))
                                                        ('DataType BERTDType)))))
                                            (Unify
                                               (DataType DType)
                                               ('DataType BERTDType)
                                               (Unify
                                                  (DataType DType)
                                                  ('DataType BERTDType)
                                                  (Unify
                                                     (DataType DType)
                                                     ('DataType BERTDType)
                                                     (Unify
                                                        (DataType DType)
                                                        ('DataType BERTDType)
                                                        (Unify
                                                           (DataType DType)
                                                           ('DataType BERTDType)
                                                           (Unify
                                                              (DataType DType)
                                                              (Unify
                                                                 (DataType DType)
                                                                 ('DataType BERTDType)
                                                                 (Unify
                                                                    (DataType DType)
                                                                    ('DataType BERTDType)
                                                                    (Seq
                                                                       (Unify
                                                                          (DataType DType)
                                                                          (Seq
                                                                             (Unify
                                                                                (DataType DType)
                                                                                ('DataType 'Int64)
                                                                                ('DataType 'Int64))
                                                                             ('DataType 'Bool))
                                                                          ('DataType 'Bool))
                                                                       ('DataType BERTDType))))
                                                              ('DataType BERTDType)))))))))
                                      ('DataType BERTDType))))))))))
           'UncheckedShape),
      Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              ('Device ('CUDA 0))
              (Unify
                 (Device (DeviceType Nat))
                 ('Device ('CUDA 0))
                 (Unify
                    (Device (DeviceType Nat))
                    ('Device ('CUDA 0))
                    (Unify
                       (Device (DeviceType Nat))
                       ('Device ('CUDA 0))
                       (Unify
                          (Device (DeviceType Nat))
                          (Unify
                             (Device (DeviceType Nat))
                             ('Device ('CUDA 0))
                             (Unify
                                (Device (DeviceType Nat))
                                (Unify
                                   (Device (DeviceType Nat))
                                   (Unify
                                      (Device (DeviceType Nat))
                                      ('Device ('CUDA 0))
                                      (Unify
                                         (Device (DeviceType Nat))
                                         ('Device ('CUDA 0))
                                         ('Device ('CUDA 0))))
                                   ('Device ('CUDA 0)))
                                ('Device ('CUDA 0))))
                          (Unify
                             (Device (DeviceType Nat))
                             (Unify
                                (Device (DeviceType Nat))
                                ('Device ('CUDA 0))
                                (Unify
                                   (Device (DeviceType Nat))
                                   ('Device ('CUDA 0))
                                   ('Device ('CUDA 0))))
                             ('Device ('CUDA 0))))))))
           (Unify
              (Device (DeviceType Nat))
              (Unify
                 (Device (DeviceType Nat))
                 ('Device ('CUDA 0))
                 (Unify
                    (Device (DeviceType Nat))
                    (Unify
                       (Device (DeviceType Nat))
                       (Unify
                          (Device (DeviceType Nat))
                          ('Device ('CUDA 0))
                          (Unify
                             (Device (DeviceType Nat)) ('Device ('CUDA 0)) ('Device ('CUDA 0))))
                       ('Device ('CUDA 0)))
                    ('Device ('CUDA 0))))
              (Unify
                 (Device (DeviceType Nat))
                 (Unify
                    (Device (DeviceType Nat))
                    ('Device ('CUDA 0))
                    (Unify
                       (Device (DeviceType Nat)) ('Device ('CUDA 0)) ('Device ('CUDA 0))))
                 ('Device ('CUDA 0))))))
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">GEncoderOnlyTransformer
  ('Dim ('Name &quot;*&quot;) ('Size 768))
  (NamedModel
     (GTransformer
        (NamedModel
           (Embedding
              ('Gradient 'WithGradient)
              ('Layout 'Dense)
              ('Device ('CUDA 0))
              ('DataType BERTDType)
              ('Dim ('Name &quot;*&quot;) ('Size 512))
              ('Dim ('Name &quot;*&quot;) ('Size 768))
              'Nothing))
        ()
        (NamedModel
           (LayerNorm
              'WithBias
              ('Gradient 'WithGradient)
              ('Device ('CUDA 0))
              ('DataType BERTDType)
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))
        Dropout
        (NamedModel
           (GTransformerStack
              (Vector
                 12
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          ()
                          (NamedModel
                             (GMultiHeadAttention
                                ('Dim ('Name &quot;*&quot;) ('Size 12))
                                ('Dim ('Name &quot;*&quot;) ('Size 64))
                                ('Dim ('Name &quot;*&quot;) ('Size 768))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device ('CUDA 0))
                                            ('DataType BERTDType)
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                  'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device ('CUDA 0))
                                            ('DataType BERTDType)
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device ('CUDA 0))
                                            ('DataType BERTDType)
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                  'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device ('CUDA 0))
                                            ('DataType BERTDType)
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device ('CUDA 0))
                                            ('DataType BERTDType)
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                  'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device ('CUDA 0))
                                            ('DataType BERTDType)
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device ('CUDA 0))
                                            ('DataType BERTDType)
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                                  'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device ('CUDA 0))
                                            ('DataType BERTDType)
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                                Dropout))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                ('Gradient 'WithGradient)
                                ('Device ('CUDA 0))
                                ('DataType BERTDType)
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                    ()
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          ()
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device ('CUDA 0))
                                      ('DataType BERTDType)
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 3072),
                                            'Dim ('Name &quot;*&quot;) ('Size 768)])))
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device ('CUDA 0))
                                      ('DataType BERTDType)
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3072)])))))
                          Gelu
                          ()
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device ('CUDA 0))
                                      ('DataType BERTDType)
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 768),
                                            'Dim ('Name &quot;*&quot;) ('Size 3072)])))
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device ('CUDA 0))
                                      ('DataType BERTDType)
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                ('Gradient 'WithGradient)
                                ('Device ('CUDA 0))
                                ('DataType BERTDType)
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))))))
        ()
        ()))
  (NamedModel
     (Embedding
        ('Gradient 'WithGradient)
        ('Layout 'Dense)
        ('Device ('CUDA 0))
        ('DataType BERTDType)
        ('Dim ('Name &quot;*&quot;) ('Size 30522))
        ('Dim ('Name &quot;*&quot;) ('Size 768))
        'Nothing))
  (NamedModel
     (Embedding
        ('Gradient 'WithGradient)
        ('Layout 'Dense)
        ('Device ('CUDA 0))
        ('DataType BERTDType)
        ('Dim ('Name &quot;*&quot;) ('Size 2))
        ('Dim ('Name &quot;*&quot;) ('Size 768))
        'Nothing))
  (NamedModel
     (GLMHead
        ('Dim ('Name &quot;*&quot;) ('Size 768))
        (NamedModel
           (GLinear
              (NamedModel
                 (Tensor
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device ('CUDA 0))
                    ('DataType BERTDType)
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 768), 'Dim ('Name &quot;*&quot;) ('Size 768)])))
              (NamedModel
                 (Tensor
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device ('CUDA 0))
                    ('DataType BERTDType)
                    ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))))
        Gelu
        (NamedModel
           (LayerNorm
              'WithBias
              ('Gradient 'WithGradient)
              ('Device ('CUDA 0))
              ('DataType BERTDType)
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 768)])))
        (NamedModel
           (GLinear
              (NamedModel
                 (Tensor
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device ('CUDA 0))
                    ('DataType BERTDType)
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 30522), 'Dim ('Name &quot;*&quot;) ('Size 768)])))
              (NamedModel
                 (Tensor
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device ('CUDA 0))
                    ('DataType BERTDType)
                    ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 30522)])))))
        (GBias ())))
</span><a href="#local-6989586621679582546"><span class="hs-identifier hs-var">bertModel</span></a></span><span> </span><span class="annot"><span class="annottext">EncoderOnlyTransformerInput
  (Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device ('CUDA 0))
     ('DataType 'Int64)
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize]))
  (Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device ('CUDA 0))
     ('DataType 'Int64)
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize]))
  (Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device ('CUDA 0))
     ('DataType 'Int64)
     ('Shape '[ 'Dim ('Name &quot;*&quot;) 'UncheckedSize]))
  (Tensor
     ('Gradient 'WithoutGradient)
     (Unify
        (Layout LayoutType)
        (Unify (Layout LayoutType) ('Layout 'Dense) ('Layout 'Dense))
        ('Layout 'Dense))
     ('Device ('CUDA 0))
     (Seq
        (Unify
           (DataType DType)
           (Seq
              (Unify (DataType DType) ('DataType 'Int64) ('DataType 'Int64))
              ('DataType 'Bool))
           ('DataType 'Bool))
        ('DataType BERTDType))
     (BroadcastShapesF
        (UnsqueezeF
           ('SelectDim ('ByIndex 1))
           (BroadcastShapesF
              ('Shape
                 '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize])
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 1)])))
        ('Shape
           '[ 'Dim ('Name &quot;*&quot;) ('Size 1),
              GetDimF
                ('SelectDim ('ByIndex 1))
                (BroadcastShapesF
                   ('Shape
                      '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize])
                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 1)])),
              GetDimF
                ('SelectDim ('ByIndex 1))
                (BroadcastShapesF
                   ('Shape
                      '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) 'UncheckedSize])
                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 1)]))])))
</span><a href="#local-6989586621679582515"><span class="hs-identifier hs-var">eotInput</span></a></span><span> </span><span class="annot"><span class="annottext">Generator ('Device ('CUDA 0))
</span><a href="#local-6989586621679582543"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679582509"><span class="annot"><span class="annottext">encoderOutput' :: [[[Float]]]
</span><a href="#local-6989586621679582509"><span class="hs-identifier hs-var hs-var">encoderOutput'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Tensor
  ('Gradient 'WithGradient)
  (Unify
     (Layout LayoutType)
     ('Layout 'Dense)
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify
                 (Layout LayoutType)
                 (Unify
                    (Layout LayoutType)
                    ('Layout 'Dense)
                    (Unify
                       (Layout LayoutType)
                       (Unify
                          (Layout LayoutType)
                          ('Layout 'Dense)
                          (Unify
                             (Layout LayoutType)
                             (Unify
                                (Layout LayoutType)
                                ('Layout 'Dense)
                                (Unify
                                   (Layout LayoutType)
                                   ('Layout 'Dense)
                                   (Unify
                                      (Layout LayoutType)
                                      ('Layout 'Dense)
                                      (Unify
                                         (Layout LayoutType)
                                         (Unify
                                            (Layout LayoutType)
                                            ('Layout 'Dense)
                                            (Unify
                                               (Layout LayoutType)
                                               ('Layout 'Dense)
                                               (Unify
                                                  (Layout LayoutType)
                                                  (Unify
                                                     (Layout LayoutType)
                                                     ('Layout 'Dense)
                                                     ('Layout 'Dense))
                                                  ('Layout 'Dense))))
                                         ('Layout 'Dense)))))
                             (Unify
                                (Layout LayoutType)
                                ('Layout 'Dense)
                                (Unify
                                   (Layout LayoutType)
                                   ('Layout 'Dense)
                                   (Unify
                                      (Layout LayoutType)
                                      ('Layout 'Dense)
                                      (Unify
                                         (Layout LayoutType)
                                         ('Layout 'Dense)
                                         (Unify
                                            (Layout LayoutType)
                                            ('Layout 'Dense)
                                            (Unify
                                               (Layout LayoutType)
                                               (Unify
                                                  (Layout LayoutType)
                                                  ('Layout 'Dense)
                                                  (Unify
                                                     (Layout LayoutType)
                                                     ('Layout 'Dense)
                                                     (Unify
                                                        (Layout LayoutType)
                                                        (Unify
                                                           (Layout LayoutType)
                                                           ('Layout 'Dense)
                                                           ('Layout 'Dense))
                                                        ('Layout 'Dense))))
                                               ('Layout 'Dense)))))))))
                       ('Layout 'Dense)))
                 (Unify
                    (Layout LayoutType)
                    ('Layout 'Dense)
                    (Unify
                       (Layout LayoutType)
                       ('Layout 'Dense)
                       (Unify
                          (Layout LayoutType)
                          ('Layout 'Dense)
                          (Unify
                             (Layout LayoutType)
                             (Unify
                                (Layout LayoutType)
                                ('Layout 'Dense)
                                (Unify
                                   (Layout LayoutType)
                                   (Unify
                                      (Layout LayoutType)
                                      ('Layout 'Dense)
                                      (Unify
                                         (Layout LayoutType)
                                         ('Layout 'Dense)
                                         (Unify
                                            (Layout LayoutType)
                                            ('Layout 'Dense)
                                            (Unify
                                               (Layout LayoutType)
                                               (Unify
                                                  (Layout LayoutType)
                                                  ('Layout 'Dense)
                                                  (Unify
                                                     (Layout LayoutType)
                                                     ('Layout 'Dense)
                                                     (Unify
                                                        (Layout LayoutType)
                                                        (Unify
                                                           (Layout LayoutType)
                                                           ('Layout 'Dense)
                                                           ('Layout 'Dense))
                                                        ('Layout 'Dense))))
                                               ('Layout 'Dense)))))
                                   (Unify
                                      (Layout LayoutType)
                                      ('Layout 'Dense)
                                      (Unify
                                         (Layout LayoutType)
                                         ('Layout 'Dense)
                                         (Unify
                                            (Layout LayoutType)
                                            ('Layout 'Dense)
                                            (Unify
                                               (Layout LayoutType)
                                               ('Layout 'Dense)
                                               (Unify
                                                  (Layout LayoutType)
                                                  ('Layout 'Dense)
                                                  (Unify
                                                     (Layout LayoutType)
                                                     (Unify
                                                        (Layout LayoutType)
                                                        ('Layout 'Dense)
                                                        (Unify
                                                           (Layout LayoutType)
                                                           ('Layout 'Dense)
                                                           (Unify
                                                              (Layout LayoutType)
                                                              (Unify
                                                                 (Layout LayoutType)
                                                                 ('Layout 'Dense)
                                                                 ('Layout 'Dense))
                                                              ('Layout 'Dense))))
                                                     ('Layout 'Dense)))))))))
                             ('Layout 'Dense))))))))))
  (Unify
     (Device (DeviceType Nat))
     ('Device ('CUDA 0))
     (Unify
        (Device (DeviceType Nat))
        ('Device ('CUDA 0))
        (Unify
           (Device (DeviceType Nat))
           ('Device ('CUDA 0))
           (Unify
              (Device (DeviceType Nat))
              ('Device ('CUDA 0))
              (Unify
                 (Device (DeviceType Nat))
                 (Unify
                    (Device (DeviceType Nat))
                    ('Device ('CUDA 0))
                    (Unify
                       (Device (DeviceType Nat))
                       ('Device ('CUDA 0))
                       (Unify
                          (Device (DeviceType Nat))
                          (Unify
                             (Device (DeviceType Nat))
                             ('Device ('CUDA 0))
                             (Unify
                                (Device (DeviceType Nat))
                                (Unify
                                   (Device (DeviceType Nat))
                                   (Unify
                                      (Device (DeviceType Nat))
                                      ('Device ('CUDA 0))
                                      (Unify
                                         (Device (DeviceType Nat))
                                         ('Device ('CUDA 0))
                                         ('Device ('CUDA 0))))
                                   ('Device ('CUDA 0)))
                                ('Device ('CUDA 0))))
                          (Unify
                             (Device (DeviceType Nat))
                             (Unify
                                (Device (DeviceType Nat))
                                ('Device ('CUDA 0))
                                (Unify
                                   (Device (DeviceType Nat))
                                   ('Device ('CUDA 0))
                                   ('Device ('CUDA 0))))
                             ('Device ('CUDA 0))))))
                 (Unify
                    (Device (DeviceType Nat))
                    (Unify
                       (Device (DeviceType Nat))
                       ('Device ('CUDA 0))
                       (Unify
                          (Device (DeviceType Nat))
                          ('Device ('CUDA 0))
                          (Unify
                             (Device (DeviceType Nat))
                             ('Device ('CUDA 0))
                             (Unify
                                (Device (DeviceType Nat))
                                ('Device ('CUDA 0))
                                (Unify
                                   (Device (DeviceType Nat))
                                   (Unify
                                      (Device (DeviceType Nat))
                                      ('Device ('CUDA 0))
                                      (Unify
                                         (Device (DeviceType Nat))
                                         (Unify
                                            (Device (DeviceType Nat))
                                            (Unify
                                               (Device (DeviceType Nat))
                                               ('Device ('CUDA 0))
                                               (Unify
                                                  (Device (DeviceType Nat))
                                                  ('Device ('CUDA 0))
                                                  ('Device ('CUDA 0))))
                                            ('Device ('CUDA 0)))
                                         ('Device ('CUDA 0))))
                                   (Unify
                                      (Device (DeviceType Nat))
                                      (Unify
                                         (Device (DeviceType Nat))
                                         ('Device ('CUDA 0))
                                         (Unify
                                            (Device (DeviceType Nat))
                                            ('Device ('CUDA 0))
                                            ('Device ('CUDA 0))))
                                      ('Device ('CUDA 0))))))))
                    (Unify
                       (Device (DeviceType Nat))
                       (Unify
                          (Device (DeviceType Nat))
                          ('Device ('CUDA 0))
                          (Unify
                             (Device (DeviceType Nat))
                             (Unify
                                (Device (DeviceType Nat))
                                (Unify
                                   (Device (DeviceType Nat))
                                   ('Device ('CUDA 0))
                                   (Unify
                                      (Device (DeviceType Nat))
                                      ('Device ('CUDA 0))
                                      ('Device ('CUDA 0))))
                                ('Device ('CUDA 0)))
                             ('Device ('CUDA 0))))
                       (Unify
                          (Device (DeviceType Nat))
                          (Unify
                             (Device (DeviceType Nat))
                             ('Device ('CUDA 0))
                             (Unify
                                (Device (DeviceType Nat)) ('Device ('CUDA 0)) ('Device ('CUDA 0))))
                          ('Device ('CUDA 0))))))))))
  (Unify
     (DataType DType)
     ('DataType BERTDType)
     (Unify
        (DataType DType)
        ('DataType BERTDType)
        (Unify
           (DataType DType)
           ('DataType BERTDType)
           (Unify
              (DataType DType)
              ('DataType BERTDType)
              (Unify
                 (DataType DType)
                 (Unify
                    (DataType DType)
                    ('DataType BERTDType)
                    (Unify
                       (DataType DType)
                       (Unify
                          (DataType DType)
                          ('DataType BERTDType)
                          (Unify
                             (DataType DType)
                             (Unify
                                (DataType DType)
                                ('DataType BERTDType)
                                (Unify
                                   (DataType DType)
                                   ('DataType BERTDType)
                                   (Unify
                                      (DataType DType)
                                      ('DataType BERTDType)
                                      (Unify
                                         (DataType DType)
                                         (Unify
                                            (DataType DType)
                                            ('DataType BERTDType)
                                            (Unify
                                               (DataType DType)
                                               ('DataType BERTDType)
                                               (Seq
                                                  (Unify
                                                     (DataType DType)
                                                     (Seq
                                                        (Unify
                                                           (DataType DType)
                                                           ('DataType 'Int64)
                                                           ('DataType 'Int64))
                                                        ('DataType 'Bool))
                                                     ('DataType 'Bool))
                                                  ('DataType BERTDType))))
                                         ('DataType BERTDType)))))
                             (Unify
                                (DataType DType)
                                ('DataType BERTDType)
                                (Unify
                                   (DataType DType)
                                   ('DataType BERTDType)
                                   (Unify
                                      (DataType DType)
                                      ('DataType BERTDType)
                                      (Unify
                                         (DataType DType)
                                         ('DataType BERTDType)
                                         (Unify
                                            (DataType DType)
                                            ('DataType BERTDType)
                                            (Unify
                                               (DataType DType)
                                               (Unify
                                                  (DataType DType)
                                                  ('DataType BERTDType)
                                                  (Unify
                                                     (DataType DType)
                                                     ('DataType BERTDType)
                                                     (Seq
                                                        (Unify
                                                           (DataType DType)
                                                           (Seq
                                                              (Unify
                                                                 (DataType DType)
                                                                 ('DataType 'Int64)
                                                                 ('DataType 'Int64))
                                                              ('DataType 'Bool))
                                                           ('DataType 'Bool))
                                                        ('DataType BERTDType))))
                                               ('DataType BERTDType)))))))))
                       ('DataType BERTDType)))
                 (Unify
                    (DataType DType)
                    ('DataType BERTDType)
                    (Unify
                       (DataType DType)
                       ('DataType BERTDType)
                       (Unify
                          (DataType DType)
                          ('DataType BERTDType)
                          (Unify
                             (DataType DType)
                             (Unify
                                (DataType DType)
                                ('DataType BERTDType)
                                (Unify
                                   (DataType DType)
                                   (Unify
                                      (DataType DType)
                                      ('DataType BERTDType)
                                      (Unify
                                         (DataType DType)
                                         ('DataType BERTDType)
                                         (Unify
                                            (DataType DType)
                                            ('DataType BERTDType)
                                            (Unify
                                               (DataType DType)
                                               (Unify
                                                  (DataType DType)
                                                  ('DataType BERTDType)
                                                  (Unify
                                                     (DataType DType)
                                                     ('DataType BERTDType)
                                                     (Seq
                                                        (Unify
                                                           (DataType DType)
                                                           (Seq
                                                              (Unify
                                                                 (DataType DType)
                                                                 ('DataType 'Int64)
                                                                 ('DataType 'Int64))
                                                              ('DataType 'Bool))
                                                           ('DataType 'Bool))
                                                        ('DataType BERTDType))))
                                               ('DataType BERTDType)))))
                                   (Unify
                                      (DataType DType)
                                      ('DataType BERTDType)
                                      (Unify
                                         (DataType DType)
                                         ('DataType BERTDType)
                                         (Unify
                                            (DataType DType)
                                            ('DataType BERTDType)
                                            (Unify
                                               (DataType DType)
                                               ('DataType BERTDType)
                                               (Unify
                                                  (DataType DType)
                                                  ('DataType BERTDType)
                                                  (Unify
                                                     (DataType DType)
                                                     (Unify
                                                        (DataType DType)
                                                        ('DataType BERTDType)
                                                        (Unify
                                                           (DataType DType)
                                                           ('DataType BERTDType)
                                                           (Seq
                                                              (Unify
                                                                 (DataType DType)
                                                                 (Seq
                                                                    (Unify
                                                                       (DataType DType)
                                                                       ('DataType 'Int64)
                                                                       ('DataType 'Int64))
                                                                    ('DataType 'Bool))
                                                                 ('DataType 'Bool))
                                                              ('DataType BERTDType))))
                                                     ('DataType BERTDType)))))))))
                             ('DataType BERTDType))))))))))
  'UncheckedShape
</span><a href="#local-6989586621679582512"><span class="hs-identifier hs-var">eoEncoderOutput</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-84"></span><span>          </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#UnsafeTensor"><span class="hs-identifier hs-type">UnsafeTensor</span></a></span><span> </span><span id="local-6989586621679582507"><span class="annot"><a href="#local-6989586621679582507"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Tensor -&gt; [[[Float]]]
forall a. TensorLike a =&gt; Tensor -&gt; a
</span><a href="../../../../hasktorch/html/src"><span class="hs-identifier hs-var">Tensor.asValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ATenTensor -&gt; Tensor
</span><a href="../../../../hasktorch/html/src"><span class="hs-identifier hs-var">Tensor.Unsafe</span></a></span><span> </span><span class="annot"><span class="annottext">ATenTensor
</span><a href="#local-6989586621679582507"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679582505"><span class="annot"><span class="annottext">firstLMHeadLogits :: [Float]
</span><a href="#local-6989586621679582505"><span class="hs-identifier hs-var hs-var">firstLMHeadLogits</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-86"></span><span>          </span><span id="local-6989586621679582504"><span class="annot"><span class="annottext">[[Float]]
</span><a href="#local-6989586621679582504"><span class="hs-identifier hs-var">firstBatch</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [[[Float]]] -&gt; [[[Float]]]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">[[[Float]]]
</span><a href="#local-6989586621679582509"><span class="hs-identifier hs-var">encoderOutput'</span></a></span><span>
</span><span id="line-87"></span><span>          </span><span id="local-6989586621679582502"><span class="annot"><span class="annottext">[Float]
</span><a href="#local-6989586621679582502"><span class="hs-identifier hs-var">firstPositions</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [[Float]] -&gt; [[Float]]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">[[Float]]
</span><a href="#local-6989586621679582504"><span class="hs-identifier hs-var">firstBatch</span></a></span><span>
</span><span id="line-88"></span><span>          </span><span class="annot"><span class="annottext">Int -&gt; [Float] -&gt; [Float]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">[Float]
</span><a href="#local-6989586621679582502"><span class="hs-identifier hs-var">firstPositions</span></a></span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679582501"><span class="annot"><span class="annottext">firstLMHeadLogits' :: [Float]
</span><a href="#local-6989586621679582501"><span class="hs-identifier hs-var hs-var">firstLMHeadLogits'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">6.4346</span></span><span class="hs-special">,</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">6.4063</span></span><span class="hs-special">,</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">6.4097</span></span><span class="hs-special">,</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">14.0119</span></span><span class="hs-special">,</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">14.7240</span></span><span class="hs-special">,</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">14.2120</span></span><span class="hs-special">,</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">9.6561</span></span><span class="hs-special">,</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">10.3125</span></span><span class="hs-special">,</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">9.7459</span></span><span class="hs-special">]</span><span>
</span><span id="line-90"></span><span>    </span><span class="annot"><span class="annottext">((Float, Float) -&gt; IO ()) -&gt; [(Float, Float)] -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Float -&gt; Float -&gt; IO ()) -&gt; (Float, Float) -&gt; IO ()
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Float -&gt; Float -&gt; Float -&gt; IO ()
forall a.
(HasCallStack, Ord a, Num a, Show a) =&gt;
FilePath -&gt; a -&gt; a -&gt; a -&gt; IO ()
</span><a href="../file:///nix/store/d9rc2h31drxy3swyhm4cw2wjq41c1s43-HUnit-approx-lib-HUnit-approx-1.1.1.1-haddock-doc/share/doc/HUnit-approx/html/src"><span class="hs-identifier hs-var">assertApproxEqual</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;failed approximate equality check&quot;</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0.001</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Float, Float)] -&gt; IO ()) -&gt; [(Float, Float)] -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Float] -&gt; [Float] -&gt; [(Float, Float)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[Float]
</span><a href="#local-6989586621679582501"><span class="hs-identifier hs-var">firstLMHeadLogits'</span></a></span><span> </span><span class="annot"><span class="annottext">[Float]
</span><a href="#local-6989586621679582505"><span class="hs-identifier hs-var">firstLMHeadLogits</span></a></span><span>
</span><span id="line-91"></span></pre></body></html>