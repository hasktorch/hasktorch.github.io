<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Torch.GraduallyTyped.NN.Functional.Linear</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.TypeLits</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Nat</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Symbol</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TypeError</span></span><span class="hs-special">)</span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.IO.Unsafe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">unsafePerformIO</span></span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html"><span class="hs-identifier">Torch.GraduallyTyped.DType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier">DType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier">DataType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html"><span class="hs-identifier">Torch.GraduallyTyped.Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier">DeviceType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html"><span class="hs-identifier">Torch.GraduallyTyped.Layout</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier">Layout</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#LayoutType"><span class="hs-identifier">LayoutType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html"><span class="hs-identifier">Torch.GraduallyTyped.Prelude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html#Reverse"><span class="hs-identifier">Reverse</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html#Seq"><span class="hs-identifier">Seq</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html"><span class="hs-identifier">Torch.GraduallyTyped.RequiresGradient</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier">Gradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier">RequiresGradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.Shape.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier">Name</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier">Shape</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier">Size</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.Tensor.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier">Tensor</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html"><span class="hs-identifier">Torch.GraduallyTyped.Unify</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator">(&lt;+&gt;)</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%7C%3E"><span class="hs-operator">(&lt;|&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../libtorch-ffi/html/src"><span class="hs-identifier">Torch.Internal.Cast</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../libtorch-ffi/html/src"><span class="hs-identifier">cast2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../libtorch-ffi/html/src"><span class="hs-identifier">cast3</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../libtorch-ffi/html/src"><span class="hs-identifier">Torch.Internal.Managed.Native</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ATen</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/a8ll3m7yfhm0g8j77q9rvjhgdb07zpwk-type-errors-pretty-lib-type-errors-pretty-0.0.1.1-haddock-doc/share/doc/type-errors-pretty/html/src"><span class="hs-identifier">Type.Errors.Pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="../file:///nix/store/a8ll3m7yfhm0g8j77q9rvjhgdb07zpwk-type-errors-pretty-lib-type-errors-pretty-0.0.1.1-haddock-doc/share/doc/type-errors-pretty/html/src"><span class="hs-operator">(%)</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="../file:///nix/store/a8ll3m7yfhm0g8j77q9rvjhgdb07zpwk-type-errors-pretty-lib-type-errors-pretty-0.0.1.1-haddock-doc/share/doc/type-errors-pretty/html/src"><span class="hs-operator">(&lt;&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-comment">-- $setup</span><span>
</span><span id="line-24"></span><span class="hs-comment">-- &gt;&gt;&gt; import Data.Singletons.Prelude.List (SList (..))</span><span>
</span><span id="line-25"></span><span class="hs-comment">-- &gt;&gt;&gt; import Torch.GraduallyTyped</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-comment">-- | Compute the output shape of a linear transformation.</span><span>
</span><span id="line-28"></span><span class="hs-comment">--</span><span>
</span><span id="line-29"></span><span class="hs-comment">-- &gt;&gt;&gt; type InputDim = 'Dim ('Name &quot;input&quot;) ('Size 5)</span><span>
</span><span id="line-30"></span><span class="hs-comment">-- &gt;&gt;&gt; type OutputDim = 'Dim ('Name &quot;output&quot;) ('Size 10)</span><span>
</span><span id="line-31"></span><span class="hs-comment">-- &gt;&gt;&gt; type BatchDim = 'Dim ('Name &quot;batch&quot;) ('Size 20)</span><span>
</span><span id="line-32"></span><span class="hs-comment">-- &gt;&gt;&gt; type WeightShape = 'Shape '[OutputDim, InputDim]</span><span>
</span><span id="line-33"></span><span class="hs-comment">-- &gt;&gt;&gt; type BiasShape = 'Shape '[OutputDim]</span><span>
</span><span id="line-34"></span><span class="hs-comment">-- &gt;&gt;&gt; type InputShape = 'Shape '[BatchDim, InputDim]</span><span>
</span><span id="line-35"></span><span class="hs-comment">-- &gt;&gt;&gt; :kind! LinearWithBiasF WeightShape BiasShape InputShape</span><span>
</span><span id="line-36"></span><span class="hs-comment">-- LinearWithBiasF WeightShape BiasShape InputShape :: Shape</span><span>
</span><span id="line-37"></span><span class="hs-comment">--                                                       [Dim (Name Symbol) (Size Nat)]</span><span>
</span><span id="line-38"></span><span class="hs-comment">-- = 'Shape</span><span>
</span><span id="line-39"></span><span class="hs-comment">--     '[ 'Dim ('Name &quot;batch&quot;) ('Size 20),</span><span>
</span><span id="line-40"></span><span class="hs-comment">--        'Dim ('Name &quot;output&quot;) ('Size 10)]</span><span>
</span><span id="line-41"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="LinearWithBiasF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWithBiasF"><span class="hs-identifier hs-var">LinearWithBiasF</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679549774"><span class="annot"><a href="#local-6989586621679549774"><span class="hs-identifier hs-type">weightShape</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679549773"><span class="annot"><a href="#local-6989586621679549773"><span class="hs-identifier hs-type">biasShape</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679549772"><span class="annot"><a href="#local-6989586621679549772"><span class="hs-identifier hs-type">inputShape</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-42"></span><span>  </span><span id="LinearWithBiasF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWithBiasF"><span class="hs-identifier hs-var">LinearWithBiasF</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TypeError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWeightDimsErrorMessage"><span class="hs-identifier hs-type">LinearWeightDimsErrorMessage</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span>  </span><span id="LinearWithBiasF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWithBiasF"><span class="hs-identifier hs-var">LinearWithBiasF</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span id="local-6989586621679549770"><span class="annot"><a href="#local-6989586621679549770"><span class="hs-identifier hs-type hs-type">weightDim</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TypeError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWeightDimsErrorMessage"><span class="hs-identifier hs-type">LinearWeightDimsErrorMessage</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679549770"><span class="hs-identifier hs-type">weightDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>  </span><span id="LinearWithBiasF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWithBiasF"><span class="hs-identifier hs-var">LinearWithBiasF</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679549769"><span class="annot"><a href="#local-6989586621679549769"><span class="hs-identifier hs-type hs-type">weightDim</span></a></span></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span id="local-6989586621679549768"><span class="annot"><a href="#local-6989586621679549768"><span class="hs-identifier hs-type hs-type">weightDim'</span></a></span></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span id="local-6989586621679549767"><span class="annot"><a href="#local-6989586621679549767"><span class="hs-identifier hs-type hs-type">weightDim''</span></a></span></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span id="local-6989586621679549766"><span class="annot"><a href="#local-6989586621679549766"><span class="hs-identifier hs-type hs-type">weightDims</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TypeError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWeightDimsErrorMessage"><span class="hs-identifier hs-type">LinearWeightDimsErrorMessage</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679549769"><span class="hs-identifier hs-type">weightDim</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679549768"><span class="hs-identifier hs-type">weightDim'</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679549767"><span class="hs-identifier hs-type">weightDim''</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679549766"><span class="hs-identifier hs-type">weightDims</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span>  </span><span id="LinearWithBiasF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWithBiasF"><span class="hs-identifier hs-var">LinearWithBiasF</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TypeError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearBiasDimsErrorMessage"><span class="hs-identifier hs-type">LinearBiasDimsErrorMessage</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span>  </span><span id="LinearWithBiasF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWithBiasF"><span class="hs-identifier hs-var">LinearWithBiasF</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679549764"><span class="annot"><a href="#local-6989586621679549764"><span class="hs-identifier hs-type hs-type">biasDim</span></a></span></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span id="local-6989586621679549763"><span class="annot"><a href="#local-6989586621679549763"><span class="hs-identifier hs-type hs-type">biasDim'</span></a></span></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span id="local-6989586621679549762"><span class="annot"><a href="#local-6989586621679549762"><span class="hs-identifier hs-type hs-type">biasDims</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TypeError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearBiasDimsErrorMessage"><span class="hs-identifier hs-type">LinearBiasDimsErrorMessage</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679549764"><span class="hs-identifier hs-type">biasDim</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679549763"><span class="hs-identifier hs-type">biasDim'</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679549762"><span class="hs-identifier hs-type">biasDims</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span>  </span><span id="LinearWithBiasF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWithBiasF"><span class="hs-identifier hs-var">LinearWithBiasF</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TypeError</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearInputDimsErrorMessage"><span class="hs-identifier hs-type">LinearInputDimsErrorMessage</span></a></span><span>
</span><span id="line-48"></span><span>  </span><span id="LinearWithBiasF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWithBiasF"><span class="hs-identifier hs-var">LinearWithBiasF</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span id="local-6989586621679549760"><span class="annot"><a href="#local-6989586621679549760"><span class="hs-identifier hs-type hs-type">weightDims</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span id="local-6989586621679549759"><span class="annot"><a href="#local-6989586621679549759"><span class="hs-identifier hs-type hs-type">biasDims</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span id="local-6989586621679549758"><span class="annot"><a href="#local-6989586621679549758"><span class="hs-identifier hs-type hs-type">inputDims</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html#Reverse"><span class="hs-identifier hs-type">Reverse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWithBiasDimsF"><span class="hs-identifier hs-type">LinearWithBiasDimsF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679549760"><span class="hs-identifier hs-type">weightDims</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679549759"><span class="hs-identifier hs-type">biasDims</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html#Reverse"><span class="hs-identifier hs-type">Reverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679549758"><span class="hs-identifier hs-type">inputDims</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span>  </span><span id="LinearWithBiasF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWithBiasF"><span class="hs-identifier hs-var">LinearWithBiasF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#UncheckedShape"><span class="hs-identifier hs-type">UncheckedShape</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#UncheckedShape"><span class="hs-identifier hs-type">UncheckedShape</span></a></span><span>
</span><span id="line-50"></span><span>  </span><span id="LinearWithBiasF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWithBiasF"><span class="hs-identifier hs-var">LinearWithBiasF</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#UncheckedShape"><span class="hs-identifier hs-type">UncheckedShape</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#UncheckedShape"><span class="hs-identifier hs-type">UncheckedShape</span></a></span><span>
</span><span id="line-51"></span><span>  </span><span id="LinearWithBiasF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWithBiasF"><span class="hs-identifier hs-var">LinearWithBiasF</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#UncheckedShape"><span class="hs-identifier hs-type">UncheckedShape</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#UncheckedShape"><span class="hs-identifier hs-type">UncheckedShape</span></a></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="LinearWithBiasDimsF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWithBiasDimsF"><span class="hs-identifier hs-var">LinearWithBiasDimsF</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679549755"><span class="annot"><a href="#local-6989586621679549755"><span class="hs-identifier hs-type">weightDims</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679549754"><span class="annot"><a href="#local-6989586621679549754"><span class="hs-identifier hs-type">biasDims</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679549753"><span class="annot"><a href="#local-6989586621679549753"><span class="hs-identifier hs-type">reversedInputDims</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-54"></span><span>  </span><span id="LinearWithBiasDimsF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWithBiasDimsF"><span class="hs-identifier hs-var">LinearWithBiasDimsF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span id="local-6989586621679549752"><span class="annot"><a href="#local-6989586621679549752"><span class="hs-identifier hs-type hs-type">outputDim</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679549751"><span class="annot"><a href="#local-6989586621679549751"><span class="hs-identifier hs-type hs-type">inputDim</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span id="local-6989586621679549750"><span class="annot"><a href="#local-6989586621679549750"><span class="hs-identifier hs-type hs-type">outputDim'</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679549749"><span class="annot"><a href="#local-6989586621679549749"><span class="hs-identifier hs-type hs-type">inputDim'</span></a></span></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span id="local-6989586621679549748"><span class="annot"><a href="#local-6989586621679549748"><span class="hs-identifier hs-type hs-type">reversedInputDims</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html#Seq"><span class="hs-identifier hs-type">Seq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679549751"><span class="hs-identifier hs-type">inputDim</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679549749"><span class="hs-identifier hs-type">inputDim'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679549752"><span class="hs-identifier hs-type">outputDim</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679549750"><span class="hs-identifier hs-type">outputDim'</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679549748"><span class="hs-identifier hs-type">reversedInputDims</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="hs-keyword">type</span><span> </span><span id="LinearInputDimsErrorMessage"><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearInputDimsErrorMessage"><span class="hs-identifier hs-var">LinearInputDimsErrorMessage</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-57"></span><span>  </span><span class="annot"><span class="hs-string">&quot;Cannot apply the linear transformation.&quot;</span></span><span>
</span><span id="line-58"></span><span>    </span><span class="annot"><a href="../file:///nix/store/a8ll3m7yfhm0g8j77q9rvjhgdb07zpwk-type-errors-pretty-lib-type-errors-pretty-0.0.1.1-haddock-doc/share/doc/type-errors-pretty/html/src"><span class="hs-operator hs-type">%</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;The input tensor does not have the minimum required number of dimensions.&quot;</span></span><span>
</span><span id="line-59"></span><span>    </span><span class="annot"><a href="../file:///nix/store/a8ll3m7yfhm0g8j77q9rvjhgdb07zpwk-type-errors-pretty-lib-type-errors-pretty-0.0.1.1-haddock-doc/share/doc/type-errors-pretty/html/src"><span class="hs-operator hs-type">%</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;At least one dimension is needed, but none were found.&quot;</span></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-keyword">type</span><span> </span><span id="LinearBiasDimsErrorMessage"><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearBiasDimsErrorMessage"><span class="hs-identifier hs-var">LinearBiasDimsErrorMessage</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679549747"><span class="annot"><a href="#local-6989586621679549747"><span class="hs-identifier hs-type">biasDims</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-62"></span><span>  </span><span class="annot"><span class="hs-string">&quot;Cannot apply the linear transformation.&quot;</span></span><span>
</span><span id="line-63"></span><span>    </span><span class="annot"><a href="../file:///nix/store/a8ll3m7yfhm0g8j77q9rvjhgdb07zpwk-type-errors-pretty-lib-type-errors-pretty-0.0.1.1-haddock-doc/share/doc/type-errors-pretty/html/src"><span class="hs-operator hs-type">%</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;The bias tensor must have exactly one dimension,&quot;</span></span><span>
</span><span id="line-64"></span><span>    </span><span class="annot"><a href="../file:///nix/store/a8ll3m7yfhm0g8j77q9rvjhgdb07zpwk-type-errors-pretty-lib-type-errors-pretty-0.0.1.1-haddock-doc/share/doc/type-errors-pretty/html/src"><span class="hs-operator hs-type">%</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;but the following dimensions were found:&quot;</span></span><span>
</span><span id="line-65"></span><span>    </span><span class="annot"><a href="../file:///nix/store/a8ll3m7yfhm0g8j77q9rvjhgdb07zpwk-type-errors-pretty-lib-type-errors-pretty-0.0.1.1-haddock-doc/share/doc/type-errors-pretty/html/src"><span class="hs-operator hs-type">%</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-66"></span><span>    </span><span class="annot"><a href="../file:///nix/store/a8ll3m7yfhm0g8j77q9rvjhgdb07zpwk-type-errors-pretty-lib-type-errors-pretty-0.0.1.1-haddock-doc/share/doc/type-errors-pretty/html/src"><span class="hs-operator hs-type">%</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;    &quot;</span></span><span> </span><span class="annot"><a href="../file:///nix/store/a8ll3m7yfhm0g8j77q9rvjhgdb07zpwk-type-errors-pretty-lib-type-errors-pretty-0.0.1.1-haddock-doc/share/doc/type-errors-pretty/html/src"><span class="hs-operator hs-type">&lt;&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679549747"><span class="hs-identifier hs-type">biasDims</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/a8ll3m7yfhm0g8j77q9rvjhgdb07zpwk-type-errors-pretty-lib-type-errors-pretty-0.0.1.1-haddock-doc/share/doc/type-errors-pretty/html/src"><span class="hs-operator hs-type">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;.&quot;</span></span><span>
</span><span id="line-67"></span><span>    </span><span class="annot"><a href="../file:///nix/store/a8ll3m7yfhm0g8j77q9rvjhgdb07zpwk-type-errors-pretty-lib-type-errors-pretty-0.0.1.1-haddock-doc/share/doc/type-errors-pretty/html/src"><span class="hs-operator hs-type">%</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-keyword">type</span><span> </span><span id="LinearWeightDimsErrorMessage"><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWeightDimsErrorMessage"><span class="hs-identifier hs-var">LinearWeightDimsErrorMessage</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679549746"><span class="annot"><a href="#local-6989586621679549746"><span class="hs-identifier hs-type">weightDims</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-70"></span><span>  </span><span class="annot"><span class="hs-string">&quot;Cannot apply the linear transformation.&quot;</span></span><span>
</span><span id="line-71"></span><span>    </span><span class="annot"><a href="../file:///nix/store/a8ll3m7yfhm0g8j77q9rvjhgdb07zpwk-type-errors-pretty-lib-type-errors-pretty-0.0.1.1-haddock-doc/share/doc/type-errors-pretty/html/src"><span class="hs-operator hs-type">%</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;The weight tensor must have exactly two dimensions,&quot;</span></span><span>
</span><span id="line-72"></span><span>    </span><span class="annot"><a href="../file:///nix/store/a8ll3m7yfhm0g8j77q9rvjhgdb07zpwk-type-errors-pretty-lib-type-errors-pretty-0.0.1.1-haddock-doc/share/doc/type-errors-pretty/html/src"><span class="hs-operator hs-type">%</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;but the following dimensions were found:&quot;</span></span><span>
</span><span id="line-73"></span><span>    </span><span class="annot"><a href="../file:///nix/store/a8ll3m7yfhm0g8j77q9rvjhgdb07zpwk-type-errors-pretty-lib-type-errors-pretty-0.0.1.1-haddock-doc/share/doc/type-errors-pretty/html/src"><span class="hs-operator hs-type">%</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-74"></span><span>    </span><span class="annot"><a href="../file:///nix/store/a8ll3m7yfhm0g8j77q9rvjhgdb07zpwk-type-errors-pretty-lib-type-errors-pretty-0.0.1.1-haddock-doc/share/doc/type-errors-pretty/html/src"><span class="hs-operator hs-type">%</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;    &quot;</span></span><span> </span><span class="annot"><a href="../file:///nix/store/a8ll3m7yfhm0g8j77q9rvjhgdb07zpwk-type-errors-pretty-lib-type-errors-pretty-0.0.1.1-haddock-doc/share/doc/type-errors-pretty/html/src"><span class="hs-operator hs-type">&lt;&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679549746"><span class="hs-identifier hs-type">weightDims</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/a8ll3m7yfhm0g8j77q9rvjhgdb07zpwk-type-errors-pretty-lib-type-errors-pretty-0.0.1.1-haddock-doc/share/doc/type-errors-pretty/html/src"><span class="hs-operator hs-type">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;.&quot;</span></span><span>
</span><span id="line-75"></span><span>    </span><span class="annot"><a href="../file:///nix/store/a8ll3m7yfhm0g8j77q9rvjhgdb07zpwk-type-errors-pretty-lib-type-errors-pretty-0.0.1.1-haddock-doc/share/doc/type-errors-pretty/html/src"><span class="hs-operator hs-type">%</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="hs-comment">-- | Applies a linear transformation to the incoming data:</span><span>
</span><span id="line-78"></span><span class="hs-comment">-- \[</span><span>
</span><span id="line-79"></span><span class="hs-comment">-- \mathrm{output} = \mathrm{input} \mathrm{weight}^{\intercal} + \mathrm{bias}.</span><span>
</span><span id="line-80"></span><span class="hs-comment">-- \]</span><span>
</span><span id="line-81"></span><span class="hs-comment">--</span><span>
</span><span id="line-82"></span><span class="hs-comment">-- Supported shapes:</span><span>
</span><span id="line-83"></span><span class="hs-comment">--</span><span>
</span><span id="line-84"></span><span class="hs-comment">--     * 'input': \((N, \ldots, \mathrm{inputFeatures})\), where \(N\) is the batch size,</span><span>
</span><span id="line-85"></span><span class="hs-comment">--     \(\ldots\) means any number of additional dimensions and</span><span>
</span><span id="line-86"></span><span class="hs-comment">--     \(\mathrm{inputFeatures}\) are the input features.</span><span>
</span><span id="line-87"></span><span class="hs-comment">--</span><span>
</span><span id="line-88"></span><span class="hs-comment">--     * 'weight': \((\mathrm{outputFeatures}, \mathrm{inputFeatures})\)</span><span>
</span><span id="line-89"></span><span class="hs-comment">--</span><span>
</span><span id="line-90"></span><span class="hs-comment">--     * 'bias': \((\mathrm{outputFeatures})\)</span><span>
</span><span id="line-91"></span><span class="hs-comment">--</span><span>
</span><span id="line-92"></span><span class="hs-comment">--     * 'output': \((N, \ldots, \mathrm{outputFeatures})\)</span><span>
</span><span id="line-93"></span><span class="hs-comment">--</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- Examples:</span><span>
</span><span id="line-95"></span><span class="hs-comment">--</span><span>
</span><span id="line-96"></span><span class="hs-comment">-- &gt;&gt;&gt; inputDim = SName @&quot;input&quot; :&amp;: SSize @5</span><span>
</span><span id="line-97"></span><span class="hs-comment">-- &gt;&gt;&gt; outputDim = SName @&quot;output&quot; :&amp;: SSize @10</span><span>
</span><span id="line-98"></span><span class="hs-comment">-- &gt;&gt;&gt; batchDim = SName @&quot;batch&quot; :&amp;: SSize @20</span><span>
</span><span id="line-99"></span><span class="hs-comment">-- &gt;&gt;&gt; weightShape = SShape $ outputDim :|: inputDim :|: SNil</span><span>
</span><span id="line-100"></span><span class="hs-comment">-- &gt;&gt;&gt; biasShape = SShape $ outputDim :|: SNil</span><span>
</span><span id="line-101"></span><span class="hs-comment">-- &gt;&gt;&gt; inputShape = SShape $ batchDim :|: inputDim :|: SNil</span><span>
</span><span id="line-102"></span><span class="hs-comment">-- &gt;&gt;&gt; g = sMkGenerator (SDevice SCPU) 0</span><span>
</span><span id="line-103"></span><span class="hs-comment">-- &gt;&gt;&gt; sRandn' = sRandn . TensorSpec (SGradient SWithoutGradient) (SLayout SDense) (SDevice SCPU) (SDataType SFloat)</span><span>
</span><span id="line-104"></span><span class="hs-comment">-- &gt;&gt;&gt; (weight, g') &lt;- sRandn' weightShape g</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- [W TensorImpl.h:1156] Warning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (function operator())</span><span>
</span><span id="line-106"></span><span class="hs-comment">-- &gt;&gt;&gt; (bias, g'') &lt;- sRandn' biasShape g'</span><span>
</span><span id="line-107"></span><span class="hs-comment">-- &gt;&gt;&gt; (input, _) &lt;- sRandn' inputShape g''</span><span>
</span><span id="line-108"></span><span class="hs-comment">-- &gt;&gt;&gt; result = linearWithBias weight bias input</span><span>
</span><span id="line-109"></span><span class="hs-comment">-- &gt;&gt;&gt; :type result</span><span>
</span><span id="line-110"></span><span class="hs-comment">-- result</span><span>
</span><span id="line-111"></span><span class="hs-comment">--   :: Tensor</span><span>
</span><span id="line-112"></span><span class="hs-comment">--        ('Gradient 'WithoutGradient)</span><span>
</span><span id="line-113"></span><span class="hs-comment">--        ('Layout 'Dense)</span><span>
</span><span id="line-114"></span><span class="hs-comment">--        ('Device 'CPU)</span><span>
</span><span id="line-115"></span><span class="hs-comment">--        ('DataType 'Float)</span><span>
</span><span id="line-116"></span><span class="hs-comment">--        ('Shape</span><span>
</span><span id="line-117"></span><span class="hs-comment">--           '[ 'Dim ('Name &quot;batch&quot;) ('Size 20),</span><span>
</span><span id="line-118"></span><span class="hs-comment">--              'Dim ('Name &quot;output&quot;) ('Size 10)])</span><span>
</span><span id="line-119"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#linearWithBias"><span class="hs-identifier hs-type">linearWithBias</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679549744"><span class="annot"><a href="#local-6989586621679549744"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679549743"><span class="annot"><a href="#local-6989586621679549743"><span class="hs-identifier hs-type">layout</span></a></span></span><span> </span><span id="local-6989586621679549742"><span class="annot"><a href="#local-6989586621679549742"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679549741"><span class="annot"><a href="#local-6989586621679549741"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679549740"><span class="annot"><a href="#local-6989586621679549740"><span class="hs-identifier hs-type">shape</span></a></span></span><span> </span><span id="local-6989586621679549739"><span class="annot"><a href="#local-6989586621679549739"><span class="hs-identifier hs-type">gradient'</span></a></span></span><span> </span><span id="local-6989586621679549738"><span class="annot"><a href="#local-6989586621679549738"><span class="hs-identifier hs-type">layout'</span></a></span></span><span> </span><span id="local-6989586621679549737"><span class="annot"><a href="#local-6989586621679549737"><span class="hs-identifier hs-type">device'</span></a></span></span><span> </span><span id="local-6989586621679549736"><span class="annot"><a href="#local-6989586621679549736"><span class="hs-identifier hs-type">dataType'</span></a></span></span><span> </span><span id="local-6989586621679549735"><span class="annot"><a href="#local-6989586621679549735"><span class="hs-identifier hs-type">shape'</span></a></span></span><span> </span><span id="local-6989586621679549734"><span class="annot"><a href="#local-6989586621679549734"><span class="hs-identifier hs-type">gradient''</span></a></span></span><span> </span><span id="local-6989586621679549733"><span class="annot"><a href="#local-6989586621679549733"><span class="hs-identifier hs-type">layout''</span></a></span></span><span> </span><span id="local-6989586621679549732"><span class="annot"><a href="#local-6989586621679549732"><span class="hs-identifier hs-type">device''</span></a></span></span><span> </span><span id="local-6989586621679549731"><span class="annot"><a href="#local-6989586621679549731"><span class="hs-identifier hs-type">dataType''</span></a></span></span><span> </span><span id="local-6989586621679549730"><span class="annot"><a href="#local-6989586621679549730"><span class="hs-identifier hs-type">shape''</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-121"></span><span>  </span><span class="hs-comment">-- | weight</span><span>
</span><span id="line-122"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679549744"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679549743"><span class="hs-identifier hs-type">layout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679549742"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679549741"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679549740"><span class="hs-identifier hs-type">shape</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-123"></span><span>  </span><span class="hs-comment">-- | bias</span><span>
</span><span id="line-124"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679549739"><span class="hs-identifier hs-type">gradient'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679549738"><span class="hs-identifier hs-type">layout'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679549737"><span class="hs-identifier hs-type">device'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679549736"><span class="hs-identifier hs-type">dataType'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679549735"><span class="hs-identifier hs-type">shape'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-125"></span><span>  </span><span class="hs-comment">-- | input</span><span>
</span><span id="line-126"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679549734"><span class="hs-identifier hs-type">gradient''</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679549733"><span class="hs-identifier hs-type">layout''</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679549732"><span class="hs-identifier hs-type">device''</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679549731"><span class="hs-identifier hs-type">dataType''</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679549730"><span class="hs-identifier hs-type">shape''</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-127"></span><span>  </span><span class="hs-comment">-- | output</span><span>
</span><span id="line-128"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span>
</span><span id="line-129"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679549739"><span class="hs-identifier hs-type">gradient'</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%7C%3E"><span class="hs-operator hs-type">&lt;|&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679549734"><span class="hs-identifier hs-type">gradient''</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%7C%3E"><span class="hs-operator hs-type">&lt;|&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679549734"><span class="hs-identifier hs-type">gradient''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679549743"><span class="hs-identifier hs-type">layout</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679549738"><span class="hs-identifier hs-type">layout'</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679549733"><span class="hs-identifier hs-type">layout''</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679549742"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679549737"><span class="hs-identifier hs-type">device'</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679549732"><span class="hs-identifier hs-type">device''</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679549741"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679549736"><span class="hs-identifier hs-type">dataType'</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679549731"><span class="hs-identifier hs-type">dataType''</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWithBiasF"><span class="hs-identifier hs-type">LinearWithBiasF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679549740"><span class="hs-identifier hs-type">shape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679549735"><span class="hs-identifier hs-type">shape'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679549730"><span class="hs-identifier hs-type">shape''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span id="linearWithBias"><span class="annot"><span class="annottext">linearWithBias :: Tensor gradient layout device dataType shape
-&gt; Tensor gradient' layout' device' dataType' shape'
-&gt; Tensor gradient'' layout'' device'' dataType'' shape''
-&gt; Tensor
     (gradient' &lt;|&gt; (gradient'' &lt;|&gt; gradient''))
     (layout &lt;+&gt; (layout' &lt;+&gt; layout''))
     (device &lt;+&gt; (device' &lt;+&gt; device''))
     (dataType &lt;+&gt; (dataType' &lt;+&gt; dataType''))
     (LinearWithBiasF shape shape' shape'')
</span><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#linearWithBias"><span class="hs-identifier hs-var hs-var">linearWithBias</span></a></span></span><span> </span><span id="local-6989586621679549729"><span class="annot"><span class="annottext">Tensor gradient layout device dataType shape
</span><a href="#local-6989586621679549729"><span class="hs-identifier hs-var">weight</span></a></span></span><span> </span><span id="local-6989586621679549728"><span class="annot"><span class="annottext">Tensor gradient' layout' device' dataType' shape'
</span><a href="#local-6989586621679549728"><span class="hs-identifier hs-var">bias</span></a></span></span><span> </span><span id="local-6989586621679549727"><span class="annot"><span class="annottext">Tensor gradient'' layout'' device'' dataType'' shape''
</span><a href="#local-6989586621679549727"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO
  (Tensor
     (Or (Gradient RequiresGradient) gradient' gradient'')
     (Unify
        (Layout LayoutType)
        layout
        (Unify (Layout LayoutType) layout' layout''))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device' device''))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType' dataType''))
     (LinearWithBiasF shape shape' shape''))
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient' gradient'')
     (Unify
        (Layout LayoutType)
        layout
        (Unify (Layout LayoutType) layout' layout''))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device' device''))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType' dataType''))
     (LinearWithBiasF shape shape' shape'')
forall a. IO a -&gt; a
</span><span class="hs-identifier hs-var">unsafePerformIO</span></span><span> </span><span class="annot"><span class="annottext">(IO
   (Tensor
      (Or (Gradient RequiresGradient) gradient' gradient'')
      (Unify
         (Layout LayoutType)
         layout
         (Unify (Layout LayoutType) layout' layout''))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device' device''))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType' dataType''))
      (LinearWithBiasF shape shape' shape''))
 -&gt; Tensor
      (Or (Gradient RequiresGradient) gradient' gradient'')
      (Unify
         (Layout LayoutType)
         layout
         (Unify (Layout LayoutType) layout' layout''))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device' device''))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType' dataType''))
      (LinearWithBiasF shape shape' shape''))
-&gt; IO
     (Tensor
        (Or (Gradient RequiresGradient) gradient' gradient'')
        (Unify
           (Layout LayoutType)
           layout
           (Unify (Layout LayoutType) layout' layout''))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device' device''))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType' dataType''))
        (LinearWithBiasF shape shape' shape''))
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient' gradient'')
     (Unify
        (Layout LayoutType)
        layout
        (Unify (Layout LayoutType) layout' layout''))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device' device''))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType' dataType''))
     (LinearWithBiasF shape shape' shape'')
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ForeignPtr Tensor
 -&gt; ForeignPtr Tensor
 -&gt; ForeignPtr Tensor
 -&gt; IO (ForeignPtr Tensor))
-&gt; Tensor gradient'' layout'' device'' dataType'' shape''
-&gt; Tensor gradient layout device dataType shape
-&gt; Tensor gradient' layout' device' dataType' shape'
-&gt; IO
     (Tensor
        (Or (Gradient RequiresGradient) gradient' gradient'')
        (Unify
           (Layout LayoutType)
           layout
           (Unify (Layout LayoutType) layout' layout''))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device' device''))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType' dataType''))
        (LinearWithBiasF shape shape' shape''))
forall a ca x1 cx1 x2 cx2 y cy.
(Castable a ca, Castable x1 cx1, Castable x2 cx2, Castable y cy) =&gt;
(ca -&gt; cx1 -&gt; cx2 -&gt; IO cy) -&gt; a -&gt; x1 -&gt; x2 -&gt; IO y
</span><a href="../../../../libtorch-ffi/html/src"><span class="hs-identifier hs-var">cast3</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Tensor
-&gt; ForeignPtr Tensor -&gt; ForeignPtr Tensor -&gt; IO (ForeignPtr Tensor)
</span><a href="../../../../libtorch-ffi/html/src"><span class="hs-identifier hs-var">ATen.linear_ttt</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor gradient'' layout'' device'' dataType'' shape''
</span><a href="#local-6989586621679549727"><span class="hs-identifier hs-var">input</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor gradient layout device dataType shape
</span><a href="#local-6989586621679549729"><span class="hs-identifier hs-var">weight</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor gradient' layout' device' dataType' shape'
</span><a href="#local-6989586621679549728"><span class="hs-identifier hs-var">bias</span></a></span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="LinearWithoutBiasF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWithoutBiasF"><span class="hs-identifier hs-var">LinearWithoutBiasF</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679549725"><span class="annot"><a href="#local-6989586621679549725"><span class="hs-identifier hs-type">weightShape</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679549724"><span class="annot"><a href="#local-6989586621679549724"><span class="hs-identifier hs-type">inputShape</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-137"></span><span>  </span><span id="LinearWithoutBiasF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWithoutBiasF"><span class="hs-identifier hs-var">LinearWithoutBiasF</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TypeError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWeightDimsErrorMessage"><span class="hs-identifier hs-type">LinearWeightDimsErrorMessage</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>  </span><span id="LinearWithoutBiasF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWithoutBiasF"><span class="hs-identifier hs-var">LinearWithoutBiasF</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span id="local-6989586621679549723"><span class="annot"><a href="#local-6989586621679549723"><span class="hs-identifier hs-type hs-type">weightDim</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TypeError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWeightDimsErrorMessage"><span class="hs-identifier hs-type">LinearWeightDimsErrorMessage</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679549723"><span class="hs-identifier hs-type">weightDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>  </span><span id="LinearWithoutBiasF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWithoutBiasF"><span class="hs-identifier hs-var">LinearWithoutBiasF</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679549722"><span class="annot"><a href="#local-6989586621679549722"><span class="hs-identifier hs-type hs-type">weightDim</span></a></span></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span id="local-6989586621679549721"><span class="annot"><a href="#local-6989586621679549721"><span class="hs-identifier hs-type hs-type">weightDim'</span></a></span></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span id="local-6989586621679549720"><span class="annot"><a href="#local-6989586621679549720"><span class="hs-identifier hs-type hs-type">weightDim''</span></a></span></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span id="local-6989586621679549719"><span class="annot"><a href="#local-6989586621679549719"><span class="hs-identifier hs-type hs-type">weightDims</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TypeError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWeightDimsErrorMessage"><span class="hs-identifier hs-type">LinearWeightDimsErrorMessage</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679549722"><span class="hs-identifier hs-type">weightDim</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679549721"><span class="hs-identifier hs-type">weightDim'</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679549720"><span class="hs-identifier hs-type">weightDim''</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679549719"><span class="hs-identifier hs-type">weightDims</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>  </span><span id="LinearWithoutBiasF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWithoutBiasF"><span class="hs-identifier hs-var">LinearWithoutBiasF</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TypeError</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearInputDimsErrorMessage"><span class="hs-identifier hs-type">LinearInputDimsErrorMessage</span></a></span><span>
</span><span id="line-141"></span><span>  </span><span id="LinearWithoutBiasF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWithoutBiasF"><span class="hs-identifier hs-var">LinearWithoutBiasF</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span id="local-6989586621679549718"><span class="annot"><a href="#local-6989586621679549718"><span class="hs-identifier hs-type hs-type">weightDims</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span id="local-6989586621679549717"><span class="annot"><a href="#local-6989586621679549717"><span class="hs-identifier hs-type hs-type">inputDims</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html#Reverse"><span class="hs-identifier hs-type">Reverse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWithoutBiasDimsF"><span class="hs-identifier hs-type">LinearWithoutBiasDimsF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679549718"><span class="hs-identifier hs-type">weightDims</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html#Reverse"><span class="hs-identifier hs-type">Reverse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679549717"><span class="hs-identifier hs-type">inputDims</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span>  </span><span id="LinearWithoutBiasF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWithoutBiasF"><span class="hs-identifier hs-var">LinearWithoutBiasF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#UncheckedShape"><span class="hs-identifier hs-type">UncheckedShape</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#UncheckedShape"><span class="hs-identifier hs-type">UncheckedShape</span></a></span><span>
</span><span id="line-143"></span><span>  </span><span id="LinearWithoutBiasF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWithoutBiasF"><span class="hs-identifier hs-var">LinearWithoutBiasF</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#UncheckedShape"><span class="hs-identifier hs-type">UncheckedShape</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#UncheckedShape"><span class="hs-identifier hs-type">UncheckedShape</span></a></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="LinearWithoutBiasDimsF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWithoutBiasDimsF"><span class="hs-identifier hs-var">LinearWithoutBiasDimsF</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679549715"><span class="annot"><a href="#local-6989586621679549715"><span class="hs-identifier hs-type">weightDims</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679549714"><span class="annot"><a href="#local-6989586621679549714"><span class="hs-identifier hs-type">reversedInputDims</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-146"></span><span>  </span><span id="LinearWithoutBiasDimsF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWithoutBiasDimsF"><span class="hs-identifier hs-var">LinearWithoutBiasDimsF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span id="local-6989586621679549713"><span class="annot"><a href="#local-6989586621679549713"><span class="hs-identifier hs-type hs-type">outputDim</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679549712"><span class="annot"><a href="#local-6989586621679549712"><span class="hs-identifier hs-type hs-type">inputDim</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679549711"><span class="annot"><a href="#local-6989586621679549711"><span class="hs-identifier hs-type hs-type">inputDim'</span></a></span></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span id="local-6989586621679549710"><span class="annot"><a href="#local-6989586621679549710"><span class="hs-identifier hs-type hs-type">reversedInputDims</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html#Seq"><span class="hs-identifier hs-type">Seq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679549712"><span class="hs-identifier hs-type">inputDim</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679549711"><span class="hs-identifier hs-type">inputDim'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679549713"><span class="hs-identifier hs-type">outputDim</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679549710"><span class="hs-identifier hs-type">reversedInputDims</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#linearWithoutBias"><span class="hs-identifier hs-type">linearWithoutBias</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-149"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679549791"><span class="annot"><a href="#local-6989586621679549791"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679549790"><span class="annot"><a href="#local-6989586621679549790"><span class="hs-identifier hs-type">layout</span></a></span></span><span> </span><span id="local-6989586621679549789"><span class="annot"><a href="#local-6989586621679549789"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679549788"><span class="annot"><a href="#local-6989586621679549788"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679549787"><span class="annot"><a href="#local-6989586621679549787"><span class="hs-identifier hs-type">shape</span></a></span></span><span> </span><span id="local-6989586621679549786"><span class="annot"><a href="#local-6989586621679549786"><span class="hs-identifier hs-type">gradient'</span></a></span></span><span> </span><span id="local-6989586621679549785"><span class="annot"><a href="#local-6989586621679549785"><span class="hs-identifier hs-type">layout'</span></a></span></span><span> </span><span id="local-6989586621679549784"><span class="annot"><a href="#local-6989586621679549784"><span class="hs-identifier hs-type">device'</span></a></span></span><span> </span><span id="local-6989586621679549783"><span class="annot"><a href="#local-6989586621679549783"><span class="hs-identifier hs-type">dataType'</span></a></span></span><span> </span><span id="local-6989586621679549782"><span class="annot"><a href="#local-6989586621679549782"><span class="hs-identifier hs-type">shape'</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-150"></span><span>  </span><span class="hs-comment">-- | weight</span><span>
</span><span id="line-151"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679549791"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679549790"><span class="hs-identifier hs-type">layout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679549789"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679549788"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679549787"><span class="hs-identifier hs-type">shape</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-comment">-- | input</span><span>
</span><span id="line-153"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679549786"><span class="hs-identifier hs-type">gradient'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679549785"><span class="hs-identifier hs-type">layout'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679549784"><span class="hs-identifier hs-type">device'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679549783"><span class="hs-identifier hs-type">dataType'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679549782"><span class="hs-identifier hs-type">shape'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-154"></span><span>  </span><span class="hs-comment">-- | output</span><span>
</span><span id="line-155"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span>
</span><span id="line-156"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679549791"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%7C%3E"><span class="hs-operator hs-type">&lt;|&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679549786"><span class="hs-identifier hs-type">gradient'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679549790"><span class="hs-identifier hs-type">layout</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679549785"><span class="hs-identifier hs-type">layout'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679549789"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679549784"><span class="hs-identifier hs-type">device'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679549788"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679549783"><span class="hs-identifier hs-type">dataType'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWithoutBiasF"><span class="hs-identifier hs-type">LinearWithoutBiasF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679549787"><span class="hs-identifier hs-type">shape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679549782"><span class="hs-identifier hs-type">shape'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span id="linearWithoutBias"><span class="annot"><span class="annottext">linearWithoutBias :: Tensor gradient layout device dataType shape
-&gt; Tensor gradient' layout' device' dataType' shape'
-&gt; Tensor
     (gradient &lt;|&gt; gradient')
     (layout &lt;+&gt; layout')
     (device &lt;+&gt; device')
     (dataType &lt;+&gt; dataType')
     (LinearWithoutBiasF shape shape')
</span><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#linearWithoutBias"><span class="hs-identifier hs-var hs-var">linearWithoutBias</span></a></span></span><span> </span><span id="local-6989586621679549708"><span class="annot"><span class="annottext">Tensor gradient layout device dataType shape
</span><a href="#local-6989586621679549708"><span class="hs-identifier hs-var">weight</span></a></span></span><span> </span><span id="local-6989586621679549707"><span class="annot"><span class="annottext">Tensor gradient' layout' device' dataType' shape'
</span><a href="#local-6989586621679549707"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO
  (Tensor
     (Or (Gradient RequiresGradient) gradient gradient')
     (Unify (Layout LayoutType) layout layout')
     (Unify (Device (DeviceType Nat)) device device')
     (Unify (DataType DType) dataType dataType')
     (LinearWithoutBiasF shape shape'))
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient gradient')
     (Unify (Layout LayoutType) layout layout')
     (Unify (Device (DeviceType Nat)) device device')
     (Unify (DataType DType) dataType dataType')
     (LinearWithoutBiasF shape shape')
forall a. IO a -&gt; a
</span><span class="hs-identifier hs-var">unsafePerformIO</span></span><span> </span><span class="annot"><span class="annottext">(IO
   (Tensor
      (Or (Gradient RequiresGradient) gradient gradient')
      (Unify (Layout LayoutType) layout layout')
      (Unify (Device (DeviceType Nat)) device device')
      (Unify (DataType DType) dataType dataType')
      (LinearWithoutBiasF shape shape'))
 -&gt; Tensor
      (Or (Gradient RequiresGradient) gradient gradient')
      (Unify (Layout LayoutType) layout layout')
      (Unify (Device (DeviceType Nat)) device device')
      (Unify (DataType DType) dataType dataType')
      (LinearWithoutBiasF shape shape'))
-&gt; IO
     (Tensor
        (Or (Gradient RequiresGradient) gradient gradient')
        (Unify (Layout LayoutType) layout layout')
        (Unify (Device (DeviceType Nat)) device device')
        (Unify (DataType DType) dataType dataType')
        (LinearWithoutBiasF shape shape'))
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient gradient')
     (Unify (Layout LayoutType) layout layout')
     (Unify (Device (DeviceType Nat)) device device')
     (Unify (DataType DType) dataType dataType')
     (LinearWithoutBiasF shape shape')
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ForeignPtr Tensor -&gt; ForeignPtr Tensor -&gt; IO (ForeignPtr Tensor))
-&gt; Tensor gradient' layout' device' dataType' shape'
-&gt; Tensor gradient layout device dataType shape
-&gt; IO
     (Tensor
        (Or (Gradient RequiresGradient) gradient gradient')
        (Unify (Layout LayoutType) layout layout')
        (Unify (Device (DeviceType Nat)) device device')
        (Unify (DataType DType) dataType dataType')
        (LinearWithoutBiasF shape shape'))
forall a ca x1 cx1 y cy.
(Castable a ca, Castable x1 cx1, Castable y cy) =&gt;
(ca -&gt; cx1 -&gt; IO cy) -&gt; a -&gt; x1 -&gt; IO y
</span><a href="../../../../libtorch-ffi/html/src"><span class="hs-identifier hs-var">cast2</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Tensor -&gt; ForeignPtr Tensor -&gt; IO (ForeignPtr Tensor)
</span><a href="../../../../libtorch-ffi/html/src"><span class="hs-identifier hs-var">ATen.linear_tt</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor gradient' layout' device' dataType' shape'
</span><a href="#local-6989586621679549707"><span class="hs-identifier hs-var">input</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor gradient layout device dataType shape
</span><a href="#local-6989586621679549708"><span class="hs-identifier hs-var">weight</span></a></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#testLinearWithoutBias"><span class="hs-identifier hs-type">testLinearWithoutBias</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-164"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span>
</span><span id="line-165"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#WithGradient"><span class="hs-identifier hs-type">WithGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier hs-type">Layout</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Dense"><span class="hs-identifier hs-type">Dense</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#UncheckedDevice"><span class="hs-identifier hs-type">UncheckedDevice</span></a></span><span>
</span><span id="line-168"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#Float"><span class="hs-identifier hs-type">Float</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;output&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span id="testLinearWithoutBias"><span class="annot"><span class="annottext">testLinearWithoutBias :: Tensor
  ('Gradient 'WithGradient)
  ('Layout 'Dense)
  'UncheckedDevice
  ('DataType 'Float)
  ('Shape '[ 'Dim ('Name &quot;output&quot;) ('Size 2)])
</span><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#testLinearWithoutBias"><span class="hs-identifier hs-var hs-var">testLinearWithoutBias</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-171"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679549704"><span class="annot"><span class="annottext">weight :: Tensor
  ('Gradient 'WithGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  ('DataType 'Float)
  ('Shape
     '[ 'Dim ('Name &quot;output&quot;) ('Size 2),
        'Dim ('Name &quot;input&quot;) ('Size 1)])
</span><a href="#local-6989586621679549704"><span class="hs-identifier hs-var hs-var">weight</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tensor
  ('Gradient 'WithGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  ('DataType 'Float)
  ('Shape
     '[ 'Dim ('Name &quot;output&quot;) ('Size 2),
        'Dim ('Name &quot;input&quot;) ('Size 1)])
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#WithGradient"><span class="hs-identifier hs-type">WithGradient</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier hs-type">Layout</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Dense"><span class="hs-identifier hs-type">Dense</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#CPU"><span class="hs-identifier hs-type">CPU</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#Float"><span class="hs-identifier hs-type">Float</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;output&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;input&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>      </span><span id="local-6989586621679549702"><span class="annot"><span class="annottext">input :: Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  'UncheckedDevice
  ('DataType 'Float)
  ('Shape '[ 'Dim ('Name &quot;input&quot;) ('Size 1)])
</span><a href="#local-6989586621679549702"><span class="hs-identifier hs-var hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  'UncheckedDevice
  ('DataType 'Float)
  ('Shape '[ 'Dim ('Name &quot;input&quot;) ('Size 1)])
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#WithoutGradient"><span class="hs-identifier hs-type">WithoutGradient</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier hs-type">Layout</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Dense"><span class="hs-identifier hs-type">Dense</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#UncheckedDevice"><span class="hs-identifier hs-type">UncheckedDevice</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#Float"><span class="hs-identifier hs-type">Float</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;input&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Tensor
  ('Gradient 'WithGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  ('DataType 'Float)
  ('Shape
     '[ 'Dim ('Name &quot;output&quot;) ('Size 2),
        'Dim ('Name &quot;input&quot;) ('Size 1)])
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     'UncheckedDevice
     ('DataType 'Float)
     ('Shape '[ 'Dim ('Name &quot;input&quot;) ('Size 1)])
-&gt; Tensor
     ('Gradient 'WithGradient &lt;|&gt; 'Gradient 'WithoutGradient)
     ('Layout 'Dense &lt;+&gt; 'Layout 'Dense)
     ('Device 'CPU &lt;+&gt; 'UncheckedDevice)
     ('DataType 'Float &lt;+&gt; 'DataType 'Float)
     (LinearWithoutBiasF
        ('Shape
           '[ 'Dim ('Name &quot;output&quot;) ('Size 2),
              'Dim ('Name &quot;input&quot;) ('Size 1)])
        ('Shape '[ 'Dim ('Name &quot;input&quot;) ('Size 1)]))
forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (gradient' :: Gradient RequiresGradient)
       (layout' :: Layout LayoutType) (device' :: Device (DeviceType Nat))
       (dataType' :: DataType DType)
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)]).
Tensor gradient layout device dataType shape
-&gt; Tensor gradient' layout' device' dataType' shape'
-&gt; Tensor
     (gradient &lt;|&gt; gradient')
     (layout &lt;+&gt; layout')
     (device &lt;+&gt; device')
     (dataType &lt;+&gt; dataType')
     (LinearWithoutBiasF shape shape')
</span><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#linearWithoutBias"><span class="hs-identifier hs-var">linearWithoutBias</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  ('Gradient 'WithGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  ('DataType 'Float)
  ('Shape
     '[ 'Dim ('Name &quot;output&quot;) ('Size 2),
        'Dim ('Name &quot;input&quot;) ('Size 1)])
</span><a href="#local-6989586621679549704"><span class="hs-identifier hs-var">weight</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  'UncheckedDevice
  ('DataType 'Float)
  ('Shape '[ 'Dim ('Name &quot;input&quot;) ('Size 1)])
</span><a href="#local-6989586621679549702"><span class="hs-identifier hs-var">input</span></a></span><span>
</span><span id="line-174"></span></pre></body></html>