<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE ConstraintKinds #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE OverloadedLists #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE PartialTypeSignatures #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE PolyKinds #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE QuantifiedConstraints #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><span id="line-17"></span><span class="hs-pragma">{-# LANGUAGE StrictData #-}</span><span>
</span><span id="line-18"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-19"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-20"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><span id="line-21"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-22"></span><span class="hs-pragma">{-# LANGUAGE UndecidableSuperClasses #-}</span><span>
</span><span id="line-23"></span><span class="hs-pragma">{-# LANGUAGE NoStarIsType #-}</span><span>
</span><span id="line-24"></span><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-partial-type-signatures #-}</span><span>
</span><span id="line-25"></span><span class="hs-pragma">{-# OPTIONS_GHC -fplugin GHC.TypeLits.Extra.Solver #-}</span><span>
</span><span id="line-26"></span><span class="hs-pragma">{-# OPTIONS_GHC -fplugin GHC.TypeLits.KnownNat.Solver #-}</span><span>
</span><span id="line-27"></span><span class="hs-pragma">{-# OPTIONS_GHC -fplugin GHC.TypeLits.Normalise #-}</span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Torch.Typed.NN.Recurrent.GRU</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Foreign.ForeignPtr</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.TypeLits</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/6hksm2ksx345yyz06ldcqdzl438awbh2-ghc-typelits-extra-lib-ghc-typelits-extra-0.4-haddock-doc/share/doc/ghc-typelits-extra/html/src"><span class="hs-identifier">GHC.TypeLits.Extra</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Environment</span></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.IO.Unsafe</span></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Torch.Autograd.html"><span class="hs-identifier">Torch.Autograd</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">A</span></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Torch.DType.html"><span class="hs-identifier">Torch.DType</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">D</span></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Torch.Device.html"><span class="hs-identifier">Torch.Device</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">D</span></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Torch.Functional.html"><span class="hs-identifier">Torch.Functional</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">D</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.HList.html"><span class="hs-identifier">Torch.HList</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../libtorch-ffi/html/src"><span class="hs-identifier">Torch.Internal.Cast</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ATen</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../libtorch-ffi/html/src"><span class="hs-identifier">Torch.Internal.Class</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ATen</span></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../libtorch-ffi/html/src"><span class="hs-identifier">Torch.Internal.Managed.Type.Tensor</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ATen</span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../libtorch-ffi/html/src"><span class="hs-identifier">Torch.Internal.Type</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ATen</span></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Torch.NN.html"><span class="hs-identifier">Torch.NN</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">A</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Torch.Tensor.html"><span class="hs-identifier">Torch.Tensor</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">D</span></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Torch.TensorFactories.html"><span class="hs-identifier">Torch.TensorFactories</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">D</span></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.Typed.Factories.html"><span class="hs-identifier">Torch.Typed.Factories</span></a></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.Typed.Functional.html"><span class="hs-identifier">Torch.Typed.Functional</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.Functional.html#sqrt"><span class="hs-identifier">sqrt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.Typed.NN.Dropout.html"><span class="hs-identifier">Torch.Typed.NN.Dropout</span></a></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.Typed.NN.Recurrent.Aux.html"><span class="hs-identifier">Torch.Typed.NN.Recurrent.Aux</span></a></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.Typed.Parameter.html"><span class="hs-identifier">Torch.Typed.Parameter</span></a></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.Typed.Tensor.html"><span class="hs-identifier">Torch.Typed.Tensor</span></a></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">tanh</span></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-keyword">data</span><span>
</span><span id="line-59"></span><span>  </span><span id="GRULayerSpec"><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayerSpec"><span class="hs-identifier hs-var">GRULayerSpec</span></a></span></span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807556"><span class="annot"><a href="#local-6989586621679807556"><span class="hs-identifier hs-type">inputSize</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807555"><span class="annot"><a href="#local-6989586621679807555"><span class="hs-identifier hs-type">hiddenSize</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807554"><span class="annot"><a href="#local-6989586621679807554"><span class="hs-identifier hs-type">directionality</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.Typed.Functional.html#RNNDirectionality"><span class="hs-identifier hs-type">RNNDirectionality</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807553"><span class="annot"><a href="#local-6989586621679807553"><span class="hs-identifier hs-type">dtype</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.DType.html#DType"><span class="hs-identifier hs-type">D.DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807552"><span class="annot"><a href="#local-6989586621679807552"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Device.html#DeviceType"><span class="hs-identifier hs-type">D.DeviceType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="GRULayerSpec"><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayerSpec"><span class="hs-identifier hs-var">GRULayerSpec</span></a></span></span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679807273"><span id="local-6989586621679807275"><span id="local-6989586621679807277"><span class="annot"><span class="annottext">Int
-&gt; GRULayerSpec inputSize hiddenSize directionality dtype device
-&gt; ShowS
[GRULayerSpec inputSize hiddenSize directionality dtype device]
-&gt; ShowS
GRULayerSpec inputSize hiddenSize directionality dtype device
-&gt; String
(Int
 -&gt; GRULayerSpec inputSize hiddenSize directionality dtype device
 -&gt; ShowS)
-&gt; (GRULayerSpec inputSize hiddenSize directionality dtype device
    -&gt; String)
-&gt; ([GRULayerSpec inputSize hiddenSize directionality dtype device]
    -&gt; ShowS)
-&gt; Show
     (GRULayerSpec inputSize hiddenSize directionality dtype device)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall (inputSize :: Nat) (hiddenSize :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)).
Int
-&gt; GRULayerSpec inputSize hiddenSize directionality dtype device
-&gt; ShowS
forall (inputSize :: Nat) (hiddenSize :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)).
[GRULayerSpec inputSize hiddenSize directionality dtype device]
-&gt; ShowS
forall (inputSize :: Nat) (hiddenSize :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)).
GRULayerSpec inputSize hiddenSize directionality dtype device
-&gt; String
showList :: [GRULayerSpec inputSize hiddenSize directionality dtype device]
-&gt; ShowS
$cshowList :: forall (inputSize :: Nat) (hiddenSize :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)).
[GRULayerSpec inputSize hiddenSize directionality dtype device]
-&gt; ShowS
show :: GRULayerSpec inputSize hiddenSize directionality dtype device
-&gt; String
$cshow :: forall (inputSize :: Nat) (hiddenSize :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)).
GRULayerSpec inputSize hiddenSize directionality dtype device
-&gt; String
showsPrec :: Int
-&gt; GRULayerSpec inputSize hiddenSize directionality dtype device
-&gt; ShowS
$cshowsPrec :: forall (inputSize :: Nat) (hiddenSize :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)).
Int
-&gt; GRULayerSpec inputSize hiddenSize directionality dtype device
-&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679807268"><span id="local-6989586621679807270"><span class="annot"><span class="annottext">GRULayerSpec inputSize hiddenSize directionality dtype device
-&gt; GRULayerSpec inputSize hiddenSize directionality dtype device
-&gt; Bool
(GRULayerSpec inputSize hiddenSize directionality dtype device
 -&gt; GRULayerSpec inputSize hiddenSize directionality dtype device
 -&gt; Bool)
-&gt; (GRULayerSpec inputSize hiddenSize directionality dtype device
    -&gt; GRULayerSpec inputSize hiddenSize directionality dtype device
    -&gt; Bool)
-&gt; Eq
     (GRULayerSpec inputSize hiddenSize directionality dtype device)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall (inputSize :: Nat) (hiddenSize :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)).
GRULayerSpec inputSize hiddenSize directionality dtype device
-&gt; GRULayerSpec inputSize hiddenSize directionality dtype device
-&gt; Bool
/= :: GRULayerSpec inputSize hiddenSize directionality dtype device
-&gt; GRULayerSpec inputSize hiddenSize directionality dtype device
-&gt; Bool
$c/= :: forall (inputSize :: Nat) (hiddenSize :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)).
GRULayerSpec inputSize hiddenSize directionality dtype device
-&gt; GRULayerSpec inputSize hiddenSize directionality dtype device
-&gt; Bool
== :: GRULayerSpec inputSize hiddenSize directionality dtype device
-&gt; GRULayerSpec inputSize hiddenSize directionality dtype device
-&gt; Bool
$c== :: forall (inputSize :: Nat) (hiddenSize :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)).
GRULayerSpec inputSize hiddenSize directionality dtype device
-&gt; GRULayerSpec inputSize hiddenSize directionality dtype device
-&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-keyword">data</span><span>
</span><span id="line-69"></span><span>  </span><span id="GRULayer"><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayer"><span class="hs-identifier hs-var">GRULayer</span></a></span></span><span>
</span><span id="line-70"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807266"><span class="annot"><a href="#local-6989586621679807266"><span class="hs-identifier hs-type">inputSize</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807265"><span class="annot"><a href="#local-6989586621679807265"><span class="hs-identifier hs-type">hiddenSize</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807264"><span class="annot"><a href="#local-6989586621679807264"><span class="hs-identifier hs-type">directionality</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.Typed.Functional.html#RNNDirectionality"><span class="hs-identifier hs-type">RNNDirectionality</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807263"><span class="annot"><a href="#local-6989586621679807263"><span class="hs-identifier hs-type">dtype</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.DType.html#DType"><span class="hs-identifier hs-type">D.DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807262"><span class="annot"><a href="#local-6989586621679807262"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Device.html#DeviceType"><span class="hs-identifier hs-type">D.DeviceType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-75"></span><span>  </span><span id="local-6989586621679807688"><span id="local-6989586621679807689"><span id="local-6989586621679807690"><span id="local-6989586621679807691"><span id="GRUUnidirectionalLayer"><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUUnidirectionalLayer"><span class="hs-identifier hs-var">GRUUnidirectionalLayer</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-76"></span><span>    </span><span class="annot"><a href="Torch.Typed.Parameter.html#Parameter"><span class="hs-identifier hs-type">Parameter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807691"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807690"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.Functional.html#GRUWIShape"><span class="hs-identifier hs-type">GRUWIShape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807689"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807688"><span class="hs-identifier hs-type">inputSize</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-77"></span><span>    </span><span class="annot"><a href="Torch.Typed.Parameter.html#Parameter"><span class="hs-identifier hs-type">Parameter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807691"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807690"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.Functional.html#GRUWHShape"><span class="hs-identifier hs-type">GRUWHShape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807689"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807688"><span class="hs-identifier hs-type">inputSize</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-78"></span><span>    </span><span class="annot"><a href="Torch.Typed.Parameter.html#Parameter"><span class="hs-identifier hs-type">Parameter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807691"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807690"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.Functional.html#GRUBIShape"><span class="hs-identifier hs-type">GRUBIShape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807689"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807688"><span class="hs-identifier hs-type">inputSize</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-79"></span><span>    </span><span class="annot"><a href="Torch.Typed.Parameter.html#Parameter"><span class="hs-identifier hs-type">Parameter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807691"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807690"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.Functional.html#GRUBHShape"><span class="hs-identifier hs-type">GRUBHShape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807689"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807688"><span class="hs-identifier hs-type">inputSize</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-80"></span><span>    </span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayer"><span class="hs-identifier hs-type">GRULayer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807688"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807689"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.Typed.Functional.html#Unidirectional"><span class="hs-identifier hs-type">Unidirectional</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807690"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807691"><span class="hs-identifier hs-type">device</span></a></span></span></span></span></span><span>
</span><span id="line-81"></span><span>  </span><span id="local-6989586621679807672"><span id="local-6989586621679807673"><span id="local-6989586621679807674"><span id="local-6989586621679807675"><span id="GRUBidirectionalLayer"><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUBidirectionalLayer"><span class="hs-identifier hs-var">GRUBidirectionalLayer</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-82"></span><span>    </span><span class="annot"><a href="Torch.Typed.Parameter.html#Parameter"><span class="hs-identifier hs-type">Parameter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807675"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807674"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.Functional.html#GRUWIShape"><span class="hs-identifier hs-type">GRUWIShape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807673"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807672"><span class="hs-identifier hs-type">inputSize</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-83"></span><span>    </span><span class="annot"><a href="Torch.Typed.Parameter.html#Parameter"><span class="hs-identifier hs-type">Parameter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807675"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807674"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.Functional.html#GRUWHShape"><span class="hs-identifier hs-type">GRUWHShape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807673"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807672"><span class="hs-identifier hs-type">inputSize</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-84"></span><span>    </span><span class="annot"><a href="Torch.Typed.Parameter.html#Parameter"><span class="hs-identifier hs-type">Parameter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807675"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807674"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.Functional.html#GRUBIShape"><span class="hs-identifier hs-type">GRUBIShape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807673"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807672"><span class="hs-identifier hs-type">inputSize</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-85"></span><span>    </span><span class="annot"><a href="Torch.Typed.Parameter.html#Parameter"><span class="hs-identifier hs-type">Parameter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807675"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807674"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.Functional.html#GRUBHShape"><span class="hs-identifier hs-type">GRUBHShape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807673"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807672"><span class="hs-identifier hs-type">inputSize</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-86"></span><span>    </span><span class="annot"><a href="Torch.Typed.Parameter.html#Parameter"><span class="hs-identifier hs-type">Parameter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807675"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807674"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.Functional.html#GRUWIShape"><span class="hs-identifier hs-type">GRUWIShape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807673"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807672"><span class="hs-identifier hs-type">inputSize</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-87"></span><span>    </span><span class="annot"><a href="Torch.Typed.Parameter.html#Parameter"><span class="hs-identifier hs-type">Parameter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807675"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807674"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.Functional.html#GRUWHShape"><span class="hs-identifier hs-type">GRUWHShape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807673"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807672"><span class="hs-identifier hs-type">inputSize</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-88"></span><span>    </span><span class="annot"><a href="Torch.Typed.Parameter.html#Parameter"><span class="hs-identifier hs-type">Parameter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807675"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807674"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.Functional.html#GRUBIShape"><span class="hs-identifier hs-type">GRUBIShape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807673"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807672"><span class="hs-identifier hs-type">inputSize</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-89"></span><span>    </span><span class="annot"><a href="Torch.Typed.Parameter.html#Parameter"><span class="hs-identifier hs-type">Parameter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807675"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807674"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.Functional.html#GRUBHShape"><span class="hs-identifier hs-type">GRUBHShape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807673"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807672"><span class="hs-identifier hs-type">inputSize</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-90"></span><span>    </span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayer"><span class="hs-identifier hs-type">GRULayer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807672"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807673"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.Typed.Functional.html#Bidirectional"><span class="hs-identifier hs-type">Bidirectional</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807674"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807675"><span class="hs-identifier hs-type">device</span></a></span></span></span></span></span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span id="local-6989586621679807248"><span id="local-6989586621679807250"><span id="local-6989586621679807252"><span id="local-6989586621679807254"><span id="local-6989586621679807255"><span id="local-6989586621679807256"><span id="local-6989586621679807257"><span id="local-6989586621679807258"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayer"><span class="hs-identifier hs-type">GRULayer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807258"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807257"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807256"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807255"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807254"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span class="hs-comment">-- deriving instance Generic (GRULayer inputSize hiddenSize directionality dtype device)</span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span id="local-6989586621679807239"><span id="local-6989586621679807240"><span id="local-6989586621679807241"><span id="local-6989586621679807242"><span id="local-6989586621679807243"><span id="local-6989586621679807244"><span id="local-6989586621679807245"><span id="local-6989586621679807246"><span id="local-6989586621679807247"><span class="hs-keyword">instance</span><span>
</span><span id="line-97"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="#local-6989586621679807247"><span class="hs-identifier hs-type">wiShape</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.Functional.html#GRUWIShape"><span class="hs-identifier hs-type">GRUWIShape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807246"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807245"><span class="hs-identifier hs-type">inputSize</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-98"></span><span>    </span><span class="annot"><a href="#local-6989586621679807244"><span class="hs-identifier hs-type">whShape</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.Functional.html#GRUWHShape"><span class="hs-identifier hs-type">GRUWHShape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807246"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807245"><span class="hs-identifier hs-type">inputSize</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-99"></span><span>    </span><span class="annot"><a href="#local-6989586621679807243"><span class="hs-identifier hs-type">biShape</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.Functional.html#GRUBIShape"><span class="hs-identifier hs-type">GRUBIShape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807246"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807245"><span class="hs-identifier hs-type">inputSize</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-100"></span><span>    </span><span class="annot"><a href="#local-6989586621679807242"><span class="hs-identifier hs-type">bhShape</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.Functional.html#GRUBHShape"><span class="hs-identifier hs-type">GRUBHShape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807246"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807245"><span class="hs-identifier hs-type">inputSize</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-101"></span><span>    </span><span class="annot"><a href="#local-6989586621679807241"><span class="hs-identifier hs-type">parameters</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="Torch.Typed.Parameter.html#Parameter"><span class="hs-identifier hs-type">Parameter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807240"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807239"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807247"><span class="hs-identifier hs-type">wiShape</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.Typed.Parameter.html#Parameter"><span class="hs-identifier hs-type">Parameter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807240"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807239"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807244"><span class="hs-identifier hs-type">whShape</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.Typed.Parameter.html#Parameter"><span class="hs-identifier hs-type">Parameter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807240"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807239"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807243"><span class="hs-identifier hs-type">biShape</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.Typed.Parameter.html#Parameter"><span class="hs-identifier hs-type">Parameter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807240"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807239"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807242"><span class="hs-identifier hs-type">bhShape</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-103"></span><span>  </span><span class="annot"><a href="Torch.Typed.Parameter.html#GParameterized"><span class="hs-identifier hs-type">GParameterized</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K1</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">R</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayer"><span class="hs-identifier hs-type">GRULayer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807245"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807246"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.Typed.Functional.html#Unidirectional"><span class="hs-identifier hs-type">Unidirectional</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807239"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807240"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679807241"><span class="hs-identifier hs-type">parameters</span></a></span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-105"></span><span>  </span><span id="local-6989586621679807235"><span class="annot"><span class="annottext">gFlattenParameters :: K1 R (GRULayer inputSize hiddenSize 'Unidirectional dtype device) a
-&gt; HList parameters
</span><a href="Torch.Typed.Parameter.html#gFlattenParameters"><span class="hs-identifier hs-var hs-var hs-var hs-var">gFlattenParameters</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUUnidirectionalLayer"><span class="hs-identifier hs-type">GRUUnidirectionalLayer</span></a></span><span> </span><span id="local-6989586621679807232"><span class="annot"><span class="annottext">wi :: Parameter device dtype (GRUWIShape hiddenSize inputSize)
</span><a href="#local-6989586621679807232"><span class="hs-identifier hs-var">wi</span></a></span></span><span> </span><span id="local-6989586621679807231"><span class="annot"><span class="annottext">wh :: Parameter device dtype (GRUWHShape hiddenSize inputSize)
</span><a href="#local-6989586621679807231"><span class="hs-identifier hs-var">wh</span></a></span></span><span> </span><span id="local-6989586621679807230"><span class="annot"><span class="annottext">bi :: Parameter device dtype (GRUBIShape hiddenSize inputSize)
</span><a href="#local-6989586621679807230"><span class="hs-identifier hs-var">bi</span></a></span></span><span> </span><span id="local-6989586621679807229"><span class="annot"><span class="annottext">bh :: Parameter device dtype (GRUBIShape hiddenSize inputSize)
</span><a href="#local-6989586621679807229"><span class="hs-identifier hs-var">bh</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-106"></span><span>    </span><span class="annot"><span class="annottext">Parameter device dtype (GRUWIShape hiddenSize inputSize)
</span><a href="#local-6989586621679807232"><span class="hs-identifier hs-var">wi</span></a></span><span> </span><span class="annot"><span class="annottext">Parameter device dtype (GRUWIShape hiddenSize inputSize)
-&gt; HList
     '[Parameter device dtype (GRUWHShape hiddenSize inputSize),
       Parameter device dtype (GRUBIShape hiddenSize inputSize),
       Parameter device dtype (GRUBIShape hiddenSize inputSize)]
-&gt; HList
     '[Parameter device dtype (GRUWIShape hiddenSize inputSize),
       Parameter device dtype (GRUWHShape hiddenSize inputSize),
       Parameter device dtype (GRUBIShape hiddenSize inputSize),
       Parameter device dtype (GRUBIShape hiddenSize inputSize)]
forall x (xs :: [Type]). x -&gt; HList xs -&gt; HList (x : xs)
</span><a href="Torch.HList.html#%3A."><span class="hs-operator hs-var">:.</span></a></span><span> </span><span class="annot"><span class="annottext">Parameter device dtype (GRUWHShape hiddenSize inputSize)
</span><a href="#local-6989586621679807231"><span class="hs-identifier hs-var">wh</span></a></span><span> </span><span class="annot"><span class="annottext">Parameter device dtype (GRUWHShape hiddenSize inputSize)
-&gt; HList
     '[Parameter device dtype (GRUBIShape hiddenSize inputSize),
       Parameter device dtype (GRUBIShape hiddenSize inputSize)]
-&gt; HList
     '[Parameter device dtype (GRUWHShape hiddenSize inputSize),
       Parameter device dtype (GRUBIShape hiddenSize inputSize),
       Parameter device dtype (GRUBIShape hiddenSize inputSize)]
forall x (xs :: [Type]). x -&gt; HList xs -&gt; HList (x : xs)
</span><a href="Torch.HList.html#%3A."><span class="hs-operator hs-var">:.</span></a></span><span> </span><span class="annot"><span class="annottext">Parameter device dtype (GRUBIShape hiddenSize inputSize)
</span><a href="#local-6989586621679807230"><span class="hs-identifier hs-var">bi</span></a></span><span> </span><span class="annot"><span class="annottext">Parameter device dtype (GRUBIShape hiddenSize inputSize)
-&gt; HList
     '[Parameter device dtype (GRUBIShape hiddenSize inputSize)]
-&gt; HList
     '[Parameter device dtype (GRUBIShape hiddenSize inputSize),
       Parameter device dtype (GRUBIShape hiddenSize inputSize)]
forall x (xs :: [Type]). x -&gt; HList xs -&gt; HList (x : xs)
</span><a href="Torch.HList.html#%3A."><span class="hs-operator hs-var">:.</span></a></span><span> </span><span class="annot"><span class="annottext">Parameter device dtype (GRUBIShape hiddenSize inputSize)
</span><a href="#local-6989586621679807229"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Parameter device dtype (GRUBIShape hiddenSize inputSize)
-&gt; HList '[]
-&gt; HList
     '[Parameter device dtype (GRUBIShape hiddenSize inputSize)]
forall x (xs :: [Type]). x -&gt; HList xs -&gt; HList (x : xs)
</span><a href="Torch.HList.html#%3A."><span class="hs-operator hs-var">:.</span></a></span><span> </span><span class="annot"><span class="annottext">HList '[]
forall k. HList '[]
</span><a href="Torch.HList.html#HNil"><span class="hs-identifier hs-var">HNil</span></a></span><span>
</span><span id="line-107"></span><span>  </span><span id="local-6989586621679807226"><span class="annot"><span class="annottext">gReplaceParameters :: K1 R (GRULayer inputSize hiddenSize 'Unidirectional dtype device) a
-&gt; HList parameters
-&gt; K1
     R (GRULayer inputSize hiddenSize 'Unidirectional dtype device) a
</span><a href="Torch.Typed.Parameter.html#gReplaceParameters"><span class="hs-identifier hs-var hs-var hs-var hs-var">gReplaceParameters</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679807224"><span class="annot"><a href="#local-6989586621679807224"><span class="hs-identifier hs-var">wi</span></a></span></span><span> </span><span class="annot"><a href="Torch.HList.html#%3A."><span class="hs-operator hs-type">:.</span></a></span><span> </span><span id="local-6989586621679807223"><span class="annot"><a href="#local-6989586621679807223"><span class="hs-identifier hs-var">wh</span></a></span></span><span> </span><span class="annot"><a href="Torch.HList.html#%3A."><span class="hs-operator hs-type">:.</span></a></span><span> </span><span id="local-6989586621679807222"><span class="annot"><a href="#local-6989586621679807222"><span class="hs-identifier hs-var">bi</span></a></span></span><span> </span><span class="annot"><a href="Torch.HList.html#%3A."><span class="hs-operator hs-type">:.</span></a></span><span> </span><span id="local-6989586621679807221"><span class="annot"><a href="#local-6989586621679807221"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="annot"><a href="Torch.HList.html#%3A."><span class="hs-operator hs-type">:.</span></a></span><span> </span><span class="annot"><a href="Torch.HList.html#HNil"><span class="hs-identifier hs-type">HNil</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-108"></span><span>    </span><span class="annot"><span class="annottext">GRULayer inputSize hiddenSize 'Unidirectional dtype device
-&gt; K1
     R (GRULayer inputSize hiddenSize 'Unidirectional dtype device) a
forall k i c (p :: k). c -&gt; K1 i c p
</span><span class="hs-identifier hs-var">K1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parameter device dtype (GRUWIShape hiddenSize inputSize)
-&gt; Parameter device dtype (GRUWHShape hiddenSize inputSize)
-&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
-&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
-&gt; GRULayer inputSize hiddenSize 'Unidirectional dtype device
forall (device :: (DeviceType, Nat)) (dtype :: DType)
       (hiddenSize :: Nat) (inputSize :: Nat).
Parameter device dtype (GRUWIShape hiddenSize inputSize)
-&gt; Parameter device dtype (GRUWHShape hiddenSize inputSize)
-&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
-&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
-&gt; GRULayer inputSize hiddenSize 'Unidirectional dtype device
</span><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUUnidirectionalLayer"><span class="hs-identifier hs-var">GRUUnidirectionalLayer</span></a></span><span> </span><span class="annot"><span class="annottext">Parameter device dtype (GRUWIShape hiddenSize inputSize)
</span><a href="#local-6989586621679807224"><span class="hs-identifier hs-var">wi</span></a></span><span> </span><span class="annot"><span class="annottext">Parameter device dtype (GRUWHShape hiddenSize inputSize)
</span><a href="#local-6989586621679807223"><span class="hs-identifier hs-var">wh</span></a></span><span> </span><span class="annot"><span class="annottext">Parameter device dtype (GRUBIShape hiddenSize inputSize)
</span><a href="#local-6989586621679807222"><span class="hs-identifier hs-var">bi</span></a></span><span> </span><span class="annot"><span class="annottext">Parameter device dtype (GRUBIShape hiddenSize inputSize)
</span><a href="#local-6989586621679807221"><span class="hs-identifier hs-var">bh</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span id="local-6989586621679807212"><span id="local-6989586621679807213"><span id="local-6989586621679807214"><span id="local-6989586621679807215"><span id="local-6989586621679807216"><span id="local-6989586621679807217"><span id="local-6989586621679807218"><span id="local-6989586621679807219"><span id="local-6989586621679807220"><span class="hs-keyword">instance</span><span>
</span><span id="line-111"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="#local-6989586621679807220"><span class="hs-identifier hs-type">wiShape</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.Functional.html#GRUWIShape"><span class="hs-identifier hs-type">GRUWIShape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807219"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807218"><span class="hs-identifier hs-type">inputSize</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-112"></span><span>    </span><span class="annot"><a href="#local-6989586621679807217"><span class="hs-identifier hs-type">whShape</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.Functional.html#GRUWHShape"><span class="hs-identifier hs-type">GRUWHShape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807219"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807218"><span class="hs-identifier hs-type">inputSize</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-113"></span><span>    </span><span class="annot"><a href="#local-6989586621679807216"><span class="hs-identifier hs-type">biShape</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.Functional.html#GRUBIShape"><span class="hs-identifier hs-type">GRUBIShape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807219"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807218"><span class="hs-identifier hs-type">inputSize</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-114"></span><span>    </span><span class="annot"><a href="#local-6989586621679807215"><span class="hs-identifier hs-type">bhShape</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.Functional.html#GRUBHShape"><span class="hs-identifier hs-type">GRUBHShape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807219"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807218"><span class="hs-identifier hs-type">inputSize</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-115"></span><span>    </span><span class="annot"><a href="#local-6989586621679807214"><span class="hs-identifier hs-type">parameters</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="Torch.Typed.Parameter.html#Parameter"><span class="hs-identifier hs-type">Parameter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807213"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807212"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807220"><span class="hs-identifier hs-type">wiShape</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.Typed.Parameter.html#Parameter"><span class="hs-identifier hs-type">Parameter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807213"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807212"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807217"><span class="hs-identifier hs-type">whShape</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.Typed.Parameter.html#Parameter"><span class="hs-identifier hs-type">Parameter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807213"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807212"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807216"><span class="hs-identifier hs-type">biShape</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.Typed.Parameter.html#Parameter"><span class="hs-identifier hs-type">Parameter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807213"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807212"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807215"><span class="hs-identifier hs-type">bhShape</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.Typed.Parameter.html#Parameter"><span class="hs-identifier hs-type">Parameter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807213"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807212"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807220"><span class="hs-identifier hs-type">wiShape</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.Typed.Parameter.html#Parameter"><span class="hs-identifier hs-type">Parameter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807213"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807212"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807217"><span class="hs-identifier hs-type">whShape</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.Typed.Parameter.html#Parameter"><span class="hs-identifier hs-type">Parameter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807213"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807212"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807216"><span class="hs-identifier hs-type">biShape</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.Typed.Parameter.html#Parameter"><span class="hs-identifier hs-type">Parameter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807213"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807212"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807215"><span class="hs-identifier hs-type">bhShape</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-116"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-117"></span><span>  </span><span class="annot"><a href="Torch.Typed.Parameter.html#GParameterized"><span class="hs-identifier hs-type">GParameterized</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K1</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">R</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayer"><span class="hs-identifier hs-type">GRULayer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807218"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807219"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.Typed.Functional.html#Bidirectional"><span class="hs-identifier hs-type">Bidirectional</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807212"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807213"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679807214"><span class="hs-identifier hs-type">parameters</span></a></span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-119"></span><span>  </span><span id="local-6989586621679807209"><span class="annot"><span class="annottext">gFlattenParameters :: K1 R (GRULayer inputSize hiddenSize 'Bidirectional dtype device) a
-&gt; HList parameters
</span><a href="#local-6989586621679807209"><span class="hs-identifier hs-var hs-var hs-var hs-var">gFlattenParameters</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUBidirectionalLayer"><span class="hs-identifier hs-type">GRUBidirectionalLayer</span></a></span><span> </span><span id="local-6989586621679807208"><span class="annot"><span class="annottext">wi :: Parameter device dtype (GRUWIShape hiddenSize inputSize)
</span><a href="#local-6989586621679807208"><span class="hs-identifier hs-var">wi</span></a></span></span><span> </span><span id="local-6989586621679807207"><span class="annot"><span class="annottext">wh :: Parameter device dtype (GRUWHShape hiddenSize inputSize)
</span><a href="#local-6989586621679807207"><span class="hs-identifier hs-var">wh</span></a></span></span><span> </span><span id="local-6989586621679807206"><span class="annot"><span class="annottext">bi :: Parameter device dtype (GRUBIShape hiddenSize inputSize)
</span><a href="#local-6989586621679807206"><span class="hs-identifier hs-var">bi</span></a></span></span><span> </span><span id="local-6989586621679807205"><span class="annot"><span class="annottext">bh :: Parameter device dtype (GRUBIShape hiddenSize inputSize)
</span><a href="#local-6989586621679807205"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span id="local-6989586621679807204"><span class="annot"><span class="annottext">wi' :: Parameter device dtype (GRUWIShape hiddenSize inputSize)
</span><a href="#local-6989586621679807204"><span class="hs-identifier hs-var">wi'</span></a></span></span><span> </span><span id="local-6989586621679807203"><span class="annot"><span class="annottext">wh' :: Parameter device dtype (GRUWHShape hiddenSize inputSize)
</span><a href="#local-6989586621679807203"><span class="hs-identifier hs-var">wh'</span></a></span></span><span> </span><span id="local-6989586621679807202"><span class="annot"><span class="annottext">bi' :: Parameter device dtype (GRUBIShape hiddenSize inputSize)
</span><a href="#local-6989586621679807202"><span class="hs-identifier hs-var">bi'</span></a></span></span><span> </span><span id="local-6989586621679807201"><span class="annot"><span class="annottext">bh' :: Parameter device dtype (GRUBIShape hiddenSize inputSize)
</span><a href="#local-6989586621679807201"><span class="hs-identifier hs-var">bh'</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-120"></span><span>    </span><span class="annot"><span class="annottext">Parameter device dtype (GRUWIShape hiddenSize inputSize)
</span><a href="#local-6989586621679807208"><span class="hs-identifier hs-var">wi</span></a></span><span> </span><span class="annot"><span class="annottext">Parameter device dtype (GRUWIShape hiddenSize inputSize)
-&gt; HList
     '[Parameter device dtype (GRUWHShape hiddenSize inputSize),
       Parameter device dtype (GRUBIShape hiddenSize inputSize),
       Parameter device dtype (GRUBIShape hiddenSize inputSize),
       Parameter device dtype (GRUWIShape hiddenSize inputSize),
       Parameter device dtype (GRUWHShape hiddenSize inputSize),
       Parameter device dtype (GRUBIShape hiddenSize inputSize),
       Parameter device dtype (GRUBIShape hiddenSize inputSize)]
-&gt; HList
     '[Parameter device dtype (GRUWIShape hiddenSize inputSize),
       Parameter device dtype (GRUWHShape hiddenSize inputSize),
       Parameter device dtype (GRUBIShape hiddenSize inputSize),
       Parameter device dtype (GRUBIShape hiddenSize inputSize),
       Parameter device dtype (GRUWIShape hiddenSize inputSize),
       Parameter device dtype (GRUWHShape hiddenSize inputSize),
       Parameter device dtype (GRUBIShape hiddenSize inputSize),
       Parameter device dtype (GRUBIShape hiddenSize inputSize)]
forall x (xs :: [Type]). x -&gt; HList xs -&gt; HList (x : xs)
</span><a href="Torch.HList.html#%3A."><span class="hs-operator hs-var">:.</span></a></span><span> </span><span class="annot"><span class="annottext">Parameter device dtype (GRUWHShape hiddenSize inputSize)
</span><a href="#local-6989586621679807207"><span class="hs-identifier hs-var">wh</span></a></span><span> </span><span class="annot"><span class="annottext">Parameter device dtype (GRUWHShape hiddenSize inputSize)
-&gt; HList
     '[Parameter device dtype (GRUBIShape hiddenSize inputSize),
       Parameter device dtype (GRUBIShape hiddenSize inputSize),
       Parameter device dtype (GRUWIShape hiddenSize inputSize),
       Parameter device dtype (GRUWHShape hiddenSize inputSize),
       Parameter device dtype (GRUBIShape hiddenSize inputSize),
       Parameter device dtype (GRUBIShape hiddenSize inputSize)]
-&gt; HList
     '[Parameter device dtype (GRUWHShape hiddenSize inputSize),
       Parameter device dtype (GRUBIShape hiddenSize inputSize),
       Parameter device dtype (GRUBIShape hiddenSize inputSize),
       Parameter device dtype (GRUWIShape hiddenSize inputSize),
       Parameter device dtype (GRUWHShape hiddenSize inputSize),
       Parameter device dtype (GRUBIShape hiddenSize inputSize),
       Parameter device dtype (GRUBIShape hiddenSize inputSize)]
forall x (xs :: [Type]). x -&gt; HList xs -&gt; HList (x : xs)
</span><a href="Torch.HList.html#%3A."><span class="hs-operator hs-var">:.</span></a></span><span> </span><span class="annot"><span class="annottext">Parameter device dtype (GRUBIShape hiddenSize inputSize)
</span><a href="#local-6989586621679807206"><span class="hs-identifier hs-var">bi</span></a></span><span> </span><span class="annot"><span class="annottext">Parameter device dtype (GRUBIShape hiddenSize inputSize)
-&gt; HList
     '[Parameter device dtype (GRUBIShape hiddenSize inputSize),
       Parameter device dtype (GRUWIShape hiddenSize inputSize),
       Parameter device dtype (GRUWHShape hiddenSize inputSize),
       Parameter device dtype (GRUBIShape hiddenSize inputSize),
       Parameter device dtype (GRUBIShape hiddenSize inputSize)]
-&gt; HList
     '[Parameter device dtype (GRUBIShape hiddenSize inputSize),
       Parameter device dtype (GRUBIShape hiddenSize inputSize),
       Parameter device dtype (GRUWIShape hiddenSize inputSize),
       Parameter device dtype (GRUWHShape hiddenSize inputSize),
       Parameter device dtype (GRUBIShape hiddenSize inputSize),
       Parameter device dtype (GRUBIShape hiddenSize inputSize)]
forall x (xs :: [Type]). x -&gt; HList xs -&gt; HList (x : xs)
</span><a href="Torch.HList.html#%3A."><span class="hs-operator hs-var">:.</span></a></span><span> </span><span class="annot"><span class="annottext">Parameter device dtype (GRUBIShape hiddenSize inputSize)
</span><a href="#local-6989586621679807205"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Parameter device dtype (GRUBIShape hiddenSize inputSize)
-&gt; HList
     '[Parameter device dtype (GRUWIShape hiddenSize inputSize),
       Parameter device dtype (GRUWHShape hiddenSize inputSize),
       Parameter device dtype (GRUBIShape hiddenSize inputSize),
       Parameter device dtype (GRUBIShape hiddenSize inputSize)]
-&gt; HList
     '[Parameter device dtype (GRUBIShape hiddenSize inputSize),
       Parameter device dtype (GRUWIShape hiddenSize inputSize),
       Parameter device dtype (GRUWHShape hiddenSize inputSize),
       Parameter device dtype (GRUBIShape hiddenSize inputSize),
       Parameter device dtype (GRUBIShape hiddenSize inputSize)]
forall x (xs :: [Type]). x -&gt; HList xs -&gt; HList (x : xs)
</span><a href="Torch.HList.html#%3A."><span class="hs-operator hs-var">:.</span></a></span><span> </span><span class="annot"><span class="annottext">Parameter device dtype (GRUWIShape hiddenSize inputSize)
</span><a href="#local-6989586621679807204"><span class="hs-identifier hs-var">wi'</span></a></span><span> </span><span class="annot"><span class="annottext">Parameter device dtype (GRUWIShape hiddenSize inputSize)
-&gt; HList
     '[Parameter device dtype (GRUWHShape hiddenSize inputSize),
       Parameter device dtype (GRUBIShape hiddenSize inputSize),
       Parameter device dtype (GRUBIShape hiddenSize inputSize)]
-&gt; HList
     '[Parameter device dtype (GRUWIShape hiddenSize inputSize),
       Parameter device dtype (GRUWHShape hiddenSize inputSize),
       Parameter device dtype (GRUBIShape hiddenSize inputSize),
       Parameter device dtype (GRUBIShape hiddenSize inputSize)]
forall x (xs :: [Type]). x -&gt; HList xs -&gt; HList (x : xs)
</span><a href="Torch.HList.html#%3A."><span class="hs-operator hs-var">:.</span></a></span><span> </span><span class="annot"><span class="annottext">Parameter device dtype (GRUWHShape hiddenSize inputSize)
</span><a href="#local-6989586621679807203"><span class="hs-identifier hs-var">wh'</span></a></span><span> </span><span class="annot"><span class="annottext">Parameter device dtype (GRUWHShape hiddenSize inputSize)
-&gt; HList
     '[Parameter device dtype (GRUBIShape hiddenSize inputSize),
       Parameter device dtype (GRUBIShape hiddenSize inputSize)]
-&gt; HList
     '[Parameter device dtype (GRUWHShape hiddenSize inputSize),
       Parameter device dtype (GRUBIShape hiddenSize inputSize),
       Parameter device dtype (GRUBIShape hiddenSize inputSize)]
forall x (xs :: [Type]). x -&gt; HList xs -&gt; HList (x : xs)
</span><a href="Torch.HList.html#%3A."><span class="hs-operator hs-var">:.</span></a></span><span> </span><span class="annot"><span class="annottext">Parameter device dtype (GRUBIShape hiddenSize inputSize)
</span><a href="#local-6989586621679807202"><span class="hs-identifier hs-var">bi'</span></a></span><span> </span><span class="annot"><span class="annottext">Parameter device dtype (GRUBIShape hiddenSize inputSize)
-&gt; HList
     '[Parameter device dtype (GRUBIShape hiddenSize inputSize)]
-&gt; HList
     '[Parameter device dtype (GRUBIShape hiddenSize inputSize),
       Parameter device dtype (GRUBIShape hiddenSize inputSize)]
forall x (xs :: [Type]). x -&gt; HList xs -&gt; HList (x : xs)
</span><a href="Torch.HList.html#%3A."><span class="hs-operator hs-var">:.</span></a></span><span> </span><span class="annot"><span class="annottext">Parameter device dtype (GRUBIShape hiddenSize inputSize)
</span><a href="#local-6989586621679807201"><span class="hs-identifier hs-var">bh'</span></a></span><span> </span><span class="annot"><span class="annottext">Parameter device dtype (GRUBIShape hiddenSize inputSize)
-&gt; HList '[]
-&gt; HList
     '[Parameter device dtype (GRUBIShape hiddenSize inputSize)]
forall x (xs :: [Type]). x -&gt; HList xs -&gt; HList (x : xs)
</span><a href="Torch.HList.html#%3A."><span class="hs-operator hs-var">:.</span></a></span><span> </span><span class="annot"><span class="annottext">HList '[]
forall k. HList '[]
</span><a href="Torch.HList.html#HNil"><span class="hs-identifier hs-var">HNil</span></a></span><span>
</span><span id="line-121"></span><span>  </span><span id="local-6989586621679807200"><span class="annot"><span class="annottext">gReplaceParameters :: K1 R (GRULayer inputSize hiddenSize 'Bidirectional dtype device) a
-&gt; HList parameters
-&gt; K1
     R (GRULayer inputSize hiddenSize 'Bidirectional dtype device) a
</span><a href="#local-6989586621679807200"><span class="hs-identifier hs-var hs-var hs-var hs-var">gReplaceParameters</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679807199"><span class="annot"><a href="#local-6989586621679807199"><span class="hs-identifier hs-var">wi</span></a></span></span><span> </span><span class="annot"><a href="Torch.HList.html#%3A."><span class="hs-operator hs-type">:.</span></a></span><span> </span><span id="local-6989586621679807198"><span class="annot"><a href="#local-6989586621679807198"><span class="hs-identifier hs-var">wh</span></a></span></span><span> </span><span class="annot"><a href="Torch.HList.html#%3A."><span class="hs-operator hs-type">:.</span></a></span><span> </span><span id="local-6989586621679807197"><span class="annot"><a href="#local-6989586621679807197"><span class="hs-identifier hs-var">bi</span></a></span></span><span> </span><span class="annot"><a href="Torch.HList.html#%3A."><span class="hs-operator hs-type">:.</span></a></span><span> </span><span id="local-6989586621679807196"><span class="annot"><a href="#local-6989586621679807196"><span class="hs-identifier hs-var">bh</span></a></span></span><span> </span><span class="annot"><a href="Torch.HList.html#%3A."><span class="hs-operator hs-type">:.</span></a></span><span> </span><span id="local-6989586621679807195"><span class="annot"><a href="#local-6989586621679807195"><span class="hs-identifier hs-var">wi'</span></a></span></span><span> </span><span class="annot"><a href="Torch.HList.html#%3A."><span class="hs-operator hs-type">:.</span></a></span><span> </span><span id="local-6989586621679807194"><span class="annot"><a href="#local-6989586621679807194"><span class="hs-identifier hs-var">wh'</span></a></span></span><span> </span><span class="annot"><a href="Torch.HList.html#%3A."><span class="hs-operator hs-type">:.</span></a></span><span> </span><span id="local-6989586621679807193"><span class="annot"><a href="#local-6989586621679807193"><span class="hs-identifier hs-var">bi'</span></a></span></span><span> </span><span class="annot"><a href="Torch.HList.html#%3A."><span class="hs-operator hs-type">:.</span></a></span><span> </span><span id="local-6989586621679807192"><span class="annot"><a href="#local-6989586621679807192"><span class="hs-identifier hs-var">bh'</span></a></span></span><span> </span><span class="annot"><a href="Torch.HList.html#%3A."><span class="hs-operator hs-type">:.</span></a></span><span> </span><span class="annot"><a href="Torch.HList.html#HNil"><span class="hs-identifier hs-type">HNil</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-122"></span><span>    </span><span class="annot"><span class="annottext">GRULayer inputSize hiddenSize 'Bidirectional dtype device
-&gt; K1
     R (GRULayer inputSize hiddenSize 'Bidirectional dtype device) a
forall k i c (p :: k). c -&gt; K1 i c p
</span><span class="hs-identifier hs-var">K1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parameter device dtype (GRUWIShape hiddenSize inputSize)
-&gt; Parameter device dtype (GRUWHShape hiddenSize inputSize)
-&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
-&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
-&gt; Parameter device dtype (GRUWIShape hiddenSize inputSize)
-&gt; Parameter device dtype (GRUWHShape hiddenSize inputSize)
-&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
-&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
-&gt; GRULayer inputSize hiddenSize 'Bidirectional dtype device
forall (device :: (DeviceType, Nat)) (dtype :: DType)
       (hiddenSize :: Nat) (inputSize :: Nat).
Parameter device dtype (GRUWIShape hiddenSize inputSize)
-&gt; Parameter device dtype (GRUWHShape hiddenSize inputSize)
-&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
-&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
-&gt; Parameter device dtype (GRUWIShape hiddenSize inputSize)
-&gt; Parameter device dtype (GRUWHShape hiddenSize inputSize)
-&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
-&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
-&gt; GRULayer inputSize hiddenSize 'Bidirectional dtype device
</span><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUBidirectionalLayer"><span class="hs-identifier hs-var">GRUBidirectionalLayer</span></a></span><span> </span><span class="annot"><span class="annottext">Parameter device dtype (GRUWIShape hiddenSize inputSize)
</span><a href="#local-6989586621679807199"><span class="hs-identifier hs-var">wi</span></a></span><span> </span><span class="annot"><span class="annottext">Parameter device dtype (GRUWHShape hiddenSize inputSize)
</span><a href="#local-6989586621679807198"><span class="hs-identifier hs-var">wh</span></a></span><span> </span><span class="annot"><span class="annottext">Parameter device dtype (GRUBIShape hiddenSize inputSize)
</span><a href="#local-6989586621679807197"><span class="hs-identifier hs-var">bi</span></a></span><span> </span><span class="annot"><span class="annottext">Parameter device dtype (GRUBIShape hiddenSize inputSize)
</span><a href="#local-6989586621679807196"><span class="hs-identifier hs-var">bh</span></a></span><span> </span><span class="annot"><span class="annottext">Parameter device dtype (GRUWIShape hiddenSize inputSize)
</span><a href="#local-6989586621679807195"><span class="hs-identifier hs-var">wi'</span></a></span><span> </span><span class="annot"><span class="annottext">Parameter device dtype (GRUWHShape hiddenSize inputSize)
</span><a href="#local-6989586621679807194"><span class="hs-identifier hs-var">wh'</span></a></span><span> </span><span class="annot"><span class="annottext">Parameter device dtype (GRUBIShape hiddenSize inputSize)
</span><a href="#local-6989586621679807193"><span class="hs-identifier hs-var">bi'</span></a></span><span> </span><span class="annot"><span class="annottext">Parameter device dtype (GRUBIShape hiddenSize inputSize)
</span><a href="#local-6989586621679807192"><span class="hs-identifier hs-var">bh'</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span id="local-6989586621679807188"><span id="local-6989586621679807189"><span id="local-6989586621679807190"><span id="local-6989586621679807191"><span class="hs-keyword">instance</span><span>
</span><span id="line-125"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.Typed.Factories.html#RandDTypeIsValid"><span class="hs-identifier hs-type">RandDTypeIsValid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807191"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807190"><span class="hs-identifier hs-type">dtype</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-126"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679807189"><span class="hs-identifier hs-type">inputSize</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-127"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679807188"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-128"></span><span>    </span><span class="annot"><a href="Torch.Typed.Tensor.html#KnownDType"><span class="hs-identifier hs-type">KnownDType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807190"><span class="hs-identifier hs-type">dtype</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-129"></span><span>    </span><span class="annot"><a href="Torch.Typed.Tensor.html#KnownDevice"><span class="hs-identifier hs-type">KnownDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807191"><span class="hs-identifier hs-type">device</span></a></span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-131"></span><span>  </span><span class="annot"><a href="Torch.NN.html#Randomizable"><span class="hs-identifier hs-type">A.Randomizable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayerSpec"><span class="hs-identifier hs-type">GRULayerSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807189"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807188"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.Typed.Functional.html#Unidirectional"><span class="hs-identifier hs-type">Unidirectional</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807190"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807191"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayer"><span class="hs-identifier hs-type">GRULayer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807189"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807188"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.Typed.Functional.html#Unidirectional"><span class="hs-identifier hs-type">Unidirectional</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807190"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807191"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-134"></span><span>  </span><span id="local-6989586621679807185"><span class="annot"><span class="annottext">sample :: GRULayerSpec inputSize hiddenSize 'Unidirectional dtype device
-&gt; IO (GRULayer inputSize hiddenSize 'Unidirectional dtype device)
</span><a href="Torch.NN.html#sample"><span class="hs-identifier hs-var hs-var hs-var hs-var">sample</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-135"></span><span>    </span><span class="annot"><span class="annottext">Parameter device dtype (GRUWIShape hiddenSize inputSize)
-&gt; Parameter device dtype (GRUWHShape hiddenSize inputSize)
-&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
-&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
-&gt; GRULayer inputSize hiddenSize 'Unidirectional dtype device
forall (device :: (DeviceType, Nat)) (dtype :: DType)
       (hiddenSize :: Nat) (inputSize :: Nat).
Parameter device dtype (GRUWIShape hiddenSize inputSize)
-&gt; Parameter device dtype (GRUWHShape hiddenSize inputSize)
-&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
-&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
-&gt; GRULayer inputSize hiddenSize 'Unidirectional dtype device
</span><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUUnidirectionalLayer"><span class="hs-identifier hs-var">GRUUnidirectionalLayer</span></a></span><span>
</span><span id="line-136"></span><span>      </span><span class="annot"><span class="annottext">(Parameter device dtype (GRUWIShape hiddenSize inputSize)
 -&gt; Parameter device dtype (GRUWHShape hiddenSize inputSize)
 -&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
 -&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
 -&gt; GRULayer inputSize hiddenSize 'Unidirectional dtype device)
-&gt; IO (Parameter device dtype (GRUWIShape hiddenSize inputSize))
-&gt; IO
     (Parameter device dtype (GRUWHShape hiddenSize inputSize)
      -&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
      -&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
      -&gt; GRULayer inputSize hiddenSize 'Unidirectional dtype device)
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tensor device dtype (GRUWIShape hiddenSize inputSize)
-&gt; IO (Parameter device dtype (GRUWIShape hiddenSize inputSize))
forall (shape :: [Nat]) (dtype :: DType)
       (device :: (DeviceType, Nat)).
Tensor device dtype shape -&gt; IO (Parameter device dtype shape)
</span><a href="Torch.Typed.Parameter.html#makeIndependent"><span class="hs-identifier hs-var">makeIndependent</span></a></span><span> </span><span class="annot"><span class="annottext">(Tensor device dtype (GRUWIShape hiddenSize inputSize)
 -&gt; IO (Parameter device dtype (GRUWIShape hiddenSize inputSize)))
-&gt; IO (Tensor device dtype (GRUWIShape hiddenSize inputSize))
-&gt; IO (Parameter device dtype (GRUWIShape hiddenSize inputSize))
forall (m :: Type -&gt; Type) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">IO (Tensor device dtype (GRUWIShape hiddenSize inputSize))
forall (device :: (DeviceType, Nat)) (dtype :: DType)
       (hiddenSize :: Nat) (featureSize :: Nat).
(KnownDType dtype, KnownNat hiddenSize, KnownNat featureSize,
 KnownDevice device, RandDTypeIsValid device dtype) =&gt;
IO (Tensor device dtype '[3 * hiddenSize, featureSize])
</span><a href="Torch.Typed.NN.Recurrent.GRU.html#xavierUniformGRU"><span class="hs-identifier hs-var">xavierUniformGRU</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>      </span><span class="annot"><span class="annottext">IO
  (Parameter device dtype (GRUWHShape hiddenSize inputSize)
   -&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
   -&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
   -&gt; GRULayer inputSize hiddenSize 'Unidirectional dtype device)
-&gt; IO (Parameter device dtype (GRUWHShape hiddenSize inputSize))
-&gt; IO
     (Parameter device dtype (GRUBIShape hiddenSize inputSize)
      -&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
      -&gt; GRULayer inputSize hiddenSize 'Unidirectional dtype device)
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tensor device dtype (GRUWHShape hiddenSize inputSize)
-&gt; IO (Parameter device dtype (GRUWHShape hiddenSize inputSize))
forall (shape :: [Nat]) (dtype :: DType)
       (device :: (DeviceType, Nat)).
Tensor device dtype shape -&gt; IO (Parameter device dtype shape)
</span><a href="Torch.Typed.Parameter.html#makeIndependent"><span class="hs-identifier hs-var">makeIndependent</span></a></span><span> </span><span class="annot"><span class="annottext">(Tensor device dtype (GRUWHShape hiddenSize inputSize)
 -&gt; IO (Parameter device dtype (GRUWHShape hiddenSize inputSize)))
-&gt; IO (Tensor device dtype (GRUWHShape hiddenSize inputSize))
-&gt; IO (Parameter device dtype (GRUWHShape hiddenSize inputSize))
forall (m :: Type -&gt; Type) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">IO (Tensor device dtype (GRUWHShape hiddenSize inputSize))
forall (device :: (DeviceType, Nat)) (dtype :: DType)
       (hiddenSize :: Nat) (featureSize :: Nat).
(KnownDType dtype, KnownNat hiddenSize, KnownNat featureSize,
 KnownDevice device, RandDTypeIsValid device dtype) =&gt;
IO (Tensor device dtype '[3 * hiddenSize, featureSize])
</span><a href="Torch.Typed.NN.Recurrent.GRU.html#xavierUniformGRU"><span class="hs-identifier hs-var">xavierUniformGRU</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>      </span><span class="annot"><span class="annottext">IO
  (Parameter device dtype (GRUBIShape hiddenSize inputSize)
   -&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
   -&gt; GRULayer inputSize hiddenSize 'Unidirectional dtype device)
-&gt; IO (Parameter device dtype (GRUBIShape hiddenSize inputSize))
-&gt; IO
     (Parameter device dtype (GRUBIShape hiddenSize inputSize)
      -&gt; GRULayer inputSize hiddenSize 'Unidirectional dtype device)
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tensor device dtype (GRUBIShape hiddenSize inputSize)
-&gt; IO (Parameter device dtype (GRUBIShape hiddenSize inputSize))
forall (shape :: [Nat]) (dtype :: DType)
       (device :: (DeviceType, Nat)).
Tensor device dtype shape -&gt; IO (Parameter device dtype shape)
</span><a href="Torch.Typed.Parameter.html#makeIndependent"><span class="hs-identifier hs-var">makeIndependent</span></a></span><span> </span><span class="annot"><span class="annottext">(Tensor device dtype (GRUBIShape hiddenSize inputSize)
 -&gt; IO (Parameter device dtype (GRUBIShape hiddenSize inputSize)))
-&gt; IO (Tensor device dtype (GRUBIShape hiddenSize inputSize))
-&gt; IO (Parameter device dtype (GRUBIShape hiddenSize inputSize))
forall (m :: Type -&gt; Type) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Tensor device dtype (GRUBIShape hiddenSize inputSize)
-&gt; IO (Tensor device dtype (GRUBIShape hiddenSize inputSize))
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Tensor device dtype (GRUBIShape hiddenSize inputSize)
forall (shape :: [Nat]) (dtype :: DType)
       (device :: (DeviceType, Nat)).
TensorOptions shape dtype device =&gt;
Tensor device dtype shape
</span><a href="Torch.Typed.Factories.html#zeros"><span class="hs-identifier hs-var">zeros</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>      </span><span class="annot"><span class="annottext">IO
  (Parameter device dtype (GRUBIShape hiddenSize inputSize)
   -&gt; GRULayer inputSize hiddenSize 'Unidirectional dtype device)
-&gt; IO (Parameter device dtype (GRUBIShape hiddenSize inputSize))
-&gt; IO (GRULayer inputSize hiddenSize 'Unidirectional dtype device)
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tensor device dtype (GRUBIShape hiddenSize inputSize)
-&gt; IO (Parameter device dtype (GRUBIShape hiddenSize inputSize))
forall (shape :: [Nat]) (dtype :: DType)
       (device :: (DeviceType, Nat)).
Tensor device dtype shape -&gt; IO (Parameter device dtype shape)
</span><a href="Torch.Typed.Parameter.html#makeIndependent"><span class="hs-identifier hs-var">makeIndependent</span></a></span><span> </span><span class="annot"><span class="annottext">(Tensor device dtype (GRUBIShape hiddenSize inputSize)
 -&gt; IO (Parameter device dtype (GRUBIShape hiddenSize inputSize)))
-&gt; IO (Tensor device dtype (GRUBIShape hiddenSize inputSize))
-&gt; IO (Parameter device dtype (GRUBIShape hiddenSize inputSize))
forall (m :: Type -&gt; Type) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Tensor device dtype (GRUBIShape hiddenSize inputSize)
-&gt; IO (Tensor device dtype (GRUBIShape hiddenSize inputSize))
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Tensor device dtype (GRUBIShape hiddenSize inputSize)
forall (shape :: [Nat]) (dtype :: DType)
       (device :: (DeviceType, Nat)).
TensorOptions shape dtype device =&gt;
Tensor device dtype shape
</span><a href="Torch.Typed.Factories.html#zeros"><span class="hs-identifier hs-var">zeros</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span id="local-6989586621679807175"><span id="local-6989586621679807176"><span id="local-6989586621679807177"><span id="local-6989586621679807178"><span class="hs-keyword">instance</span><span>
</span><span id="line-142"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.Typed.Factories.html#RandDTypeIsValid"><span class="hs-identifier hs-type">RandDTypeIsValid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807178"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807177"><span class="hs-identifier hs-type">dtype</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-143"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679807176"><span class="hs-identifier hs-type">inputSize</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-144"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679807175"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-145"></span><span>    </span><span class="annot"><a href="Torch.Typed.Tensor.html#KnownDType"><span class="hs-identifier hs-type">KnownDType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807177"><span class="hs-identifier hs-type">dtype</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-146"></span><span>    </span><span class="annot"><a href="Torch.Typed.Tensor.html#KnownDevice"><span class="hs-identifier hs-type">KnownDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807178"><span class="hs-identifier hs-type">device</span></a></span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-148"></span><span>  </span><span class="annot"><a href="Torch.NN.html#Randomizable"><span class="hs-identifier hs-type">A.Randomizable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayerSpec"><span class="hs-identifier hs-type">GRULayerSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807176"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807175"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.Typed.Functional.html#Bidirectional"><span class="hs-identifier hs-type">Bidirectional</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807177"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807178"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayer"><span class="hs-identifier hs-type">GRULayer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807176"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807175"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.Typed.Functional.html#Bidirectional"><span class="hs-identifier hs-type">Bidirectional</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807177"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807178"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-151"></span><span>  </span><span id="local-6989586621679807173"><span class="annot"><span class="annottext">sample :: GRULayerSpec inputSize hiddenSize 'Bidirectional dtype device
-&gt; IO (GRULayer inputSize hiddenSize 'Bidirectional dtype device)
</span><a href="#local-6989586621679807173"><span class="hs-identifier hs-var hs-var hs-var hs-var">sample</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-152"></span><span>    </span><span class="annot"><span class="annottext">Parameter device dtype (GRUWIShape hiddenSize inputSize)
-&gt; Parameter device dtype (GRUWHShape hiddenSize inputSize)
-&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
-&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
-&gt; Parameter device dtype (GRUWIShape hiddenSize inputSize)
-&gt; Parameter device dtype (GRUWHShape hiddenSize inputSize)
-&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
-&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
-&gt; GRULayer inputSize hiddenSize 'Bidirectional dtype device
forall (device :: (DeviceType, Nat)) (dtype :: DType)
       (hiddenSize :: Nat) (inputSize :: Nat).
Parameter device dtype (GRUWIShape hiddenSize inputSize)
-&gt; Parameter device dtype (GRUWHShape hiddenSize inputSize)
-&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
-&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
-&gt; Parameter device dtype (GRUWIShape hiddenSize inputSize)
-&gt; Parameter device dtype (GRUWHShape hiddenSize inputSize)
-&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
-&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
-&gt; GRULayer inputSize hiddenSize 'Bidirectional dtype device
</span><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUBidirectionalLayer"><span class="hs-identifier hs-var">GRUBidirectionalLayer</span></a></span><span>
</span><span id="line-153"></span><span>      </span><span class="annot"><span class="annottext">(Parameter device dtype (GRUWIShape hiddenSize inputSize)
 -&gt; Parameter device dtype (GRUWHShape hiddenSize inputSize)
 -&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
 -&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
 -&gt; Parameter device dtype (GRUWIShape hiddenSize inputSize)
 -&gt; Parameter device dtype (GRUWHShape hiddenSize inputSize)
 -&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
 -&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
 -&gt; GRULayer inputSize hiddenSize 'Bidirectional dtype device)
-&gt; IO (Parameter device dtype (GRUWIShape hiddenSize inputSize))
-&gt; IO
     (Parameter device dtype (GRUWHShape hiddenSize inputSize)
      -&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
      -&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
      -&gt; Parameter device dtype (GRUWIShape hiddenSize inputSize)
      -&gt; Parameter device dtype (GRUWHShape hiddenSize inputSize)
      -&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
      -&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
      -&gt; GRULayer inputSize hiddenSize 'Bidirectional dtype device)
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tensor device dtype (GRUWIShape hiddenSize inputSize)
-&gt; IO (Parameter device dtype (GRUWIShape hiddenSize inputSize))
forall (shape :: [Nat]) (dtype :: DType)
       (device :: (DeviceType, Nat)).
Tensor device dtype shape -&gt; IO (Parameter device dtype shape)
</span><a href="Torch.Typed.Parameter.html#makeIndependent"><span class="hs-identifier hs-var">makeIndependent</span></a></span><span> </span><span class="annot"><span class="annottext">(Tensor device dtype (GRUWIShape hiddenSize inputSize)
 -&gt; IO (Parameter device dtype (GRUWIShape hiddenSize inputSize)))
-&gt; IO (Tensor device dtype (GRUWIShape hiddenSize inputSize))
-&gt; IO (Parameter device dtype (GRUWIShape hiddenSize inputSize))
forall (m :: Type -&gt; Type) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">IO (Tensor device dtype (GRUWIShape hiddenSize inputSize))
forall (device :: (DeviceType, Nat)) (dtype :: DType)
       (hiddenSize :: Nat) (featureSize :: Nat).
(KnownDType dtype, KnownNat hiddenSize, KnownNat featureSize,
 KnownDevice device, RandDTypeIsValid device dtype) =&gt;
IO (Tensor device dtype '[3 * hiddenSize, featureSize])
</span><a href="Torch.Typed.NN.Recurrent.GRU.html#xavierUniformGRU"><span class="hs-identifier hs-var">xavierUniformGRU</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>      </span><span class="annot"><span class="annottext">IO
  (Parameter device dtype (GRUWHShape hiddenSize inputSize)
   -&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
   -&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
   -&gt; Parameter device dtype (GRUWIShape hiddenSize inputSize)
   -&gt; Parameter device dtype (GRUWHShape hiddenSize inputSize)
   -&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
   -&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
   -&gt; GRULayer inputSize hiddenSize 'Bidirectional dtype device)
-&gt; IO (Parameter device dtype (GRUWHShape hiddenSize inputSize))
-&gt; IO
     (Parameter device dtype (GRUBIShape hiddenSize inputSize)
      -&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
      -&gt; Parameter device dtype (GRUWIShape hiddenSize inputSize)
      -&gt; Parameter device dtype (GRUWHShape hiddenSize inputSize)
      -&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
      -&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
      -&gt; GRULayer inputSize hiddenSize 'Bidirectional dtype device)
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tensor device dtype (GRUWHShape hiddenSize inputSize)
-&gt; IO (Parameter device dtype (GRUWHShape hiddenSize inputSize))
forall (shape :: [Nat]) (dtype :: DType)
       (device :: (DeviceType, Nat)).
Tensor device dtype shape -&gt; IO (Parameter device dtype shape)
</span><a href="Torch.Typed.Parameter.html#makeIndependent"><span class="hs-identifier hs-var">makeIndependent</span></a></span><span> </span><span class="annot"><span class="annottext">(Tensor device dtype (GRUWHShape hiddenSize inputSize)
 -&gt; IO (Parameter device dtype (GRUWHShape hiddenSize inputSize)))
-&gt; IO (Tensor device dtype (GRUWHShape hiddenSize inputSize))
-&gt; IO (Parameter device dtype (GRUWHShape hiddenSize inputSize))
forall (m :: Type -&gt; Type) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">IO (Tensor device dtype (GRUWHShape hiddenSize inputSize))
forall (device :: (DeviceType, Nat)) (dtype :: DType)
       (hiddenSize :: Nat) (featureSize :: Nat).
(KnownDType dtype, KnownNat hiddenSize, KnownNat featureSize,
 KnownDevice device, RandDTypeIsValid device dtype) =&gt;
IO (Tensor device dtype '[3 * hiddenSize, featureSize])
</span><a href="Torch.Typed.NN.Recurrent.GRU.html#xavierUniformGRU"><span class="hs-identifier hs-var">xavierUniformGRU</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>      </span><span class="annot"><span class="annottext">IO
  (Parameter device dtype (GRUBIShape hiddenSize inputSize)
   -&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
   -&gt; Parameter device dtype (GRUWIShape hiddenSize inputSize)
   -&gt; Parameter device dtype (GRUWHShape hiddenSize inputSize)
   -&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
   -&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
   -&gt; GRULayer inputSize hiddenSize 'Bidirectional dtype device)
-&gt; IO (Parameter device dtype (GRUBIShape hiddenSize inputSize))
-&gt; IO
     (Parameter device dtype (GRUBIShape hiddenSize inputSize)
      -&gt; Parameter device dtype (GRUWIShape hiddenSize inputSize)
      -&gt; Parameter device dtype (GRUWHShape hiddenSize inputSize)
      -&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
      -&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
      -&gt; GRULayer inputSize hiddenSize 'Bidirectional dtype device)
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tensor device dtype (GRUBIShape hiddenSize inputSize)
-&gt; IO (Parameter device dtype (GRUBIShape hiddenSize inputSize))
forall (shape :: [Nat]) (dtype :: DType)
       (device :: (DeviceType, Nat)).
Tensor device dtype shape -&gt; IO (Parameter device dtype shape)
</span><a href="Torch.Typed.Parameter.html#makeIndependent"><span class="hs-identifier hs-var">makeIndependent</span></a></span><span> </span><span class="annot"><span class="annottext">(Tensor device dtype (GRUBIShape hiddenSize inputSize)
 -&gt; IO (Parameter device dtype (GRUBIShape hiddenSize inputSize)))
-&gt; IO (Tensor device dtype (GRUBIShape hiddenSize inputSize))
-&gt; IO (Parameter device dtype (GRUBIShape hiddenSize inputSize))
forall (m :: Type -&gt; Type) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Tensor device dtype (GRUBIShape hiddenSize inputSize)
-&gt; IO (Tensor device dtype (GRUBIShape hiddenSize inputSize))
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Tensor device dtype (GRUBIShape hiddenSize inputSize)
forall (shape :: [Nat]) (dtype :: DType)
       (device :: (DeviceType, Nat)).
TensorOptions shape dtype device =&gt;
Tensor device dtype shape
</span><a href="Torch.Typed.Factories.html#zeros"><span class="hs-identifier hs-var">zeros</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span>      </span><span class="annot"><span class="annottext">IO
  (Parameter device dtype (GRUBIShape hiddenSize inputSize)
   -&gt; Parameter device dtype (GRUWIShape hiddenSize inputSize)
   -&gt; Parameter device dtype (GRUWHShape hiddenSize inputSize)
   -&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
   -&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
   -&gt; GRULayer inputSize hiddenSize 'Bidirectional dtype device)
-&gt; IO (Parameter device dtype (GRUBIShape hiddenSize inputSize))
-&gt; IO
     (Parameter device dtype (GRUWIShape hiddenSize inputSize)
      -&gt; Parameter device dtype (GRUWHShape hiddenSize inputSize)
      -&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
      -&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
      -&gt; GRULayer inputSize hiddenSize 'Bidirectional dtype device)
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tensor device dtype (GRUBIShape hiddenSize inputSize)
-&gt; IO (Parameter device dtype (GRUBIShape hiddenSize inputSize))
forall (shape :: [Nat]) (dtype :: DType)
       (device :: (DeviceType, Nat)).
Tensor device dtype shape -&gt; IO (Parameter device dtype shape)
</span><a href="Torch.Typed.Parameter.html#makeIndependent"><span class="hs-identifier hs-var">makeIndependent</span></a></span><span> </span><span class="annot"><span class="annottext">(Tensor device dtype (GRUBIShape hiddenSize inputSize)
 -&gt; IO (Parameter device dtype (GRUBIShape hiddenSize inputSize)))
-&gt; IO (Tensor device dtype (GRUBIShape hiddenSize inputSize))
-&gt; IO (Parameter device dtype (GRUBIShape hiddenSize inputSize))
forall (m :: Type -&gt; Type) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Tensor device dtype (GRUBIShape hiddenSize inputSize)
-&gt; IO (Tensor device dtype (GRUBIShape hiddenSize inputSize))
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Tensor device dtype (GRUBIShape hiddenSize inputSize)
forall (shape :: [Nat]) (dtype :: DType)
       (device :: (DeviceType, Nat)).
TensorOptions shape dtype device =&gt;
Tensor device dtype shape
</span><a href="Torch.Typed.Factories.html#zeros"><span class="hs-identifier hs-var">zeros</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span>      </span><span class="annot"><span class="annottext">IO
  (Parameter device dtype (GRUWIShape hiddenSize inputSize)
   -&gt; Parameter device dtype (GRUWHShape hiddenSize inputSize)
   -&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
   -&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
   -&gt; GRULayer inputSize hiddenSize 'Bidirectional dtype device)
-&gt; IO (Parameter device dtype (GRUWIShape hiddenSize inputSize))
-&gt; IO
     (Parameter device dtype (GRUWHShape hiddenSize inputSize)
      -&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
      -&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
      -&gt; GRULayer inputSize hiddenSize 'Bidirectional dtype device)
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tensor device dtype (GRUWIShape hiddenSize inputSize)
-&gt; IO (Parameter device dtype (GRUWIShape hiddenSize inputSize))
forall (shape :: [Nat]) (dtype :: DType)
       (device :: (DeviceType, Nat)).
Tensor device dtype shape -&gt; IO (Parameter device dtype shape)
</span><a href="Torch.Typed.Parameter.html#makeIndependent"><span class="hs-identifier hs-var">makeIndependent</span></a></span><span> </span><span class="annot"><span class="annottext">(Tensor device dtype (GRUWIShape hiddenSize inputSize)
 -&gt; IO (Parameter device dtype (GRUWIShape hiddenSize inputSize)))
-&gt; IO (Tensor device dtype (GRUWIShape hiddenSize inputSize))
-&gt; IO (Parameter device dtype (GRUWIShape hiddenSize inputSize))
forall (m :: Type -&gt; Type) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">IO (Tensor device dtype (GRUWIShape hiddenSize inputSize))
forall (device :: (DeviceType, Nat)) (dtype :: DType)
       (hiddenSize :: Nat) (featureSize :: Nat).
(KnownDType dtype, KnownNat hiddenSize, KnownNat featureSize,
 KnownDevice device, RandDTypeIsValid device dtype) =&gt;
IO (Tensor device dtype '[3 * hiddenSize, featureSize])
</span><a href="Torch.Typed.NN.Recurrent.GRU.html#xavierUniformGRU"><span class="hs-identifier hs-var">xavierUniformGRU</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>      </span><span class="annot"><span class="annottext">IO
  (Parameter device dtype (GRUWHShape hiddenSize inputSize)
   -&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
   -&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
   -&gt; GRULayer inputSize hiddenSize 'Bidirectional dtype device)
-&gt; IO (Parameter device dtype (GRUWHShape hiddenSize inputSize))
-&gt; IO
     (Parameter device dtype (GRUBIShape hiddenSize inputSize)
      -&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
      -&gt; GRULayer inputSize hiddenSize 'Bidirectional dtype device)
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tensor device dtype (GRUWHShape hiddenSize inputSize)
-&gt; IO (Parameter device dtype (GRUWHShape hiddenSize inputSize))
forall (shape :: [Nat]) (dtype :: DType)
       (device :: (DeviceType, Nat)).
Tensor device dtype shape -&gt; IO (Parameter device dtype shape)
</span><a href="Torch.Typed.Parameter.html#makeIndependent"><span class="hs-identifier hs-var">makeIndependent</span></a></span><span> </span><span class="annot"><span class="annottext">(Tensor device dtype (GRUWHShape hiddenSize inputSize)
 -&gt; IO (Parameter device dtype (GRUWHShape hiddenSize inputSize)))
-&gt; IO (Tensor device dtype (GRUWHShape hiddenSize inputSize))
-&gt; IO (Parameter device dtype (GRUWHShape hiddenSize inputSize))
forall (m :: Type -&gt; Type) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">IO (Tensor device dtype (GRUWHShape hiddenSize inputSize))
forall (device :: (DeviceType, Nat)) (dtype :: DType)
       (hiddenSize :: Nat) (featureSize :: Nat).
(KnownDType dtype, KnownNat hiddenSize, KnownNat featureSize,
 KnownDevice device, RandDTypeIsValid device dtype) =&gt;
IO (Tensor device dtype '[3 * hiddenSize, featureSize])
</span><a href="Torch.Typed.NN.Recurrent.GRU.html#xavierUniformGRU"><span class="hs-identifier hs-var">xavierUniformGRU</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>      </span><span class="annot"><span class="annottext">IO
  (Parameter device dtype (GRUBIShape hiddenSize inputSize)
   -&gt; Parameter device dtype (GRUBIShape hiddenSize inputSize)
   -&gt; GRULayer inputSize hiddenSize 'Bidirectional dtype device)
-&gt; IO (Parameter device dtype (GRUBIShape hiddenSize inputSize))
-&gt; IO
     (Parameter device dtype (GRUBIShape hiddenSize inputSize)
      -&gt; GRULayer inputSize hiddenSize 'Bidirectional dtype device)
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tensor device dtype (GRUBIShape hiddenSize inputSize)
-&gt; IO (Parameter device dtype (GRUBIShape hiddenSize inputSize))
forall (shape :: [Nat]) (dtype :: DType)
       (device :: (DeviceType, Nat)).
Tensor device dtype shape -&gt; IO (Parameter device dtype shape)
</span><a href="Torch.Typed.Parameter.html#makeIndependent"><span class="hs-identifier hs-var">makeIndependent</span></a></span><span> </span><span class="annot"><span class="annottext">(Tensor device dtype (GRUBIShape hiddenSize inputSize)
 -&gt; IO (Parameter device dtype (GRUBIShape hiddenSize inputSize)))
-&gt; IO (Tensor device dtype (GRUBIShape hiddenSize inputSize))
-&gt; IO (Parameter device dtype (GRUBIShape hiddenSize inputSize))
forall (m :: Type -&gt; Type) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Tensor device dtype (GRUBIShape hiddenSize inputSize)
-&gt; IO (Tensor device dtype (GRUBIShape hiddenSize inputSize))
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Tensor device dtype (GRUBIShape hiddenSize inputSize)
forall (shape :: [Nat]) (dtype :: DType)
       (device :: (DeviceType, Nat)).
TensorOptions shape dtype device =&gt;
Tensor device dtype shape
</span><a href="Torch.Typed.Factories.html#zeros"><span class="hs-identifier hs-var">zeros</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>      </span><span class="annot"><span class="annottext">IO
  (Parameter device dtype (GRUBIShape hiddenSize inputSize)
   -&gt; GRULayer inputSize hiddenSize 'Bidirectional dtype device)
-&gt; IO (Parameter device dtype (GRUBIShape hiddenSize inputSize))
-&gt; IO (GRULayer inputSize hiddenSize 'Bidirectional dtype device)
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tensor device dtype (GRUBIShape hiddenSize inputSize)
-&gt; IO (Parameter device dtype (GRUBIShape hiddenSize inputSize))
forall (shape :: [Nat]) (dtype :: DType)
       (device :: (DeviceType, Nat)).
Tensor device dtype shape -&gt; IO (Parameter device dtype shape)
</span><a href="Torch.Typed.Parameter.html#makeIndependent"><span class="hs-identifier hs-var">makeIndependent</span></a></span><span> </span><span class="annot"><span class="annottext">(Tensor device dtype (GRUBIShape hiddenSize inputSize)
 -&gt; IO (Parameter device dtype (GRUBIShape hiddenSize inputSize)))
-&gt; IO (Tensor device dtype (GRUBIShape hiddenSize inputSize))
-&gt; IO (Parameter device dtype (GRUBIShape hiddenSize inputSize))
forall (m :: Type -&gt; Type) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Tensor device dtype (GRUBIShape hiddenSize inputSize)
-&gt; IO (Tensor device dtype (GRUBIShape hiddenSize inputSize))
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Tensor device dtype (GRUBIShape hiddenSize inputSize)
forall (shape :: [Nat]) (dtype :: DType)
       (device :: (DeviceType, Nat)).
TensorOptions shape dtype device =&gt;
Tensor device dtype shape
</span><a href="Torch.Typed.Factories.html#zeros"><span class="hs-identifier hs-var">zeros</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="hs-keyword">data</span><span>
</span><span id="line-163"></span><span>  </span><span id="GRULayerStackSpec"><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayerStackSpec"><span class="hs-identifier hs-var">GRULayerStackSpec</span></a></span></span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807545"><span class="annot"><a href="#local-6989586621679807545"><span class="hs-identifier hs-type">inputSize</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807544"><span class="annot"><a href="#local-6989586621679807544"><span class="hs-identifier hs-type">hiddenSize</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807543"><span class="annot"><a href="#local-6989586621679807543"><span class="hs-identifier hs-type">numLayers</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807542"><span class="annot"><a href="#local-6989586621679807542"><span class="hs-identifier hs-type">directionality</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.Typed.Functional.html#RNNDirectionality"><span class="hs-identifier hs-type">RNNDirectionality</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807541"><span class="annot"><a href="#local-6989586621679807541"><span class="hs-identifier hs-type">dtype</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.DType.html#DType"><span class="hs-identifier hs-type">D.DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807540"><span class="annot"><a href="#local-6989586621679807540"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Device.html#DeviceType"><span class="hs-identifier hs-type">D.DeviceType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="GRULayerStackSpec"><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayerStackSpec"><span class="hs-identifier hs-var">GRULayerStackSpec</span></a></span></span><span>
</span><span id="line-171"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679807166"><span id="local-6989586621679807168"><span id="local-6989586621679807170"><span class="annot"><span class="annottext">Int
-&gt; GRULayerStackSpec
     inputSize hiddenSize numLayers directionality dtype device
-&gt; ShowS
[GRULayerStackSpec
   inputSize hiddenSize numLayers directionality dtype device]
-&gt; ShowS
GRULayerStackSpec
  inputSize hiddenSize numLayers directionality dtype device
-&gt; String
(Int
 -&gt; GRULayerStackSpec
      inputSize hiddenSize numLayers directionality dtype device
 -&gt; ShowS)
-&gt; (GRULayerStackSpec
      inputSize hiddenSize numLayers directionality dtype device
    -&gt; String)
-&gt; ([GRULayerStackSpec
       inputSize hiddenSize numLayers directionality dtype device]
    -&gt; ShowS)
-&gt; Show
     (GRULayerStackSpec
        inputSize hiddenSize numLayers directionality dtype device)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall (inputSize :: Nat) (hiddenSize :: Nat) (numLayers :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)).
Int
-&gt; GRULayerStackSpec
     inputSize hiddenSize numLayers directionality dtype device
-&gt; ShowS
forall (inputSize :: Nat) (hiddenSize :: Nat) (numLayers :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)).
[GRULayerStackSpec
   inputSize hiddenSize numLayers directionality dtype device]
-&gt; ShowS
forall (inputSize :: Nat) (hiddenSize :: Nat) (numLayers :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)).
GRULayerStackSpec
  inputSize hiddenSize numLayers directionality dtype device
-&gt; String
showList :: [GRULayerStackSpec
   inputSize hiddenSize numLayers directionality dtype device]
-&gt; ShowS
$cshowList :: forall (inputSize :: Nat) (hiddenSize :: Nat) (numLayers :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)).
[GRULayerStackSpec
   inputSize hiddenSize numLayers directionality dtype device]
-&gt; ShowS
show :: GRULayerStackSpec
  inputSize hiddenSize numLayers directionality dtype device
-&gt; String
$cshow :: forall (inputSize :: Nat) (hiddenSize :: Nat) (numLayers :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)).
GRULayerStackSpec
  inputSize hiddenSize numLayers directionality dtype device
-&gt; String
showsPrec :: Int
-&gt; GRULayerStackSpec
     inputSize hiddenSize numLayers directionality dtype device
-&gt; ShowS
$cshowsPrec :: forall (inputSize :: Nat) (hiddenSize :: Nat) (numLayers :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)).
Int
-&gt; GRULayerStackSpec
     inputSize hiddenSize numLayers directionality dtype device
-&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679807162"><span id="local-6989586621679807164"><span class="annot"><span class="annottext">GRULayerStackSpec
  inputSize hiddenSize numLayers directionality dtype device
-&gt; GRULayerStackSpec
     inputSize hiddenSize numLayers directionality dtype device
-&gt; Bool
(GRULayerStackSpec
   inputSize hiddenSize numLayers directionality dtype device
 -&gt; GRULayerStackSpec
      inputSize hiddenSize numLayers directionality dtype device
 -&gt; Bool)
-&gt; (GRULayerStackSpec
      inputSize hiddenSize numLayers directionality dtype device
    -&gt; GRULayerStackSpec
         inputSize hiddenSize numLayers directionality dtype device
    -&gt; Bool)
-&gt; Eq
     (GRULayerStackSpec
        inputSize hiddenSize numLayers directionality dtype device)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall (inputSize :: Nat) (hiddenSize :: Nat) (numLayers :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)).
GRULayerStackSpec
  inputSize hiddenSize numLayers directionality dtype device
-&gt; GRULayerStackSpec
     inputSize hiddenSize numLayers directionality dtype device
-&gt; Bool
/= :: GRULayerStackSpec
  inputSize hiddenSize numLayers directionality dtype device
-&gt; GRULayerStackSpec
     inputSize hiddenSize numLayers directionality dtype device
-&gt; Bool
$c/= :: forall (inputSize :: Nat) (hiddenSize :: Nat) (numLayers :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)).
GRULayerStackSpec
  inputSize hiddenSize numLayers directionality dtype device
-&gt; GRULayerStackSpec
     inputSize hiddenSize numLayers directionality dtype device
-&gt; Bool
== :: GRULayerStackSpec
  inputSize hiddenSize numLayers directionality dtype device
-&gt; GRULayerStackSpec
     inputSize hiddenSize numLayers directionality dtype device
-&gt; Bool
$c== :: forall (inputSize :: Nat) (hiddenSize :: Nat) (numLayers :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)).
GRULayerStackSpec
  inputSize hiddenSize numLayers directionality dtype device
-&gt; GRULayerStackSpec
     inputSize hiddenSize numLayers directionality dtype device
-&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="hs-comment">-- Input-to-hidden, hidden-to-hidden, and bias parameters for a mulilayered</span><span>
</span><span id="line-174"></span><span class="hs-comment">-- (and optionally) bidirectional GRU.</span><span>
</span><span id="line-175"></span><span class="hs-comment">--</span><span>
</span><span id="line-176"></span><span class="hs-keyword">data</span><span>
</span><span id="line-177"></span><span>  </span><span id="GRULayerStack"><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayerStack"><span class="hs-identifier hs-var">GRULayerStack</span></a></span></span><span>
</span><span id="line-178"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807161"><span class="annot"><a href="#local-6989586621679807161"><span class="hs-identifier hs-type">inputSize</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807160"><span class="annot"><a href="#local-6989586621679807160"><span class="hs-identifier hs-type">hiddenSize</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807159"><span class="annot"><a href="#local-6989586621679807159"><span class="hs-identifier hs-type">numLayers</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807158"><span class="annot"><a href="#local-6989586621679807158"><span class="hs-identifier hs-type">directionality</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.Typed.Functional.html#RNNDirectionality"><span class="hs-identifier hs-type">RNNDirectionality</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807157"><span class="annot"><a href="#local-6989586621679807157"><span class="hs-identifier hs-type">dtype</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.DType.html#DType"><span class="hs-identifier hs-type">D.DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807156"><span class="annot"><a href="#local-6989586621679807156"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Device.html#DeviceType"><span class="hs-identifier hs-type">D.DeviceType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-184"></span><span>  </span><span id="local-6989586621679807601"><span id="local-6989586621679807602"><span id="local-6989586621679807603"><span id="local-6989586621679807604"><span id="local-6989586621679807605"><span id="GRULayer1"><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayer1"><span class="hs-identifier hs-var">GRULayer1</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-185"></span><span>    </span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayer"><span class="hs-identifier hs-type">GRULayer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807605"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807604"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807603"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807602"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807601"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-186"></span><span>    </span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayerStack"><span class="hs-identifier hs-type">GRULayerStack</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807605"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807604"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><a href="#local-6989586621679807603"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807602"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807601"><span class="hs-identifier hs-type">device</span></a></span></span></span></span></span></span><span>
</span><span id="line-187"></span><span>  </span><span id="local-6989586621679807565"><span id="local-6989586621679807566"><span id="local-6989586621679807567"><span id="local-6989586621679807568"><span id="local-6989586621679807569"><span id="local-6989586621679807570"><span id="GRULayerK"><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayerK"><span class="hs-identifier hs-var">GRULayerK</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-188"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;=</span></span><span> </span><span class="annot"><a href="#local-6989586621679807570"><span class="hs-identifier hs-type">numLayers</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-189"></span><span>    </span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayerStack"><span class="hs-identifier hs-type">GRULayerStack</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807569"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807568"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679807570"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679807567"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807566"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807565"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-190"></span><span>    </span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayer"><span class="hs-identifier hs-type">GRULayer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679807568"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">*</span></span><span> </span><span class="annot"><a href="Torch.Typed.Functional.html#NumberOfDirections"><span class="hs-identifier hs-type">NumberOfDirections</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807567"><span class="hs-identifier hs-type">directionality</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679807568"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807567"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807566"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807565"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-191"></span><span>    </span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayerStack"><span class="hs-identifier hs-type">GRULayerStack</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807569"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807568"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807570"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807567"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807566"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807565"><span class="hs-identifier hs-type">device</span></a></span></span></span></span></span></span></span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span id="local-6989586621679807142"><span id="local-6989586621679807144"><span id="local-6989586621679807146"><span id="local-6989586621679807148"><span id="local-6989586621679807149"><span id="local-6989586621679807150"><span id="local-6989586621679807151"><span id="local-6989586621679807152"><span id="local-6989586621679807153"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayerStack"><span class="hs-identifier hs-type">GRULayerStack</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807153"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807152"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807151"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807150"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807149"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807148"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span class="hs-comment">--  TODO: Generics? see https://gist.github.com/RyanGlScott/71d9f933e823b4a03f99de54d4b94d51</span><span>
</span><span id="line-196"></span><span class="hs-comment">-- deriving instance Generic (GRULayerStack inputSize hiddenSize numLayers directionality dtype device)</span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span id="local-6989586621679807135"><span id="local-6989586621679807136"><span id="local-6989586621679807137"><span id="local-6989586621679807138"><span id="local-6989586621679807139"><span id="local-6989586621679807140"><span id="local-6989586621679807141"><span class="hs-keyword">instance</span><span>
</span><span id="line-199"></span><span>  </span><span class="hs-pragma">{-# OVERLAPS</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-200"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="#local-6989586621679807141"><span class="hs-identifier hs-type">layer</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K1</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">R</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayer"><span class="hs-identifier hs-type">GRULayer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807140"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807139"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807138"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807137"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807136"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-201"></span><span>    </span><span class="annot"><a href="Torch.Typed.Parameter.html#GParameterized"><span class="hs-identifier hs-type">GParameterized</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807141"><span class="hs-identifier hs-type">layer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807135"><span class="hs-identifier hs-type">parameters</span></a></span><span>
</span><span id="line-202"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-203"></span><span>  </span><span class="annot"><a href="Torch.Typed.Parameter.html#GParameterized"><span class="hs-identifier hs-type">GParameterized</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K1</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">R</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayerStack"><span class="hs-identifier hs-type">GRULayerStack</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807140"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807139"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><a href="#local-6989586621679807138"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807137"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807136"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679807135"><span class="hs-identifier hs-type">parameters</span></a></span><span>
</span><span id="line-204"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-205"></span><span>  </span><span id="local-6989586621679807132"><span class="annot"><span class="annottext">gFlattenParameters :: K1
  R
  (GRULayerStack inputSize hiddenSize 1 directionality dtype device)
  a
-&gt; HList parameters
</span><a href="#local-6989586621679807132"><span class="hs-identifier hs-var hs-var hs-var hs-var">gFlattenParameters</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayer1"><span class="hs-identifier hs-type">GRULayer1</span></a></span><span> </span><span id="local-6989586621679807131"><span class="annot"><span class="annottext">gruLayer :: GRULayer inputSize hiddenSize directionality dtype device
</span><a href="#local-6989586621679807131"><span class="hs-identifier hs-var">gruLayer</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-206"></span><span>    </span><span class="annot"><span class="annottext">layer Any -&gt; HList parameters
forall (f :: Type -&gt; Type) (as :: [Type]) a.
GParameterized f as =&gt;
f a -&gt; HList as
</span><a href="Torch.Typed.Parameter.html#gFlattenParameters"><span class="hs-identifier hs-var">gFlattenParameters</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GRULayer inputSize hiddenSize directionality dtype device
-&gt; K1
     R (GRULayer inputSize hiddenSize directionality dtype device) _
forall k i c (p :: k). c -&gt; K1 i c p
</span><span class="hs-identifier hs-var">K1</span></span><span> </span><span class="annot"><span class="annottext">GRULayer inputSize hiddenSize directionality dtype device
</span><a href="#local-6989586621679807131"><span class="hs-identifier hs-var">gruLayer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679807141"><span class="hs-identifier hs-type">layer</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span>  </span><span id="local-6989586621679807130"><span class="annot"><span class="annottext">gReplaceParameters :: K1
  R
  (GRULayerStack inputSize hiddenSize 1 directionality dtype device)
  a
-&gt; HList parameters
-&gt; K1
     R
     (GRULayerStack inputSize hiddenSize 1 directionality dtype device)
     a
</span><a href="#local-6989586621679807130"><span class="hs-identifier hs-var hs-var hs-var hs-var">gReplaceParameters</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayer1"><span class="hs-identifier hs-type">GRULayer1</span></a></span><span> </span><span id="local-6989586621679807129"><span class="annot"><span class="annottext">gruLayer :: GRULayer inputSize hiddenSize directionality dtype device
</span><a href="#local-6989586621679807129"><span class="hs-identifier hs-var">gruLayer</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679807128"><span class="annot"><span class="annottext">parameters :: HList parameters
</span><a href="#local-6989586621679807128"><span class="hs-identifier hs-var">parameters</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-208"></span><span>    </span><span class="annot"><span class="annottext">GRULayerStack inputSize hiddenSize 1 directionality dtype device
-&gt; K1
     R
     (GRULayerStack inputSize hiddenSize 1 directionality dtype device)
     a
forall k i c (p :: k). c -&gt; K1 i c p
</span><span class="hs-identifier hs-var">K1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GRULayer inputSize hiddenSize directionality dtype device
-&gt; GRULayerStack inputSize hiddenSize 1 directionality dtype device
forall (inputSize :: Nat) (hiddenSize :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)).
GRULayer inputSize hiddenSize directionality dtype device
-&gt; GRULayerStack inputSize hiddenSize 1 directionality dtype device
</span><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayer1"><span class="hs-identifier hs-var">GRULayer1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">K1
  R (GRULayer inputSize hiddenSize directionality dtype device) Any
-&gt; GRULayer inputSize hiddenSize directionality dtype device
forall i c k (p :: k). K1 i c p -&gt; c
</span><span class="hs-identifier hs-var hs-var">unK1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">layer Any -&gt; HList parameters -&gt; layer Any
forall (f :: Type -&gt; Type) (as :: [Type]) a.
GParameterized f as =&gt;
f a -&gt; HList as -&gt; f a
</span><a href="Torch.Typed.Parameter.html#gReplaceParameters"><span class="hs-identifier hs-var">gReplaceParameters</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GRULayer inputSize hiddenSize directionality dtype device
-&gt; K1
     R (GRULayer inputSize hiddenSize directionality dtype device) _
forall k i c (p :: k). c -&gt; K1 i c p
</span><span class="hs-identifier hs-var">K1</span></span><span> </span><span class="annot"><span class="annottext">GRULayer inputSize hiddenSize directionality dtype device
</span><a href="#local-6989586621679807129"><span class="hs-identifier hs-var">gruLayer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679807141"><span class="hs-identifier hs-type">layer</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HList parameters
</span><a href="#local-6989586621679807128"><span class="hs-identifier hs-var">parameters</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span></span></span></span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span id="local-6989586621679807116"><span id="local-6989586621679807117"><span id="local-6989586621679807118"><span id="local-6989586621679807119"><span id="local-6989586621679807120"><span id="local-6989586621679807121"><span id="local-6989586621679807122"><span id="local-6989586621679807123"><span id="local-6989586621679807124"><span id="local-6989586621679807125"><span id="local-6989586621679807126"><span class="hs-keyword">instance</span><span>
</span><span id="line-211"></span><span>  </span><span class="hs-pragma">{-# OVERLAPPABLE</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-212"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;=</span></span><span> </span><span class="annot"><a href="#local-6989586621679807126"><span class="hs-identifier hs-type">numLayers</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-213"></span><span>    </span><span class="annot"><a href="#local-6989586621679807125"><span class="hs-identifier hs-type">layerStack</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K1</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">R</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayerStack"><span class="hs-identifier hs-type">GRULayerStack</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807124"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807123"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679807126"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679807122"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807121"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807120"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-214"></span><span>    </span><span class="annot"><a href="#local-6989586621679807119"><span class="hs-identifier hs-type">layer</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K1</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">R</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayer"><span class="hs-identifier hs-type">GRULayer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679807123"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">*</span></span><span> </span><span class="annot"><a href="Torch.Typed.Functional.html#NumberOfDirections"><span class="hs-identifier hs-type">NumberOfDirections</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807122"><span class="hs-identifier hs-type">directionality</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679807123"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807122"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807121"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807120"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-215"></span><span>    </span><span class="annot"><a href="Torch.Typed.Parameter.html#GParameterized"><span class="hs-identifier hs-type">GParameterized</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807125"><span class="hs-identifier hs-type">layerStack</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807118"><span class="hs-identifier hs-type">parameters</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-216"></span><span>    </span><span class="annot"><a href="Torch.Typed.Parameter.html#GParameterized"><span class="hs-identifier hs-type">GParameterized</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807119"><span class="hs-identifier hs-type">layer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807117"><span class="hs-identifier hs-type">parameters'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-217"></span><span>    </span><span class="annot"><a href="Torch.HList.html#HAppendFD"><span class="hs-identifier hs-type">HAppendFD</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807118"><span class="hs-identifier hs-type">parameters</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807117"><span class="hs-identifier hs-type">parameters'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807116"><span class="hs-identifier hs-type">parameters''</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-218"></span><span>    </span><span class="annot"><a href="#local-6989586621679807116"><span class="hs-identifier hs-type">parameters''</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679807118"><span class="hs-identifier hs-type">parameters</span></a></span><span> </span><span class="annot"><a href="Torch.HList.html#%2B%2B"><span class="hs-operator hs-type">++</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807117"><span class="hs-identifier hs-type">parameters'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-220"></span><span>  </span><span class="annot"><a href="Torch.Typed.Parameter.html#GParameterized"><span class="hs-identifier hs-type">GParameterized</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K1</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">R</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayerStack"><span class="hs-identifier hs-type">GRULayerStack</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807124"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807123"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807126"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807122"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807121"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807120"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679807116"><span class="hs-identifier hs-type">parameters''</span></a></span><span>
</span><span id="line-221"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-222"></span><span>  </span><span id="local-6989586621679807113"><span class="annot"><span class="annottext">gFlattenParameters :: K1
  R
  (GRULayerStack
     inputSize hiddenSize numLayers directionality dtype device)
  a
-&gt; HList parameters''
</span><a href="#local-6989586621679807113"><span class="hs-identifier hs-var hs-var hs-var hs-var">gFlattenParameters</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayerK"><span class="hs-identifier hs-type">GRULayerK</span></a></span><span> </span><span id="local-6989586621679807112"><span class="annot"><span class="annottext">gruLayerStack :: GRULayerStack
  inputSize hiddenSize (numLayers - 1) directionality dtype device
</span><a href="#local-6989586621679807112"><span class="hs-identifier hs-var">gruLayerStack</span></a></span></span><span> </span><span id="local-6989586621679807111"><span class="annot"><span class="annottext">gruLayer :: GRULayer
  (hiddenSize * NumberOfDirections directionality)
  hiddenSize
  directionality
  dtype
  device
</span><a href="#local-6989586621679807111"><span class="hs-identifier hs-var">gruLayer</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-223"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679807110"><span class="annot"><span class="annottext">parameters :: HList parameters
</span><a href="#local-6989586621679807110"><span class="hs-identifier hs-var hs-var">parameters</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">layerStack Any -&gt; HList parameters
forall (f :: Type -&gt; Type) (as :: [Type]) a.
GParameterized f as =&gt;
f a -&gt; HList as
</span><a href="Torch.Typed.Parameter.html#gFlattenParameters"><span class="hs-identifier hs-var">gFlattenParameters</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GRULayerStack
  inputSize hiddenSize (numLayers - 1) directionality dtype device
-&gt; K1
     R
     (GRULayerStack
        inputSize hiddenSize (numLayers - 1) directionality dtype device)
     _
forall k i c (p :: k). c -&gt; K1 i c p
</span><span class="hs-identifier hs-var">K1</span></span><span> </span><span class="annot"><span class="annottext">GRULayerStack
  inputSize hiddenSize (numLayers - 1) directionality dtype device
</span><a href="#local-6989586621679807112"><span class="hs-identifier hs-var">gruLayerStack</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679807125"><span class="hs-identifier hs-type">layerStack</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>        </span><span id="local-6989586621679807109"><span class="annot"><span class="annottext">parameters' :: HList parameters'
</span><a href="#local-6989586621679807109"><span class="hs-identifier hs-var hs-var">parameters'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">layer Any -&gt; HList parameters'
forall (f :: Type -&gt; Type) (as :: [Type]) a.
GParameterized f as =&gt;
f a -&gt; HList as
</span><a href="Torch.Typed.Parameter.html#gFlattenParameters"><span class="hs-identifier hs-var">gFlattenParameters</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GRULayer
  (hiddenSize * NumberOfDirections directionality)
  hiddenSize
  directionality
  dtype
  device
-&gt; K1
     R
     (GRULayer
        (hiddenSize * NumberOfDirections directionality)
        hiddenSize
        directionality
        dtype
        device)
     _
forall k i c (p :: k). c -&gt; K1 i c p
</span><span class="hs-identifier hs-var">K1</span></span><span> </span><span class="annot"><span class="annottext">GRULayer
  (hiddenSize * NumberOfDirections directionality)
  hiddenSize
  directionality
  dtype
  device
</span><a href="#local-6989586621679807111"><span class="hs-identifier hs-var">gruLayer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679807119"><span class="hs-identifier hs-type">layer</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">HList parameters
</span><a href="#local-6989586621679807110"><span class="hs-identifier hs-var">parameters</span></a></span><span> </span><span class="annot"><span class="annottext">HList parameters -&gt; HList parameters' -&gt; HList parameters''
forall k (a :: [k]) (b :: [k]) (ab :: [k]).
HAppendFD a b ab =&gt;
HList a -&gt; HList b -&gt; HList ab
</span><a href="Torch.HList.html#happendFD"><span class="hs-operator hs-var">`happendFD`</span></a></span><span> </span><span class="annot"><span class="annottext">HList parameters'
</span><a href="#local-6989586621679807109"><span class="hs-identifier hs-var">parameters'</span></a></span><span>
</span><span id="line-226"></span><span>  </span><span id="local-6989586621679807107"><span class="annot"><span class="annottext">gReplaceParameters :: K1
  R
  (GRULayerStack
     inputSize hiddenSize numLayers directionality dtype device)
  a
-&gt; HList parameters''
-&gt; K1
     R
     (GRULayerStack
        inputSize hiddenSize numLayers directionality dtype device)
     a
</span><a href="#local-6989586621679807107"><span class="hs-identifier hs-var hs-var hs-var hs-var">gReplaceParameters</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayerK"><span class="hs-identifier hs-type">GRULayerK</span></a></span><span> </span><span id="local-6989586621679807106"><span class="annot"><span class="annottext">gruLayerStack :: GRULayerStack
  inputSize hiddenSize (numLayers - 1) directionality dtype device
</span><a href="#local-6989586621679807106"><span class="hs-identifier hs-var">gruLayerStack</span></a></span></span><span> </span><span id="local-6989586621679807105"><span class="annot"><span class="annottext">gruLayer :: GRULayer
  (hiddenSize * NumberOfDirections directionality)
  hiddenSize
  directionality
  dtype
  device
</span><a href="#local-6989586621679807105"><span class="hs-identifier hs-var">gruLayer</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679807104"><span class="annot"><span class="annottext">parameters'' :: HList parameters''
</span><a href="#local-6989586621679807104"><span class="hs-identifier hs-var">parameters''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-227"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679807103"><span class="annot"><span class="annottext">parameters :: HList parameters
</span><a href="#local-6989586621679807103"><span class="hs-identifier hs-var">parameters</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679807102"><span class="annot"><span class="annottext">parameters' :: HList parameters'
</span><a href="#local-6989586621679807102"><span class="hs-identifier hs-var">parameters'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HList parameters'' -&gt; (HList parameters, HList parameters')
forall k (a :: [k]) (b :: [k]) (ab :: [k]).
HAppendFD a b ab =&gt;
HList ab -&gt; (HList a, HList b)
</span><a href="Torch.HList.html#hunappendFD"><span class="hs-identifier hs-var">hunappendFD</span></a></span><span> </span><span class="annot"><span class="annottext">HList parameters''
</span><a href="#local-6989586621679807104"><span class="hs-identifier hs-var">parameters''</span></a></span><span>
</span><span id="line-228"></span><span>        </span><span id="local-6989586621679807100"><span class="annot"><span class="annottext">gruLayerStack' :: GRULayerStack
  inputSize hiddenSize (numLayers - 1) directionality dtype device
</span><a href="#local-6989586621679807100"><span class="hs-identifier hs-var hs-var">gruLayerStack'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">K1
  R
  (GRULayerStack
     inputSize hiddenSize (numLayers - 1) directionality dtype device)
  Any
-&gt; GRULayerStack
     inputSize hiddenSize (numLayers - 1) directionality dtype device
forall i c k (p :: k). K1 i c p -&gt; c
</span><span class="hs-identifier hs-var hs-var">unK1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">layerStack Any -&gt; HList parameters -&gt; layerStack Any
forall (f :: Type -&gt; Type) (as :: [Type]) a.
GParameterized f as =&gt;
f a -&gt; HList as -&gt; f a
</span><a href="Torch.Typed.Parameter.html#gReplaceParameters"><span class="hs-identifier hs-var">gReplaceParameters</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GRULayerStack
  inputSize hiddenSize (numLayers - 1) directionality dtype device
-&gt; K1
     R
     (GRULayerStack
        inputSize hiddenSize (numLayers - 1) directionality dtype device)
     _
forall k i c (p :: k). c -&gt; K1 i c p
</span><span class="hs-identifier hs-var">K1</span></span><span> </span><span class="annot"><span class="annottext">GRULayerStack
  inputSize hiddenSize (numLayers - 1) directionality dtype device
</span><a href="#local-6989586621679807106"><span class="hs-identifier hs-var">gruLayerStack</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679807125"><span class="hs-identifier hs-type">layerStack</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HList parameters
</span><a href="#local-6989586621679807103"><span class="hs-identifier hs-var">parameters</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span>        </span><span id="local-6989586621679807099"><span class="annot"><span class="annottext">gruLayer' :: GRULayer
  (hiddenSize * NumberOfDirections directionality)
  hiddenSize
  directionality
  dtype
  device
</span><a href="#local-6989586621679807099"><span class="hs-identifier hs-var hs-var">gruLayer'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">K1
  R
  (GRULayer
     (hiddenSize * NumberOfDirections directionality)
     hiddenSize
     directionality
     dtype
     device)
  Any
-&gt; GRULayer
     (hiddenSize * NumberOfDirections directionality)
     hiddenSize
     directionality
     dtype
     device
forall i c k (p :: k). K1 i c p -&gt; c
</span><span class="hs-identifier hs-var hs-var">unK1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">layer Any -&gt; HList parameters' -&gt; layer Any
forall (f :: Type -&gt; Type) (as :: [Type]) a.
GParameterized f as =&gt;
f a -&gt; HList as -&gt; f a
</span><a href="Torch.Typed.Parameter.html#gReplaceParameters"><span class="hs-identifier hs-var">gReplaceParameters</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GRULayer
  (hiddenSize * NumberOfDirections directionality)
  hiddenSize
  directionality
  dtype
  device
-&gt; K1
     R
     (GRULayer
        (hiddenSize * NumberOfDirections directionality)
        hiddenSize
        directionality
        dtype
        device)
     _
forall k i c (p :: k). c -&gt; K1 i c p
</span><span class="hs-identifier hs-var">K1</span></span><span> </span><span class="annot"><span class="annottext">GRULayer
  (hiddenSize * NumberOfDirections directionality)
  hiddenSize
  directionality
  dtype
  device
</span><a href="#local-6989586621679807105"><span class="hs-identifier hs-var">gruLayer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679807119"><span class="hs-identifier hs-type">layer</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HList parameters'
</span><a href="#local-6989586621679807102"><span class="hs-identifier hs-var">parameters'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">GRULayerStack
  inputSize hiddenSize numLayers directionality dtype device
-&gt; K1
     R
     (GRULayerStack
        inputSize hiddenSize numLayers directionality dtype device)
     a
forall k i c (p :: k). c -&gt; K1 i c p
</span><span class="hs-identifier hs-var">K1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GRULayerStack
  inputSize hiddenSize (numLayers - 1) directionality dtype device
-&gt; GRULayer
     (hiddenSize * NumberOfDirections directionality)
     hiddenSize
     directionality
     dtype
     device
-&gt; GRULayerStack
     inputSize hiddenSize numLayers directionality dtype device
forall (numLayers :: Nat) (inputSize :: Nat) (hiddenSize :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)).
(2 &lt;= numLayers) =&gt;
GRULayerStack
  inputSize hiddenSize (numLayers - 1) directionality dtype device
-&gt; GRULayer
     (hiddenSize * NumberOfDirections directionality)
     hiddenSize
     directionality
     dtype
     device
-&gt; GRULayerStack
     inputSize hiddenSize numLayers directionality dtype device
</span><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayerK"><span class="hs-identifier hs-var">GRULayerK</span></a></span><span> </span><span class="annot"><span class="annottext">GRULayerStack
  inputSize hiddenSize (numLayers - 1) directionality dtype device
</span><a href="#local-6989586621679807100"><span class="hs-identifier hs-var">gruLayerStack'</span></a></span><span> </span><span class="annot"><span class="annottext">GRULayer
  (hiddenSize * NumberOfDirections directionality)
  hiddenSize
  directionality
  dtype
  device
</span><a href="#local-6989586621679807099"><span class="hs-identifier hs-var">gruLayer'</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span id="local-6989586621679807094"><span id="local-6989586621679807095"><span id="local-6989586621679807096"><span id="local-6989586621679807097"><span id="local-6989586621679807098"><span class="hs-keyword">instance</span><span>
</span><span id="line-233"></span><span>  </span><span class="hs-pragma">{-# OVERLAPS</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-234"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.Typed.Factories.html#RandDTypeIsValid"><span class="hs-identifier hs-type">RandDTypeIsValid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807098"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807097"><span class="hs-identifier hs-type">dtype</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-235"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679807096"><span class="hs-identifier hs-type">inputSize</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-236"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679807095"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-237"></span><span>    </span><span class="annot"><a href="Torch.Typed.Tensor.html#KnownDType"><span class="hs-identifier hs-type">KnownDType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807097"><span class="hs-identifier hs-type">dtype</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-238"></span><span>    </span><span class="annot"><a href="Torch.Typed.Tensor.html#KnownDevice"><span class="hs-identifier hs-type">KnownDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807098"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-239"></span><span>    </span><span class="annot"><a href="Torch.NN.html#Randomizable"><span class="hs-identifier hs-type">A.Randomizable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayerSpec"><span class="hs-identifier hs-type">GRULayerSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807096"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807095"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807094"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807097"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807098"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayer"><span class="hs-identifier hs-type">GRULayer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807096"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807095"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807094"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807097"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807098"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-242"></span><span>  </span><span class="annot"><a href="Torch.NN.html#Randomizable"><span class="hs-identifier hs-type">A.Randomizable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayerStackSpec"><span class="hs-identifier hs-type">GRULayerStackSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807096"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807095"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><a href="#local-6989586621679807094"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807097"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807098"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayerStack"><span class="hs-identifier hs-type">GRULayerStack</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807096"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807095"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><a href="#local-6989586621679807094"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807097"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807098"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-245"></span><span>  </span><span id="local-6989586621679807092"><span class="annot"><span class="annottext">sample :: GRULayerStackSpec
  inputSize hiddenSize 1 directionality dtype device
-&gt; IO
     (GRULayerStack inputSize hiddenSize 1 directionality dtype device)
</span><a href="#local-6989586621679807092"><span class="hs-identifier hs-var hs-var hs-var hs-var">sample</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GRULayer inputSize hiddenSize directionality dtype device
-&gt; GRULayerStack inputSize hiddenSize 1 directionality dtype device
forall (inputSize :: Nat) (hiddenSize :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)).
GRULayer inputSize hiddenSize directionality dtype device
-&gt; GRULayerStack inputSize hiddenSize 1 directionality dtype device
</span><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayer1"><span class="hs-identifier hs-var">GRULayer1</span></a></span><span> </span><span class="annot"><span class="annottext">(GRULayer inputSize hiddenSize directionality dtype device
 -&gt; GRULayerStack
      inputSize hiddenSize 1 directionality dtype device)
-&gt; IO (GRULayer inputSize hiddenSize directionality dtype device)
-&gt; IO
     (GRULayerStack inputSize hiddenSize 1 directionality dtype device)
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GRULayerSpec inputSize hiddenSize directionality dtype device
-&gt; IO (GRULayer inputSize hiddenSize directionality dtype device)
forall spec f. Randomizable spec f =&gt; spec -&gt; IO f
</span><a href="Torch.NN.html#sample"><span class="hs-identifier hs-var">A.sample</span></a></span><span> </span><span class="annot"><span class="annottext">(GRULayerSpec inputSize hiddenSize directionality dtype device
 -&gt; IO (GRULayer inputSize hiddenSize directionality dtype device))
-&gt; GRULayerSpec inputSize hiddenSize directionality dtype device
-&gt; IO (GRULayer inputSize hiddenSize directionality dtype device)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GRULayerSpec inputSize hiddenSize directionality dtype device
forall (inputSize :: Nat) (hiddenSize :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)).
GRULayerSpec inputSize hiddenSize directionality dtype device
</span><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayerSpec"><span class="hs-identifier hs-var">GRULayerSpec</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807096"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807095"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807094"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807097"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807098"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span id="local-6989586621679807086"><span id="local-6989586621679807087"><span id="local-6989586621679807088"><span id="local-6989586621679807089"><span id="local-6989586621679807090"><span id="local-6989586621679807091"><span class="hs-keyword">instance</span><span>
</span><span id="line-248"></span><span>  </span><span class="hs-pragma">{-# OVERLAPPABLE</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-249"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;=</span></span><span> </span><span class="annot"><a href="#local-6989586621679807091"><span class="hs-identifier hs-type">numLayers</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-250"></span><span>    </span><span class="annot"><a href="Torch.Typed.Factories.html#RandDTypeIsValid"><span class="hs-identifier hs-type">RandDTypeIsValid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807090"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807089"><span class="hs-identifier hs-type">dtype</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-251"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679807088"><span class="hs-identifier hs-type">inputSize</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-252"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679807087"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-253"></span><span>    </span><span class="annot"><a href="Torch.Typed.Tensor.html#KnownDType"><span class="hs-identifier hs-type">KnownDType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807089"><span class="hs-identifier hs-type">dtype</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-254"></span><span>    </span><span class="annot"><a href="Torch.Typed.Tensor.html#KnownDevice"><span class="hs-identifier hs-type">KnownDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807090"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-255"></span><span>    </span><span class="annot"><a href="Torch.NN.html#Randomizable"><span class="hs-identifier hs-type">A.Randomizable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayerStackSpec"><span class="hs-identifier hs-type">GRULayerStackSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807088"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807087"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679807091"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679807086"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807089"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807090"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayerStack"><span class="hs-identifier hs-type">GRULayerStack</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807088"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807087"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679807091"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679807086"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807089"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807090"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-257"></span><span>    </span><span class="annot"><a href="Torch.NN.html#Randomizable"><span class="hs-identifier hs-type">A.Randomizable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayerSpec"><span class="hs-identifier hs-type">GRULayerSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679807087"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">*</span></span><span> </span><span class="annot"><a href="Torch.Typed.Functional.html#NumberOfDirections"><span class="hs-identifier hs-type">NumberOfDirections</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807086"><span class="hs-identifier hs-type">directionality</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679807087"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807086"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807089"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807090"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayer"><span class="hs-identifier hs-type">GRULayer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679807087"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">*</span></span><span> </span><span class="annot"><a href="Torch.Typed.Functional.html#NumberOfDirections"><span class="hs-identifier hs-type">NumberOfDirections</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807086"><span class="hs-identifier hs-type">directionality</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679807087"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807086"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807089"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807090"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-260"></span><span>  </span><span class="annot"><a href="Torch.NN.html#Randomizable"><span class="hs-identifier hs-type">A.Randomizable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayerStackSpec"><span class="hs-identifier hs-type">GRULayerStackSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807088"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807087"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807091"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807086"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807089"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807090"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayerStack"><span class="hs-identifier hs-type">GRULayerStack</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807088"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807087"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807091"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807086"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807089"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807090"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-263"></span><span>  </span><span id="local-6989586621679807084"><span class="annot"><span class="annottext">sample :: GRULayerStackSpec
  inputSize hiddenSize numLayers directionality dtype device
-&gt; IO
     (GRULayerStack
        inputSize hiddenSize numLayers directionality dtype device)
</span><a href="#local-6989586621679807084"><span class="hs-identifier hs-var hs-var hs-var hs-var">sample</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-264"></span><span>    </span><span class="annot"><span class="annottext">GRULayerStack
  inputSize hiddenSize (numLayers - 1) directionality dtype device
-&gt; GRULayer
     (hiddenSize * NumberOfDirections directionality)
     hiddenSize
     directionality
     dtype
     device
-&gt; GRULayerStack
     inputSize hiddenSize numLayers directionality dtype device
forall (numLayers :: Nat) (inputSize :: Nat) (hiddenSize :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)).
(2 &lt;= numLayers) =&gt;
GRULayerStack
  inputSize hiddenSize (numLayers - 1) directionality dtype device
-&gt; GRULayer
     (hiddenSize * NumberOfDirections directionality)
     hiddenSize
     directionality
     dtype
     device
-&gt; GRULayerStack
     inputSize hiddenSize numLayers directionality dtype device
</span><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayerK"><span class="hs-identifier hs-var">GRULayerK</span></a></span><span>
</span><span id="line-265"></span><span>      </span><span class="annot"><span class="annottext">(GRULayerStack
   inputSize hiddenSize (numLayers - 1) directionality dtype device
 -&gt; GRULayer
      (hiddenSize * NumberOfDirections directionality)
      hiddenSize
      directionality
      dtype
      device
 -&gt; GRULayerStack
      inputSize hiddenSize numLayers directionality dtype device)
-&gt; IO
     (GRULayerStack
        inputSize hiddenSize (numLayers - 1) directionality dtype device)
-&gt; IO
     (GRULayer
        (hiddenSize * NumberOfDirections directionality)
        hiddenSize
        directionality
        dtype
        device
      -&gt; GRULayerStack
           inputSize hiddenSize numLayers directionality dtype device)
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GRULayerStackSpec
  inputSize hiddenSize (numLayers - 1) directionality dtype device
-&gt; IO
     (GRULayerStack
        inputSize hiddenSize (numLayers - 1) directionality dtype device)
forall spec f. Randomizable spec f =&gt; spec -&gt; IO f
</span><a href="Torch.NN.html#sample"><span class="hs-identifier hs-var">A.sample</span></a></span><span> </span><span class="annot"><span class="annottext">(GRULayerStackSpec
   inputSize hiddenSize (numLayers - 1) directionality dtype device
 -&gt; IO
      (GRULayerStack
         inputSize hiddenSize (numLayers - 1) directionality dtype device))
-&gt; GRULayerStackSpec
     inputSize hiddenSize (numLayers - 1) directionality dtype device
-&gt; IO
     (GRULayerStack
        inputSize hiddenSize (numLayers - 1) directionality dtype device)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GRULayerStackSpec
  inputSize hiddenSize (numLayers - 1) directionality dtype device
forall (inputSize :: Nat) (hiddenSize :: Nat) (numLayers :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)).
GRULayerStackSpec
  inputSize hiddenSize numLayers directionality dtype device
</span><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayerStackSpec"><span class="hs-identifier hs-var">GRULayerStackSpec</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807088"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807087"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679807091"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807086"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807089"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807090"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span>      </span><span class="annot"><span class="annottext">IO
  (GRULayer
     (hiddenSize * NumberOfDirections directionality)
     hiddenSize
     directionality
     dtype
     device
   -&gt; GRULayerStack
        inputSize hiddenSize numLayers directionality dtype device)
-&gt; IO
     (GRULayer
        (hiddenSize * NumberOfDirections directionality)
        hiddenSize
        directionality
        dtype
        device)
-&gt; IO
     (GRULayerStack
        inputSize hiddenSize numLayers directionality dtype device)
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GRULayerSpec
  (hiddenSize * NumberOfDirections directionality)
  hiddenSize
  directionality
  dtype
  device
-&gt; IO
     (GRULayer
        (hiddenSize * NumberOfDirections directionality)
        hiddenSize
        directionality
        dtype
        device)
forall spec f. Randomizable spec f =&gt; spec -&gt; IO f
</span><a href="Torch.NN.html#sample"><span class="hs-identifier hs-var">A.sample</span></a></span><span> </span><span class="annot"><span class="annottext">(GRULayerSpec
   (hiddenSize * NumberOfDirections directionality)
   hiddenSize
   directionality
   dtype
   device
 -&gt; IO
      (GRULayer
         (hiddenSize * NumberOfDirections directionality)
         hiddenSize
         directionality
         dtype
         device))
-&gt; GRULayerSpec
     (hiddenSize * NumberOfDirections directionality)
     hiddenSize
     directionality
     dtype
     device
-&gt; IO
     (GRULayer
        (hiddenSize * NumberOfDirections directionality)
        hiddenSize
        directionality
        dtype
        device)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GRULayerSpec
  (hiddenSize * NumberOfDirections directionality)
  hiddenSize
  directionality
  dtype
  device
forall (inputSize :: Nat) (hiddenSize :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)).
GRULayerSpec inputSize hiddenSize directionality dtype device
</span><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayerSpec"><span class="hs-identifier hs-var">GRULayerSpec</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679807087"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">*</span></span><span> </span><span class="annot"><a href="Torch.Typed.Functional.html#NumberOfDirections"><span class="hs-identifier hs-type">NumberOfDirections</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807086"><span class="hs-identifier hs-type">directionality</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807087"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807086"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807089"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807090"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span id="local-6989586621679807082"><span id="local-6989586621679807083"></span></span><span class="hs-keyword">newtype</span><span>
</span><span id="line-269"></span><span>  </span><span id="GRUSpec"><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUSpec"><span class="hs-identifier hs-var">GRUSpec</span></a></span></span><span>
</span><span id="line-270"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807081"><span class="annot"><a href="#local-6989586621679807081"><span class="hs-identifier hs-type">inputSize</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807080"><span class="annot"><a href="#local-6989586621679807080"><span class="hs-identifier hs-type">hiddenSize</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807079"><span class="annot"><a href="#local-6989586621679807079"><span class="hs-identifier hs-type">numLayers</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807078"><span class="annot"><a href="#local-6989586621679807078"><span class="hs-identifier hs-type">directionality</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.Typed.Functional.html#RNNDirectionality"><span class="hs-identifier hs-type">RNNDirectionality</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-274"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807077"><span class="annot"><a href="#local-6989586621679807077"><span class="hs-identifier hs-type">dtype</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.DType.html#DType"><span class="hs-identifier hs-type">D.DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807076"><span class="annot"><a href="#local-6989586621679807076"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Device.html#DeviceType"><span class="hs-identifier hs-type">D.DeviceType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-276"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="GRUSpec"><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUSpec"><span class="hs-identifier hs-var">GRUSpec</span></a></span></span><span> </span><span class="annot"><a href="Torch.Typed.NN.Dropout.html#DropoutSpec"><span class="hs-identifier hs-type">DropoutSpec</span></a></span><span>
</span><span id="line-277"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679807069"><span id="local-6989586621679807071"><span id="local-6989586621679807073"><span class="annot"><span class="annottext">Int
-&gt; GRUSpec
     inputSize hiddenSize numLayers directionality dtype device
-&gt; ShowS
[GRUSpec
   inputSize hiddenSize numLayers directionality dtype device]
-&gt; ShowS
GRUSpec inputSize hiddenSize numLayers directionality dtype device
-&gt; String
(Int
 -&gt; GRUSpec
      inputSize hiddenSize numLayers directionality dtype device
 -&gt; ShowS)
-&gt; (GRUSpec
      inputSize hiddenSize numLayers directionality dtype device
    -&gt; String)
-&gt; ([GRUSpec
       inputSize hiddenSize numLayers directionality dtype device]
    -&gt; ShowS)
-&gt; Show
     (GRUSpec
        inputSize hiddenSize numLayers directionality dtype device)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall (inputSize :: Nat) (hiddenSize :: Nat) (numLayers :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)).
Int
-&gt; GRUSpec
     inputSize hiddenSize numLayers directionality dtype device
-&gt; ShowS
forall (inputSize :: Nat) (hiddenSize :: Nat) (numLayers :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)).
[GRUSpec
   inputSize hiddenSize numLayers directionality dtype device]
-&gt; ShowS
forall (inputSize :: Nat) (hiddenSize :: Nat) (numLayers :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)).
GRUSpec inputSize hiddenSize numLayers directionality dtype device
-&gt; String
showList :: [GRUSpec
   inputSize hiddenSize numLayers directionality dtype device]
-&gt; ShowS
$cshowList :: forall (inputSize :: Nat) (hiddenSize :: Nat) (numLayers :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)).
[GRUSpec
   inputSize hiddenSize numLayers directionality dtype device]
-&gt; ShowS
show :: GRUSpec inputSize hiddenSize numLayers directionality dtype device
-&gt; String
$cshow :: forall (inputSize :: Nat) (hiddenSize :: Nat) (numLayers :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)).
GRUSpec inputSize hiddenSize numLayers directionality dtype device
-&gt; String
showsPrec :: Int
-&gt; GRUSpec
     inputSize hiddenSize numLayers directionality dtype device
-&gt; ShowS
$cshowsPrec :: forall (inputSize :: Nat) (hiddenSize :: Nat) (numLayers :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)).
Int
-&gt; GRUSpec
     inputSize hiddenSize numLayers directionality dtype device
-&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x.
 GRUSpec inputSize hiddenSize numLayers directionality dtype device
 -&gt; Rep
      (GRUSpec
         inputSize hiddenSize numLayers directionality dtype device)
      x)
-&gt; (forall x.
    Rep
      (GRUSpec
         inputSize hiddenSize numLayers directionality dtype device)
      x
    -&gt; GRUSpec
         inputSize hiddenSize numLayers directionality dtype device)
-&gt; Generic
     (GRUSpec
        inputSize hiddenSize numLayers directionality dtype device)
forall x.
Rep
  (GRUSpec
     inputSize hiddenSize numLayers directionality dtype device)
  x
-&gt; GRUSpec
     inputSize hiddenSize numLayers directionality dtype device
forall x.
GRUSpec inputSize hiddenSize numLayers directionality dtype device
-&gt; Rep
     (GRUSpec
        inputSize hiddenSize numLayers directionality dtype device)
     x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall (inputSize :: Nat) (hiddenSize :: Nat) (numLayers :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)) x.
Rep
  (GRUSpec
     inputSize hiddenSize numLayers directionality dtype device)
  x
-&gt; GRUSpec
     inputSize hiddenSize numLayers directionality dtype device
forall (inputSize :: Nat) (hiddenSize :: Nat) (numLayers :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)) x.
GRUSpec inputSize hiddenSize numLayers directionality dtype device
-&gt; Rep
     (GRUSpec
        inputSize hiddenSize numLayers directionality dtype device)
     x
$cto :: forall (inputSize :: Nat) (hiddenSize :: Nat) (numLayers :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)) x.
Rep
  (GRUSpec
     inputSize hiddenSize numLayers directionality dtype device)
  x
-&gt; GRUSpec
     inputSize hiddenSize numLayers directionality dtype device
$cfrom :: forall (inputSize :: Nat) (hiddenSize :: Nat) (numLayers :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)) x.
GRUSpec inputSize hiddenSize numLayers directionality dtype device
-&gt; Rep
     (GRUSpec
        inputSize hiddenSize numLayers directionality dtype device)
     x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span>
</span><span id="line-279"></span><span id="local-6989586621679807064"><span id="local-6989586621679807065"></span></span><span class="hs-keyword">data</span><span>
</span><span id="line-280"></span><span>  </span><span id="GRU"><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRU"><span class="hs-identifier hs-var">GRU</span></a></span></span><span>
</span><span id="line-281"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807471"><span class="annot"><a href="#local-6989586621679807471"><span class="hs-identifier hs-type">inputSize</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807470"><span class="annot"><a href="#local-6989586621679807470"><span class="hs-identifier hs-type">hiddenSize</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807469"><span class="annot"><a href="#local-6989586621679807469"><span class="hs-identifier hs-type">numLayers</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span>
</span><span id="line-284"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807468"><span class="annot"><a href="#local-6989586621679807468"><span class="hs-identifier hs-type">directionality</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.Typed.Functional.html#RNNDirectionality"><span class="hs-identifier hs-type">RNNDirectionality</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-285"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807467"><span class="annot"><a href="#local-6989586621679807467"><span class="hs-identifier hs-type">dtype</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.DType.html#DType"><span class="hs-identifier hs-type">D.DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807466"><span class="annot"><a href="#local-6989586621679807466"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Device.html#DeviceType"><span class="hs-identifier hs-type">D.DeviceType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-287"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="GRU"><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRU"><span class="hs-identifier hs-var">GRU</span></a></span></span><span>
</span><span id="line-288"></span><span>      </span><span class="hs-special">{</span><span> </span><span id="gru_layer_stack"><span class="annot"><span class="annottext">GRU inputSize hiddenSize numLayers directionality dtype device
-&gt; GRULayerStack
     inputSize hiddenSize numLayers directionality dtype device
</span><a href="Torch.Typed.NN.Recurrent.GRU.html#gru_layer_stack"><span class="hs-identifier hs-var hs-var">gru_layer_stack</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayerStack"><span class="hs-identifier hs-type">GRULayerStack</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807471"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807470"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807469"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807468"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807467"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807466"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-289"></span><span>        </span><span id="gru_dropout"><span class="annot"><span class="annottext">GRU inputSize hiddenSize numLayers directionality dtype device
-&gt; Dropout
</span><a href="Torch.Typed.NN.Recurrent.GRU.html#gru_dropout"><span class="hs-identifier hs-var hs-var">gru_dropout</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.Typed.NN.Dropout.html#Dropout"><span class="hs-identifier hs-type">Dropout</span></a></span><span>
</span><span id="line-290"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-291"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679807055"><span id="local-6989586621679807057"><span id="local-6989586621679807059"><span class="annot"><span class="annottext">Int
-&gt; GRU inputSize hiddenSize numLayers directionality dtype device
-&gt; ShowS
[GRU inputSize hiddenSize numLayers directionality dtype device]
-&gt; ShowS
GRU inputSize hiddenSize numLayers directionality dtype device
-&gt; String
(Int
 -&gt; GRU inputSize hiddenSize numLayers directionality dtype device
 -&gt; ShowS)
-&gt; (GRU inputSize hiddenSize numLayers directionality dtype device
    -&gt; String)
-&gt; ([GRU
       inputSize hiddenSize numLayers directionality dtype device]
    -&gt; ShowS)
-&gt; Show
     (GRU inputSize hiddenSize numLayers directionality dtype device)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall (inputSize :: Nat) (hiddenSize :: Nat) (numLayers :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)).
Int
-&gt; GRU inputSize hiddenSize numLayers directionality dtype device
-&gt; ShowS
forall (inputSize :: Nat) (hiddenSize :: Nat) (numLayers :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)).
[GRU inputSize hiddenSize numLayers directionality dtype device]
-&gt; ShowS
forall (inputSize :: Nat) (hiddenSize :: Nat) (numLayers :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)).
GRU inputSize hiddenSize numLayers directionality dtype device
-&gt; String
showList :: [GRU inputSize hiddenSize numLayers directionality dtype device]
-&gt; ShowS
$cshowList :: forall (inputSize :: Nat) (hiddenSize :: Nat) (numLayers :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)).
[GRU inputSize hiddenSize numLayers directionality dtype device]
-&gt; ShowS
show :: GRU inputSize hiddenSize numLayers directionality dtype device
-&gt; String
$cshow :: forall (inputSize :: Nat) (hiddenSize :: Nat) (numLayers :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)).
GRU inputSize hiddenSize numLayers directionality dtype device
-&gt; String
showsPrec :: Int
-&gt; GRU inputSize hiddenSize numLayers directionality dtype device
-&gt; ShowS
$cshowsPrec :: forall (inputSize :: Nat) (hiddenSize :: Nat) (numLayers :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)).
Int
-&gt; GRU inputSize hiddenSize numLayers directionality dtype device
-&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x.
 GRU inputSize hiddenSize numLayers directionality dtype device
 -&gt; Rep
      (GRU inputSize hiddenSize numLayers directionality dtype device) x)
-&gt; (forall x.
    Rep
      (GRU inputSize hiddenSize numLayers directionality dtype device) x
    -&gt; GRU inputSize hiddenSize numLayers directionality dtype device)
-&gt; Generic
     (GRU inputSize hiddenSize numLayers directionality dtype device)
forall x.
Rep
  (GRU inputSize hiddenSize numLayers directionality dtype device) x
-&gt; GRU inputSize hiddenSize numLayers directionality dtype device
forall x.
GRU inputSize hiddenSize numLayers directionality dtype device
-&gt; Rep
     (GRU inputSize hiddenSize numLayers directionality dtype device) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall (inputSize :: Nat) (hiddenSize :: Nat) (numLayers :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)) x.
Rep
  (GRU inputSize hiddenSize numLayers directionality dtype device) x
-&gt; GRU inputSize hiddenSize numLayers directionality dtype device
forall (inputSize :: Nat) (hiddenSize :: Nat) (numLayers :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)) x.
GRU inputSize hiddenSize numLayers directionality dtype device
-&gt; Rep
     (GRU inputSize hiddenSize numLayers directionality dtype device) x
$cto :: forall (inputSize :: Nat) (hiddenSize :: Nat) (numLayers :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)) x.
Rep
  (GRU inputSize hiddenSize numLayers directionality dtype device) x
-&gt; GRU inputSize hiddenSize numLayers directionality dtype device
$cfrom :: forall (inputSize :: Nat) (hiddenSize :: Nat) (numLayers :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)) x.
GRU inputSize hiddenSize numLayers directionality dtype device
-&gt; Rep
     (GRU inputSize hiddenSize numLayers directionality dtype device) x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span class="hs-comment">-- TODO: when we have cannonical initializers do this correctly:</span><span>
</span><span id="line-294"></span><span class="hs-comment">-- https://github.com/pytorch/pytorch/issues/9221</span><span>
</span><span id="line-295"></span><span class="hs-comment">-- https://discuss.pytorch.org/t/initializing-rnn-gru-and-gru-correctly/23605</span><span>
</span><span id="line-296"></span><span>
</span><span id="line-297"></span><span class="hs-comment">-- | Helper to do xavier uniform initializations on weight matrices and</span><span>
</span><span id="line-298"></span><span class="hs-comment">-- orthagonal initializations for the gates. (When implemented.)</span><span>
</span><span id="line-299"></span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#xavierUniformGRU"><span class="hs-identifier hs-type">xavierUniformGRU</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-300"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679807648"><span class="annot"><a href="#local-6989586621679807648"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679807651"><span class="annot"><a href="#local-6989586621679807651"><span class="hs-identifier hs-type">dtype</span></a></span></span><span> </span><span id="local-6989586621679807650"><span class="annot"><a href="#local-6989586621679807650"><span class="hs-identifier hs-type">hiddenSize</span></a></span></span><span> </span><span id="local-6989586621679807649"><span class="annot"><a href="#local-6989586621679807649"><span class="hs-identifier hs-type">featureSize</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-301"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.Typed.Tensor.html#KnownDType"><span class="hs-identifier hs-type">KnownDType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807651"><span class="hs-identifier hs-type">dtype</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-302"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679807650"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-303"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679807649"><span class="hs-identifier hs-type">featureSize</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-304"></span><span>    </span><span class="annot"><a href="Torch.Typed.Tensor.html#KnownDevice"><span class="hs-identifier hs-type">KnownDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807648"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-305"></span><span>    </span><span class="annot"><a href="Torch.Typed.Factories.html#RandDTypeIsValid"><span class="hs-identifier hs-type">RandDTypeIsValid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807648"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807651"><span class="hs-identifier hs-type">dtype</span></a></span><span>
</span><span id="line-306"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-307"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.Tensor.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807648"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807651"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">*</span></span><span> </span><span class="annot"><a href="#local-6989586621679807650"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679807649"><span class="hs-identifier hs-type">featureSize</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-308"></span><span id="xavierUniformGRU"><span class="annot"><span class="annottext">xavierUniformGRU :: IO (Tensor device dtype '[3 * hiddenSize, featureSize])
</span><a href="Torch.Typed.NN.Recurrent.GRU.html#xavierUniformGRU"><span class="hs-identifier hs-var hs-var">xavierUniformGRU</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-309"></span><span>  </span><span id="local-6989586621679807052"><span class="annot"><span class="annottext">Tensor device dtype '[3 * hiddenSize, featureSize]
</span><a href="#local-6989586621679807052"><span class="hs-identifier hs-var">init</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Tensor device dtype '[3 * hiddenSize, featureSize])
forall (shape :: [Nat]) (dtype :: DType)
       (device :: (DeviceType, Nat)).
(TensorOptions shape dtype device,
 RandDTypeIsValid device dtype) =&gt;
IO (Tensor device dtype shape)
</span><a href="Torch.Typed.Factories.html#randn"><span class="hs-identifier hs-var">randn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.Tensor.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807648"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807651"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">*</span></span><span> </span><span class="annot"><a href="#local-6989586621679807650"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679807649"><span class="hs-identifier hs-type">featureSize</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>  </span><span class="annot"><span class="annottext">Tensor -&gt; Tensor device dtype '[3 * hiddenSize, featureSize]
forall (device :: (DeviceType, Nat)) (dtype :: DType)
       (shape :: [Nat]).
Tensor -&gt; Tensor device dtype shape
</span><a href="Torch.Typed.Tensor.html#UnsafeMkTensor"><span class="hs-identifier hs-var">UnsafeMkTensor</span></a></span><span>
</span><span id="line-311"></span><span>    </span><span class="annot"><span class="annottext">(Tensor -&gt; Tensor device dtype '[3 * hiddenSize, featureSize])
-&gt; IO Tensor
-&gt; IO (Tensor device dtype '[3 * hiddenSize, featureSize])
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Tensor -&gt; Float -&gt; [Int] -&gt; IO Tensor
</span><a href="Torch.Typed.NN.Recurrent.Aux.html#xavierUniformFIXME"><span class="hs-identifier hs-var">xavierUniformFIXME</span></a></span><span>
</span><span id="line-312"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tensor device dtype '[3 * hiddenSize, featureSize] -&gt; Tensor
forall (device :: (DeviceType, Nat)) (dtype :: DType)
       (shape :: [Nat]).
Tensor device dtype shape -&gt; Tensor
</span><a href="Torch.Typed.Tensor.html#toDynamic"><span class="hs-identifier hs-var hs-var">toDynamic</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor device dtype '[3 * hiddenSize, featureSize]
</span><a href="#local-6989586621679807052"><span class="hs-identifier hs-var">init</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">5.0</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="hs-number">3</span></span><span class="hs-special">)</span><span>
</span><span id="line-314"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tensor device dtype '[3 * hiddenSize, featureSize] -&gt; [Int]
forall (device :: (DeviceType, Nat)) (dtype :: DType)
       (shape :: [Nat]).
TensorOptions shape dtype device =&gt;
Tensor device dtype shape -&gt; [Int]
</span><a href="Torch.Typed.Tensor.html#shape"><span class="hs-identifier hs-var">shape</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807648"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807651"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">*</span></span><span> </span><span class="annot"><a href="#local-6989586621679807650"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679807649"><span class="hs-identifier hs-type">featureSize</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Tensor device dtype '[3 * hiddenSize, featureSize]
</span><a href="#local-6989586621679807052"><span class="hs-identifier hs-var">init</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-315"></span><span>
</span><span id="line-316"></span><span id="local-6989586621679807040"><span id="local-6989586621679807041"><span id="local-6989586621679807042"><span id="local-6989586621679807043"><span id="local-6989586621679807044"><span id="local-6989586621679807045"><span class="hs-keyword">instance</span><span>
</span><span id="line-317"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.Typed.Tensor.html#KnownDType"><span class="hs-identifier hs-type">KnownDType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807045"><span class="hs-identifier hs-type">dtype</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-318"></span><span>    </span><span class="annot"><a href="Torch.Typed.Tensor.html#KnownDevice"><span class="hs-identifier hs-type">KnownDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807044"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-319"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679807043"><span class="hs-identifier hs-type">inputSize</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-320"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679807042"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-321"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.Functional.html#NumberOfDirections"><span class="hs-identifier hs-type">NumberOfDirections</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807041"><span class="hs-identifier hs-type">directionality</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-322"></span><span>    </span><span class="annot"><a href="Torch.Typed.Factories.html#RandDTypeIsValid"><span class="hs-identifier hs-type">RandDTypeIsValid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807044"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807045"><span class="hs-identifier hs-type">dtype</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-323"></span><span>    </span><span class="annot"><a href="Torch.NN.html#Randomizable"><span class="hs-identifier hs-type">A.Randomizable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayerStackSpec"><span class="hs-identifier hs-type">GRULayerStackSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807043"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807042"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807040"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807041"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807045"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807044"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-324"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayerStack"><span class="hs-identifier hs-type">GRULayerStack</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807043"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807042"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807040"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807041"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807045"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807044"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-325"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-326"></span><span>  </span><span class="annot"><a href="Torch.NN.html#Randomizable"><span class="hs-identifier hs-type">A.Randomizable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUSpec"><span class="hs-identifier hs-type">GRUSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807043"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807042"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807040"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807041"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807045"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807044"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-327"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRU"><span class="hs-identifier hs-type">GRU</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807043"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807042"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807040"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807041"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807045"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807044"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-328"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-329"></span><span>  </span><span id="local-6989586621679807038"><span class="annot"><span class="annottext">sample :: GRUSpec inputSize hiddenSize numLayers directionality dtype device
-&gt; IO
     (GRU inputSize hiddenSize numLayers directionality dtype device)
</span><a href="#local-6989586621679807038"><span class="hs-identifier hs-var hs-var hs-var hs-var">sample</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUSpec"><span class="hs-identifier hs-type">GRUSpec</span></a></span><span> </span><span id="local-6989586621679807037"><span class="annot"><span class="annottext">dropoutSpec :: DropoutSpec
</span><a href="#local-6989586621679807037"><span class="hs-identifier hs-var">dropoutSpec</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-330"></span><span>    </span><span class="annot"><span class="annottext">GRULayerStack
  inputSize hiddenSize numLayers directionality dtype device
-&gt; Dropout
-&gt; GRU inputSize hiddenSize numLayers directionality dtype device
forall (inputSize :: Nat) (hiddenSize :: Nat) (numLayers :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)).
GRULayerStack
  inputSize hiddenSize numLayers directionality dtype device
-&gt; Dropout
-&gt; GRU inputSize hiddenSize numLayers directionality dtype device
</span><a href="Torch.Typed.NN.Recurrent.GRU.html#GRU"><span class="hs-identifier hs-var">GRU</span></a></span><span>
</span><span id="line-331"></span><span>      </span><span class="annot"><span class="annottext">(GRULayerStack
   inputSize hiddenSize numLayers directionality dtype device
 -&gt; Dropout
 -&gt; GRU inputSize hiddenSize numLayers directionality dtype device)
-&gt; IO
     (GRULayerStack
        inputSize hiddenSize numLayers directionality dtype device)
-&gt; IO
     (Dropout
      -&gt; GRU inputSize hiddenSize numLayers directionality dtype device)
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">GRULayerStackSpec
  inputSize hiddenSize numLayers directionality dtype device
-&gt; IO
     (GRULayerStack
        inputSize hiddenSize numLayers directionality dtype device)
forall spec f. Randomizable spec f =&gt; spec -&gt; IO f
</span><a href="Torch.NN.html#sample"><span class="hs-identifier hs-var">A.sample</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GRULayerStackSpec
  inputSize hiddenSize numLayers directionality dtype device
forall (inputSize :: Nat) (hiddenSize :: Nat) (numLayers :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)).
GRULayerStackSpec
  inputSize hiddenSize numLayers directionality dtype device
</span><a href="Torch.Typed.NN.Recurrent.GRU.html#GRULayerStackSpec"><span class="hs-identifier hs-var">GRULayerStackSpec</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807043"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807042"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807040"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807041"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807045"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807044"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span>      </span><span class="annot"><span class="annottext">IO
  (Dropout
   -&gt; GRU inputSize hiddenSize numLayers directionality dtype device)
-&gt; IO Dropout
-&gt; IO
     (GRU inputSize hiddenSize numLayers directionality dtype device)
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">DropoutSpec -&gt; IO Dropout
forall spec f. Randomizable spec f =&gt; spec -&gt; IO f
</span><a href="Torch.NN.html#sample"><span class="hs-identifier hs-var">A.sample</span></a></span><span> </span><span class="annot"><span class="annottext">DropoutSpec
</span><a href="#local-6989586621679807037"><span class="hs-identifier hs-var">dropoutSpec</span></a></span></span></span></span></span></span></span><span>
</span><span id="line-333"></span><span>
</span><span id="line-334"></span><span class="hs-comment">-- | A specification for a long, short-term memory layer.</span><span>
</span><span id="line-335"></span><span class="hs-keyword">data</span><span>
</span><span id="line-336"></span><span>  </span><span id="GRUWithInitSpec"><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUWithInitSpec"><span class="hs-identifier hs-var">GRUWithInitSpec</span></a></span></span><span>
</span><span id="line-337"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807036"><span class="annot"><a href="#local-6989586621679807036"><span class="hs-identifier hs-type">inputSize</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807035"><span class="annot"><a href="#local-6989586621679807035"><span class="hs-identifier hs-type">hiddenSize</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span>
</span><span id="line-339"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807034"><span class="annot"><a href="#local-6989586621679807034"><span class="hs-identifier hs-type">numLayers</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span>
</span><span id="line-340"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807033"><span class="annot"><a href="#local-6989586621679807033"><span class="hs-identifier hs-type">directionality</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.Typed.Functional.html#RNNDirectionality"><span class="hs-identifier hs-type">RNNDirectionality</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-341"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807032"><span class="annot"><a href="#local-6989586621679807032"><span class="hs-identifier hs-type">initialization</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.Typed.NN.Recurrent.Aux.html#RNNInitialization"><span class="hs-identifier hs-type">RNNInitialization</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-342"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807031"><span class="annot"><a href="#local-6989586621679807031"><span class="hs-identifier hs-type">dtype</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.DType.html#DType"><span class="hs-identifier hs-type">D.DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807030"><span class="annot"><a href="#local-6989586621679807030"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Device.html#DeviceType"><span class="hs-identifier hs-type">D.DeviceType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-344"></span><span>  </span><span class="hs-comment">-- | Weights drawn from Xavier-Uniform</span><span>
</span><span id="line-345"></span><span>  </span><span class="hs-comment">--   with zeros-value initialized biases and cell states.</span><span>
</span><span id="line-346"></span><span>  </span><span id="GRUWithZerosInitSpec"><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUWithZerosInitSpec"><span class="hs-identifier hs-var">GRUWithZerosInitSpec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-347"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679807028"><span class="annot"><a href="#local-6989586621679807028"><span class="hs-identifier hs-type">inputSize</span></a></span></span><span> </span><span id="local-6989586621679807027"><span class="annot"><a href="#local-6989586621679807027"><span class="hs-identifier hs-type">hiddenSize</span></a></span></span><span> </span><span id="local-6989586621679807026"><span class="annot"><a href="#local-6989586621679807026"><span class="hs-identifier hs-type">numLayers</span></a></span></span><span> </span><span id="local-6989586621679807025"><span class="annot"><a href="#local-6989586621679807025"><span class="hs-identifier hs-type">directionality</span></a></span></span><span> </span><span id="local-6989586621679807024"><span class="annot"><a href="#local-6989586621679807024"><span class="hs-identifier hs-type">dtype</span></a></span></span><span> </span><span id="local-6989586621679807023"><span class="annot"><a href="#local-6989586621679807023"><span class="hs-identifier hs-type">device</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-348"></span><span>    </span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUSpec"><span class="hs-identifier hs-type">GRUSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807028"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807027"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807026"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807025"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807024"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807023"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-349"></span><span>    </span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUWithInitSpec"><span class="hs-identifier hs-type">GRUWithInitSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807028"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807027"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807026"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807025"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.Aux.html#ConstantInitialization"><span class="hs-identifier hs-type">ConstantInitialization</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807024"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807023"><span class="hs-identifier hs-type">device</span></a></span><span>
</span><span id="line-350"></span><span>  </span><span class="hs-comment">-- | Weights drawn from Xavier-Uniform</span><span>
</span><span id="line-351"></span><span>  </span><span class="hs-comment">--   with zeros-value initialized biases</span><span>
</span><span id="line-352"></span><span>  </span><span class="hs-comment">--   and user-provided cell states.</span><span>
</span><span id="line-353"></span><span>  </span><span id="GRUWithConstInitSpec"><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUWithConstInitSpec"><span class="hs-identifier hs-var">GRUWithConstInitSpec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-354"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679807021"><span class="annot"><a href="#local-6989586621679807021"><span class="hs-identifier hs-type">inputSize</span></a></span></span><span> </span><span id="local-6989586621679807020"><span class="annot"><a href="#local-6989586621679807020"><span class="hs-identifier hs-type">hiddenSize</span></a></span></span><span> </span><span id="local-6989586621679807019"><span class="annot"><a href="#local-6989586621679807019"><span class="hs-identifier hs-type">numLayers</span></a></span></span><span> </span><span id="local-6989586621679807018"><span class="annot"><a href="#local-6989586621679807018"><span class="hs-identifier hs-type">directionality</span></a></span></span><span> </span><span id="local-6989586621679807017"><span class="annot"><a href="#local-6989586621679807017"><span class="hs-identifier hs-type">dtype</span></a></span></span><span> </span><span id="local-6989586621679807016"><span class="annot"><a href="#local-6989586621679807016"><span class="hs-identifier hs-type">device</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-355"></span><span>    </span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUSpec"><span class="hs-identifier hs-type">GRUSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807021"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807020"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807019"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807018"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807017"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807016"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-356"></span><span>    </span><span class="hs-comment">-- | The initial values of the hidden state</span><span>
</span><span id="line-357"></span><span>    </span><span class="annot"><a href="Torch.Typed.Tensor.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807016"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807017"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679807019"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">*</span></span><span> </span><span class="annot"><a href="Torch.Typed.Functional.html#NumberOfDirections"><span class="hs-identifier hs-type">NumberOfDirections</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807018"><span class="hs-identifier hs-type">directionality</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679807020"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-358"></span><span>    </span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUWithInitSpec"><span class="hs-identifier hs-type">GRUWithInitSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807021"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807020"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807019"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807018"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.Aux.html#ConstantInitialization"><span class="hs-identifier hs-type">ConstantInitialization</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807017"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807016"><span class="hs-identifier hs-type">device</span></a></span><span>
</span><span id="line-359"></span><span>  </span><span class="hs-comment">-- | Weights drawn from Xavier-Uniform</span><span>
</span><span id="line-360"></span><span>  </span><span class="hs-comment">--   with zeros-value initialized biases</span><span>
</span><span id="line-361"></span><span>  </span><span class="hs-comment">--   and learned cell states.</span><span>
</span><span id="line-362"></span><span>  </span><span id="GRUWithLearnedInitSpec"><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUWithLearnedInitSpec"><span class="hs-identifier hs-var">GRUWithLearnedInitSpec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-363"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679807014"><span class="annot"><a href="#local-6989586621679807014"><span class="hs-identifier hs-type">inputSize</span></a></span></span><span> </span><span id="local-6989586621679807013"><span class="annot"><a href="#local-6989586621679807013"><span class="hs-identifier hs-type">hiddenSize</span></a></span></span><span> </span><span id="local-6989586621679807012"><span class="annot"><a href="#local-6989586621679807012"><span class="hs-identifier hs-type">numLayers</span></a></span></span><span> </span><span id="local-6989586621679807011"><span class="annot"><a href="#local-6989586621679807011"><span class="hs-identifier hs-type">directionality</span></a></span></span><span> </span><span id="local-6989586621679807010"><span class="annot"><a href="#local-6989586621679807010"><span class="hs-identifier hs-type">dtype</span></a></span></span><span> </span><span id="local-6989586621679807009"><span class="annot"><a href="#local-6989586621679807009"><span class="hs-identifier hs-type">device</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-364"></span><span>    </span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUSpec"><span class="hs-identifier hs-type">GRUSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807014"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807013"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807012"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807011"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807010"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807009"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-365"></span><span>    </span><span class="hs-comment">-- | The initial (learnable)</span><span>
</span><span id="line-366"></span><span>    </span><span class="hs-comment">-- values of the hidden state</span><span>
</span><span id="line-367"></span><span>    </span><span class="annot"><a href="Torch.Typed.Tensor.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807009"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807010"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679807012"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">*</span></span><span> </span><span class="annot"><a href="Torch.Typed.Functional.html#NumberOfDirections"><span class="hs-identifier hs-type">NumberOfDirections</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807011"><span class="hs-identifier hs-type">directionality</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679807013"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-368"></span><span>    </span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUWithInitSpec"><span class="hs-identifier hs-type">GRUWithInitSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807014"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807013"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807012"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807011"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.Aux.html#LearnedInitialization"><span class="hs-identifier hs-type">LearnedInitialization</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807010"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807009"><span class="hs-identifier hs-type">device</span></a></span><span>
</span><span id="line-369"></span><span>
</span><span id="line-370"></span><span id="local-6989586621679806996"><span id="local-6989586621679806998"><span id="local-6989586621679807000"><span id="local-6989586621679807002"><span id="local-6989586621679807003"><span id="local-6989586621679807004"><span id="local-6989586621679807005"><span id="local-6989586621679807006"><span id="local-6989586621679807007"><span id="local-6989586621679807008"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUWithInitSpec"><span class="hs-identifier hs-type">GRUWithInitSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807008"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807007"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807006"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807005"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807004"><span class="hs-identifier hs-type">initialization</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807003"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807002"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-371"></span><span>
</span><span id="line-372"></span><span class="hs-comment">-- deriving instance Generic (GRUWithInitSpec inputSize hiddenSize numLayers directionality initialization dtype device)</span><span>
</span><span id="line-373"></span><span>
</span><span id="line-374"></span><span class="hs-comment">-- | A long, short-term memory layer with either fixed initial</span><span>
</span><span id="line-375"></span><span class="hs-comment">-- states for the memory cells and hidden state or learnable</span><span>
</span><span id="line-376"></span><span class="hs-comment">-- inital states for the memory cells and hidden state.</span><span>
</span><span id="line-377"></span><span class="hs-keyword">data</span><span>
</span><span id="line-378"></span><span>  </span><span id="GRUWithInit"><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUWithInit"><span class="hs-identifier hs-var">GRUWithInit</span></a></span></span><span>
</span><span id="line-379"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679806995"><span class="annot"><a href="#local-6989586621679806995"><span class="hs-identifier hs-type">inputSize</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span>
</span><span id="line-380"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679806994"><span class="annot"><a href="#local-6989586621679806994"><span class="hs-identifier hs-type">hiddenSize</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span>
</span><span id="line-381"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679806993"><span class="annot"><a href="#local-6989586621679806993"><span class="hs-identifier hs-type">numLayers</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span>
</span><span id="line-382"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679806992"><span class="annot"><a href="#local-6989586621679806992"><span class="hs-identifier hs-type">directionality</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.Typed.Functional.html#RNNDirectionality"><span class="hs-identifier hs-type">RNNDirectionality</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-383"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679806991"><span class="annot"><a href="#local-6989586621679806991"><span class="hs-identifier hs-type">initialization</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.Typed.NN.Recurrent.Aux.html#RNNInitialization"><span class="hs-identifier hs-type">RNNInitialization</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-384"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679806990"><span class="annot"><a href="#local-6989586621679806990"><span class="hs-identifier hs-type">dtype</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.DType.html#DType"><span class="hs-identifier hs-type">D.DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-385"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679806989"><span class="annot"><a href="#local-6989586621679806989"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Device.html#DeviceType"><span class="hs-identifier hs-type">D.DeviceType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-386"></span><span>  </span><span id="GRUWithConstInit"><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUWithConstInit"><span class="hs-identifier hs-var">GRUWithConstInit</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-387"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679807415"><span class="annot"><a href="#local-6989586621679807415"><span class="hs-identifier hs-type">inputSize</span></a></span></span><span> </span><span id="local-6989586621679807414"><span class="annot"><a href="#local-6989586621679807414"><span class="hs-identifier hs-type">hiddenSize</span></a></span></span><span> </span><span id="local-6989586621679807413"><span class="annot"><a href="#local-6989586621679807413"><span class="hs-identifier hs-type">numLayers</span></a></span></span><span> </span><span id="local-6989586621679807412"><span class="annot"><a href="#local-6989586621679807412"><span class="hs-identifier hs-type">directionality</span></a></span></span><span> </span><span id="local-6989586621679807411"><span class="annot"><a href="#local-6989586621679807411"><span class="hs-identifier hs-type">dtype</span></a></span></span><span> </span><span id="local-6989586621679807410"><span class="annot"><a href="#local-6989586621679807410"><span class="hs-identifier hs-type">device</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-388"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="gruWithConstInit_gru"><span class="annot"><span class="annottext">GRUWithInit
  inputSize
  hiddenSize
  numLayers
  directionality
  'ConstantInitialization
  dtype
  device
-&gt; GRU inputSize hiddenSize numLayers directionality dtype device
</span><a href="Torch.Typed.NN.Recurrent.GRU.html#gruWithConstInit_gru"><span class="hs-identifier hs-var hs-var">gruWithConstInit_gru</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRU"><span class="hs-identifier hs-type">GRU</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807415"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807414"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807413"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807412"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807411"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807410"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-389"></span><span>      </span><span id="gruWithConstInit_h"><span class="annot"><span class="annottext">GRUWithInit
  inputSize
  hiddenSize
  numLayers
  directionality
  'ConstantInitialization
  dtype
  device
-&gt; Tensor
     device
     dtype
     '[numLayers * NumberOfDirections directionality, hiddenSize]
</span><a href="Torch.Typed.NN.Recurrent.GRU.html#gruWithConstInit_h"><span class="hs-identifier hs-var hs-var">gruWithConstInit_h</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.Typed.Tensor.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807410"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807411"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679807413"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">*</span></span><span> </span><span class="annot"><a href="Torch.Typed.Functional.html#NumberOfDirections"><span class="hs-identifier hs-type">NumberOfDirections</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807412"><span class="hs-identifier hs-type">directionality</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679807414"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-390"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-391"></span><span>    </span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUWithInit"><span class="hs-identifier hs-type">GRUWithInit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807415"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807414"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807413"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807412"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.Aux.html#ConstantInitialization"><span class="hs-identifier hs-type">ConstantInitialization</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807411"><span class="hs-identifier hs-type">dtype</span></a></span><span>
</span><span id="line-392"></span><span>      </span><span class="annot"><a href="#local-6989586621679807410"><span class="hs-identifier hs-type">device</span></a></span><span>
</span><span id="line-393"></span><span>  </span><span id="GRUWithLearnedInit"><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUWithLearnedInit"><span class="hs-identifier hs-var">GRUWithLearnedInit</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-394"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679807397"><span class="annot"><a href="#local-6989586621679807397"><span class="hs-identifier hs-type">inputSize</span></a></span></span><span> </span><span id="local-6989586621679807396"><span class="annot"><a href="#local-6989586621679807396"><span class="hs-identifier hs-type">hiddenSize</span></a></span></span><span> </span><span id="local-6989586621679807395"><span class="annot"><a href="#local-6989586621679807395"><span class="hs-identifier hs-type">numLayers</span></a></span></span><span> </span><span id="local-6989586621679807394"><span class="annot"><a href="#local-6989586621679807394"><span class="hs-identifier hs-type">directionality</span></a></span></span><span> </span><span id="local-6989586621679807393"><span class="annot"><a href="#local-6989586621679807393"><span class="hs-identifier hs-type">dtype</span></a></span></span><span> </span><span id="local-6989586621679807392"><span class="annot"><a href="#local-6989586621679807392"><span class="hs-identifier hs-type">device</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-395"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="gruWithLearnedInit_gru"><span class="annot"><span class="annottext">GRUWithInit
  inputSize
  hiddenSize
  numLayers
  directionality
  'LearnedInitialization
  dtype
  device
-&gt; GRU inputSize hiddenSize numLayers directionality dtype device
</span><a href="Torch.Typed.NN.Recurrent.GRU.html#gruWithLearnedInit_gru"><span class="hs-identifier hs-var hs-var">gruWithLearnedInit_gru</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRU"><span class="hs-identifier hs-type">GRU</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807397"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807396"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807395"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807394"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807393"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807392"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-396"></span><span>      </span><span id="gruWithLearnedInit_h"><span class="annot"><span class="annottext">GRUWithInit
  inputSize
  hiddenSize
  numLayers
  directionality
  'LearnedInitialization
  dtype
  device
-&gt; Parameter
     device
     dtype
     '[numLayers * NumberOfDirections directionality, hiddenSize]
</span><a href="Torch.Typed.NN.Recurrent.GRU.html#gruWithLearnedInit_h"><span class="hs-identifier hs-var hs-var">gruWithLearnedInit_h</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.Typed.Parameter.html#Parameter"><span class="hs-identifier hs-type">Parameter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807392"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807393"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679807395"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">*</span></span><span> </span><span class="annot"><a href="Torch.Typed.Functional.html#NumberOfDirections"><span class="hs-identifier hs-type">NumberOfDirections</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807394"><span class="hs-identifier hs-type">directionality</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679807396"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-397"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-398"></span><span>    </span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUWithInit"><span class="hs-identifier hs-type">GRUWithInit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807397"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807396"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807395"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807394"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.Aux.html#LearnedInitialization"><span class="hs-identifier hs-type">LearnedInitialization</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807393"><span class="hs-identifier hs-type">dtype</span></a></span><span>
</span><span id="line-399"></span><span>      </span><span class="annot"><a href="#local-6989586621679807392"><span class="hs-identifier hs-type">device</span></a></span><span>
</span><span id="line-400"></span><span>
</span><span id="line-401"></span><span id="local-6989586621679806970"><span id="local-6989586621679806972"><span id="local-6989586621679806974"><span id="local-6989586621679806976"><span id="local-6989586621679806977"><span id="local-6989586621679806978"><span id="local-6989586621679806979"><span id="local-6989586621679806980"><span id="local-6989586621679806981"><span id="local-6989586621679806982"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUWithInit"><span class="hs-identifier hs-type">GRUWithInit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806982"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806981"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806980"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806979"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806978"><span class="hs-identifier hs-type">initialization</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806977"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806976"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-402"></span><span>
</span><span id="line-403"></span><span class="hs-comment">-- TODO: https://ryanglscott.github.io/2018/02/11/how-to-derive-generic-for-some-gadts/</span><span>
</span><span id="line-404"></span><span class="hs-comment">-- deriving instance Generic (GRUWithInit inputSize hiddenSize numLayers directionality 'ConstantInitialization dtype device)</span><span>
</span><span id="line-405"></span><span>
</span><span id="line-406"></span><span id="local-6989586621679806964"><span id="local-6989586621679806965"><span id="local-6989586621679806966"><span id="local-6989586621679806967"><span id="local-6989586621679806968"><span id="local-6989586621679806969"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Generic</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUWithInit"><span class="hs-identifier hs-type">GRUWithInit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806969"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806968"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806967"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806966"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.Aux.html#ConstantInitialization"><span class="hs-identifier hs-type">ConstantInitialization</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806965"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806964"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-407"></span><span>  </span><span class="hs-keyword">type</span><span>
</span><span id="line-408"></span><span>    </span><span id="Rep"><span class="annot"><span class="hs-identifier hs-var">Rep</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUWithInit"><span class="hs-identifier hs-type">GRUWithInit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806969"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806968"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806967"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806966"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.Aux.html#ConstantInitialization"><span class="hs-identifier hs-type">ConstantInitialization</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806965"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806964"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-409"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Rec0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRU"><span class="hs-identifier hs-type">GRU</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806969"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806968"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806967"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806966"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806965"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806964"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-410"></span><span>        </span><span class="annot"><span class="hs-operator hs-type">:*:</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rec0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.Tensor.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806964"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806965"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679806967"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">*</span></span><span> </span><span class="annot"><a href="Torch.Typed.Functional.html#NumberOfDirections"><span class="hs-identifier hs-type">NumberOfDirections</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806966"><span class="hs-identifier hs-type">directionality</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679806968"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-411"></span><span>
</span><span id="line-412"></span><span>  </span><span id="local-6989586621679806961"><span class="annot"><span class="annottext">from :: GRUWithInit
  inputSize
  hiddenSize
  numLayers
  directionality
  'ConstantInitialization
  dtype
  device
-&gt; Rep
     (GRUWithInit
        inputSize
        hiddenSize
        numLayers
        directionality
        'ConstantInitialization
        dtype
        device)
     x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">from</span></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679806958"><span id="local-6989586621679806959"><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUWithConstInit"><span class="hs-identifier hs-type">GRUWithConstInit</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GRU inputSize hiddenSize numLayers directionality dtype device
-&gt; K1
     R
     (GRU inputSize hiddenSize numLayers directionality dtype device)
     x
forall k i c (p :: k). c -&gt; K1 i c p
</span><span class="hs-identifier hs-var">K1</span></span><span> </span><span class="annot"><span class="annottext">GRU inputSize hiddenSize numLayers directionality dtype device
</span><a href="#local-6989586621679806959"><span class="hs-identifier hs-var">gruWithConstInit_gru</span></a></span><span> </span><span class="annot"><span class="annottext">K1
  R
  (GRU inputSize hiddenSize numLayers directionality dtype device)
  x
-&gt; K1
     R
     (Tensor
        device
        dtype
        '[numLayers * NumberOfDirections directionality, hiddenSize])
     x
-&gt; (:*:)
     (K1
        R (GRU inputSize hiddenSize numLayers directionality dtype device))
     (K1
        R
        (Tensor
           device
           dtype
           '[numLayers * NumberOfDirections directionality, hiddenSize]))
     x
forall k (f :: k -&gt; Type) (g :: k -&gt; Type) (p :: k).
f p -&gt; g p -&gt; (:*:) f g p
</span><span class="hs-operator hs-var">:*:</span></span><span> </span><span class="annot"><span class="annottext">Tensor
  device
  dtype
  '[numLayers * NumberOfDirections directionality, hiddenSize]
-&gt; K1
     R
     (Tensor
        device
        dtype
        '[numLayers * NumberOfDirections directionality, hiddenSize])
     x
forall k i c (p :: k). c -&gt; K1 i c p
</span><span class="hs-identifier hs-var">K1</span></span><span> </span><span class="annot"><span class="annottext">Tensor
  device
  dtype
  '[numLayers * NumberOfDirections directionality, hiddenSize]
</span><a href="#local-6989586621679806958"><span class="hs-identifier hs-var">gruWithConstInit_h</span></a></span><span>
</span><span id="line-413"></span><span>  </span><span id="local-6989586621679806956"><span class="annot"><span class="annottext">to :: Rep
  (GRUWithInit
     inputSize
     hiddenSize
     numLayers
     directionality
     'ConstantInitialization
     dtype
     device)
  x
-&gt; GRUWithInit
     inputSize
     hiddenSize
     numLayers
     directionality
     'ConstantInitialization
     dtype
     device
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">to</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K1</span></span><span> </span><span id="local-6989586621679806954"><span class="annot"><a href="#local-6989586621679806954"><span class="hs-identifier hs-var">gru</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:*:</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">K1</span></span><span> </span><span id="local-6989586621679806953"><span class="annot"><a href="#local-6989586621679806953"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GRU inputSize hiddenSize numLayers directionality dtype device
-&gt; Tensor
     device
     dtype
     '[numLayers * NumberOfDirections directionality, hiddenSize]
-&gt; GRUWithInit
     inputSize
     hiddenSize
     numLayers
     directionality
     'ConstantInitialization
     dtype
     device
forall (inputSize :: Nat) (hiddenSize :: Nat) (numLayers :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)).
GRU inputSize hiddenSize numLayers directionality dtype device
-&gt; Tensor
     device
     dtype
     '[numLayers * NumberOfDirections directionality, hiddenSize]
-&gt; GRUWithInit
     inputSize
     hiddenSize
     numLayers
     directionality
     'ConstantInitialization
     dtype
     device
</span><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUWithConstInit"><span class="hs-identifier hs-var">GRUWithConstInit</span></a></span><span> </span><span class="annot"><span class="annottext">GRU inputSize hiddenSize numLayers directionality dtype device
</span><a href="#local-6989586621679806954"><span class="hs-identifier hs-var">gru</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  device
  dtype
  '[numLayers * NumberOfDirections directionality, hiddenSize]
</span><a href="#local-6989586621679806953"><span class="hs-identifier hs-var">h</span></a></span></span></span></span></span></span></span><span>
</span><span id="line-414"></span><span>
</span><span id="line-415"></span><span id="local-6989586621679806947"><span id="local-6989586621679806948"><span id="local-6989586621679806949"><span id="local-6989586621679806950"><span id="local-6989586621679806951"><span id="local-6989586621679806952"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Generic</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUWithInit"><span class="hs-identifier hs-type">GRUWithInit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806952"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806951"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806950"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806949"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.Aux.html#LearnedInitialization"><span class="hs-identifier hs-type">LearnedInitialization</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806948"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806947"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-416"></span><span>  </span><span class="hs-keyword">type</span><span>
</span><span id="line-417"></span><span>    </span><span id="Rep"><span class="annot"><span class="hs-identifier hs-var">Rep</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUWithInit"><span class="hs-identifier hs-type">GRUWithInit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806952"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806951"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806950"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806949"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.Aux.html#LearnedInitialization"><span class="hs-identifier hs-type">LearnedInitialization</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806948"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806947"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-418"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Rec0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRU"><span class="hs-identifier hs-type">GRU</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806952"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806951"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806950"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806949"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806948"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806947"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-419"></span><span>        </span><span class="annot"><span class="hs-operator hs-type">:*:</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rec0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.Parameter.html#Parameter"><span class="hs-identifier hs-type">Parameter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806947"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806948"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679806950"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">*</span></span><span> </span><span class="annot"><a href="Torch.Typed.Functional.html#NumberOfDirections"><span class="hs-identifier hs-type">NumberOfDirections</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806949"><span class="hs-identifier hs-type">directionality</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679806951"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-420"></span><span>
</span><span id="line-421"></span><span>  </span><span id="local-6989586621679806944"><span class="annot"><span class="annottext">from :: GRUWithInit
  inputSize
  hiddenSize
  numLayers
  directionality
  'LearnedInitialization
  dtype
  device
-&gt; Rep
     (GRUWithInit
        inputSize
        hiddenSize
        numLayers
        directionality
        'LearnedInitialization
        dtype
        device)
     x
</span><a href="#local-6989586621679806944"><span class="hs-identifier hs-var hs-var hs-var hs-var">from</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679806942"><span id="local-6989586621679806943"><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUWithLearnedInit"><span class="hs-identifier hs-type">GRUWithLearnedInit</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GRU inputSize hiddenSize numLayers directionality dtype device
-&gt; K1
     R
     (GRU inputSize hiddenSize numLayers directionality dtype device)
     x
forall k i c (p :: k). c -&gt; K1 i c p
</span><span class="hs-identifier hs-var">K1</span></span><span> </span><span class="annot"><span class="annottext">GRU inputSize hiddenSize numLayers directionality dtype device
</span><a href="#local-6989586621679806943"><span class="hs-identifier hs-var">gruWithLearnedInit_gru</span></a></span><span> </span><span class="annot"><span class="annottext">K1
  R
  (GRU inputSize hiddenSize numLayers directionality dtype device)
  x
-&gt; K1
     R
     (Parameter
        device
        dtype
        '[numLayers * NumberOfDirections directionality, hiddenSize])
     x
-&gt; (:*:)
     (K1
        R (GRU inputSize hiddenSize numLayers directionality dtype device))
     (K1
        R
        (Parameter
           device
           dtype
           '[numLayers * NumberOfDirections directionality, hiddenSize]))
     x
forall k (f :: k -&gt; Type) (g :: k -&gt; Type) (p :: k).
f p -&gt; g p -&gt; (:*:) f g p
</span><span class="hs-operator hs-var">:*:</span></span><span> </span><span class="annot"><span class="annottext">Parameter
  device
  dtype
  '[numLayers * NumberOfDirections directionality, hiddenSize]
-&gt; K1
     R
     (Parameter
        device
        dtype
        '[numLayers * NumberOfDirections directionality, hiddenSize])
     x
forall k i c (p :: k). c -&gt; K1 i c p
</span><span class="hs-identifier hs-var">K1</span></span><span> </span><span class="annot"><span class="annottext">Parameter
  device
  dtype
  '[numLayers * NumberOfDirections directionality, hiddenSize]
</span><a href="#local-6989586621679806942"><span class="hs-identifier hs-var">gruWithLearnedInit_h</span></a></span><span>
</span><span id="line-422"></span><span>  </span><span id="local-6989586621679806941"><span class="annot"><span class="annottext">to :: Rep
  (GRUWithInit
     inputSize
     hiddenSize
     numLayers
     directionality
     'LearnedInitialization
     dtype
     device)
  x
-&gt; GRUWithInit
     inputSize
     hiddenSize
     numLayers
     directionality
     'LearnedInitialization
     dtype
     device
</span><a href="#local-6989586621679806941"><span class="hs-identifier hs-var hs-var hs-var hs-var">to</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K1</span></span><span> </span><span id="local-6989586621679806940"><span class="annot"><a href="#local-6989586621679806940"><span class="hs-identifier hs-var">gru</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:*:</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">K1</span></span><span> </span><span id="local-6989586621679806939"><span class="annot"><a href="#local-6989586621679806939"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GRU inputSize hiddenSize numLayers directionality dtype device
-&gt; Parameter
     device
     dtype
     '[numLayers * NumberOfDirections directionality, hiddenSize]
-&gt; GRUWithInit
     inputSize
     hiddenSize
     numLayers
     directionality
     'LearnedInitialization
     dtype
     device
forall (inputSize :: Nat) (hiddenSize :: Nat) (numLayers :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)).
GRU inputSize hiddenSize numLayers directionality dtype device
-&gt; Parameter
     device
     dtype
     '[numLayers * NumberOfDirections directionality, hiddenSize]
-&gt; GRUWithInit
     inputSize
     hiddenSize
     numLayers
     directionality
     'LearnedInitialization
     dtype
     device
</span><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUWithLearnedInit"><span class="hs-identifier hs-var">GRUWithLearnedInit</span></a></span><span> </span><span class="annot"><span class="annottext">GRU inputSize hiddenSize numLayers directionality dtype device
</span><a href="#local-6989586621679806940"><span class="hs-identifier hs-var">gru</span></a></span><span> </span><span class="annot"><span class="annottext">Parameter
  device
  dtype
  '[numLayers * NumberOfDirections directionality, hiddenSize]
</span><a href="#local-6989586621679806939"><span class="hs-identifier hs-var">h</span></a></span></span></span></span></span></span></span><span>
</span><span id="line-423"></span><span>
</span><span id="line-424"></span><span id="local-6989586621679806933"><span id="local-6989586621679806934"><span id="local-6989586621679806935"><span id="local-6989586621679806936"><span id="local-6989586621679806937"><span id="local-6989586621679806938"><span class="hs-keyword">instance</span><span>
</span><span id="line-425"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679806938"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-426"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679806937"><span class="hs-identifier hs-type">numLayers</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-427"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.Functional.html#NumberOfDirections"><span class="hs-identifier hs-type">NumberOfDirections</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806936"><span class="hs-identifier hs-type">directionality</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-428"></span><span>    </span><span class="annot"><a href="Torch.Typed.Tensor.html#KnownDType"><span class="hs-identifier hs-type">KnownDType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806935"><span class="hs-identifier hs-type">dtype</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-429"></span><span>    </span><span class="annot"><a href="Torch.Typed.Tensor.html#KnownDevice"><span class="hs-identifier hs-type">KnownDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806934"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-430"></span><span>    </span><span class="annot"><a href="Torch.NN.html#Randomizable"><span class="hs-identifier hs-type">A.Randomizable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUSpec"><span class="hs-identifier hs-type">GRUSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806933"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806938"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806937"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806936"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806935"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806934"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-431"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRU"><span class="hs-identifier hs-type">GRU</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806933"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806938"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806937"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806936"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806935"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806934"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-432"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-433"></span><span>  </span><span class="annot"><a href="Torch.NN.html#Randomizable"><span class="hs-identifier hs-type">A.Randomizable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUWithInitSpec"><span class="hs-identifier hs-type">GRUWithInitSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806933"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806938"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806937"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806936"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.Aux.html#ConstantInitialization"><span class="hs-identifier hs-type">ConstantInitialization</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806935"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806934"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-434"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUWithInit"><span class="hs-identifier hs-type">GRUWithInit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806933"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806938"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806937"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806936"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.Aux.html#ConstantInitialization"><span class="hs-identifier hs-type">ConstantInitialization</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806935"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806934"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-435"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-436"></span><span>  </span><span id="local-6989586621679806931"><span class="annot"><span class="annottext">sample :: GRUWithInitSpec
  inputSize
  hiddenSize
  numLayers
  directionality
  'ConstantInitialization
  dtype
  device
-&gt; IO
     (GRUWithInit
        inputSize
        hiddenSize
        numLayers
        directionality
        'ConstantInitialization
        dtype
        device)
</span><a href="#local-6989586621679806931"><span class="hs-identifier hs-var hs-var hs-var hs-var">sample</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUWithZerosInitSpec"><span class="hs-identifier hs-type">GRUWithZerosInitSpec</span></a></span><span> </span><span id="local-6989586621679806930"><span class="annot"><span class="annottext">gruSpec :: GRUSpec inputSize hiddenSize numLayers directionality dtype device
</span><a href="#local-6989586621679806930"><span class="hs-identifier hs-var">gruSpec</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-437"></span><span>    </span><span class="annot"><span class="annottext">GRU inputSize hiddenSize numLayers directionality dtype device
-&gt; Tensor
     device
     dtype
     '[numLayers * NumberOfDirections directionality, hiddenSize]
-&gt; GRUWithInit
     inputSize
     hiddenSize
     numLayers
     directionality
     'ConstantInitialization
     dtype
     device
forall (inputSize :: Nat) (hiddenSize :: Nat) (numLayers :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)).
GRU inputSize hiddenSize numLayers directionality dtype device
-&gt; Tensor
     device
     dtype
     '[numLayers * NumberOfDirections directionality, hiddenSize]
-&gt; GRUWithInit
     inputSize
     hiddenSize
     numLayers
     directionality
     'ConstantInitialization
     dtype
     device
</span><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUWithConstInit"><span class="hs-identifier hs-var">GRUWithConstInit</span></a></span><span>
</span><span id="line-438"></span><span>      </span><span class="annot"><span class="annottext">(GRU inputSize hiddenSize numLayers directionality dtype device
 -&gt; Tensor
      device
      dtype
      '[numLayers * NumberOfDirections directionality, hiddenSize]
 -&gt; GRUWithInit
      inputSize
      hiddenSize
      numLayers
      directionality
      'ConstantInitialization
      dtype
      device)
-&gt; IO
     (GRU inputSize hiddenSize numLayers directionality dtype device)
-&gt; IO
     (Tensor
        device
        dtype
        '[numLayers * NumberOfDirections directionality, hiddenSize]
      -&gt; GRUWithInit
           inputSize
           hiddenSize
           numLayers
           directionality
           'ConstantInitialization
           dtype
           device)
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">GRUSpec inputSize hiddenSize numLayers directionality dtype device
-&gt; IO
     (GRU inputSize hiddenSize numLayers directionality dtype device)
forall spec f. Randomizable spec f =&gt; spec -&gt; IO f
</span><a href="Torch.NN.html#sample"><span class="hs-identifier hs-var">A.sample</span></a></span><span> </span><span class="annot"><span class="annottext">GRUSpec inputSize hiddenSize numLayers directionality dtype device
</span><a href="#local-6989586621679806930"><span class="hs-identifier hs-var">gruSpec</span></a></span><span>
</span><span id="line-439"></span><span>      </span><span class="annot"><span class="annottext">IO
  (Tensor
     device
     dtype
     '[numLayers * NumberOfDirections directionality, hiddenSize]
   -&gt; GRUWithInit
        inputSize
        hiddenSize
        numLayers
        directionality
        'ConstantInitialization
        dtype
        device)
-&gt; IO
     (Tensor
        device
        dtype
        '[numLayers * NumberOfDirections directionality, hiddenSize])
-&gt; IO
     (GRUWithInit
        inputSize
        hiddenSize
        numLayers
        directionality
        'ConstantInitialization
        dtype
        device)
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Tensor
  device
  dtype
  '[numLayers * NumberOfDirections directionality, hiddenSize]
-&gt; IO
     (Tensor
        device
        dtype
        '[numLayers * NumberOfDirections directionality, hiddenSize])
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Tensor
  device
  dtype
  '[numLayers * NumberOfDirections directionality, hiddenSize]
forall (shape :: [Nat]) (dtype :: DType)
       (device :: (DeviceType, Nat)).
TensorOptions shape dtype device =&gt;
Tensor device dtype shape
</span><a href="Torch.Typed.Factories.html#zeros"><span class="hs-identifier hs-var">zeros</span></a></span><span>
</span><span id="line-440"></span><span>  </span><span class="annot"><a href="Torch.NN.html#sample"><span class="hs-identifier hs-var">sample</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUWithConstInitSpec"><span class="hs-identifier hs-type">GRUWithConstInitSpec</span></a></span><span> </span><span id="local-6989586621679806929"><span class="annot"><span class="annottext">gruSpec :: GRUSpec inputSize hiddenSize numLayers directionality dtype device
</span><a href="#local-6989586621679806929"><span class="hs-identifier hs-var">gruSpec</span></a></span></span><span> </span><span id="local-6989586621679806928"><span class="annot"><span class="annottext">h :: Tensor
  device
  dtype
  '[numLayers * NumberOfDirections directionality, hiddenSize]
</span><a href="#local-6989586621679806928"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-441"></span><span>    </span><span class="annot"><span class="annottext">GRU inputSize hiddenSize numLayers directionality dtype device
-&gt; Tensor
     device
     dtype
     '[numLayers * NumberOfDirections directionality, hiddenSize]
-&gt; GRUWithInit
     inputSize
     hiddenSize
     numLayers
     directionality
     'ConstantInitialization
     dtype
     device
forall (inputSize :: Nat) (hiddenSize :: Nat) (numLayers :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)).
GRU inputSize hiddenSize numLayers directionality dtype device
-&gt; Tensor
     device
     dtype
     '[numLayers * NumberOfDirections directionality, hiddenSize]
-&gt; GRUWithInit
     inputSize
     hiddenSize
     numLayers
     directionality
     'ConstantInitialization
     dtype
     device
</span><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUWithConstInit"><span class="hs-identifier hs-var">GRUWithConstInit</span></a></span><span>
</span><span id="line-442"></span><span>      </span><span class="annot"><span class="annottext">(GRU inputSize hiddenSize numLayers directionality dtype device
 -&gt; Tensor
      device
      dtype
      '[numLayers * NumberOfDirections directionality, hiddenSize]
 -&gt; GRUWithInit
      inputSize
      hiddenSize
      numLayers
      directionality
      'ConstantInitialization
      dtype
      device)
-&gt; IO
     (GRU inputSize hiddenSize numLayers directionality dtype device)
-&gt; IO
     (Tensor
        device
        dtype
        '[numLayers * NumberOfDirections directionality, hiddenSize]
      -&gt; GRUWithInit
           inputSize
           hiddenSize
           numLayers
           directionality
           'ConstantInitialization
           dtype
           device)
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">GRUSpec inputSize hiddenSize numLayers directionality dtype device
-&gt; IO
     (GRU inputSize hiddenSize numLayers directionality dtype device)
forall spec f. Randomizable spec f =&gt; spec -&gt; IO f
</span><a href="Torch.NN.html#sample"><span class="hs-identifier hs-var">A.sample</span></a></span><span> </span><span class="annot"><span class="annottext">GRUSpec inputSize hiddenSize numLayers directionality dtype device
</span><a href="#local-6989586621679806929"><span class="hs-identifier hs-var">gruSpec</span></a></span><span>
</span><span id="line-443"></span><span>      </span><span class="annot"><span class="annottext">IO
  (Tensor
     device
     dtype
     '[numLayers * NumberOfDirections directionality, hiddenSize]
   -&gt; GRUWithInit
        inputSize
        hiddenSize
        numLayers
        directionality
        'ConstantInitialization
        dtype
        device)
-&gt; IO
     (Tensor
        device
        dtype
        '[numLayers * NumberOfDirections directionality, hiddenSize])
-&gt; IO
     (GRUWithInit
        inputSize
        hiddenSize
        numLayers
        directionality
        'ConstantInitialization
        dtype
        device)
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Tensor
  device
  dtype
  '[numLayers * NumberOfDirections directionality, hiddenSize]
-&gt; IO
     (Tensor
        device
        dtype
        '[numLayers * NumberOfDirections directionality, hiddenSize])
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Tensor
  device
  dtype
  '[numLayers * NumberOfDirections directionality, hiddenSize]
</span><a href="#local-6989586621679806928"><span class="hs-identifier hs-var">h</span></a></span></span></span></span></span></span></span><span>
</span><span id="line-444"></span><span>
</span><span id="line-445"></span><span id="local-6989586621679806922"><span id="local-6989586621679806923"><span id="local-6989586621679806924"><span id="local-6989586621679806925"><span id="local-6989586621679806926"><span id="local-6989586621679806927"><span class="hs-keyword">instance</span><span>
</span><span id="line-446"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679806927"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-447"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679806926"><span class="hs-identifier hs-type">numLayers</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-448"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.Functional.html#NumberOfDirections"><span class="hs-identifier hs-type">NumberOfDirections</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806925"><span class="hs-identifier hs-type">directionality</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-449"></span><span>    </span><span class="annot"><a href="Torch.Typed.Tensor.html#KnownDType"><span class="hs-identifier hs-type">KnownDType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806924"><span class="hs-identifier hs-type">dtype</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-450"></span><span>    </span><span class="annot"><a href="Torch.Typed.Tensor.html#KnownDevice"><span class="hs-identifier hs-type">KnownDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806923"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-451"></span><span>    </span><span class="annot"><a href="Torch.NN.html#Randomizable"><span class="hs-identifier hs-type">A.Randomizable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUSpec"><span class="hs-identifier hs-type">GRUSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806922"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806927"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806926"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806925"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806924"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806923"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-452"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRU"><span class="hs-identifier hs-type">GRU</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806922"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806927"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806926"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806925"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806924"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806923"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-453"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-454"></span><span>  </span><span class="annot"><a href="Torch.NN.html#Randomizable"><span class="hs-identifier hs-type">A.Randomizable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUWithInitSpec"><span class="hs-identifier hs-type">GRUWithInitSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806922"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806927"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806926"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806925"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.Aux.html#LearnedInitialization"><span class="hs-identifier hs-type">LearnedInitialization</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806924"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806923"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-455"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUWithInit"><span class="hs-identifier hs-type">GRUWithInit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806922"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806927"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806926"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806925"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.Aux.html#LearnedInitialization"><span class="hs-identifier hs-type">LearnedInitialization</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806924"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806923"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-456"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-457"></span><span>  </span><span id="local-6989586621679806920"><span class="annot"><span class="annottext">sample :: GRUWithInitSpec
  inputSize
  hiddenSize
  numLayers
  directionality
  'LearnedInitialization
  dtype
  device
-&gt; IO
     (GRUWithInit
        inputSize
        hiddenSize
        numLayers
        directionality
        'LearnedInitialization
        dtype
        device)
</span><a href="#local-6989586621679806920"><span class="hs-identifier hs-var hs-var hs-var hs-var">sample</span></a></span></span><span> </span><span id="local-6989586621679806919"><span class="annot"><span class="annottext">s :: GRUWithInitSpec
  inputSize
  hiddenSize
  numLayers
  directionality
  'LearnedInitialization
  dtype
  device
</span><a href="#local-6989586621679806919"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUWithLearnedInitSpec"><span class="hs-identifier hs-type">GRUWithLearnedInitSpec</span></a></span><span> </span><span id="local-6989586621679806918"><span class="annot"><span class="annottext">gruSpec :: GRUSpec inputSize hiddenSize numLayers directionality dtype device
</span><a href="#local-6989586621679806918"><span class="hs-identifier hs-var">gruSpec</span></a></span></span><span> </span><span id="local-6989586621679806917"><span class="annot"><span class="annottext">h :: Tensor
  device
  dtype
  '[numLayers * NumberOfDirections directionality, hiddenSize]
</span><a href="#local-6989586621679806917"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-458"></span><span>    </span><span class="annot"><span class="annottext">GRU inputSize hiddenSize numLayers directionality dtype device
-&gt; Parameter
     device
     dtype
     '[numLayers * NumberOfDirections directionality, hiddenSize]
-&gt; GRUWithInit
     inputSize
     hiddenSize
     numLayers
     directionality
     'LearnedInitialization
     dtype
     device
forall (inputSize :: Nat) (hiddenSize :: Nat) (numLayers :: Nat)
       (directionality :: RNNDirectionality) (dtype :: DType)
       (device :: (DeviceType, Nat)).
GRU inputSize hiddenSize numLayers directionality dtype device
-&gt; Parameter
     device
     dtype
     '[numLayers * NumberOfDirections directionality, hiddenSize]
-&gt; GRUWithInit
     inputSize
     hiddenSize
     numLayers
     directionality
     'LearnedInitialization
     dtype
     device
</span><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUWithLearnedInit"><span class="hs-identifier hs-var">GRUWithLearnedInit</span></a></span><span>
</span><span id="line-459"></span><span>      </span><span class="annot"><span class="annottext">(GRU inputSize hiddenSize numLayers directionality dtype device
 -&gt; Parameter
      device
      dtype
      '[numLayers * NumberOfDirections directionality, hiddenSize]
 -&gt; GRUWithInit
      inputSize
      hiddenSize
      numLayers
      directionality
      'LearnedInitialization
      dtype
      device)
-&gt; IO
     (GRU inputSize hiddenSize numLayers directionality dtype device)
-&gt; IO
     (Parameter
        device
        dtype
        '[numLayers * NumberOfDirections directionality, hiddenSize]
      -&gt; GRUWithInit
           inputSize
           hiddenSize
           numLayers
           directionality
           'LearnedInitialization
           dtype
           device)
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">GRUSpec inputSize hiddenSize numLayers directionality dtype device
-&gt; IO
     (GRU inputSize hiddenSize numLayers directionality dtype device)
forall spec f. Randomizable spec f =&gt; spec -&gt; IO f
</span><a href="Torch.NN.html#sample"><span class="hs-identifier hs-var">A.sample</span></a></span><span> </span><span class="annot"><span class="annottext">GRUSpec inputSize hiddenSize numLayers directionality dtype device
</span><a href="#local-6989586621679806918"><span class="hs-identifier hs-var">gruSpec</span></a></span><span>
</span><span id="line-460"></span><span>      </span><span class="annot"><span class="annottext">IO
  (Parameter
     device
     dtype
     '[numLayers * NumberOfDirections directionality, hiddenSize]
   -&gt; GRUWithInit
        inputSize
        hiddenSize
        numLayers
        directionality
        'LearnedInitialization
        dtype
        device)
-&gt; IO
     (Parameter
        device
        dtype
        '[numLayers * NumberOfDirections directionality, hiddenSize])
-&gt; IO
     (GRUWithInit
        inputSize
        hiddenSize
        numLayers
        directionality
        'LearnedInitialization
        dtype
        device)
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tensor
  device
  dtype
  '[numLayers * NumberOfDirections directionality, hiddenSize]
-&gt; IO
     (Parameter
        device
        dtype
        '[numLayers * NumberOfDirections directionality, hiddenSize])
forall (shape :: [Nat]) (dtype :: DType)
       (device :: (DeviceType, Nat)).
Tensor device dtype shape -&gt; IO (Parameter device dtype shape)
</span><a href="Torch.Typed.Parameter.html#makeIndependent"><span class="hs-identifier hs-var">makeIndependent</span></a></span><span> </span><span class="annot"><span class="annottext">(Tensor
   device
   dtype
   '[numLayers * NumberOfDirections directionality, hiddenSize]
 -&gt; IO
      (Parameter
         device
         dtype
         '[numLayers * NumberOfDirections directionality, hiddenSize]))
-&gt; IO
     (Tensor
        device
        dtype
        '[numLayers * NumberOfDirections directionality, hiddenSize])
-&gt; IO
     (Parameter
        device
        dtype
        '[numLayers * NumberOfDirections directionality, hiddenSize])
forall (m :: Type -&gt; Type) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Tensor
  device
  dtype
  '[numLayers * NumberOfDirections directionality, hiddenSize]
-&gt; IO
     (Tensor
        device
        dtype
        '[numLayers * NumberOfDirections directionality, hiddenSize])
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Tensor
  device
  dtype
  '[numLayers * NumberOfDirections directionality, hiddenSize]
</span><a href="#local-6989586621679806917"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-461"></span><span>
</span><span id="line-462"></span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#gruForward"><span class="hs-identifier hs-type">gruForward</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-463"></span><span>  </span><span class="hs-keyword">forall</span><span>
</span><span id="line-464"></span><span>    </span><span id="local-6989586621679807303"><span class="annot"><a href="#local-6989586621679807303"><span class="hs-identifier hs-type">shapeOrder</span></a></span></span><span>
</span><span id="line-465"></span><span>    </span><span id="local-6989586621679807305"><span class="annot"><a href="#local-6989586621679807305"><span class="hs-identifier hs-type">batchSize</span></a></span></span><span>
</span><span id="line-466"></span><span>    </span><span id="local-6989586621679807300"><span class="annot"><a href="#local-6989586621679807300"><span class="hs-identifier hs-type">seqLen</span></a></span></span><span>
</span><span id="line-467"></span><span>    </span><span id="local-6989586621679807307"><span class="annot"><a href="#local-6989586621679807307"><span class="hs-identifier hs-type">directionality</span></a></span></span><span>
</span><span id="line-468"></span><span>    </span><span id="local-6989586621679807292"><span class="annot"><a href="#local-6989586621679807292"><span class="hs-identifier hs-type">initialization</span></a></span></span><span>
</span><span id="line-469"></span><span>    </span><span id="local-6989586621679807306"><span class="annot"><a href="#local-6989586621679807306"><span class="hs-identifier hs-type">numLayers</span></a></span></span><span>
</span><span id="line-470"></span><span>    </span><span id="local-6989586621679807299"><span class="annot"><a href="#local-6989586621679807299"><span class="hs-identifier hs-type">inputSize</span></a></span></span><span>
</span><span id="line-471"></span><span>    </span><span id="local-6989586621679807302"><span class="annot"><a href="#local-6989586621679807302"><span class="hs-identifier hs-type">outputSize</span></a></span></span><span>
</span><span id="line-472"></span><span>    </span><span id="local-6989586621679807304"><span class="annot"><a href="#local-6989586621679807304"><span class="hs-identifier hs-type">hiddenSize</span></a></span></span><span>
</span><span id="line-473"></span><span>    </span><span id="local-6989586621679807301"><span class="annot"><a href="#local-6989586621679807301"><span class="hs-identifier hs-type">inputShape</span></a></span></span><span>
</span><span id="line-474"></span><span>    </span><span id="local-6989586621679807298"><span class="annot"><a href="#local-6989586621679807298"><span class="hs-identifier hs-type">outputShape</span></a></span></span><span>
</span><span id="line-475"></span><span>    </span><span id="local-6989586621679807297"><span class="annot"><a href="#local-6989586621679807297"><span class="hs-identifier hs-type">hcShape</span></a></span></span><span>
</span><span id="line-476"></span><span>    </span><span id="local-6989586621679807294"><span class="annot"><a href="#local-6989586621679807294"><span class="hs-identifier hs-type">parameters</span></a></span></span><span>
</span><span id="line-477"></span><span>    </span><span id="local-6989586621679807293"><span class="annot"><a href="#local-6989586621679807293"><span class="hs-identifier hs-type">tensorParameters</span></a></span></span><span>
</span><span id="line-478"></span><span>    </span><span id="local-6989586621679807296"><span class="annot"><a href="#local-6989586621679807296"><span class="hs-identifier hs-type">dtype</span></a></span></span><span>
</span><span id="line-479"></span><span>    </span><span id="local-6989586621679807295"><span class="annot"><a href="#local-6989586621679807295"><span class="hs-identifier hs-type">device</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-480"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.Functional.html#NumberOfDirections"><span class="hs-identifier hs-type">NumberOfDirections</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807307"><span class="hs-identifier hs-type">directionality</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-481"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679807306"><span class="hs-identifier hs-type">numLayers</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-482"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679807305"><span class="hs-identifier hs-type">batchSize</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-483"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679807304"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-484"></span><span>    </span><span class="annot"><a href="Torch.Typed.Functional.html#KnownRNNShapeOrder"><span class="hs-identifier hs-type">KnownRNNShapeOrder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807303"><span class="hs-identifier hs-type">shapeOrder</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-485"></span><span>    </span><span class="annot"><a href="Torch.Typed.Functional.html#KnownRNNDirectionality"><span class="hs-identifier hs-type">KnownRNNDirectionality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807307"><span class="hs-identifier hs-type">directionality</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-486"></span><span>    </span><span class="annot"><a href="#local-6989586621679807302"><span class="hs-identifier hs-type">outputSize</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679807304"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">*</span></span><span> </span><span class="annot"><a href="Torch.Typed.Functional.html#NumberOfDirections"><span class="hs-identifier hs-type">NumberOfDirections</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807307"><span class="hs-identifier hs-type">directionality</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-487"></span><span>    </span><span class="annot"><a href="#local-6989586621679807301"><span class="hs-identifier hs-type">inputShape</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.Typed.Functional.html#RNNShape"><span class="hs-identifier hs-type">RNNShape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807303"><span class="hs-identifier hs-type">shapeOrder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807300"><span class="hs-identifier hs-type">seqLen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807305"><span class="hs-identifier hs-type">batchSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807299"><span class="hs-identifier hs-type">inputSize</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-488"></span><span>    </span><span class="annot"><a href="#local-6989586621679807298"><span class="hs-identifier hs-type">outputShape</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.Typed.Functional.html#RNNShape"><span class="hs-identifier hs-type">RNNShape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807303"><span class="hs-identifier hs-type">shapeOrder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807300"><span class="hs-identifier hs-type">seqLen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807305"><span class="hs-identifier hs-type">batchSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807302"><span class="hs-identifier hs-type">outputSize</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-489"></span><span>    </span><span class="annot"><a href="#local-6989586621679807297"><span class="hs-identifier hs-type">hcShape</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679807306"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">*</span></span><span> </span><span class="annot"><a href="Torch.Typed.Functional.html#NumberOfDirections"><span class="hs-identifier hs-type">NumberOfDirections</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807307"><span class="hs-identifier hs-type">directionality</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679807305"><span class="hs-identifier hs-type">batchSize</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679807304"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-490"></span><span>    </span><span class="annot"><a href="Torch.Typed.Parameter.html#Parameterized"><span class="hs-identifier hs-type">Parameterized</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRU"><span class="hs-identifier hs-type">GRU</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807299"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807304"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807306"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807307"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807296"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807295"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679807294"><span class="hs-identifier hs-type">parameters</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-491"></span><span>    </span><span class="annot"><a href="#local-6989586621679807293"><span class="hs-identifier hs-type">tensorParameters</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.Typed.Functional.html#GRUR"><span class="hs-identifier hs-type">GRUR</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807299"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807304"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807306"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807307"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807296"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807295"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-492"></span><span>    </span><span class="annot"><a href="../../../../libtorch-ffi/html/src"><span class="hs-identifier hs-type">ATen.Castable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.HList.html#HList"><span class="hs-identifier hs-type">HList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807293"><span class="hs-identifier hs-type">tensorParameters</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Torch.Tensor.html#ATenTensor"><span class="hs-identifier hs-type">D.ATenTensor</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-493"></span><span>    </span><span class="annot"><a href="Torch.HList.html#HMap%27"><span class="hs-identifier hs-type">HMap'</span></a></span><span> </span><span class="annot"><a href="Torch.Typed.Parameter.html#ToDependent"><span class="hs-identifier hs-type">ToDependent</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807294"><span class="hs-identifier hs-type">parameters</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807293"><span class="hs-identifier hs-type">tensorParameters</span></a></span><span>
</span><span id="line-494"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-495"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-496"></span><span>  </span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUWithInit"><span class="hs-identifier hs-type">GRUWithInit</span></a></span><span>
</span><span id="line-497"></span><span>    </span><span class="annot"><a href="#local-6989586621679807299"><span class="hs-identifier hs-type">inputSize</span></a></span><span>
</span><span id="line-498"></span><span>    </span><span class="annot"><a href="#local-6989586621679807304"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span>
</span><span id="line-499"></span><span>    </span><span class="annot"><a href="#local-6989586621679807306"><span class="hs-identifier hs-type">numLayers</span></a></span><span>
</span><span id="line-500"></span><span>    </span><span class="annot"><a href="#local-6989586621679807307"><span class="hs-identifier hs-type">directionality</span></a></span><span>
</span><span id="line-501"></span><span>    </span><span class="annot"><a href="#local-6989586621679807292"><span class="hs-identifier hs-type">initialization</span></a></span><span>
</span><span id="line-502"></span><span>    </span><span class="annot"><a href="#local-6989586621679807296"><span class="hs-identifier hs-type">dtype</span></a></span><span>
</span><span id="line-503"></span><span>    </span><span class="annot"><a href="#local-6989586621679807295"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-504"></span><span>  </span><span class="annot"><a href="Torch.Typed.Tensor.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807295"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807296"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807301"><span class="hs-identifier hs-type">inputShape</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-505"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.Typed.Tensor.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807295"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807296"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807298"><span class="hs-identifier hs-type">outputShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-506"></span><span>    </span><span class="annot"><a href="Torch.Typed.Tensor.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807295"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807296"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807297"><span class="hs-identifier hs-type">hcShape</span></a></span><span>
</span><span id="line-507"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-508"></span><span id="gruForward"><span class="annot"><span class="annottext">gruForward :: Bool
-&gt; GRUWithInit
     inputSize
     hiddenSize
     numLayers
     directionality
     initialization
     dtype
     device
-&gt; Tensor device dtype inputShape
-&gt; (Tensor device dtype outputShape, Tensor device dtype hcShape)
</span><a href="Torch.Typed.NN.Recurrent.GRU.html#gruForward"><span class="hs-identifier hs-var hs-var">gruForward</span></a></span></span><span> </span><span id="local-6989586621679806915"><span class="annot"><span class="annottext">dropoutOn :: Bool
</span><a href="#local-6989586621679806915"><span class="hs-identifier hs-var">dropoutOn</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUWithConstInit"><span class="hs-identifier hs-type">GRUWithConstInit</span></a></span><span> </span><span id="local-6989586621679806914"><span class="annot"><span class="annottext">gruModel :: GRU inputSize hiddenSize numLayers directionality dtype device
</span><a href="#local-6989586621679806914"><span class="hs-identifier hs-var">gruModel</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRU"><span class="hs-identifier hs-type">GRU</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Dropout.html#Dropout"><span class="hs-identifier hs-type">Dropout</span></a></span><span> </span><span id="local-6989586621679806912"><span class="annot"><span class="annottext">dropoutProb :: Double
</span><a href="#local-6989586621679806912"><span class="hs-identifier hs-var">dropoutProb</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679806911"><span class="annot"><span class="annottext">hc :: Tensor
  device
  dtype
  '[numLayers * NumberOfDirections directionality, hiddenSize]
</span><a href="#local-6989586621679806911"><span class="hs-identifier hs-var">hc</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679806910"><span class="annot"><span class="annottext">input :: Tensor device dtype inputShape
</span><a href="#local-6989586621679806910"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-509"></span><span>  </span><span class="annot"><span class="annottext">HList tensorParameters
-&gt; Double
-&gt; Bool
-&gt; Tensor device dtype hcShape
-&gt; Tensor device dtype inputShape
-&gt; (Tensor device dtype outputShape, Tensor device dtype hcShape)
forall k (shapeOrder :: RNNShapeOrder)
       (directionality :: RNNDirectionality) (numLayers :: Nat)
       (seqLen :: Nat) (batchSize :: Nat) (inputSize :: Nat)
       (outputSize :: Nat) (hiddenSize :: Nat) (inputShape :: [Nat])
       (outputShape :: [Nat]) (hcShape :: [Nat]) (tensorParameters :: [k])
       (dtype :: DType) (device :: (DeviceType, Nat)).
(KnownNat numLayers, KnownRNNShapeOrder shapeOrder,
 KnownRNNDirectionality directionality,
 outputSize ~ (hiddenSize * NumberOfDirections directionality),
 inputShape ~ RNNShape shapeOrder seqLen batchSize inputSize,
 outputShape ~ RNNShape shapeOrder seqLen batchSize outputSize,
 hcShape
 ~ '[numLayers * NumberOfDirections directionality, batchSize,
     hiddenSize],
 tensorParameters
 ~ GRUR inputSize hiddenSize numLayers directionality dtype device,
 Castable (HList tensorParameters) [ATenTensor]) =&gt;
HList tensorParameters
-&gt; Double
-&gt; Bool
-&gt; Tensor device dtype hcShape
-&gt; Tensor device dtype inputShape
-&gt; (Tensor device dtype outputShape, Tensor device dtype hcShape)
</span><a href="Torch.Typed.Functional.html#gru"><span class="hs-identifier hs-var">gru</span></a></span><span>
</span><span id="line-510"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807303"><span class="hs-identifier hs-type">shapeOrder</span></a></span><span>
</span><span id="line-511"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807307"><span class="hs-identifier hs-type">directionality</span></a></span><span>
</span><span id="line-512"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807306"><span class="hs-identifier hs-type">numLayers</span></a></span><span>
</span><span id="line-513"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807300"><span class="hs-identifier hs-type">seqLen</span></a></span><span>
</span><span id="line-514"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807305"><span class="hs-identifier hs-type">batchSize</span></a></span><span>
</span><span id="line-515"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807299"><span class="hs-identifier hs-type">inputSize</span></a></span><span>
</span><span id="line-516"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807302"><span class="hs-identifier hs-type">outputSize</span></a></span><span>
</span><span id="line-517"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807304"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span>
</span><span id="line-518"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807301"><span class="hs-identifier hs-type">inputShape</span></a></span><span>
</span><span id="line-519"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807298"><span class="hs-identifier hs-type">outputShape</span></a></span><span>
</span><span id="line-520"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807297"><span class="hs-identifier hs-type">hcShape</span></a></span><span>
</span><span id="line-521"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807293"><span class="hs-identifier hs-type">tensorParameters</span></a></span><span>
</span><span id="line-522"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807296"><span class="hs-identifier hs-type">dtype</span></a></span><span>
</span><span id="line-523"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807295"><span class="hs-identifier hs-type">device</span></a></span><span>
</span><span id="line-524"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ToDependent -&gt; HList parameters -&gt; HList tensorParameters
forall k f (xs :: [k]) (ys :: [k]).
HMap' f xs ys =&gt;
f -&gt; HList xs -&gt; HList ys
</span><a href="Torch.HList.html#hmap%27"><span class="hs-identifier hs-var">hmap'</span></a></span><span> </span><span class="annot"><span class="annottext">ToDependent
</span><a href="Torch.Typed.Parameter.html#ToDependent"><span class="hs-identifier hs-var">ToDependent</span></a></span><span> </span><span class="annot"><span class="annottext">(HList parameters -&gt; HList tensorParameters)
-&gt; (GRU inputSize hiddenSize numLayers directionality dtype device
    -&gt; HList parameters)
-&gt; GRU inputSize hiddenSize numLayers directionality dtype device
-&gt; HList tensorParameters
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GRU inputSize hiddenSize numLayers directionality dtype device
-&gt; HList parameters
forall f (as :: [Type]). Parameterized f as =&gt; f -&gt; HList as
</span><a href="Torch.Typed.Parameter.html#flattenParameters"><span class="hs-identifier hs-var">flattenParameters</span></a></span><span> </span><span class="annot"><span class="annottext">(GRU inputSize hiddenSize numLayers directionality dtype device
 -&gt; HList tensorParameters)
-&gt; GRU inputSize hiddenSize numLayers directionality dtype device
-&gt; HList tensorParameters
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GRU inputSize hiddenSize numLayers directionality dtype device
</span><a href="#local-6989586621679806914"><span class="hs-identifier hs-var">gruModel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-525"></span><span>    </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679806912"><span class="hs-identifier hs-var">dropoutProb</span></a></span><span>
</span><span id="line-526"></span><span>    </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679806915"><span class="hs-identifier hs-var">dropoutOn</span></a></span><span>
</span><span id="line-527"></span><span>    </span><span class="annot"><span class="annottext">Tensor device dtype hcShape
</span><a href="#local-6989586621679806904"><span class="hs-identifier hs-var">hc'</span></a></span><span>
</span><span id="line-528"></span><span>    </span><span class="annot"><span class="annottext">Tensor device dtype inputShape
</span><a href="#local-6989586621679806910"><span class="hs-identifier hs-var">input</span></a></span><span>
</span><span id="line-529"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-530"></span><span>    </span><span id="local-6989586621679806904"><span class="annot"><span class="annottext">hc' :: Tensor device dtype hcShape
</span><a href="#local-6989586621679806904"><span class="hs-identifier hs-var hs-var">hc'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-531"></span><span>      </span><span class="annot"><span class="annottext">forall (shape' :: [Nat]) (shape :: [Nat]) (dtype :: DType)
       (device :: (DeviceType, Nat)).
(KnownShape shape', Numel shape ~ Numel shape') =&gt;
Tensor device dtype shape -&gt; Tensor device dtype shape'
forall (shape :: [Nat]) (dtype :: DType)
       (device :: (DeviceType, Nat)).
(KnownShape hcShape, Numel shape ~ Numel hcShape) =&gt;
Tensor device dtype shape -&gt; Tensor device dtype hcShape
</span><a href="Torch.Typed.Tensor.html#reshape"><span class="hs-identifier hs-var">reshape</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807297"><span class="hs-identifier hs-type">hcShape</span></a></span><span>
</span><span id="line-532"></span><span>        </span><span class="annot"><span class="annottext">(Tensor
   device
   dtype
   '[batchSize, numLayers * NumberOfDirections directionality,
     hiddenSize]
 -&gt; Tensor device dtype hcShape)
-&gt; (Tensor
      device
      dtype
      '[numLayers * NumberOfDirections directionality, hiddenSize]
    -&gt; Tensor
         device
         dtype
         '[batchSize, numLayers * NumberOfDirections directionality,
           hiddenSize])
-&gt; Tensor
     device
     dtype
     '[numLayers * NumberOfDirections directionality, hiddenSize]
-&gt; Tensor device dtype hcShape
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; Tensor
     device
     dtype
     '[numLayers * NumberOfDirections directionality, hiddenSize]
-&gt; Tensor
     device
     dtype
     '[batchSize, numLayers * NumberOfDirections directionality,
       hiddenSize]
forall (shape' :: [Nat]) (shape :: [Nat]) (dtype :: DType)
       (device :: (DeviceType, Nat)).
(KnownShape shape', shape' ~ Broadcast shape shape') =&gt;
Bool -&gt; Tensor device dtype shape -&gt; Tensor device dtype shape'
</span><a href="Torch.Typed.Functional.html#expand"><span class="hs-identifier hs-var">expand</span></a></span><span>
</span><span id="line-533"></span><span>          </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679807305"><span class="hs-identifier hs-type">batchSize</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679807306"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">*</span></span><span> </span><span class="annot"><a href="Torch.Typed.Functional.html#NumberOfDirections"><span class="hs-identifier hs-type">NumberOfDirections</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807307"><span class="hs-identifier hs-type">directionality</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679807304"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-534"></span><span>          </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-comment">-- TODO: What does the bool do?</span><span>
</span><span id="line-535"></span><span>        </span><span class="annot"><span class="annottext">(Tensor
   device
   dtype
   '[numLayers * NumberOfDirections directionality, hiddenSize]
 -&gt; Tensor device dtype hcShape)
-&gt; Tensor
     device
     dtype
     '[numLayers * NumberOfDirections directionality, hiddenSize]
-&gt; Tensor device dtype hcShape
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Tensor
  device
  dtype
  '[numLayers * NumberOfDirections directionality, hiddenSize]
</span><a href="#local-6989586621679806911"><span class="hs-identifier hs-var">hc</span></a></span><span>
</span><span id="line-536"></span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#gruForward"><span class="hs-identifier hs-var">gruForward</span></a></span><span> </span><span id="local-6989586621679806901"><span class="annot"><span class="annottext">dropoutOn :: Bool
</span><a href="#local-6989586621679806901"><span class="hs-identifier hs-var">dropoutOn</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUWithLearnedInit"><span class="hs-identifier hs-type">GRUWithLearnedInit</span></a></span><span> </span><span id="local-6989586621679806900"><span class="annot"><span class="annottext">gruModel :: GRU inputSize hiddenSize numLayers directionality dtype device
</span><a href="#local-6989586621679806900"><span class="hs-identifier hs-var">gruModel</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRU"><span class="hs-identifier hs-type">GRU</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Dropout.html#Dropout"><span class="hs-identifier hs-type">Dropout</span></a></span><span> </span><span id="local-6989586621679806899"><span class="annot"><span class="annottext">dropoutProb :: Double
</span><a href="#local-6989586621679806899"><span class="hs-identifier hs-var">dropoutProb</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679806898"><span class="annot"><span class="annottext">hc :: Parameter
  device
  dtype
  '[numLayers * NumberOfDirections directionality, hiddenSize]
</span><a href="#local-6989586621679806898"><span class="hs-identifier hs-var">hc</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679806897"><span class="annot"><span class="annottext">input :: Tensor device dtype inputShape
</span><a href="#local-6989586621679806897"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-537"></span><span>  </span><span class="annot"><span class="annottext">HList tensorParameters
-&gt; Double
-&gt; Bool
-&gt; Tensor device dtype hcShape
-&gt; Tensor device dtype inputShape
-&gt; (Tensor device dtype outputShape, Tensor device dtype hcShape)
forall k (shapeOrder :: RNNShapeOrder)
       (directionality :: RNNDirectionality) (numLayers :: Nat)
       (seqLen :: Nat) (batchSize :: Nat) (inputSize :: Nat)
       (outputSize :: Nat) (hiddenSize :: Nat) (inputShape :: [Nat])
       (outputShape :: [Nat]) (hcShape :: [Nat]) (tensorParameters :: [k])
       (dtype :: DType) (device :: (DeviceType, Nat)).
(KnownNat numLayers, KnownRNNShapeOrder shapeOrder,
 KnownRNNDirectionality directionality,
 outputSize ~ (hiddenSize * NumberOfDirections directionality),
 inputShape ~ RNNShape shapeOrder seqLen batchSize inputSize,
 outputShape ~ RNNShape shapeOrder seqLen batchSize outputSize,
 hcShape
 ~ '[numLayers * NumberOfDirections directionality, batchSize,
     hiddenSize],
 tensorParameters
 ~ GRUR inputSize hiddenSize numLayers directionality dtype device,
 Castable (HList tensorParameters) [ATenTensor]) =&gt;
HList tensorParameters
-&gt; Double
-&gt; Bool
-&gt; Tensor device dtype hcShape
-&gt; Tensor device dtype inputShape
-&gt; (Tensor device dtype outputShape, Tensor device dtype hcShape)
</span><a href="Torch.Typed.Functional.html#gru"><span class="hs-identifier hs-var">gru</span></a></span><span>
</span><span id="line-538"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807303"><span class="hs-identifier hs-type">shapeOrder</span></a></span><span>
</span><span id="line-539"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807307"><span class="hs-identifier hs-type">directionality</span></a></span><span>
</span><span id="line-540"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807306"><span class="hs-identifier hs-type">numLayers</span></a></span><span>
</span><span id="line-541"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807300"><span class="hs-identifier hs-type">seqLen</span></a></span><span>
</span><span id="line-542"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807305"><span class="hs-identifier hs-type">batchSize</span></a></span><span>
</span><span id="line-543"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807299"><span class="hs-identifier hs-type">inputSize</span></a></span><span>
</span><span id="line-544"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807302"><span class="hs-identifier hs-type">outputSize</span></a></span><span>
</span><span id="line-545"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807304"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span>
</span><span id="line-546"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807301"><span class="hs-identifier hs-type">inputShape</span></a></span><span>
</span><span id="line-547"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807298"><span class="hs-identifier hs-type">outputShape</span></a></span><span>
</span><span id="line-548"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807297"><span class="hs-identifier hs-type">hcShape</span></a></span><span>
</span><span id="line-549"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807293"><span class="hs-identifier hs-type">tensorParameters</span></a></span><span>
</span><span id="line-550"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807296"><span class="hs-identifier hs-type">dtype</span></a></span><span>
</span><span id="line-551"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807295"><span class="hs-identifier hs-type">device</span></a></span><span>
</span><span id="line-552"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ToDependent -&gt; HList parameters -&gt; HList tensorParameters
forall k f (xs :: [k]) (ys :: [k]).
HMap' f xs ys =&gt;
f -&gt; HList xs -&gt; HList ys
</span><a href="Torch.HList.html#hmap%27"><span class="hs-identifier hs-var">hmap'</span></a></span><span> </span><span class="annot"><span class="annottext">ToDependent
</span><a href="Torch.Typed.Parameter.html#ToDependent"><span class="hs-identifier hs-var">ToDependent</span></a></span><span> </span><span class="annot"><span class="annottext">(HList parameters -&gt; HList tensorParameters)
-&gt; (GRU inputSize hiddenSize numLayers directionality dtype device
    -&gt; HList parameters)
-&gt; GRU inputSize hiddenSize numLayers directionality dtype device
-&gt; HList tensorParameters
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GRU inputSize hiddenSize numLayers directionality dtype device
-&gt; HList parameters
forall f (as :: [Type]). Parameterized f as =&gt; f -&gt; HList as
</span><a href="Torch.Typed.Parameter.html#flattenParameters"><span class="hs-identifier hs-var">flattenParameters</span></a></span><span> </span><span class="annot"><span class="annottext">(GRU inputSize hiddenSize numLayers directionality dtype device
 -&gt; HList tensorParameters)
-&gt; GRU inputSize hiddenSize numLayers directionality dtype device
-&gt; HList tensorParameters
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GRU inputSize hiddenSize numLayers directionality dtype device
</span><a href="#local-6989586621679806900"><span class="hs-identifier hs-var">gruModel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-553"></span><span>    </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679806899"><span class="hs-identifier hs-var">dropoutProb</span></a></span><span>
</span><span id="line-554"></span><span>    </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679806901"><span class="hs-identifier hs-var">dropoutOn</span></a></span><span>
</span><span id="line-555"></span><span>    </span><span class="annot"><span class="annottext">Tensor device dtype hcShape
</span><a href="#local-6989586621679806896"><span class="hs-identifier hs-var">hc'</span></a></span><span>
</span><span id="line-556"></span><span>    </span><span class="annot"><span class="annottext">Tensor device dtype inputShape
</span><a href="#local-6989586621679806897"><span class="hs-identifier hs-var">input</span></a></span><span>
</span><span id="line-557"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-558"></span><span>    </span><span id="local-6989586621679806896"><span class="annot"><span class="annottext">hc' :: Tensor device dtype hcShape
</span><a href="#local-6989586621679806896"><span class="hs-identifier hs-var hs-var">hc'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-559"></span><span>      </span><span class="annot"><span class="annottext">forall (shape' :: [Nat]) (shape :: [Nat]) (dtype :: DType)
       (device :: (DeviceType, Nat)).
(KnownShape shape', Numel shape ~ Numel shape') =&gt;
Tensor device dtype shape -&gt; Tensor device dtype shape'
forall (shape :: [Nat]) (dtype :: DType)
       (device :: (DeviceType, Nat)).
(KnownShape hcShape, Numel shape ~ Numel hcShape) =&gt;
Tensor device dtype shape -&gt; Tensor device dtype hcShape
</span><a href="Torch.Typed.Tensor.html#reshape"><span class="hs-identifier hs-var">reshape</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807297"><span class="hs-identifier hs-type">hcShape</span></a></span><span>
</span><span id="line-560"></span><span>        </span><span class="annot"><span class="annottext">(Tensor
   device
   dtype
   '[batchSize, numLayers * NumberOfDirections directionality,
     hiddenSize]
 -&gt; Tensor device dtype hcShape)
-&gt; (Parameter
      device
      dtype
      '[numLayers * NumberOfDirections directionality, hiddenSize]
    -&gt; Tensor
         device
         dtype
         '[batchSize, numLayers * NumberOfDirections directionality,
           hiddenSize])
-&gt; Parameter
     device
     dtype
     '[numLayers * NumberOfDirections directionality, hiddenSize]
-&gt; Tensor device dtype hcShape
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; Tensor
     device
     dtype
     '[numLayers * NumberOfDirections directionality, hiddenSize]
-&gt; Tensor
     device
     dtype
     '[batchSize, numLayers * NumberOfDirections directionality,
       hiddenSize]
forall (shape' :: [Nat]) (shape :: [Nat]) (dtype :: DType)
       (device :: (DeviceType, Nat)).
(KnownShape shape', shape' ~ Broadcast shape shape') =&gt;
Bool -&gt; Tensor device dtype shape -&gt; Tensor device dtype shape'
</span><a href="Torch.Typed.Functional.html#expand"><span class="hs-identifier hs-var">expand</span></a></span><span>
</span><span id="line-561"></span><span>          </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679807305"><span class="hs-identifier hs-type">batchSize</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679807306"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">*</span></span><span> </span><span class="annot"><a href="Torch.Typed.Functional.html#NumberOfDirections"><span class="hs-identifier hs-type">NumberOfDirections</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807307"><span class="hs-identifier hs-type">directionality</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679807304"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-562"></span><span>          </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-comment">-- TODO: What does the bool do?</span><span>
</span><span id="line-563"></span><span>        </span><span class="annot"><span class="annottext">(Tensor
   device
   dtype
   '[numLayers * NumberOfDirections directionality, hiddenSize]
 -&gt; Tensor
      device
      dtype
      '[batchSize, numLayers * NumberOfDirections directionality,
        hiddenSize])
-&gt; (Parameter
      device
      dtype
      '[numLayers * NumberOfDirections directionality, hiddenSize]
    -&gt; Tensor
         device
         dtype
         '[numLayers * NumberOfDirections directionality, hiddenSize])
-&gt; Parameter
     device
     dtype
     '[numLayers * NumberOfDirections directionality, hiddenSize]
-&gt; Tensor
     device
     dtype
     '[batchSize, numLayers * NumberOfDirections directionality,
       hiddenSize]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Parameter
  device
  dtype
  '[numLayers * NumberOfDirections directionality, hiddenSize]
-&gt; Tensor
     device
     dtype
     '[numLayers * NumberOfDirections directionality, hiddenSize]
forall (shape :: [Nat]) (dtype :: DType)
       (device :: (DeviceType, Nat)).
Parameter device dtype shape -&gt; Tensor device dtype shape
</span><a href="Torch.Typed.Parameter.html#toDependent"><span class="hs-identifier hs-var">toDependent</span></a></span><span>
</span><span id="line-564"></span><span>        </span><span class="annot"><span class="annottext">(Parameter
   device
   dtype
   '[numLayers * NumberOfDirections directionality, hiddenSize]
 -&gt; Tensor device dtype hcShape)
-&gt; Parameter
     device
     dtype
     '[numLayers * NumberOfDirections directionality, hiddenSize]
-&gt; Tensor device dtype hcShape
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Parameter
  device
  dtype
  '[numLayers * NumberOfDirections directionality, hiddenSize]
</span><a href="#local-6989586621679806898"><span class="hs-identifier hs-var">hc</span></a></span><span>
</span><span id="line-565"></span><span>
</span><span id="line-566"></span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#gruForwardWithDropout"><span class="hs-identifier hs-type">gruForwardWithDropout</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-567"></span><span>  </span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#gruForwardWithoutDropout"><span class="hs-identifier hs-type">gruForwardWithoutDropout</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-568"></span><span>    </span><span class="hs-keyword">forall</span><span>
</span><span id="line-569"></span><span>      </span><span id="local-6989586621679806892"><span class="annot"><a href="#local-6989586621679806892"><span class="hs-identifier hs-type">shapeOrder</span></a></span></span><span>
</span><span id="line-570"></span><span>      </span><span id="local-6989586621679806891"><span class="annot"><a href="#local-6989586621679806891"><span class="hs-identifier hs-type">batchSize</span></a></span></span><span>
</span><span id="line-571"></span><span>      </span><span id="local-6989586621679806890"><span class="annot"><a href="#local-6989586621679806890"><span class="hs-identifier hs-type">seqLen</span></a></span></span><span>
</span><span id="line-572"></span><span>      </span><span id="local-6989586621679806889"><span class="annot"><a href="#local-6989586621679806889"><span class="hs-identifier hs-type">directionality</span></a></span></span><span>
</span><span id="line-573"></span><span>      </span><span id="local-6989586621679806888"><span class="annot"><a href="#local-6989586621679806888"><span class="hs-identifier hs-type">initialization</span></a></span></span><span>
</span><span id="line-574"></span><span>      </span><span id="local-6989586621679806887"><span class="annot"><a href="#local-6989586621679806887"><span class="hs-identifier hs-type">numLayers</span></a></span></span><span>
</span><span id="line-575"></span><span>      </span><span id="local-6989586621679806886"><span class="annot"><a href="#local-6989586621679806886"><span class="hs-identifier hs-type">inputSize</span></a></span></span><span>
</span><span id="line-576"></span><span>      </span><span id="local-6989586621679806885"><span class="annot"><a href="#local-6989586621679806885"><span class="hs-identifier hs-type">outputSize</span></a></span></span><span>
</span><span id="line-577"></span><span>      </span><span id="local-6989586621679806884"><span class="annot"><a href="#local-6989586621679806884"><span class="hs-identifier hs-type">hiddenSize</span></a></span></span><span>
</span><span id="line-578"></span><span>      </span><span id="local-6989586621679806883"><span class="annot"><a href="#local-6989586621679806883"><span class="hs-identifier hs-type">inputShape</span></a></span></span><span>
</span><span id="line-579"></span><span>      </span><span id="local-6989586621679806882"><span class="annot"><a href="#local-6989586621679806882"><span class="hs-identifier hs-type">outputShape</span></a></span></span><span>
</span><span id="line-580"></span><span>      </span><span id="local-6989586621679806881"><span class="annot"><a href="#local-6989586621679806881"><span class="hs-identifier hs-type">hcShape</span></a></span></span><span>
</span><span id="line-581"></span><span>      </span><span id="local-6989586621679806880"><span class="annot"><a href="#local-6989586621679806880"><span class="hs-identifier hs-type">parameters</span></a></span></span><span>
</span><span id="line-582"></span><span>      </span><span id="local-6989586621679806879"><span class="annot"><a href="#local-6989586621679806879"><span class="hs-identifier hs-type">tensorParameters</span></a></span></span><span>
</span><span id="line-583"></span><span>      </span><span id="local-6989586621679806878"><span class="annot"><a href="#local-6989586621679806878"><span class="hs-identifier hs-type">dtype</span></a></span></span><span>
</span><span id="line-584"></span><span>      </span><span id="local-6989586621679806877"><span class="annot"><a href="#local-6989586621679806877"><span class="hs-identifier hs-type">device</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-585"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.Functional.html#NumberOfDirections"><span class="hs-identifier hs-type">NumberOfDirections</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806889"><span class="hs-identifier hs-type">directionality</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-586"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679806887"><span class="hs-identifier hs-type">numLayers</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-587"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679806891"><span class="hs-identifier hs-type">batchSize</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-588"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679806884"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-589"></span><span>      </span><span class="annot"><a href="Torch.Typed.Functional.html#KnownRNNShapeOrder"><span class="hs-identifier hs-type">KnownRNNShapeOrder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806892"><span class="hs-identifier hs-type">shapeOrder</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-590"></span><span>      </span><span class="annot"><a href="Torch.Typed.Functional.html#KnownRNNDirectionality"><span class="hs-identifier hs-type">KnownRNNDirectionality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806889"><span class="hs-identifier hs-type">directionality</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-591"></span><span>      </span><span class="annot"><a href="#local-6989586621679806885"><span class="hs-identifier hs-type">outputSize</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679806884"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">*</span></span><span> </span><span class="annot"><a href="Torch.Typed.Functional.html#NumberOfDirections"><span class="hs-identifier hs-type">NumberOfDirections</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806889"><span class="hs-identifier hs-type">directionality</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-592"></span><span>      </span><span class="annot"><a href="#local-6989586621679806883"><span class="hs-identifier hs-type">inputShape</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.Typed.Functional.html#RNNShape"><span class="hs-identifier hs-type">RNNShape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806892"><span class="hs-identifier hs-type">shapeOrder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806890"><span class="hs-identifier hs-type">seqLen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806891"><span class="hs-identifier hs-type">batchSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806886"><span class="hs-identifier hs-type">inputSize</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-593"></span><span>      </span><span class="annot"><a href="#local-6989586621679806882"><span class="hs-identifier hs-type">outputShape</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.Typed.Functional.html#RNNShape"><span class="hs-identifier hs-type">RNNShape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806892"><span class="hs-identifier hs-type">shapeOrder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806890"><span class="hs-identifier hs-type">seqLen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806891"><span class="hs-identifier hs-type">batchSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806885"><span class="hs-identifier hs-type">outputSize</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-594"></span><span>      </span><span class="annot"><a href="#local-6989586621679806881"><span class="hs-identifier hs-type">hcShape</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679806887"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">*</span></span><span> </span><span class="annot"><a href="Torch.Typed.Functional.html#NumberOfDirections"><span class="hs-identifier hs-type">NumberOfDirections</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806889"><span class="hs-identifier hs-type">directionality</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679806891"><span class="hs-identifier hs-type">batchSize</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679806884"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-595"></span><span>      </span><span class="annot"><a href="Torch.Typed.Parameter.html#Parameterized"><span class="hs-identifier hs-type">Parameterized</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRU"><span class="hs-identifier hs-type">GRU</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806886"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806884"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806887"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806889"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806878"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806877"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679806880"><span class="hs-identifier hs-type">parameters</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-596"></span><span>      </span><span class="annot"><a href="#local-6989586621679806879"><span class="hs-identifier hs-type">tensorParameters</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.Typed.Functional.html#GRUR"><span class="hs-identifier hs-type">GRUR</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806886"><span class="hs-identifier hs-type">inputSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806884"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806887"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806889"><span class="hs-identifier hs-type">directionality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806878"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806877"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-597"></span><span>      </span><span class="annot"><a href="../../../../libtorch-ffi/html/src"><span class="hs-identifier hs-type">ATen.Castable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.HList.html#HList"><span class="hs-identifier hs-type">HList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806879"><span class="hs-identifier hs-type">tensorParameters</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Torch.Tensor.html#ATenTensor"><span class="hs-identifier hs-type">D.ATenTensor</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-598"></span><span>      </span><span class="annot"><a href="Torch.HList.html#HMap%27"><span class="hs-identifier hs-type">HMap'</span></a></span><span> </span><span class="annot"><a href="Torch.Typed.Parameter.html#ToDependent"><span class="hs-identifier hs-type">ToDependent</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806880"><span class="hs-identifier hs-type">parameters</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806879"><span class="hs-identifier hs-type">tensorParameters</span></a></span><span>
</span><span id="line-599"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-600"></span><span>    </span><span class="annot"><a href="Torch.Typed.NN.Recurrent.GRU.html#GRUWithInit"><span class="hs-identifier hs-type">GRUWithInit</span></a></span><span>
</span><span id="line-601"></span><span>      </span><span class="annot"><a href="#local-6989586621679806886"><span class="hs-identifier hs-type">inputSize</span></a></span><span>
</span><span id="line-602"></span><span>      </span><span class="annot"><a href="#local-6989586621679806884"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span>
</span><span id="line-603"></span><span>      </span><span class="annot"><a href="#local-6989586621679806887"><span class="hs-identifier hs-type">numLayers</span></a></span><span>
</span><span id="line-604"></span><span>      </span><span class="annot"><a href="#local-6989586621679806889"><span class="hs-identifier hs-type">directionality</span></a></span><span>
</span><span id="line-605"></span><span>      </span><span class="annot"><a href="#local-6989586621679806888"><span class="hs-identifier hs-type">initialization</span></a></span><span>
</span><span id="line-606"></span><span>      </span><span class="annot"><a href="#local-6989586621679806878"><span class="hs-identifier hs-type">dtype</span></a></span><span>
</span><span id="line-607"></span><span>      </span><span class="annot"><a href="#local-6989586621679806877"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-608"></span><span>    </span><span class="annot"><a href="Torch.Typed.Tensor.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806877"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806878"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806883"><span class="hs-identifier hs-type">inputShape</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-609"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.Typed.Tensor.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806877"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806878"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806882"><span class="hs-identifier hs-type">outputShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-610"></span><span>      </span><span class="annot"><a href="Torch.Typed.Tensor.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806877"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806878"><span class="hs-identifier hs-type">dtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806881"><span class="hs-identifier hs-type">hcShape</span></a></span><span>
</span><span id="line-611"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-612"></span><span class="hs-comment">-- ^ Forward propagate the `GRU` module and apply dropout on the outputs of each layer.</span><span>
</span><span id="line-613"></span><span class="hs-comment">--</span><span>
</span><span id="line-614"></span><span class="hs-comment">-- &gt;&gt;&gt; input :: CPUTensor 'D.Float '[5,16,10] &lt;- randn</span><span>
</span><span id="line-615"></span><span class="hs-comment">-- &gt;&gt;&gt; spec = GRUWithZerosInitSpec @10 @30 @3 @'Bidirectional @'D.Float @'( 'D.CPU, 0) (GRUSpec (DropoutSpec 0.5))</span><span>
</span><span id="line-616"></span><span class="hs-comment">-- &gt;&gt;&gt; model &lt;- A.sample spec</span><span>
</span><span id="line-617"></span><span class="hs-comment">-- &gt;&gt;&gt; :t gruForwardWithDropout @'BatchFirst model input</span><span>
</span><span id="line-618"></span><span class="hs-comment">-- gruForwardWithDropout @'BatchFirst model input</span><span>
</span><span id="line-619"></span><span class="hs-comment">--   :: (Tensor '( 'D.CPU, 0) 'D.Float '[5, 16, 60],</span><span>
</span><span id="line-620"></span><span class="hs-comment">--       Tensor '( 'D.CPU, 0) 'D.Float '[6, 5, 30])</span><span>
</span><span id="line-621"></span><span class="hs-comment">-- &gt;&gt;&gt; gruForwardWithDropout @'BatchFirst model input</span><span>
</span><span id="line-622"></span><span class="hs-comment">-- (Tensor Float [5,16,60] ,Tensor Float [6,5,30] )</span><span>
</span><span id="line-623"></span><span id="gruForwardWithDropout"><span class="annot"><span class="annottext">gruForwardWithDropout :: GRUWithInit
  inputSize
  hiddenSize
  numLayers
  directionality
  initialization
  dtype
  device
-&gt; Tensor device dtype inputShape
-&gt; (Tensor device dtype outputShape, Tensor device dtype hcShape)
</span><a href="Torch.Typed.NN.Recurrent.GRU.html#gruForwardWithDropout"><span class="hs-identifier hs-var hs-var">gruForwardWithDropout</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-624"></span><span>  </span><span class="annot"><span class="annottext">Bool
-&gt; GRUWithInit
     inputSize
     hiddenSize
     numLayers
     directionality
     initialization
     dtype
     device
-&gt; Tensor device dtype inputShape
-&gt; (Tensor device dtype outputShape, Tensor device dtype hcShape)
forall (shapeOrder :: RNNShapeOrder) (batchSize :: Nat)
       (seqLen :: Nat) (directionality :: RNNDirectionality)
       (initialization :: RNNInitialization) (numLayers :: Nat)
       (inputSize :: Nat) (outputSize :: Nat) (hiddenSize :: Nat)
       (inputShape :: [Nat]) (outputShape :: [Nat]) (hcShape :: [Nat])
       (parameters :: [Type]) (tensorParameters :: [Type])
       (dtype :: DType) (device :: (DeviceType, Nat)).
(KnownNat (NumberOfDirections directionality), KnownNat numLayers,
 KnownNat batchSize, KnownNat hiddenSize,
 KnownRNNShapeOrder shapeOrder,
 KnownRNNDirectionality directionality,
 outputSize ~ (hiddenSize * NumberOfDirections directionality),
 inputShape ~ RNNShape shapeOrder seqLen batchSize inputSize,
 outputShape ~ RNNShape shapeOrder seqLen batchSize outputSize,
 hcShape
 ~ '[numLayers * NumberOfDirections directionality, batchSize,
     hiddenSize],
 Parameterized
   (GRU inputSize hiddenSize numLayers directionality dtype device)
   parameters,
 tensorParameters
 ~ GRUR inputSize hiddenSize numLayers directionality dtype device,
 Castable (HList tensorParameters) [ATenTensor],
 HMap' ToDependent parameters tensorParameters) =&gt;
Bool
-&gt; GRUWithInit
     inputSize
     hiddenSize
     numLayers
     directionality
     initialization
     dtype
     device
-&gt; Tensor device dtype inputShape
-&gt; (Tensor device dtype outputShape, Tensor device dtype hcShape)
</span><a href="Torch.Typed.NN.Recurrent.GRU.html#gruForward"><span class="hs-identifier hs-var">gruForward</span></a></span><span>
</span><span id="line-625"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679806892"><span class="hs-identifier hs-type">shapeOrder</span></a></span><span>
</span><span id="line-626"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679806891"><span class="hs-identifier hs-type">batchSize</span></a></span><span>
</span><span id="line-627"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679806890"><span class="hs-identifier hs-type">seqLen</span></a></span><span>
</span><span id="line-628"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679806889"><span class="hs-identifier hs-type">directionality</span></a></span><span>
</span><span id="line-629"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679806888"><span class="hs-identifier hs-type">initialization</span></a></span><span>
</span><span id="line-630"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679806887"><span class="hs-identifier hs-type">numLayers</span></a></span><span>
</span><span id="line-631"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679806886"><span class="hs-identifier hs-type">inputSize</span></a></span><span>
</span><span id="line-632"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679806885"><span class="hs-identifier hs-type">outputSize</span></a></span><span>
</span><span id="line-633"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679806884"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span>
</span><span id="line-634"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679806883"><span class="hs-identifier hs-type">inputShape</span></a></span><span>
</span><span id="line-635"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679806882"><span class="hs-identifier hs-type">outputShape</span></a></span><span>
</span><span id="line-636"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679806881"><span class="hs-identifier hs-type">hcShape</span></a></span><span>
</span><span id="line-637"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679806880"><span class="hs-identifier hs-type">parameters</span></a></span><span>
</span><span id="line-638"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679806879"><span class="hs-identifier hs-type">tensorParameters</span></a></span><span>
</span><span id="line-639"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679806878"><span class="hs-identifier hs-type">dtype</span></a></span><span>
</span><span id="line-640"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679806877"><span class="hs-identifier hs-type">device</span></a></span><span>
</span><span id="line-641"></span><span>    </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-642"></span><span class="hs-comment">-- ^ Forward propagate the `GRU` module (without applying dropout on the outputs of each layer).</span><span>
</span><span id="line-643"></span><span class="hs-comment">--</span><span>
</span><span id="line-644"></span><span class="hs-comment">-- &gt;&gt;&gt; input :: CPUTensor 'D.Float '[5,16,10] &lt;- randn</span><span>
</span><span id="line-645"></span><span class="hs-comment">-- &gt;&gt;&gt; spec = GRUWithZerosInitSpec @10 @30 @3 @'Bidirectional @'D.Float @'( 'D.CPU, 0) (GRUSpec (DropoutSpec 0.5))</span><span>
</span><span id="line-646"></span><span class="hs-comment">-- &gt;&gt;&gt; model &lt;- A.sample spec</span><span>
</span><span id="line-647"></span><span class="hs-comment">-- &gt;&gt;&gt; :t gruForwardWithoutDropout @'BatchFirst model input</span><span>
</span><span id="line-648"></span><span class="hs-comment">-- gruForwardWithoutDropout @'BatchFirst model input</span><span>
</span><span id="line-649"></span><span class="hs-comment">--   :: (Tensor '( 'D.CPU, 0) 'D.Float '[5, 16, 60],</span><span>
</span><span id="line-650"></span><span class="hs-comment">--       Tensor '( 'D.CPU, 0) 'D.Float '[6, 5, 30])</span><span>
</span><span id="line-651"></span><span class="hs-comment">-- &gt;&gt;&gt; gruForwardWithoutDropout @'BatchFirst model input</span><span>
</span><span id="line-652"></span><span class="hs-comment">-- (Tensor Float [5,16,60] ,Tensor Float [6,5,30] )</span><span>
</span><span id="line-653"></span><span id="gruForwardWithoutDropout"><span class="annot"><span class="annottext">gruForwardWithoutDropout :: GRUWithInit
  inputSize
  hiddenSize
  numLayers
  directionality
  initialization
  dtype
  device
-&gt; Tensor device dtype inputShape
-&gt; (Tensor device dtype outputShape, Tensor device dtype hcShape)
</span><a href="Torch.Typed.NN.Recurrent.GRU.html#gruForwardWithoutDropout"><span class="hs-identifier hs-var hs-var">gruForwardWithoutDropout</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-654"></span><span>  </span><span class="annot"><span class="annottext">Bool
-&gt; GRUWithInit
     inputSize
     hiddenSize
     numLayers
     directionality
     initialization
     dtype
     device
-&gt; Tensor device dtype inputShape
-&gt; (Tensor device dtype outputShape, Tensor device dtype hcShape)
forall (shapeOrder :: RNNShapeOrder) (batchSize :: Nat)
       (seqLen :: Nat) (directionality :: RNNDirectionality)
       (initialization :: RNNInitialization) (numLayers :: Nat)
       (inputSize :: Nat) (outputSize :: Nat) (hiddenSize :: Nat)
       (inputShape :: [Nat]) (outputShape :: [Nat]) (hcShape :: [Nat])
       (parameters :: [Type]) (tensorParameters :: [Type])
       (dtype :: DType) (device :: (DeviceType, Nat)).
(KnownNat (NumberOfDirections directionality), KnownNat numLayers,
 KnownNat batchSize, KnownNat hiddenSize,
 KnownRNNShapeOrder shapeOrder,
 KnownRNNDirectionality directionality,
 outputSize ~ (hiddenSize * NumberOfDirections directionality),
 inputShape ~ RNNShape shapeOrder seqLen batchSize inputSize,
 outputShape ~ RNNShape shapeOrder seqLen batchSize outputSize,
 hcShape
 ~ '[numLayers * NumberOfDirections directionality, batchSize,
     hiddenSize],
 Parameterized
   (GRU inputSize hiddenSize numLayers directionality dtype device)
   parameters,
 tensorParameters
 ~ GRUR inputSize hiddenSize numLayers directionality dtype device,
 Castable (HList tensorParameters) [ATenTensor],
 HMap' ToDependent parameters tensorParameters) =&gt;
Bool
-&gt; GRUWithInit
     inputSize
     hiddenSize
     numLayers
     directionality
     initialization
     dtype
     device
-&gt; Tensor device dtype inputShape
-&gt; (Tensor device dtype outputShape, Tensor device dtype hcShape)
</span><a href="Torch.Typed.NN.Recurrent.GRU.html#gruForward"><span class="hs-identifier hs-var">gruForward</span></a></span><span>
</span><span id="line-655"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679806892"><span class="hs-identifier hs-type">shapeOrder</span></a></span><span>
</span><span id="line-656"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679806891"><span class="hs-identifier hs-type">batchSize</span></a></span><span>
</span><span id="line-657"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679806890"><span class="hs-identifier hs-type">seqLen</span></a></span><span>
</span><span id="line-658"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679806889"><span class="hs-identifier hs-type">directionality</span></a></span><span>
</span><span id="line-659"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679806888"><span class="hs-identifier hs-type">initialization</span></a></span><span>
</span><span id="line-660"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679806887"><span class="hs-identifier hs-type">numLayers</span></a></span><span>
</span><span id="line-661"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679806886"><span class="hs-identifier hs-type">inputSize</span></a></span><span>
</span><span id="line-662"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679806885"><span class="hs-identifier hs-type">outputSize</span></a></span><span>
</span><span id="line-663"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679806884"><span class="hs-identifier hs-type">hiddenSize</span></a></span><span>
</span><span id="line-664"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679806883"><span class="hs-identifier hs-type">inputShape</span></a></span><span>
</span><span id="line-665"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679806882"><span class="hs-identifier hs-type">outputShape</span></a></span><span>
</span><span id="line-666"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679806881"><span class="hs-identifier hs-type">hcShape</span></a></span><span>
</span><span id="line-667"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679806880"><span class="hs-identifier hs-type">parameters</span></a></span><span>
</span><span id="line-668"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679806879"><span class="hs-identifier hs-type">tensorParameters</span></a></span><span>
</span><span id="line-669"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679806878"><span class="hs-identifier hs-type">dtype</span></a></span><span>
</span><span id="line-670"></span><span>    </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679806877"><span class="hs-identifier hs-type">device</span></a></span><span>
</span><span id="line-671"></span><span>    </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-672"></span></pre></body></html>